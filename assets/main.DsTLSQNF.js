import{F as VI,f as Wy}from"./ffmpeg.C6phY-E3.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const u of a.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&n(u)}).observe(document,{childList:!0,subtree:!0});function t(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(i){if(i.ep)return;i.ep=!0;const a=t(i);fetch(i.href,a)}})();var Of={exports:{}},Sl={},Ff={exports:{}},ze={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Gy;function MI(){if(Gy)return ze;Gy=1;var r=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),u=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),p=Symbol.for("react.memo"),g=Symbol.for("react.lazy"),_=Symbol.iterator;function E(L){return L===null||typeof L!="object"?null:(L=_&&L[_]||L["@@iterator"],typeof L=="function"?L:null)}var C={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},A=Object.assign,P={};function D(L,Z,Ee){this.props=L,this.context=Z,this.refs=P,this.updater=Ee||C}D.prototype.isReactComponent={},D.prototype.setState=function(L,Z){if(typeof L!="object"&&typeof L!="function"&&L!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,L,Z,"setState")},D.prototype.forceUpdate=function(L){this.updater.enqueueForceUpdate(this,L,"forceUpdate")};function B(){}B.prototype=D.prototype;function W(L,Z,Ee){this.props=L,this.context=Z,this.refs=P,this.updater=Ee||C}var $=W.prototype=new B;$.constructor=W,A($,D.prototype),$.isPureReactComponent=!0;var X=Array.isArray,F=Object.prototype.hasOwnProperty,U={current:null},N={key:!0,ref:!0,__self:!0,__source:!0};function I(L,Z,Ee){var be,Q={},ee=null,ye=null;if(Z!=null)for(be in Z.ref!==void 0&&(ye=Z.ref),Z.key!==void 0&&(ee=""+Z.key),Z)F.call(Z,be)&&!N.hasOwnProperty(be)&&(Q[be]=Z[be]);var te=arguments.length-2;if(te===1)Q.children=Ee;else if(1<te){for(var ve=Array(te),Oe=0;Oe<te;Oe++)ve[Oe]=arguments[Oe+2];Q.children=ve}if(L&&L.defaultProps)for(be in te=L.defaultProps,te)Q[be]===void 0&&(Q[be]=te[be]);return{$$typeof:r,type:L,key:ee,ref:ye,props:Q,_owner:U.current}}function R(L,Z){return{$$typeof:r,type:L.type,key:Z,ref:L.ref,props:L.props,_owner:L._owner}}function b(L){return typeof L=="object"&&L!==null&&L.$$typeof===r}function V(L){var Z={"=":"=0",":":"=2"};return"$"+L.replace(/[=:]/g,function(Ee){return Z[Ee]})}var M=/\/+/g;function k(L,Z){return typeof L=="object"&&L!==null&&L.key!=null?V(""+L.key):Z.toString(36)}function me(L,Z,Ee,be,Q){var ee=typeof L;(ee==="undefined"||ee==="boolean")&&(L=null);var ye=!1;if(L===null)ye=!0;else switch(ee){case"string":case"number":ye=!0;break;case"object":switch(L.$$typeof){case r:case e:ye=!0}}if(ye)return ye=L,Q=Q(ye),L=be===""?"."+k(ye,0):be,X(Q)?(Ee="",L!=null&&(Ee=L.replace(M,"$&/")+"/"),me(Q,Z,Ee,"",function(Oe){return Oe})):Q!=null&&(b(Q)&&(Q=R(Q,Ee+(!Q.key||ye&&ye.key===Q.key?"":(""+Q.key).replace(M,"$&/")+"/")+L)),Z.push(Q)),1;if(ye=0,be=be===""?".":be+":",X(L))for(var te=0;te<L.length;te++){ee=L[te];var ve=be+k(ee,te);ye+=me(ee,Z,Ee,ve,Q)}else if(ve=E(L),typeof ve=="function")for(L=ve.call(L),te=0;!(ee=L.next()).done;)ee=ee.value,ve=be+k(ee,te++),ye+=me(ee,Z,Ee,ve,Q);else if(ee==="object")throw Z=String(L),Error("Objects are not valid as a React child (found: "+(Z==="[object Object]"?"object with keys {"+Object.keys(L).join(", ")+"}":Z)+"). If you meant to render a collection of children, use an array instead.");return ye}function ce(L,Z,Ee){if(L==null)return L;var be=[],Q=0;return me(L,be,"","",function(ee){return Z.call(Ee,ee,Q++)}),be}function fe(L){if(L._status===-1){var Z=L._result;Z=Z(),Z.then(function(Ee){(L._status===0||L._status===-1)&&(L._status=1,L._result=Ee)},function(Ee){(L._status===0||L._status===-1)&&(L._status=2,L._result=Ee)}),L._status===-1&&(L._status=0,L._result=Z)}if(L._status===1)return L._result.default;throw L._result}var oe={current:null},ne={transition:null},se={ReactCurrentDispatcher:oe,ReactCurrentBatchConfig:ne,ReactCurrentOwner:U};function re(){throw Error("act(...) is not supported in production builds of React.")}return ze.Children={map:ce,forEach:function(L,Z,Ee){ce(L,function(){Z.apply(this,arguments)},Ee)},count:function(L){var Z=0;return ce(L,function(){Z++}),Z},toArray:function(L){return ce(L,function(Z){return Z})||[]},only:function(L){if(!b(L))throw Error("React.Children.only expected to receive a single React element child.");return L}},ze.Component=D,ze.Fragment=t,ze.Profiler=i,ze.PureComponent=W,ze.StrictMode=n,ze.Suspense=d,ze.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=se,ze.act=re,ze.cloneElement=function(L,Z,Ee){if(L==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+L+".");var be=A({},L.props),Q=L.key,ee=L.ref,ye=L._owner;if(Z!=null){if(Z.ref!==void 0&&(ee=Z.ref,ye=U.current),Z.key!==void 0&&(Q=""+Z.key),L.type&&L.type.defaultProps)var te=L.type.defaultProps;for(ve in Z)F.call(Z,ve)&&!N.hasOwnProperty(ve)&&(be[ve]=Z[ve]===void 0&&te!==void 0?te[ve]:Z[ve])}var ve=arguments.length-2;if(ve===1)be.children=Ee;else if(1<ve){te=Array(ve);for(var Oe=0;Oe<ve;Oe++)te[Oe]=arguments[Oe+2];be.children=te}return{$$typeof:r,type:L.type,key:Q,ref:ee,props:be,_owner:ye}},ze.createContext=function(L){return L={$$typeof:u,_currentValue:L,_currentValue2:L,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},L.Provider={$$typeof:a,_context:L},L.Consumer=L},ze.createElement=I,ze.createFactory=function(L){var Z=I.bind(null,L);return Z.type=L,Z},ze.createRef=function(){return{current:null}},ze.forwardRef=function(L){return{$$typeof:c,render:L}},ze.isValidElement=b,ze.lazy=function(L){return{$$typeof:g,_payload:{_status:-1,_result:L},_init:fe}},ze.memo=function(L,Z){return{$$typeof:p,type:L,compare:Z===void 0?null:Z}},ze.startTransition=function(L){var Z=ne.transition;ne.transition={};try{L()}finally{ne.transition=Z}},ze.unstable_act=re,ze.useCallback=function(L,Z){return oe.current.useCallback(L,Z)},ze.useContext=function(L){return oe.current.useContext(L)},ze.useDebugValue=function(){},ze.useDeferredValue=function(L){return oe.current.useDeferredValue(L)},ze.useEffect=function(L,Z){return oe.current.useEffect(L,Z)},ze.useId=function(){return oe.current.useId()},ze.useImperativeHandle=function(L,Z,Ee){return oe.current.useImperativeHandle(L,Z,Ee)},ze.useInsertionEffect=function(L,Z){return oe.current.useInsertionEffect(L,Z)},ze.useLayoutEffect=function(L,Z){return oe.current.useLayoutEffect(L,Z)},ze.useMemo=function(L,Z){return oe.current.useMemo(L,Z)},ze.useReducer=function(L,Z,Ee){return oe.current.useReducer(L,Z,Ee)},ze.useRef=function(L){return oe.current.useRef(L)},ze.useState=function(L){return oe.current.useState(L)},ze.useSyncExternalStore=function(L,Z,Ee){return oe.current.useSyncExternalStore(L,Z,Ee)},ze.useTransition=function(){return oe.current.useTransition()},ze.version="18.3.1",ze}var Ky;function zp(){return Ky||(Ky=1,Ff.exports=MI()),Ff.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Hy;function OI(){if(Hy)return Sl;Hy=1;var r=zp(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,i=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,a={key:!0,ref:!0,__self:!0,__source:!0};function u(c,d,p){var g,_={},E=null,C=null;p!==void 0&&(E=""+p),d.key!==void 0&&(E=""+d.key),d.ref!==void 0&&(C=d.ref);for(g in d)n.call(d,g)&&!a.hasOwnProperty(g)&&(_[g]=d[g]);if(c&&c.defaultProps)for(g in d=c.defaultProps,d)_[g]===void 0&&(_[g]=d[g]);return{$$typeof:e,type:c,key:E,ref:C,props:_,_owner:i.current}}return Sl.Fragment=t,Sl.jsx=u,Sl.jsxs=u,Sl}var Qy;function FI(){return Qy||(Qy=1,Of.exports=OI()),Of.exports}var T=FI(),he=zp(),Fc={},Lf={exports:{}},bn={},jf={exports:{}},Bf={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Xy;function LI(){return Xy||(Xy=1,function(r){function e(ne,se){var re=ne.length;ne.push(se);e:for(;0<re;){var L=re-1>>>1,Z=ne[L];if(0<i(Z,se))ne[L]=se,ne[re]=Z,re=L;else break e}}function t(ne){return ne.length===0?null:ne[0]}function n(ne){if(ne.length===0)return null;var se=ne[0],re=ne.pop();if(re!==se){ne[0]=re;e:for(var L=0,Z=ne.length,Ee=Z>>>1;L<Ee;){var be=2*(L+1)-1,Q=ne[be],ee=be+1,ye=ne[ee];if(0>i(Q,re))ee<Z&&0>i(ye,Q)?(ne[L]=ye,ne[ee]=re,L=ee):(ne[L]=Q,ne[be]=re,L=be);else if(ee<Z&&0>i(ye,re))ne[L]=ye,ne[ee]=re,L=ee;else break e}}return se}function i(ne,se){var re=ne.sortIndex-se.sortIndex;return re!==0?re:ne.id-se.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;r.unstable_now=function(){return a.now()}}else{var u=Date,c=u.now();r.unstable_now=function(){return u.now()-c}}var d=[],p=[],g=1,_=null,E=3,C=!1,A=!1,P=!1,D=typeof setTimeout=="function"?setTimeout:null,B=typeof clearTimeout=="function"?clearTimeout:null,W=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function $(ne){for(var se=t(p);se!==null;){if(se.callback===null)n(p);else if(se.startTime<=ne)n(p),se.sortIndex=se.expirationTime,e(d,se);else break;se=t(p)}}function X(ne){if(P=!1,$(ne),!A)if(t(d)!==null)A=!0,fe(F);else{var se=t(p);se!==null&&oe(X,se.startTime-ne)}}function F(ne,se){A=!1,P&&(P=!1,B(I),I=-1),C=!0;var re=E;try{for($(se),_=t(d);_!==null&&(!(_.expirationTime>se)||ne&&!V());){var L=_.callback;if(typeof L=="function"){_.callback=null,E=_.priorityLevel;var Z=L(_.expirationTime<=se);se=r.unstable_now(),typeof Z=="function"?_.callback=Z:_===t(d)&&n(d),$(se)}else n(d);_=t(d)}if(_!==null)var Ee=!0;else{var be=t(p);be!==null&&oe(X,be.startTime-se),Ee=!1}return Ee}finally{_=null,E=re,C=!1}}var U=!1,N=null,I=-1,R=5,b=-1;function V(){return!(r.unstable_now()-b<R)}function M(){if(N!==null){var ne=r.unstable_now();b=ne;var se=!0;try{se=N(!0,ne)}finally{se?k():(U=!1,N=null)}}else U=!1}var k;if(typeof W=="function")k=function(){W(M)};else if(typeof MessageChannel<"u"){var me=new MessageChannel,ce=me.port2;me.port1.onmessage=M,k=function(){ce.postMessage(null)}}else k=function(){D(M,0)};function fe(ne){N=ne,U||(U=!0,k())}function oe(ne,se){I=D(function(){ne(r.unstable_now())},se)}r.unstable_IdlePriority=5,r.unstable_ImmediatePriority=1,r.unstable_LowPriority=4,r.unstable_NormalPriority=3,r.unstable_Profiling=null,r.unstable_UserBlockingPriority=2,r.unstable_cancelCallback=function(ne){ne.callback=null},r.unstable_continueExecution=function(){A||C||(A=!0,fe(F))},r.unstable_forceFrameRate=function(ne){0>ne||125<ne?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):R=0<ne?Math.floor(1e3/ne):5},r.unstable_getCurrentPriorityLevel=function(){return E},r.unstable_getFirstCallbackNode=function(){return t(d)},r.unstable_next=function(ne){switch(E){case 1:case 2:case 3:var se=3;break;default:se=E}var re=E;E=se;try{return ne()}finally{E=re}},r.unstable_pauseExecution=function(){},r.unstable_requestPaint=function(){},r.unstable_runWithPriority=function(ne,se){switch(ne){case 1:case 2:case 3:case 4:case 5:break;default:ne=3}var re=E;E=ne;try{return se()}finally{E=re}},r.unstable_scheduleCallback=function(ne,se,re){var L=r.unstable_now();switch(typeof re=="object"&&re!==null?(re=re.delay,re=typeof re=="number"&&0<re?L+re:L):re=L,ne){case 1:var Z=-1;break;case 2:Z=250;break;case 5:Z=1073741823;break;case 4:Z=1e4;break;default:Z=5e3}return Z=re+Z,ne={id:g++,callback:se,priorityLevel:ne,startTime:re,expirationTime:Z,sortIndex:-1},re>L?(ne.sortIndex=re,e(p,ne),t(d)===null&&ne===t(p)&&(P?(B(I),I=-1):P=!0,oe(X,re-L))):(ne.sortIndex=Z,e(d,ne),A||C||(A=!0,fe(F))),ne},r.unstable_shouldYield=V,r.unstable_wrapCallback=function(ne){var se=E;return function(){var re=E;E=se;try{return ne.apply(this,arguments)}finally{E=re}}}}(Bf)),Bf}var Yy;function jI(){return Yy||(Yy=1,jf.exports=LI()),jf.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Zy;function BI(){if(Zy)return bn;Zy=1;var r=zp(),e=jI();function t(s){for(var o="https://reactjs.org/docs/error-decoder.html?invariant="+s,l=1;l<arguments.length;l++)o+="&args[]="+encodeURIComponent(arguments[l]);return"Minified React error #"+s+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var n=new Set,i={};function a(s,o){u(s,o),u(s+"Capture",o)}function u(s,o){for(i[s]=o,s=0;s<o.length;s++)n.add(o[s])}var c=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),d=Object.prototype.hasOwnProperty,p=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,g={},_={};function E(s){return d.call(_,s)?!0:d.call(g,s)?!1:p.test(s)?_[s]=!0:(g[s]=!0,!1)}function C(s,o,l,f){if(l!==null&&l.type===0)return!1;switch(typeof o){case"function":case"symbol":return!0;case"boolean":return f?!1:l!==null?!l.acceptsBooleans:(s=s.toLowerCase().slice(0,5),s!=="data-"&&s!=="aria-");default:return!1}}function A(s,o,l,f){if(o===null||typeof o>"u"||C(s,o,l,f))return!0;if(f)return!1;if(l!==null)switch(l.type){case 3:return!o;case 4:return o===!1;case 5:return isNaN(o);case 6:return isNaN(o)||1>o}return!1}function P(s,o,l,f,m,v,S){this.acceptsBooleans=o===2||o===3||o===4,this.attributeName=f,this.attributeNamespace=m,this.mustUseProperty=l,this.propertyName=s,this.type=o,this.sanitizeURL=v,this.removeEmptyString=S}var D={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(s){D[s]=new P(s,0,!1,s,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(s){var o=s[0];D[o]=new P(o,1,!1,s[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(s){D[s]=new P(s,2,!1,s.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(s){D[s]=new P(s,2,!1,s,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(s){D[s]=new P(s,3,!1,s.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(s){D[s]=new P(s,3,!0,s,null,!1,!1)}),["capture","download"].forEach(function(s){D[s]=new P(s,4,!1,s,null,!1,!1)}),["cols","rows","size","span"].forEach(function(s){D[s]=new P(s,6,!1,s,null,!1,!1)}),["rowSpan","start"].forEach(function(s){D[s]=new P(s,5,!1,s.toLowerCase(),null,!1,!1)});var B=/[\-:]([a-z])/g;function W(s){return s[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(s){var o=s.replace(B,W);D[o]=new P(o,1,!1,s,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(s){var o=s.replace(B,W);D[o]=new P(o,1,!1,s,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(s){var o=s.replace(B,W);D[o]=new P(o,1,!1,s,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(s){D[s]=new P(s,1,!1,s.toLowerCase(),null,!1,!1)}),D.xlinkHref=new P("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(s){D[s]=new P(s,1,!1,s.toLowerCase(),null,!0,!0)});function $(s,o,l,f){var m=D.hasOwnProperty(o)?D[o]:null;(m!==null?m.type!==0:f||!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(A(o,l,m,f)&&(l=null),f||m===null?E(o)&&(l===null?s.removeAttribute(o):s.setAttribute(o,""+l)):m.mustUseProperty?s[m.propertyName]=l===null?m.type===3?!1:"":l:(o=m.attributeName,f=m.attributeNamespace,l===null?s.removeAttribute(o):(m=m.type,l=m===3||m===4&&l===!0?"":""+l,f?s.setAttributeNS(f,o,l):s.setAttribute(o,l))))}var X=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,F=Symbol.for("react.element"),U=Symbol.for("react.portal"),N=Symbol.for("react.fragment"),I=Symbol.for("react.strict_mode"),R=Symbol.for("react.profiler"),b=Symbol.for("react.provider"),V=Symbol.for("react.context"),M=Symbol.for("react.forward_ref"),k=Symbol.for("react.suspense"),me=Symbol.for("react.suspense_list"),ce=Symbol.for("react.memo"),fe=Symbol.for("react.lazy"),oe=Symbol.for("react.offscreen"),ne=Symbol.iterator;function se(s){return s===null||typeof s!="object"?null:(s=ne&&s[ne]||s["@@iterator"],typeof s=="function"?s:null)}var re=Object.assign,L;function Z(s){if(L===void 0)try{throw Error()}catch(l){var o=l.stack.trim().match(/\n( *(at )?)/);L=o&&o[1]||""}return`
`+L+s}var Ee=!1;function be(s,o){if(!s||Ee)return"";Ee=!0;var l=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(o)if(o=function(){throw Error()},Object.defineProperty(o.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(o,[])}catch(Y){var f=Y}Reflect.construct(s,[],o)}else{try{o.call()}catch(Y){f=Y}s.call(o.prototype)}else{try{throw Error()}catch(Y){f=Y}s()}}catch(Y){if(Y&&f&&typeof Y.stack=="string"){for(var m=Y.stack.split(`
`),v=f.stack.split(`
`),S=m.length-1,O=v.length-1;1<=S&&0<=O&&m[S]!==v[O];)O--;for(;1<=S&&0<=O;S--,O--)if(m[S]!==v[O]){if(S!==1||O!==1)do if(S--,O--,0>O||m[S]!==v[O]){var j=`
`+m[S].replace(" at new "," at ");return s.displayName&&j.includes("<anonymous>")&&(j=j.replace("<anonymous>",s.displayName)),j}while(1<=S&&0<=O);break}}}finally{Ee=!1,Error.prepareStackTrace=l}return(s=s?s.displayName||s.name:"")?Z(s):""}function Q(s){switch(s.tag){case 5:return Z(s.type);case 16:return Z("Lazy");case 13:return Z("Suspense");case 19:return Z("SuspenseList");case 0:case 2:case 15:return s=be(s.type,!1),s;case 11:return s=be(s.type.render,!1),s;case 1:return s=be(s.type,!0),s;default:return""}}function ee(s){if(s==null)return null;if(typeof s=="function")return s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case N:return"Fragment";case U:return"Portal";case R:return"Profiler";case I:return"StrictMode";case k:return"Suspense";case me:return"SuspenseList"}if(typeof s=="object")switch(s.$$typeof){case V:return(s.displayName||"Context")+".Consumer";case b:return(s._context.displayName||"Context")+".Provider";case M:var o=s.render;return s=s.displayName,s||(s=o.displayName||o.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case ce:return o=s.displayName||null,o!==null?o:ee(s.type)||"Memo";case fe:o=s._payload,s=s._init;try{return ee(s(o))}catch{}}return null}function ye(s){var o=s.type;switch(s.tag){case 24:return"Cache";case 9:return(o.displayName||"Context")+".Consumer";case 10:return(o._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return s=o.render,s=s.displayName||s.name||"",o.displayName||(s!==""?"ForwardRef("+s+")":"ForwardRef");case 7:return"Fragment";case 5:return o;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ee(o);case 8:return o===I?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof o=="function")return o.displayName||o.name||null;if(typeof o=="string")return o}return null}function te(s){switch(typeof s){case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function ve(s){var o=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function Oe(s){var o=ve(s)?"checked":"value",l=Object.getOwnPropertyDescriptor(s.constructor.prototype,o),f=""+s[o];if(!s.hasOwnProperty(o)&&typeof l<"u"&&typeof l.get=="function"&&typeof l.set=="function"){var m=l.get,v=l.set;return Object.defineProperty(s,o,{configurable:!0,get:function(){return m.call(this)},set:function(S){f=""+S,v.call(this,S)}}),Object.defineProperty(s,o,{enumerable:l.enumerable}),{getValue:function(){return f},setValue:function(S){f=""+S},stopTracking:function(){s._valueTracker=null,delete s[o]}}}}function Be(s){s._valueTracker||(s._valueTracker=Oe(s))}function it(s){if(!s)return!1;var o=s._valueTracker;if(!o)return!0;var l=o.getValue(),f="";return s&&(f=ve(s)?s.checked?"true":"false":s.value),s=f,s!==l?(o.setValue(s),!0):!1}function Lt(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}function qe(s,o){var l=o.checked;return re({},o,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:l??s._wrapperState.initialChecked})}function hr(s,o){var l=o.defaultValue==null?"":o.defaultValue,f=o.checked!=null?o.checked:o.defaultChecked;l=te(o.value!=null?o.value:l),s._wrapperState={initialChecked:f,initialValue:l,controlled:o.type==="checkbox"||o.type==="radio"?o.checked!=null:o.value!=null}}function Mr(s,o){o=o.checked,o!=null&&$(s,"checked",o,!1)}function dr(s,o){Mr(s,o);var l=te(o.value),f=o.type;if(l!=null)f==="number"?(l===0&&s.value===""||s.value!=l)&&(s.value=""+l):s.value!==""+l&&(s.value=""+l);else if(f==="submit"||f==="reset"){s.removeAttribute("value");return}o.hasOwnProperty("value")?On(s,o.type,l):o.hasOwnProperty("defaultValue")&&On(s,o.type,te(o.defaultValue)),o.checked==null&&o.defaultChecked!=null&&(s.defaultChecked=!!o.defaultChecked)}function rs(s,o,l){if(o.hasOwnProperty("value")||o.hasOwnProperty("defaultValue")){var f=o.type;if(!(f!=="submit"&&f!=="reset"||o.value!==void 0&&o.value!==null))return;o=""+s._wrapperState.initialValue,l||o===s.value||(s.value=o),s.defaultValue=o}l=s.name,l!==""&&(s.name=""),s.defaultChecked=!!s._wrapperState.initialChecked,l!==""&&(s.name=l)}function On(s,o,l){(o!=="number"||Lt(s.ownerDocument)!==s)&&(l==null?s.defaultValue=""+s._wrapperState.initialValue:s.defaultValue!==""+l&&(s.defaultValue=""+l))}var Fn=Array.isArray;function ut(s,o,l,f){if(s=s.options,o){o={};for(var m=0;m<l.length;m++)o["$"+l[m]]=!0;for(l=0;l<s.length;l++)m=o.hasOwnProperty("$"+s[l].value),s[l].selected!==m&&(s[l].selected=m),m&&f&&(s[l].defaultSelected=!0)}else{for(l=""+te(l),o=null,m=0;m<s.length;m++){if(s[m].value===l){s[m].selected=!0,f&&(s[m].defaultSelected=!0);return}o!==null||s[m].disabled||(o=s[m])}o!==null&&(o.selected=!0)}}function Or(s,o){if(o.dangerouslySetInnerHTML!=null)throw Error(t(91));return re({},o,{value:void 0,defaultValue:void 0,children:""+s._wrapperState.initialValue})}function Ye(s,o){var l=o.value;if(l==null){if(l=o.children,o=o.defaultValue,l!=null){if(o!=null)throw Error(t(92));if(Fn(l)){if(1<l.length)throw Error(t(93));l=l[0]}o=l}o==null&&(o=""),l=o}s._wrapperState={initialValue:te(l)}}function In(s,o){var l=te(o.value),f=te(o.defaultValue);l!=null&&(l=""+l,l!==s.value&&(s.value=l),o.defaultValue==null&&s.defaultValue!==l&&(s.defaultValue=l)),f!=null&&(s.defaultValue=""+f)}function mn(s){var o=s.textContent;o===s._wrapperState.initialValue&&o!==""&&o!==null&&(s.value=o)}function dt(s){switch(s){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ft(s,o){return s==null||s==="http://www.w3.org/1999/xhtml"?dt(o):s==="http://www.w3.org/2000/svg"&&o==="foreignObject"?"http://www.w3.org/1999/xhtml":s}var Sn,ss=function(s){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(o,l,f,m){MSApp.execUnsafeLocalFunction(function(){return s(o,l,f,m)})}:s}(function(s,o){if(s.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in s)s.innerHTML=o;else{for(Sn=Sn||document.createElement("div"),Sn.innerHTML="<svg>"+o.valueOf().toString()+"</svg>",o=Sn.firstChild;s.firstChild;)s.removeChild(s.firstChild);for(;o.firstChild;)s.appendChild(o.firstChild)}});function Yn(s,o){if(o){var l=s.firstChild;if(l&&l===s.lastChild&&l.nodeType===3){l.nodeValue=o;return}}s.textContent=o}var Ln={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},jn=["Webkit","ms","Moz","O"];Object.keys(Ln).forEach(function(s){jn.forEach(function(o){o=o+s.charAt(0).toUpperCase()+s.substring(1),Ln[o]=Ln[s]})});function fr(s,o,l){return o==null||typeof o=="boolean"||o===""?"":l||typeof o!="number"||o===0||Ln.hasOwnProperty(s)&&Ln[s]?(""+o).trim():o+"px"}function Ti(s,o){s=s.style;for(var l in o)if(o.hasOwnProperty(l)){var f=l.indexOf("--")===0,m=fr(l,o[l],f);l==="float"&&(l="cssFloat"),f?s.setProperty(l,m):s[l]=m}}var Ii=re({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Si(s,o){if(o){if(Ii[s]&&(o.children!=null||o.dangerouslySetInnerHTML!=null))throw Error(t(137,s));if(o.dangerouslySetInnerHTML!=null){if(o.children!=null)throw Error(t(60));if(typeof o.dangerouslySetInnerHTML!="object"||!("__html"in o.dangerouslySetInnerHTML))throw Error(t(61))}if(o.style!=null&&typeof o.style!="object")throw Error(t(62))}}function Ps(s,o){if(s.indexOf("-")===-1)return typeof o.is=="string";switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Te=null;function Re(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var je=null,Ue=null,nt=null;function $t(s){if(s=ul(s)){if(typeof je!="function")throw Error(t(280));var o=s.stateNode;o&&(o=Zu(o),je(s.stateNode,s.type,o))}}function Rt(s){Ue?nt?nt.push(s):nt=[s]:Ue=s}function pr(){if(Ue){var s=Ue,o=nt;if(nt=Ue=null,$t(s),o)for(s=0;s<o.length;s++)$t(o[s])}}function Fr(s,o){return s(o)}function Ci(){}var mr=!1;function Ai(s,o,l){if(mr)return s(o,l);mr=!0;try{return Fr(s,o,l)}finally{mr=!1,(Ue!==null||nt!==null)&&(Ci(),pr())}}function pt(s,o){var l=s.stateNode;if(l===null)return null;var f=Zu(l);if(f===null)return null;l=f[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(f=!f.disabled)||(s=s.type,f=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!f;break e;default:s=!1}if(s)return null;if(l&&typeof l!="function")throw Error(t(231,o,typeof l));return l}var Ze=!1;if(c)try{var et={};Object.defineProperty(et,"passive",{get:function(){Ze=!0}}),window.addEventListener("test",et,et),window.removeEventListener("test",et,et)}catch{Ze=!1}function qt(s,o,l,f,m,v,S,O,j){var Y=Array.prototype.slice.call(arguments,3);try{o.apply(l,Y)}catch(ue){this.onError(ue)}}var gr=!1,Lr=null,gn=!1,is=null,ud={onError:function(s){gr=!0,Lr=s}};function Io(s,o,l,f,m,v,S,O,j){gr=!1,Lr=null,qt.apply(ud,arguments)}function Iu(s,o,l,f,m,v,S,O,j){if(Io.apply(this,arguments),gr){if(gr){var Y=Lr;gr=!1,Lr=null}else throw Error(t(198));gn||(gn=!0,is=Y)}}function yr(s){var o=s,l=s;if(s.alternate)for(;o.return;)o=o.return;else{s=o;do o=s,o.flags&4098&&(l=o.return),s=o.return;while(s)}return o.tag===3?l:null}function xi(s){if(s.tag===13){var o=s.memoizedState;if(o===null&&(s=s.alternate,s!==null&&(o=s.memoizedState)),o!==null)return o.dehydrated}return null}function vr(s){if(yr(s)!==s)throw Error(t(188))}function Su(s){var o=s.alternate;if(!o){if(o=yr(s),o===null)throw Error(t(188));return o!==s?null:s}for(var l=s,f=o;;){var m=l.return;if(m===null)break;var v=m.alternate;if(v===null){if(f=m.return,f!==null){l=f;continue}break}if(m.child===v.child){for(v=m.child;v;){if(v===l)return vr(m),s;if(v===f)return vr(m),o;v=v.sibling}throw Error(t(188))}if(l.return!==f.return)l=m,f=v;else{for(var S=!1,O=m.child;O;){if(O===l){S=!0,l=m,f=v;break}if(O===f){S=!0,f=m,l=v;break}O=O.sibling}if(!S){for(O=v.child;O;){if(O===l){S=!0,l=v,f=m;break}if(O===f){S=!0,f=v,l=m;break}O=O.sibling}if(!S)throw Error(t(189))}}if(l.alternate!==f)throw Error(t(190))}if(l.tag!==3)throw Error(t(188));return l.stateNode.current===l?s:o}function qa(s){return s=Su(s),s!==null?So(s):null}function So(s){if(s.tag===5||s.tag===6)return s;for(s=s.child;s!==null;){var o=So(s);if(o!==null)return o;s=s.sibling}return null}var Co=e.unstable_scheduleCallback,Wa=e.unstable_cancelCallback,Cu=e.unstable_shouldYield,cd=e.unstable_requestPaint,ct=e.unstable_now,Au=e.unstable_getCurrentPriorityLevel,Ni=e.unstable_ImmediatePriority,ks=e.unstable_UserBlockingPriority,Zn=e.unstable_NormalPriority,Ga=e.unstable_LowPriority,xu=e.unstable_IdlePriority,Ri=null,Bn=null;function Nu(s){if(Bn&&typeof Bn.onCommitFiberRoot=="function")try{Bn.onCommitFiberRoot(Ri,s,void 0,(s.current.flags&128)===128)}catch{}}var yn=Math.clz32?Math.clz32:Pu,Ka=Math.log,Ru=Math.LN2;function Pu(s){return s>>>=0,s===0?32:31-(Ka(s)/Ru|0)|0}var Ao=64,xo=4194304;function bs(s){switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return s&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return s}}function Pi(s,o){var l=s.pendingLanes;if(l===0)return 0;var f=0,m=s.suspendedLanes,v=s.pingedLanes,S=l&268435455;if(S!==0){var O=S&~m;O!==0?f=bs(O):(v&=S,v!==0&&(f=bs(v)))}else S=l&~m,S!==0?f=bs(S):v!==0&&(f=bs(v));if(f===0)return 0;if(o!==0&&o!==f&&!(o&m)&&(m=f&-f,v=o&-o,m>=v||m===16&&(v&4194240)!==0))return o;if(f&4&&(f|=l&16),o=s.entangledLanes,o!==0)for(s=s.entanglements,o&=f;0<o;)l=31-yn(o),m=1<<l,f|=s[l],o&=~m;return f}function hd(s,o){switch(s){case 1:case 2:case 4:return o+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function os(s,o){for(var l=s.suspendedLanes,f=s.pingedLanes,m=s.expirationTimes,v=s.pendingLanes;0<v;){var S=31-yn(v),O=1<<S,j=m[S];j===-1?(!(O&l)||O&f)&&(m[S]=hd(O,o)):j<=o&&(s.expiredLanes|=O),v&=~O}}function zn(s){return s=s.pendingLanes&-1073741825,s!==0?s:s&1073741824?1073741824:0}function ki(){var s=Ao;return Ao<<=1,!(Ao&4194240)&&(Ao=64),s}function Ds(s){for(var o=[],l=0;31>l;l++)o.push(s);return o}function Vs(s,o,l){s.pendingLanes|=o,o!==536870912&&(s.suspendedLanes=0,s.pingedLanes=0),s=s.eventTimes,o=31-yn(o),s[o]=l}function at(s,o){var l=s.pendingLanes&~o;s.pendingLanes=o,s.suspendedLanes=0,s.pingedLanes=0,s.expiredLanes&=o,s.mutableReadLanes&=o,s.entangledLanes&=o,o=s.entanglements;var f=s.eventTimes;for(s=s.expirationTimes;0<l;){var m=31-yn(l),v=1<<m;o[m]=0,f[m]=-1,s[m]=-1,l&=~v}}function Ms(s,o){var l=s.entangledLanes|=o;for(s=s.entanglements;l;){var f=31-yn(l),m=1<<f;m&o|s[f]&o&&(s[f]|=o),l&=~m}}var We=0;function Os(s){return s&=-s,1<s?4<s?s&268435455?16:536870912:4:1}var ku,No,bu,Du,Vu,Ha=!1,jr=[],Zt=null,_r=null,wr=null,Fs=new Map,Jn=new Map,Br=[],dd="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Mu(s,o){switch(s){case"focusin":case"focusout":Zt=null;break;case"dragenter":case"dragleave":_r=null;break;case"mouseover":case"mouseout":wr=null;break;case"pointerover":case"pointerout":Fs.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":Jn.delete(o.pointerId)}}function Cn(s,o,l,f,m,v){return s===null||s.nativeEvent!==v?(s={blockedOn:o,domEventName:l,eventSystemFlags:f,nativeEvent:v,targetContainers:[m]},o!==null&&(o=ul(o),o!==null&&No(o)),s):(s.eventSystemFlags|=f,o=s.targetContainers,m!==null&&o.indexOf(m)===-1&&o.push(m),s)}function fd(s,o,l,f,m){switch(o){case"focusin":return Zt=Cn(Zt,s,o,l,f,m),!0;case"dragenter":return _r=Cn(_r,s,o,l,f,m),!0;case"mouseover":return wr=Cn(wr,s,o,l,f,m),!0;case"pointerover":var v=m.pointerId;return Fs.set(v,Cn(Fs.get(v)||null,s,o,l,f,m)),!0;case"gotpointercapture":return v=m.pointerId,Jn.set(v,Cn(Jn.get(v)||null,s,o,l,f,m)),!0}return!1}function Ou(s){var o=Oi(s.target);if(o!==null){var l=yr(o);if(l!==null){if(o=l.tag,o===13){if(o=xi(l),o!==null){s.blockedOn=o,Vu(s.priority,function(){bu(l)});return}}else if(o===3&&l.stateNode.current.memoizedState.isDehydrated){s.blockedOn=l.tag===3?l.stateNode.containerInfo:null;return}}}s.blockedOn=null}function as(s){if(s.blockedOn!==null)return!1;for(var o=s.targetContainers;0<o.length;){var l=Ro(s.domEventName,s.eventSystemFlags,o[0],s.nativeEvent);if(l===null){l=s.nativeEvent;var f=new l.constructor(l.type,l);Te=f,l.target.dispatchEvent(f),Te=null}else return o=ul(l),o!==null&&No(o),s.blockedOn=l,!1;o.shift()}return!0}function bi(s,o,l){as(s)&&l.delete(o)}function Fu(){Ha=!1,Zt!==null&&as(Zt)&&(Zt=null),_r!==null&&as(_r)&&(_r=null),wr!==null&&as(wr)&&(wr=null),Fs.forEach(bi),Jn.forEach(bi)}function Er(s,o){s.blockedOn===o&&(s.blockedOn=null,Ha||(Ha=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,Fu)))}function Tr(s){function o(m){return Er(m,s)}if(0<jr.length){Er(jr[0],s);for(var l=1;l<jr.length;l++){var f=jr[l];f.blockedOn===s&&(f.blockedOn=null)}}for(Zt!==null&&Er(Zt,s),_r!==null&&Er(_r,s),wr!==null&&Er(wr,s),Fs.forEach(o),Jn.forEach(o),l=0;l<Br.length;l++)f=Br[l],f.blockedOn===s&&(f.blockedOn=null);for(;0<Br.length&&(l=Br[0],l.blockedOn===null);)Ou(l),l.blockedOn===null&&Br.shift()}var ls=X.ReactCurrentBatchConfig,Ls=!0;function vt(s,o,l,f){var m=We,v=ls.transition;ls.transition=null;try{We=1,Qa(s,o,l,f)}finally{We=m,ls.transition=v}}function pd(s,o,l,f){var m=We,v=ls.transition;ls.transition=null;try{We=4,Qa(s,o,l,f)}finally{We=m,ls.transition=v}}function Qa(s,o,l,f){if(Ls){var m=Ro(s,o,l,f);if(m===null)Cd(s,o,f,Di,l),Mu(s,f);else if(fd(m,s,o,l,f))f.stopPropagation();else if(Mu(s,f),o&4&&-1<dd.indexOf(s)){for(;m!==null;){var v=ul(m);if(v!==null&&ku(v),v=Ro(s,o,l,f),v===null&&Cd(s,o,f,Di,l),v===m)break;m=v}m!==null&&f.stopPropagation()}else Cd(s,o,f,null,l)}}var Di=null;function Ro(s,o,l,f){if(Di=null,s=Re(f),s=Oi(s),s!==null)if(o=yr(s),o===null)s=null;else if(l=o.tag,l===13){if(s=xi(o),s!==null)return s;s=null}else if(l===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;s=null}else o!==s&&(s=null);return Di=s,null}function Xa(s){switch(s){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Au()){case Ni:return 1;case ks:return 4;case Zn:case Ga:return 16;case xu:return 536870912;default:return 16}default:return 16}}var Un=null,Po=null,An=null;function Ya(){if(An)return An;var s,o=Po,l=o.length,f,m="value"in Un?Un.value:Un.textContent,v=m.length;for(s=0;s<l&&o[s]===m[s];s++);var S=l-s;for(f=1;f<=S&&o[l-f]===m[v-f];f++);return An=m.slice(s,1<f?1-f:void 0)}function ko(s){var o=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&o===13&&(s=13)):s=o,s===10&&(s=13),32<=s||s===13?s:0}function zr(){return!0}function Za(){return!1}function Jt(s){function o(l,f,m,v,S){this._reactName=l,this._targetInst=m,this.type=f,this.nativeEvent=v,this.target=S,this.currentTarget=null;for(var O in s)s.hasOwnProperty(O)&&(l=s[O],this[O]=l?l(v):v[O]);return this.isDefaultPrevented=(v.defaultPrevented!=null?v.defaultPrevented:v.returnValue===!1)?zr:Za,this.isPropagationStopped=Za,this}return re(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var l=this.nativeEvent;l&&(l.preventDefault?l.preventDefault():typeof l.returnValue!="unknown"&&(l.returnValue=!1),this.isDefaultPrevented=zr)},stopPropagation:function(){var l=this.nativeEvent;l&&(l.stopPropagation?l.stopPropagation():typeof l.cancelBubble!="unknown"&&(l.cancelBubble=!0),this.isPropagationStopped=zr)},persist:function(){},isPersistent:zr}),o}var Ir={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},bo=Jt(Ir),Ur=re({},Ir,{view:0,detail:0}),md=Jt(Ur),Do,us,js,Vi=re({},Ur,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:$r,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==js&&(js&&s.type==="mousemove"?(Do=s.screenX-js.screenX,us=s.screenY-js.screenY):us=Do=0,js=s),Do)},movementY:function(s){return"movementY"in s?s.movementY:us}}),Vo=Jt(Vi),Ja=re({},Vi,{dataTransfer:0}),Lu=Jt(Ja),Mo=re({},Ur,{relatedTarget:0}),Oo=Jt(Mo),ju=re({},Ir,{animationName:0,elapsedTime:0,pseudoElement:0}),cs=Jt(ju),Bu=re({},Ir,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),zu=Jt(Bu),Uu=re({},Ir,{data:0}),el=Jt(Uu),Fo={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},vn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},$u={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function qu(s){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(s):(s=$u[s])?!!o[s]:!1}function $r(){return qu}var h=re({},Ur,{key:function(s){if(s.key){var o=Fo[s.key]||s.key;if(o!=="Unidentified")return o}return s.type==="keypress"?(s=ko(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?vn[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:$r,charCode:function(s){return s.type==="keypress"?ko(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?ko(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),y=Jt(h),w=re({},Vi,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),x=Jt(w),G=re({},Ur,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:$r}),J=Jt(G),ge=re({},Ir,{propertyName:0,elapsedTime:0,pseudoElement:0}),rt=Jt(ge),jt=re({},Vi,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),Ke=Jt(jt),Wt=[9,13,27,32],Mt=c&&"CompositionEvent"in window,er=null;c&&"documentMode"in document&&(er=document.documentMode);var $n=c&&"TextEvent"in window&&!er,Mi=c&&(!Mt||er&&8<er&&11>=er),Lo=" ",jm=!1;function Bm(s,o){switch(s){case"keyup":return Wt.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function zm(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var jo=!1;function kT(s,o){switch(s){case"compositionend":return zm(o);case"keypress":return o.which!==32?null:(jm=!0,Lo);case"textInput":return s=o.data,s===Lo&&jm?null:s;default:return null}}function bT(s,o){if(jo)return s==="compositionend"||!Mt&&Bm(s,o)?(s=Ya(),An=Po=Un=null,jo=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return Mi&&o.locale!=="ko"?null:o.data;default:return null}}var DT={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Um(s){var o=s&&s.nodeName&&s.nodeName.toLowerCase();return o==="input"?!!DT[s.type]:o==="textarea"}function $m(s,o,l,f){Rt(f),o=Qu(o,"onChange"),0<o.length&&(l=new bo("onChange","change",null,l,f),s.push({event:l,listeners:o}))}var tl=null,nl=null;function VT(s){ag(s,0)}function Wu(s){var o=qo(s);if(it(o))return s}function MT(s,o){if(s==="change")return o}var qm=!1;if(c){var gd;if(c){var yd="oninput"in document;if(!yd){var Wm=document.createElement("div");Wm.setAttribute("oninput","return;"),yd=typeof Wm.oninput=="function"}gd=yd}else gd=!1;qm=gd&&(!document.documentMode||9<document.documentMode)}function Gm(){tl&&(tl.detachEvent("onpropertychange",Km),nl=tl=null)}function Km(s){if(s.propertyName==="value"&&Wu(nl)){var o=[];$m(o,nl,s,Re(s)),Ai(VT,o)}}function OT(s,o,l){s==="focusin"?(Gm(),tl=o,nl=l,tl.attachEvent("onpropertychange",Km)):s==="focusout"&&Gm()}function FT(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return Wu(nl)}function LT(s,o){if(s==="click")return Wu(o)}function jT(s,o){if(s==="input"||s==="change")return Wu(o)}function BT(s,o){return s===o&&(s!==0||1/s===1/o)||s!==s&&o!==o}var Sr=typeof Object.is=="function"?Object.is:BT;function rl(s,o){if(Sr(s,o))return!0;if(typeof s!="object"||s===null||typeof o!="object"||o===null)return!1;var l=Object.keys(s),f=Object.keys(o);if(l.length!==f.length)return!1;for(f=0;f<l.length;f++){var m=l[f];if(!d.call(o,m)||!Sr(s[m],o[m]))return!1}return!0}function Hm(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function Qm(s,o){var l=Hm(s);s=0;for(var f;l;){if(l.nodeType===3){if(f=s+l.textContent.length,s<=o&&f>=o)return{node:l,offset:o-s};s=f}e:{for(;l;){if(l.nextSibling){l=l.nextSibling;break e}l=l.parentNode}l=void 0}l=Hm(l)}}function Xm(s,o){return s&&o?s===o?!0:s&&s.nodeType===3?!1:o&&o.nodeType===3?Xm(s,o.parentNode):"contains"in s?s.contains(o):s.compareDocumentPosition?!!(s.compareDocumentPosition(o)&16):!1:!1}function Ym(){for(var s=window,o=Lt();o instanceof s.HTMLIFrameElement;){try{var l=typeof o.contentWindow.location.href=="string"}catch{l=!1}if(l)s=o.contentWindow;else break;o=Lt(s.document)}return o}function vd(s){var o=s&&s.nodeName&&s.nodeName.toLowerCase();return o&&(o==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||o==="textarea"||s.contentEditable==="true")}function zT(s){var o=Ym(),l=s.focusedElem,f=s.selectionRange;if(o!==l&&l&&l.ownerDocument&&Xm(l.ownerDocument.documentElement,l)){if(f!==null&&vd(l)){if(o=f.start,s=f.end,s===void 0&&(s=o),"selectionStart"in l)l.selectionStart=o,l.selectionEnd=Math.min(s,l.value.length);else if(s=(o=l.ownerDocument||document)&&o.defaultView||window,s.getSelection){s=s.getSelection();var m=l.textContent.length,v=Math.min(f.start,m);f=f.end===void 0?v:Math.min(f.end,m),!s.extend&&v>f&&(m=f,f=v,v=m),m=Qm(l,v);var S=Qm(l,f);m&&S&&(s.rangeCount!==1||s.anchorNode!==m.node||s.anchorOffset!==m.offset||s.focusNode!==S.node||s.focusOffset!==S.offset)&&(o=o.createRange(),o.setStart(m.node,m.offset),s.removeAllRanges(),v>f?(s.addRange(o),s.extend(S.node,S.offset)):(o.setEnd(S.node,S.offset),s.addRange(o)))}}for(o=[],s=l;s=s.parentNode;)s.nodeType===1&&o.push({element:s,left:s.scrollLeft,top:s.scrollTop});for(typeof l.focus=="function"&&l.focus(),l=0;l<o.length;l++)s=o[l],s.element.scrollLeft=s.left,s.element.scrollTop=s.top}}var UT=c&&"documentMode"in document&&11>=document.documentMode,Bo=null,_d=null,sl=null,wd=!1;function Zm(s,o,l){var f=l.window===l?l.document:l.nodeType===9?l:l.ownerDocument;wd||Bo==null||Bo!==Lt(f)||(f=Bo,"selectionStart"in f&&vd(f)?f={start:f.selectionStart,end:f.selectionEnd}:(f=(f.ownerDocument&&f.ownerDocument.defaultView||window).getSelection(),f={anchorNode:f.anchorNode,anchorOffset:f.anchorOffset,focusNode:f.focusNode,focusOffset:f.focusOffset}),sl&&rl(sl,f)||(sl=f,f=Qu(_d,"onSelect"),0<f.length&&(o=new bo("onSelect","select",null,o,l),s.push({event:o,listeners:f}),o.target=Bo)))}function Gu(s,o){var l={};return l[s.toLowerCase()]=o.toLowerCase(),l["Webkit"+s]="webkit"+o,l["Moz"+s]="moz"+o,l}var zo={animationend:Gu("Animation","AnimationEnd"),animationiteration:Gu("Animation","AnimationIteration"),animationstart:Gu("Animation","AnimationStart"),transitionend:Gu("Transition","TransitionEnd")},Ed={},Jm={};c&&(Jm=document.createElement("div").style,"AnimationEvent"in window||(delete zo.animationend.animation,delete zo.animationiteration.animation,delete zo.animationstart.animation),"TransitionEvent"in window||delete zo.transitionend.transition);function Ku(s){if(Ed[s])return Ed[s];if(!zo[s])return s;var o=zo[s],l;for(l in o)if(o.hasOwnProperty(l)&&l in Jm)return Ed[s]=o[l];return s}var eg=Ku("animationend"),tg=Ku("animationiteration"),ng=Ku("animationstart"),rg=Ku("transitionend"),sg=new Map,ig="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Bs(s,o){sg.set(s,o),a(o,[s])}for(var Td=0;Td<ig.length;Td++){var Id=ig[Td],$T=Id.toLowerCase(),qT=Id[0].toUpperCase()+Id.slice(1);Bs($T,"on"+qT)}Bs(eg,"onAnimationEnd"),Bs(tg,"onAnimationIteration"),Bs(ng,"onAnimationStart"),Bs("dblclick","onDoubleClick"),Bs("focusin","onFocus"),Bs("focusout","onBlur"),Bs(rg,"onTransitionEnd"),u("onMouseEnter",["mouseout","mouseover"]),u("onMouseLeave",["mouseout","mouseover"]),u("onPointerEnter",["pointerout","pointerover"]),u("onPointerLeave",["pointerout","pointerover"]),a("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),a("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),a("onBeforeInput",["compositionend","keypress","textInput","paste"]),a("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var il="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),WT=new Set("cancel close invalid load scroll toggle".split(" ").concat(il));function og(s,o,l){var f=s.type||"unknown-event";s.currentTarget=l,Iu(f,o,void 0,s),s.currentTarget=null}function ag(s,o){o=(o&4)!==0;for(var l=0;l<s.length;l++){var f=s[l],m=f.event;f=f.listeners;e:{var v=void 0;if(o)for(var S=f.length-1;0<=S;S--){var O=f[S],j=O.instance,Y=O.currentTarget;if(O=O.listener,j!==v&&m.isPropagationStopped())break e;og(m,O,Y),v=j}else for(S=0;S<f.length;S++){if(O=f[S],j=O.instance,Y=O.currentTarget,O=O.listener,j!==v&&m.isPropagationStopped())break e;og(m,O,Y),v=j}}}if(gn)throw s=is,gn=!1,is=null,s}function mt(s,o){var l=o[kd];l===void 0&&(l=o[kd]=new Set);var f=s+"__bubble";l.has(f)||(lg(o,s,2,!1),l.add(f))}function Sd(s,o,l){var f=0;o&&(f|=4),lg(l,s,f,o)}var Hu="_reactListening"+Math.random().toString(36).slice(2);function ol(s){if(!s[Hu]){s[Hu]=!0,n.forEach(function(l){l!=="selectionchange"&&(WT.has(l)||Sd(l,!1,s),Sd(l,!0,s))});var o=s.nodeType===9?s:s.ownerDocument;o===null||o[Hu]||(o[Hu]=!0,Sd("selectionchange",!1,o))}}function lg(s,o,l,f){switch(Xa(o)){case 1:var m=vt;break;case 4:m=pd;break;default:m=Qa}l=m.bind(null,o,l,s),m=void 0,!Ze||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(m=!0),f?m!==void 0?s.addEventListener(o,l,{capture:!0,passive:m}):s.addEventListener(o,l,!0):m!==void 0?s.addEventListener(o,l,{passive:m}):s.addEventListener(o,l,!1)}function Cd(s,o,l,f,m){var v=f;if(!(o&1)&&!(o&2)&&f!==null)e:for(;;){if(f===null)return;var S=f.tag;if(S===3||S===4){var O=f.stateNode.containerInfo;if(O===m||O.nodeType===8&&O.parentNode===m)break;if(S===4)for(S=f.return;S!==null;){var j=S.tag;if((j===3||j===4)&&(j=S.stateNode.containerInfo,j===m||j.nodeType===8&&j.parentNode===m))return;S=S.return}for(;O!==null;){if(S=Oi(O),S===null)return;if(j=S.tag,j===5||j===6){f=v=S;continue e}O=O.parentNode}}f=f.return}Ai(function(){var Y=v,ue=Re(l),de=[];e:{var ae=sg.get(s);if(ae!==void 0){var we=bo,Se=s;switch(s){case"keypress":if(ko(l)===0)break e;case"keydown":case"keyup":we=y;break;case"focusin":Se="focus",we=Oo;break;case"focusout":Se="blur",we=Oo;break;case"beforeblur":case"afterblur":we=Oo;break;case"click":if(l.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":we=Vo;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":we=Lu;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":we=J;break;case eg:case tg:case ng:we=cs;break;case rg:we=rt;break;case"scroll":we=md;break;case"wheel":we=Ke;break;case"copy":case"cut":case"paste":we=zu;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":we=x}var xe=(o&4)!==0,Pt=!xe&&s==="scroll",K=xe?ae!==null?ae+"Capture":null:ae;xe=[];for(var z=Y,H;z!==null;){H=z;var pe=H.stateNode;if(H.tag===5&&pe!==null&&(H=pe,K!==null&&(pe=pt(z,K),pe!=null&&xe.push(al(z,pe,H)))),Pt)break;z=z.return}0<xe.length&&(ae=new we(ae,Se,null,l,ue),de.push({event:ae,listeners:xe}))}}if(!(o&7)){e:{if(ae=s==="mouseover"||s==="pointerover",we=s==="mouseout"||s==="pointerout",ae&&l!==Te&&(Se=l.relatedTarget||l.fromElement)&&(Oi(Se)||Se[hs]))break e;if((we||ae)&&(ae=ue.window===ue?ue:(ae=ue.ownerDocument)?ae.defaultView||ae.parentWindow:window,we?(Se=l.relatedTarget||l.toElement,we=Y,Se=Se?Oi(Se):null,Se!==null&&(Pt=yr(Se),Se!==Pt||Se.tag!==5&&Se.tag!==6)&&(Se=null)):(we=null,Se=Y),we!==Se)){if(xe=Vo,pe="onMouseLeave",K="onMouseEnter",z="mouse",(s==="pointerout"||s==="pointerover")&&(xe=x,pe="onPointerLeave",K="onPointerEnter",z="pointer"),Pt=we==null?ae:qo(we),H=Se==null?ae:qo(Se),ae=new xe(pe,z+"leave",we,l,ue),ae.target=Pt,ae.relatedTarget=H,pe=null,Oi(ue)===Y&&(xe=new xe(K,z+"enter",Se,l,ue),xe.target=H,xe.relatedTarget=Pt,pe=xe),Pt=pe,we&&Se)t:{for(xe=we,K=Se,z=0,H=xe;H;H=Uo(H))z++;for(H=0,pe=K;pe;pe=Uo(pe))H++;for(;0<z-H;)xe=Uo(xe),z--;for(;0<H-z;)K=Uo(K),H--;for(;z--;){if(xe===K||K!==null&&xe===K.alternate)break t;xe=Uo(xe),K=Uo(K)}xe=null}else xe=null;we!==null&&ug(de,ae,we,xe,!1),Se!==null&&Pt!==null&&ug(de,Pt,Se,xe,!0)}}e:{if(ae=Y?qo(Y):window,we=ae.nodeName&&ae.nodeName.toLowerCase(),we==="select"||we==="input"&&ae.type==="file")var Pe=MT;else if(Um(ae))if(qm)Pe=jT;else{Pe=FT;var Ve=OT}else(we=ae.nodeName)&&we.toLowerCase()==="input"&&(ae.type==="checkbox"||ae.type==="radio")&&(Pe=LT);if(Pe&&(Pe=Pe(s,Y))){$m(de,Pe,l,ue);break e}Ve&&Ve(s,ae,Y),s==="focusout"&&(Ve=ae._wrapperState)&&Ve.controlled&&ae.type==="number"&&On(ae,"number",ae.value)}switch(Ve=Y?qo(Y):window,s){case"focusin":(Um(Ve)||Ve.contentEditable==="true")&&(Bo=Ve,_d=Y,sl=null);break;case"focusout":sl=_d=Bo=null;break;case"mousedown":wd=!0;break;case"contextmenu":case"mouseup":case"dragend":wd=!1,Zm(de,l,ue);break;case"selectionchange":if(UT)break;case"keydown":case"keyup":Zm(de,l,ue)}var Me;if(Mt)e:{switch(s){case"compositionstart":var Fe="onCompositionStart";break e;case"compositionend":Fe="onCompositionEnd";break e;case"compositionupdate":Fe="onCompositionUpdate";break e}Fe=void 0}else jo?Bm(s,l)&&(Fe="onCompositionEnd"):s==="keydown"&&l.keyCode===229&&(Fe="onCompositionStart");Fe&&(Mi&&l.locale!=="ko"&&(jo||Fe!=="onCompositionStart"?Fe==="onCompositionEnd"&&jo&&(Me=Ya()):(Un=ue,Po="value"in Un?Un.value:Un.textContent,jo=!0)),Ve=Qu(Y,Fe),0<Ve.length&&(Fe=new el(Fe,s,null,l,ue),de.push({event:Fe,listeners:Ve}),Me?Fe.data=Me:(Me=zm(l),Me!==null&&(Fe.data=Me)))),(Me=$n?kT(s,l):bT(s,l))&&(Y=Qu(Y,"onBeforeInput"),0<Y.length&&(ue=new el("onBeforeInput","beforeinput",null,l,ue),de.push({event:ue,listeners:Y}),ue.data=Me))}ag(de,o)})}function al(s,o,l){return{instance:s,listener:o,currentTarget:l}}function Qu(s,o){for(var l=o+"Capture",f=[];s!==null;){var m=s,v=m.stateNode;m.tag===5&&v!==null&&(m=v,v=pt(s,l),v!=null&&f.unshift(al(s,v,m)),v=pt(s,o),v!=null&&f.push(al(s,v,m))),s=s.return}return f}function Uo(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5);return s||null}function ug(s,o,l,f,m){for(var v=o._reactName,S=[];l!==null&&l!==f;){var O=l,j=O.alternate,Y=O.stateNode;if(j!==null&&j===f)break;O.tag===5&&Y!==null&&(O=Y,m?(j=pt(l,v),j!=null&&S.unshift(al(l,j,O))):m||(j=pt(l,v),j!=null&&S.push(al(l,j,O)))),l=l.return}S.length!==0&&s.push({event:o,listeners:S})}var GT=/\r\n?/g,KT=/\u0000|\uFFFD/g;function cg(s){return(typeof s=="string"?s:""+s).replace(GT,`
`).replace(KT,"")}function Xu(s,o,l){if(o=cg(o),cg(s)!==o&&l)throw Error(t(425))}function Yu(){}var Ad=null,xd=null;function Nd(s,o){return s==="textarea"||s==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var Rd=typeof setTimeout=="function"?setTimeout:void 0,HT=typeof clearTimeout=="function"?clearTimeout:void 0,hg=typeof Promise=="function"?Promise:void 0,QT=typeof queueMicrotask=="function"?queueMicrotask:typeof hg<"u"?function(s){return hg.resolve(null).then(s).catch(XT)}:Rd;function XT(s){setTimeout(function(){throw s})}function Pd(s,o){var l=o,f=0;do{var m=l.nextSibling;if(s.removeChild(l),m&&m.nodeType===8)if(l=m.data,l==="/$"){if(f===0){s.removeChild(m),Tr(o);return}f--}else l!=="$"&&l!=="$?"&&l!=="$!"||f++;l=m}while(l);Tr(o)}function zs(s){for(;s!=null;s=s.nextSibling){var o=s.nodeType;if(o===1||o===3)break;if(o===8){if(o=s.data,o==="$"||o==="$!"||o==="$?")break;if(o==="/$")return null}}return s}function dg(s){s=s.previousSibling;for(var o=0;s;){if(s.nodeType===8){var l=s.data;if(l==="$"||l==="$!"||l==="$?"){if(o===0)return s;o--}else l==="/$"&&o++}s=s.previousSibling}return null}var $o=Math.random().toString(36).slice(2),qr="__reactFiber$"+$o,ll="__reactProps$"+$o,hs="__reactContainer$"+$o,kd="__reactEvents$"+$o,YT="__reactListeners$"+$o,ZT="__reactHandles$"+$o;function Oi(s){var o=s[qr];if(o)return o;for(var l=s.parentNode;l;){if(o=l[hs]||l[qr]){if(l=o.alternate,o.child!==null||l!==null&&l.child!==null)for(s=dg(s);s!==null;){if(l=s[qr])return l;s=dg(s)}return o}s=l,l=s.parentNode}return null}function ul(s){return s=s[qr]||s[hs],!s||s.tag!==5&&s.tag!==6&&s.tag!==13&&s.tag!==3?null:s}function qo(s){if(s.tag===5||s.tag===6)return s.stateNode;throw Error(t(33))}function Zu(s){return s[ll]||null}var bd=[],Wo=-1;function Us(s){return{current:s}}function gt(s){0>Wo||(s.current=bd[Wo],bd[Wo]=null,Wo--)}function ht(s,o){Wo++,bd[Wo]=s.current,s.current=o}var $s={},rn=Us($s),xn=Us(!1),Fi=$s;function Go(s,o){var l=s.type.contextTypes;if(!l)return $s;var f=s.stateNode;if(f&&f.__reactInternalMemoizedUnmaskedChildContext===o)return f.__reactInternalMemoizedMaskedChildContext;var m={},v;for(v in l)m[v]=o[v];return f&&(s=s.stateNode,s.__reactInternalMemoizedUnmaskedChildContext=o,s.__reactInternalMemoizedMaskedChildContext=m),m}function Nn(s){return s=s.childContextTypes,s!=null}function Ju(){gt(xn),gt(rn)}function fg(s,o,l){if(rn.current!==$s)throw Error(t(168));ht(rn,o),ht(xn,l)}function pg(s,o,l){var f=s.stateNode;if(o=o.childContextTypes,typeof f.getChildContext!="function")return l;f=f.getChildContext();for(var m in f)if(!(m in o))throw Error(t(108,ye(s)||"Unknown",m));return re({},l,f)}function ec(s){return s=(s=s.stateNode)&&s.__reactInternalMemoizedMergedChildContext||$s,Fi=rn.current,ht(rn,s),ht(xn,xn.current),!0}function mg(s,o,l){var f=s.stateNode;if(!f)throw Error(t(169));l?(s=pg(s,o,Fi),f.__reactInternalMemoizedMergedChildContext=s,gt(xn),gt(rn),ht(rn,s)):gt(xn),ht(xn,l)}var ds=null,tc=!1,Dd=!1;function gg(s){ds===null?ds=[s]:ds.push(s)}function JT(s){tc=!0,gg(s)}function qs(){if(!Dd&&ds!==null){Dd=!0;var s=0,o=We;try{var l=ds;for(We=1;s<l.length;s++){var f=l[s];do f=f(!0);while(f!==null)}ds=null,tc=!1}catch(m){throw ds!==null&&(ds=ds.slice(s+1)),Co(Ni,qs),m}finally{We=o,Dd=!1}}return null}var Ko=[],Ho=0,nc=null,rc=0,tr=[],nr=0,Li=null,fs=1,ps="";function ji(s,o){Ko[Ho++]=rc,Ko[Ho++]=nc,nc=s,rc=o}function yg(s,o,l){tr[nr++]=fs,tr[nr++]=ps,tr[nr++]=Li,Li=s;var f=fs;s=ps;var m=32-yn(f)-1;f&=~(1<<m),l+=1;var v=32-yn(o)+m;if(30<v){var S=m-m%5;v=(f&(1<<S)-1).toString(32),f>>=S,m-=S,fs=1<<32-yn(o)+m|l<<m|f,ps=v+s}else fs=1<<v|l<<m|f,ps=s}function Vd(s){s.return!==null&&(ji(s,1),yg(s,1,0))}function Md(s){for(;s===nc;)nc=Ko[--Ho],Ko[Ho]=null,rc=Ko[--Ho],Ko[Ho]=null;for(;s===Li;)Li=tr[--nr],tr[nr]=null,ps=tr[--nr],tr[nr]=null,fs=tr[--nr],tr[nr]=null}var qn=null,Wn=null,_t=!1,Cr=null;function vg(s,o){var l=or(5,null,null,0);l.elementType="DELETED",l.stateNode=o,l.return=s,o=s.deletions,o===null?(s.deletions=[l],s.flags|=16):o.push(l)}function _g(s,o){switch(s.tag){case 5:var l=s.type;return o=o.nodeType!==1||l.toLowerCase()!==o.nodeName.toLowerCase()?null:o,o!==null?(s.stateNode=o,qn=s,Wn=zs(o.firstChild),!0):!1;case 6:return o=s.pendingProps===""||o.nodeType!==3?null:o,o!==null?(s.stateNode=o,qn=s,Wn=null,!0):!1;case 13:return o=o.nodeType!==8?null:o,o!==null?(l=Li!==null?{id:fs,overflow:ps}:null,s.memoizedState={dehydrated:o,treeContext:l,retryLane:1073741824},l=or(18,null,null,0),l.stateNode=o,l.return=s,s.child=l,qn=s,Wn=null,!0):!1;default:return!1}}function Od(s){return(s.mode&1)!==0&&(s.flags&128)===0}function Fd(s){if(_t){var o=Wn;if(o){var l=o;if(!_g(s,o)){if(Od(s))throw Error(t(418));o=zs(l.nextSibling);var f=qn;o&&_g(s,o)?vg(f,l):(s.flags=s.flags&-4097|2,_t=!1,qn=s)}}else{if(Od(s))throw Error(t(418));s.flags=s.flags&-4097|2,_t=!1,qn=s}}}function wg(s){for(s=s.return;s!==null&&s.tag!==5&&s.tag!==3&&s.tag!==13;)s=s.return;qn=s}function sc(s){if(s!==qn)return!1;if(!_t)return wg(s),_t=!0,!1;var o;if((o=s.tag!==3)&&!(o=s.tag!==5)&&(o=s.type,o=o!=="head"&&o!=="body"&&!Nd(s.type,s.memoizedProps)),o&&(o=Wn)){if(Od(s))throw Eg(),Error(t(418));for(;o;)vg(s,o),o=zs(o.nextSibling)}if(wg(s),s.tag===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(t(317));e:{for(s=s.nextSibling,o=0;s;){if(s.nodeType===8){var l=s.data;if(l==="/$"){if(o===0){Wn=zs(s.nextSibling);break e}o--}else l!=="$"&&l!=="$!"&&l!=="$?"||o++}s=s.nextSibling}Wn=null}}else Wn=qn?zs(s.stateNode.nextSibling):null;return!0}function Eg(){for(var s=Wn;s;)s=zs(s.nextSibling)}function Qo(){Wn=qn=null,_t=!1}function Ld(s){Cr===null?Cr=[s]:Cr.push(s)}var eI=X.ReactCurrentBatchConfig;function cl(s,o,l){if(s=l.ref,s!==null&&typeof s!="function"&&typeof s!="object"){if(l._owner){if(l=l._owner,l){if(l.tag!==1)throw Error(t(309));var f=l.stateNode}if(!f)throw Error(t(147,s));var m=f,v=""+s;return o!==null&&o.ref!==null&&typeof o.ref=="function"&&o.ref._stringRef===v?o.ref:(o=function(S){var O=m.refs;S===null?delete O[v]:O[v]=S},o._stringRef=v,o)}if(typeof s!="string")throw Error(t(284));if(!l._owner)throw Error(t(290,s))}return s}function ic(s,o){throw s=Object.prototype.toString.call(o),Error(t(31,s==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":s))}function Tg(s){var o=s._init;return o(s._payload)}function Ig(s){function o(K,z){if(s){var H=K.deletions;H===null?(K.deletions=[z],K.flags|=16):H.push(z)}}function l(K,z){if(!s)return null;for(;z!==null;)o(K,z),z=z.sibling;return null}function f(K,z){for(K=new Map;z!==null;)z.key!==null?K.set(z.key,z):K.set(z.index,z),z=z.sibling;return K}function m(K,z){return K=Zs(K,z),K.index=0,K.sibling=null,K}function v(K,z,H){return K.index=H,s?(H=K.alternate,H!==null?(H=H.index,H<z?(K.flags|=2,z):H):(K.flags|=2,z)):(K.flags|=1048576,z)}function S(K){return s&&K.alternate===null&&(K.flags|=2),K}function O(K,z,H,pe){return z===null||z.tag!==6?(z=Pf(H,K.mode,pe),z.return=K,z):(z=m(z,H),z.return=K,z)}function j(K,z,H,pe){var Pe=H.type;return Pe===N?ue(K,z,H.props.children,pe,H.key):z!==null&&(z.elementType===Pe||typeof Pe=="object"&&Pe!==null&&Pe.$$typeof===fe&&Tg(Pe)===z.type)?(pe=m(z,H.props),pe.ref=cl(K,z,H),pe.return=K,pe):(pe=Rc(H.type,H.key,H.props,null,K.mode,pe),pe.ref=cl(K,z,H),pe.return=K,pe)}function Y(K,z,H,pe){return z===null||z.tag!==4||z.stateNode.containerInfo!==H.containerInfo||z.stateNode.implementation!==H.implementation?(z=kf(H,K.mode,pe),z.return=K,z):(z=m(z,H.children||[]),z.return=K,z)}function ue(K,z,H,pe,Pe){return z===null||z.tag!==7?(z=Ki(H,K.mode,pe,Pe),z.return=K,z):(z=m(z,H),z.return=K,z)}function de(K,z,H){if(typeof z=="string"&&z!==""||typeof z=="number")return z=Pf(""+z,K.mode,H),z.return=K,z;if(typeof z=="object"&&z!==null){switch(z.$$typeof){case F:return H=Rc(z.type,z.key,z.props,null,K.mode,H),H.ref=cl(K,null,z),H.return=K,H;case U:return z=kf(z,K.mode,H),z.return=K,z;case fe:var pe=z._init;return de(K,pe(z._payload),H)}if(Fn(z)||se(z))return z=Ki(z,K.mode,H,null),z.return=K,z;ic(K,z)}return null}function ae(K,z,H,pe){var Pe=z!==null?z.key:null;if(typeof H=="string"&&H!==""||typeof H=="number")return Pe!==null?null:O(K,z,""+H,pe);if(typeof H=="object"&&H!==null){switch(H.$$typeof){case F:return H.key===Pe?j(K,z,H,pe):null;case U:return H.key===Pe?Y(K,z,H,pe):null;case fe:return Pe=H._init,ae(K,z,Pe(H._payload),pe)}if(Fn(H)||se(H))return Pe!==null?null:ue(K,z,H,pe,null);ic(K,H)}return null}function we(K,z,H,pe,Pe){if(typeof pe=="string"&&pe!==""||typeof pe=="number")return K=K.get(H)||null,O(z,K,""+pe,Pe);if(typeof pe=="object"&&pe!==null){switch(pe.$$typeof){case F:return K=K.get(pe.key===null?H:pe.key)||null,j(z,K,pe,Pe);case U:return K=K.get(pe.key===null?H:pe.key)||null,Y(z,K,pe,Pe);case fe:var Ve=pe._init;return we(K,z,H,Ve(pe._payload),Pe)}if(Fn(pe)||se(pe))return K=K.get(H)||null,ue(z,K,pe,Pe,null);ic(z,pe)}return null}function Se(K,z,H,pe){for(var Pe=null,Ve=null,Me=z,Fe=z=0,Ht=null;Me!==null&&Fe<H.length;Fe++){Me.index>Fe?(Ht=Me,Me=null):Ht=Me.sibling;var Je=ae(K,Me,H[Fe],pe);if(Je===null){Me===null&&(Me=Ht);break}s&&Me&&Je.alternate===null&&o(K,Me),z=v(Je,z,Fe),Ve===null?Pe=Je:Ve.sibling=Je,Ve=Je,Me=Ht}if(Fe===H.length)return l(K,Me),_t&&ji(K,Fe),Pe;if(Me===null){for(;Fe<H.length;Fe++)Me=de(K,H[Fe],pe),Me!==null&&(z=v(Me,z,Fe),Ve===null?Pe=Me:Ve.sibling=Me,Ve=Me);return _t&&ji(K,Fe),Pe}for(Me=f(K,Me);Fe<H.length;Fe++)Ht=we(Me,K,Fe,H[Fe],pe),Ht!==null&&(s&&Ht.alternate!==null&&Me.delete(Ht.key===null?Fe:Ht.key),z=v(Ht,z,Fe),Ve===null?Pe=Ht:Ve.sibling=Ht,Ve=Ht);return s&&Me.forEach(function(Js){return o(K,Js)}),_t&&ji(K,Fe),Pe}function xe(K,z,H,pe){var Pe=se(H);if(typeof Pe!="function")throw Error(t(150));if(H=Pe.call(H),H==null)throw Error(t(151));for(var Ve=Pe=null,Me=z,Fe=z=0,Ht=null,Je=H.next();Me!==null&&!Je.done;Fe++,Je=H.next()){Me.index>Fe?(Ht=Me,Me=null):Ht=Me.sibling;var Js=ae(K,Me,Je.value,pe);if(Js===null){Me===null&&(Me=Ht);break}s&&Me&&Js.alternate===null&&o(K,Me),z=v(Js,z,Fe),Ve===null?Pe=Js:Ve.sibling=Js,Ve=Js,Me=Ht}if(Je.done)return l(K,Me),_t&&ji(K,Fe),Pe;if(Me===null){for(;!Je.done;Fe++,Je=H.next())Je=de(K,Je.value,pe),Je!==null&&(z=v(Je,z,Fe),Ve===null?Pe=Je:Ve.sibling=Je,Ve=Je);return _t&&ji(K,Fe),Pe}for(Me=f(K,Me);!Je.done;Fe++,Je=H.next())Je=we(Me,K,Fe,Je.value,pe),Je!==null&&(s&&Je.alternate!==null&&Me.delete(Je.key===null?Fe:Je.key),z=v(Je,z,Fe),Ve===null?Pe=Je:Ve.sibling=Je,Ve=Je);return s&&Me.forEach(function(DI){return o(K,DI)}),_t&&ji(K,Fe),Pe}function Pt(K,z,H,pe){if(typeof H=="object"&&H!==null&&H.type===N&&H.key===null&&(H=H.props.children),typeof H=="object"&&H!==null){switch(H.$$typeof){case F:e:{for(var Pe=H.key,Ve=z;Ve!==null;){if(Ve.key===Pe){if(Pe=H.type,Pe===N){if(Ve.tag===7){l(K,Ve.sibling),z=m(Ve,H.props.children),z.return=K,K=z;break e}}else if(Ve.elementType===Pe||typeof Pe=="object"&&Pe!==null&&Pe.$$typeof===fe&&Tg(Pe)===Ve.type){l(K,Ve.sibling),z=m(Ve,H.props),z.ref=cl(K,Ve,H),z.return=K,K=z;break e}l(K,Ve);break}else o(K,Ve);Ve=Ve.sibling}H.type===N?(z=Ki(H.props.children,K.mode,pe,H.key),z.return=K,K=z):(pe=Rc(H.type,H.key,H.props,null,K.mode,pe),pe.ref=cl(K,z,H),pe.return=K,K=pe)}return S(K);case U:e:{for(Ve=H.key;z!==null;){if(z.key===Ve)if(z.tag===4&&z.stateNode.containerInfo===H.containerInfo&&z.stateNode.implementation===H.implementation){l(K,z.sibling),z=m(z,H.children||[]),z.return=K,K=z;break e}else{l(K,z);break}else o(K,z);z=z.sibling}z=kf(H,K.mode,pe),z.return=K,K=z}return S(K);case fe:return Ve=H._init,Pt(K,z,Ve(H._payload),pe)}if(Fn(H))return Se(K,z,H,pe);if(se(H))return xe(K,z,H,pe);ic(K,H)}return typeof H=="string"&&H!==""||typeof H=="number"?(H=""+H,z!==null&&z.tag===6?(l(K,z.sibling),z=m(z,H),z.return=K,K=z):(l(K,z),z=Pf(H,K.mode,pe),z.return=K,K=z),S(K)):l(K,z)}return Pt}var Xo=Ig(!0),Sg=Ig(!1),oc=Us(null),ac=null,Yo=null,jd=null;function Bd(){jd=Yo=ac=null}function zd(s){var o=oc.current;gt(oc),s._currentValue=o}function Ud(s,o,l){for(;s!==null;){var f=s.alternate;if((s.childLanes&o)!==o?(s.childLanes|=o,f!==null&&(f.childLanes|=o)):f!==null&&(f.childLanes&o)!==o&&(f.childLanes|=o),s===l)break;s=s.return}}function Zo(s,o){ac=s,jd=Yo=null,s=s.dependencies,s!==null&&s.firstContext!==null&&(s.lanes&o&&(Rn=!0),s.firstContext=null)}function rr(s){var o=s._currentValue;if(jd!==s)if(s={context:s,memoizedValue:o,next:null},Yo===null){if(ac===null)throw Error(t(308));Yo=s,ac.dependencies={lanes:0,firstContext:s}}else Yo=Yo.next=s;return o}var Bi=null;function $d(s){Bi===null?Bi=[s]:Bi.push(s)}function Cg(s,o,l,f){var m=o.interleaved;return m===null?(l.next=l,$d(o)):(l.next=m.next,m.next=l),o.interleaved=l,ms(s,f)}function ms(s,o){s.lanes|=o;var l=s.alternate;for(l!==null&&(l.lanes|=o),l=s,s=s.return;s!==null;)s.childLanes|=o,l=s.alternate,l!==null&&(l.childLanes|=o),l=s,s=s.return;return l.tag===3?l.stateNode:null}var Ws=!1;function qd(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Ag(s,o){s=s.updateQueue,o.updateQueue===s&&(o.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,effects:s.effects})}function gs(s,o){return{eventTime:s,lane:o,tag:0,payload:null,callback:null,next:null}}function Gs(s,o,l){var f=s.updateQueue;if(f===null)return null;if(f=f.shared,Xe&2){var m=f.pending;return m===null?o.next=o:(o.next=m.next,m.next=o),f.pending=o,ms(s,l)}return m=f.interleaved,m===null?(o.next=o,$d(f)):(o.next=m.next,m.next=o),f.interleaved=o,ms(s,l)}function lc(s,o,l){if(o=o.updateQueue,o!==null&&(o=o.shared,(l&4194240)!==0)){var f=o.lanes;f&=s.pendingLanes,l|=f,o.lanes=l,Ms(s,l)}}function xg(s,o){var l=s.updateQueue,f=s.alternate;if(f!==null&&(f=f.updateQueue,l===f)){var m=null,v=null;if(l=l.firstBaseUpdate,l!==null){do{var S={eventTime:l.eventTime,lane:l.lane,tag:l.tag,payload:l.payload,callback:l.callback,next:null};v===null?m=v=S:v=v.next=S,l=l.next}while(l!==null);v===null?m=v=o:v=v.next=o}else m=v=o;l={baseState:f.baseState,firstBaseUpdate:m,lastBaseUpdate:v,shared:f.shared,effects:f.effects},s.updateQueue=l;return}s=l.lastBaseUpdate,s===null?l.firstBaseUpdate=o:s.next=o,l.lastBaseUpdate=o}function uc(s,o,l,f){var m=s.updateQueue;Ws=!1;var v=m.firstBaseUpdate,S=m.lastBaseUpdate,O=m.shared.pending;if(O!==null){m.shared.pending=null;var j=O,Y=j.next;j.next=null,S===null?v=Y:S.next=Y,S=j;var ue=s.alternate;ue!==null&&(ue=ue.updateQueue,O=ue.lastBaseUpdate,O!==S&&(O===null?ue.firstBaseUpdate=Y:O.next=Y,ue.lastBaseUpdate=j))}if(v!==null){var de=m.baseState;S=0,ue=Y=j=null,O=v;do{var ae=O.lane,we=O.eventTime;if((f&ae)===ae){ue!==null&&(ue=ue.next={eventTime:we,lane:0,tag:O.tag,payload:O.payload,callback:O.callback,next:null});e:{var Se=s,xe=O;switch(ae=o,we=l,xe.tag){case 1:if(Se=xe.payload,typeof Se=="function"){de=Se.call(we,de,ae);break e}de=Se;break e;case 3:Se.flags=Se.flags&-65537|128;case 0:if(Se=xe.payload,ae=typeof Se=="function"?Se.call(we,de,ae):Se,ae==null)break e;de=re({},de,ae);break e;case 2:Ws=!0}}O.callback!==null&&O.lane!==0&&(s.flags|=64,ae=m.effects,ae===null?m.effects=[O]:ae.push(O))}else we={eventTime:we,lane:ae,tag:O.tag,payload:O.payload,callback:O.callback,next:null},ue===null?(Y=ue=we,j=de):ue=ue.next=we,S|=ae;if(O=O.next,O===null){if(O=m.shared.pending,O===null)break;ae=O,O=ae.next,ae.next=null,m.lastBaseUpdate=ae,m.shared.pending=null}}while(!0);if(ue===null&&(j=de),m.baseState=j,m.firstBaseUpdate=Y,m.lastBaseUpdate=ue,o=m.shared.interleaved,o!==null){m=o;do S|=m.lane,m=m.next;while(m!==o)}else v===null&&(m.shared.lanes=0);$i|=S,s.lanes=S,s.memoizedState=de}}function Ng(s,o,l){if(s=o.effects,o.effects=null,s!==null)for(o=0;o<s.length;o++){var f=s[o],m=f.callback;if(m!==null){if(f.callback=null,f=l,typeof m!="function")throw Error(t(191,m));m.call(f)}}}var hl={},Wr=Us(hl),dl=Us(hl),fl=Us(hl);function zi(s){if(s===hl)throw Error(t(174));return s}function Wd(s,o){switch(ht(fl,o),ht(dl,s),ht(Wr,hl),s=o.nodeType,s){case 9:case 11:o=(o=o.documentElement)?o.namespaceURI:ft(null,"");break;default:s=s===8?o.parentNode:o,o=s.namespaceURI||null,s=s.tagName,o=ft(o,s)}gt(Wr),ht(Wr,o)}function Jo(){gt(Wr),gt(dl),gt(fl)}function Rg(s){zi(fl.current);var o=zi(Wr.current),l=ft(o,s.type);o!==l&&(ht(dl,s),ht(Wr,l))}function Gd(s){dl.current===s&&(gt(Wr),gt(dl))}var Tt=Us(0);function cc(s){for(var o=s;o!==null;){if(o.tag===13){var l=o.memoizedState;if(l!==null&&(l=l.dehydrated,l===null||l.data==="$?"||l.data==="$!"))return o}else if(o.tag===19&&o.memoizedProps.revealOrder!==void 0){if(o.flags&128)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===s)break;for(;o.sibling===null;){if(o.return===null||o.return===s)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}var Kd=[];function Hd(){for(var s=0;s<Kd.length;s++)Kd[s]._workInProgressVersionPrimary=null;Kd.length=0}var hc=X.ReactCurrentDispatcher,Qd=X.ReactCurrentBatchConfig,Ui=0,It=null,Bt=null,Gt=null,dc=!1,pl=!1,ml=0,tI=0;function sn(){throw Error(t(321))}function Xd(s,o){if(o===null)return!1;for(var l=0;l<o.length&&l<s.length;l++)if(!Sr(s[l],o[l]))return!1;return!0}function Yd(s,o,l,f,m,v){if(Ui=v,It=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,hc.current=s===null||s.memoizedState===null?iI:oI,s=l(f,m),pl){v=0;do{if(pl=!1,ml=0,25<=v)throw Error(t(301));v+=1,Gt=Bt=null,o.updateQueue=null,hc.current=aI,s=l(f,m)}while(pl)}if(hc.current=mc,o=Bt!==null&&Bt.next!==null,Ui=0,Gt=Bt=It=null,dc=!1,o)throw Error(t(300));return s}function Zd(){var s=ml!==0;return ml=0,s}function Gr(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Gt===null?It.memoizedState=Gt=s:Gt=Gt.next=s,Gt}function sr(){if(Bt===null){var s=It.alternate;s=s!==null?s.memoizedState:null}else s=Bt.next;var o=Gt===null?It.memoizedState:Gt.next;if(o!==null)Gt=o,Bt=s;else{if(s===null)throw Error(t(310));Bt=s,s={memoizedState:Bt.memoizedState,baseState:Bt.baseState,baseQueue:Bt.baseQueue,queue:Bt.queue,next:null},Gt===null?It.memoizedState=Gt=s:Gt=Gt.next=s}return Gt}function gl(s,o){return typeof o=="function"?o(s):o}function Jd(s){var o=sr(),l=o.queue;if(l===null)throw Error(t(311));l.lastRenderedReducer=s;var f=Bt,m=f.baseQueue,v=l.pending;if(v!==null){if(m!==null){var S=m.next;m.next=v.next,v.next=S}f.baseQueue=m=v,l.pending=null}if(m!==null){v=m.next,f=f.baseState;var O=S=null,j=null,Y=v;do{var ue=Y.lane;if((Ui&ue)===ue)j!==null&&(j=j.next={lane:0,action:Y.action,hasEagerState:Y.hasEagerState,eagerState:Y.eagerState,next:null}),f=Y.hasEagerState?Y.eagerState:s(f,Y.action);else{var de={lane:ue,action:Y.action,hasEagerState:Y.hasEagerState,eagerState:Y.eagerState,next:null};j===null?(O=j=de,S=f):j=j.next=de,It.lanes|=ue,$i|=ue}Y=Y.next}while(Y!==null&&Y!==v);j===null?S=f:j.next=O,Sr(f,o.memoizedState)||(Rn=!0),o.memoizedState=f,o.baseState=S,o.baseQueue=j,l.lastRenderedState=f}if(s=l.interleaved,s!==null){m=s;do v=m.lane,It.lanes|=v,$i|=v,m=m.next;while(m!==s)}else m===null&&(l.lanes=0);return[o.memoizedState,l.dispatch]}function ef(s){var o=sr(),l=o.queue;if(l===null)throw Error(t(311));l.lastRenderedReducer=s;var f=l.dispatch,m=l.pending,v=o.memoizedState;if(m!==null){l.pending=null;var S=m=m.next;do v=s(v,S.action),S=S.next;while(S!==m);Sr(v,o.memoizedState)||(Rn=!0),o.memoizedState=v,o.baseQueue===null&&(o.baseState=v),l.lastRenderedState=v}return[v,f]}function Pg(){}function kg(s,o){var l=It,f=sr(),m=o(),v=!Sr(f.memoizedState,m);if(v&&(f.memoizedState=m,Rn=!0),f=f.queue,tf(Vg.bind(null,l,f,s),[s]),f.getSnapshot!==o||v||Gt!==null&&Gt.memoizedState.tag&1){if(l.flags|=2048,yl(9,Dg.bind(null,l,f,m,o),void 0,null),Kt===null)throw Error(t(349));Ui&30||bg(l,o,m)}return m}function bg(s,o,l){s.flags|=16384,s={getSnapshot:o,value:l},o=It.updateQueue,o===null?(o={lastEffect:null,stores:null},It.updateQueue=o,o.stores=[s]):(l=o.stores,l===null?o.stores=[s]:l.push(s))}function Dg(s,o,l,f){o.value=l,o.getSnapshot=f,Mg(o)&&Og(s)}function Vg(s,o,l){return l(function(){Mg(o)&&Og(s)})}function Mg(s){var o=s.getSnapshot;s=s.value;try{var l=o();return!Sr(s,l)}catch{return!0}}function Og(s){var o=ms(s,1);o!==null&&Rr(o,s,1,-1)}function Fg(s){var o=Gr();return typeof s=="function"&&(s=s()),o.memoizedState=o.baseState=s,s={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:gl,lastRenderedState:s},o.queue=s,s=s.dispatch=sI.bind(null,It,s),[o.memoizedState,s]}function yl(s,o,l,f){return s={tag:s,create:o,destroy:l,deps:f,next:null},o=It.updateQueue,o===null?(o={lastEffect:null,stores:null},It.updateQueue=o,o.lastEffect=s.next=s):(l=o.lastEffect,l===null?o.lastEffect=s.next=s:(f=l.next,l.next=s,s.next=f,o.lastEffect=s)),s}function Lg(){return sr().memoizedState}function fc(s,o,l,f){var m=Gr();It.flags|=s,m.memoizedState=yl(1|o,l,void 0,f===void 0?null:f)}function pc(s,o,l,f){var m=sr();f=f===void 0?null:f;var v=void 0;if(Bt!==null){var S=Bt.memoizedState;if(v=S.destroy,f!==null&&Xd(f,S.deps)){m.memoizedState=yl(o,l,v,f);return}}It.flags|=s,m.memoizedState=yl(1|o,l,v,f)}function jg(s,o){return fc(8390656,8,s,o)}function tf(s,o){return pc(2048,8,s,o)}function Bg(s,o){return pc(4,2,s,o)}function zg(s,o){return pc(4,4,s,o)}function Ug(s,o){if(typeof o=="function")return s=s(),o(s),function(){o(null)};if(o!=null)return s=s(),o.current=s,function(){o.current=null}}function $g(s,o,l){return l=l!=null?l.concat([s]):null,pc(4,4,Ug.bind(null,o,s),l)}function nf(){}function qg(s,o){var l=sr();o=o===void 0?null:o;var f=l.memoizedState;return f!==null&&o!==null&&Xd(o,f[1])?f[0]:(l.memoizedState=[s,o],s)}function Wg(s,o){var l=sr();o=o===void 0?null:o;var f=l.memoizedState;return f!==null&&o!==null&&Xd(o,f[1])?f[0]:(s=s(),l.memoizedState=[s,o],s)}function Gg(s,o,l){return Ui&21?(Sr(l,o)||(l=ki(),It.lanes|=l,$i|=l,s.baseState=!0),o):(s.baseState&&(s.baseState=!1,Rn=!0),s.memoizedState=l)}function nI(s,o){var l=We;We=l!==0&&4>l?l:4,s(!0);var f=Qd.transition;Qd.transition={};try{s(!1),o()}finally{We=l,Qd.transition=f}}function Kg(){return sr().memoizedState}function rI(s,o,l){var f=Xs(s);if(l={lane:f,action:l,hasEagerState:!1,eagerState:null,next:null},Hg(s))Qg(o,l);else if(l=Cg(s,o,l,f),l!==null){var m=wn();Rr(l,s,f,m),Xg(l,o,f)}}function sI(s,o,l){var f=Xs(s),m={lane:f,action:l,hasEagerState:!1,eagerState:null,next:null};if(Hg(s))Qg(o,m);else{var v=s.alternate;if(s.lanes===0&&(v===null||v.lanes===0)&&(v=o.lastRenderedReducer,v!==null))try{var S=o.lastRenderedState,O=v(S,l);if(m.hasEagerState=!0,m.eagerState=O,Sr(O,S)){var j=o.interleaved;j===null?(m.next=m,$d(o)):(m.next=j.next,j.next=m),o.interleaved=m;return}}catch{}finally{}l=Cg(s,o,m,f),l!==null&&(m=wn(),Rr(l,s,f,m),Xg(l,o,f))}}function Hg(s){var o=s.alternate;return s===It||o!==null&&o===It}function Qg(s,o){pl=dc=!0;var l=s.pending;l===null?o.next=o:(o.next=l.next,l.next=o),s.pending=o}function Xg(s,o,l){if(l&4194240){var f=o.lanes;f&=s.pendingLanes,l|=f,o.lanes=l,Ms(s,l)}}var mc={readContext:rr,useCallback:sn,useContext:sn,useEffect:sn,useImperativeHandle:sn,useInsertionEffect:sn,useLayoutEffect:sn,useMemo:sn,useReducer:sn,useRef:sn,useState:sn,useDebugValue:sn,useDeferredValue:sn,useTransition:sn,useMutableSource:sn,useSyncExternalStore:sn,useId:sn,unstable_isNewReconciler:!1},iI={readContext:rr,useCallback:function(s,o){return Gr().memoizedState=[s,o===void 0?null:o],s},useContext:rr,useEffect:jg,useImperativeHandle:function(s,o,l){return l=l!=null?l.concat([s]):null,fc(4194308,4,Ug.bind(null,o,s),l)},useLayoutEffect:function(s,o){return fc(4194308,4,s,o)},useInsertionEffect:function(s,o){return fc(4,2,s,o)},useMemo:function(s,o){var l=Gr();return o=o===void 0?null:o,s=s(),l.memoizedState=[s,o],s},useReducer:function(s,o,l){var f=Gr();return o=l!==void 0?l(o):o,f.memoizedState=f.baseState=o,s={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:o},f.queue=s,s=s.dispatch=rI.bind(null,It,s),[f.memoizedState,s]},useRef:function(s){var o=Gr();return s={current:s},o.memoizedState=s},useState:Fg,useDebugValue:nf,useDeferredValue:function(s){return Gr().memoizedState=s},useTransition:function(){var s=Fg(!1),o=s[0];return s=nI.bind(null,s[1]),Gr().memoizedState=s,[o,s]},useMutableSource:function(){},useSyncExternalStore:function(s,o,l){var f=It,m=Gr();if(_t){if(l===void 0)throw Error(t(407));l=l()}else{if(l=o(),Kt===null)throw Error(t(349));Ui&30||bg(f,o,l)}m.memoizedState=l;var v={value:l,getSnapshot:o};return m.queue=v,jg(Vg.bind(null,f,v,s),[s]),f.flags|=2048,yl(9,Dg.bind(null,f,v,l,o),void 0,null),l},useId:function(){var s=Gr(),o=Kt.identifierPrefix;if(_t){var l=ps,f=fs;l=(f&~(1<<32-yn(f)-1)).toString(32)+l,o=":"+o+"R"+l,l=ml++,0<l&&(o+="H"+l.toString(32)),o+=":"}else l=tI++,o=":"+o+"r"+l.toString(32)+":";return s.memoizedState=o},unstable_isNewReconciler:!1},oI={readContext:rr,useCallback:qg,useContext:rr,useEffect:tf,useImperativeHandle:$g,useInsertionEffect:Bg,useLayoutEffect:zg,useMemo:Wg,useReducer:Jd,useRef:Lg,useState:function(){return Jd(gl)},useDebugValue:nf,useDeferredValue:function(s){var o=sr();return Gg(o,Bt.memoizedState,s)},useTransition:function(){var s=Jd(gl)[0],o=sr().memoizedState;return[s,o]},useMutableSource:Pg,useSyncExternalStore:kg,useId:Kg,unstable_isNewReconciler:!1},aI={readContext:rr,useCallback:qg,useContext:rr,useEffect:tf,useImperativeHandle:$g,useInsertionEffect:Bg,useLayoutEffect:zg,useMemo:Wg,useReducer:ef,useRef:Lg,useState:function(){return ef(gl)},useDebugValue:nf,useDeferredValue:function(s){var o=sr();return Bt===null?o.memoizedState=s:Gg(o,Bt.memoizedState,s)},useTransition:function(){var s=ef(gl)[0],o=sr().memoizedState;return[s,o]},useMutableSource:Pg,useSyncExternalStore:kg,useId:Kg,unstable_isNewReconciler:!1};function Ar(s,o){if(s&&s.defaultProps){o=re({},o),s=s.defaultProps;for(var l in s)o[l]===void 0&&(o[l]=s[l]);return o}return o}function rf(s,o,l,f){o=s.memoizedState,l=l(f,o),l=l==null?o:re({},o,l),s.memoizedState=l,s.lanes===0&&(s.updateQueue.baseState=l)}var gc={isMounted:function(s){return(s=s._reactInternals)?yr(s)===s:!1},enqueueSetState:function(s,o,l){s=s._reactInternals;var f=wn(),m=Xs(s),v=gs(f,m);v.payload=o,l!=null&&(v.callback=l),o=Gs(s,v,m),o!==null&&(Rr(o,s,m,f),lc(o,s,m))},enqueueReplaceState:function(s,o,l){s=s._reactInternals;var f=wn(),m=Xs(s),v=gs(f,m);v.tag=1,v.payload=o,l!=null&&(v.callback=l),o=Gs(s,v,m),o!==null&&(Rr(o,s,m,f),lc(o,s,m))},enqueueForceUpdate:function(s,o){s=s._reactInternals;var l=wn(),f=Xs(s),m=gs(l,f);m.tag=2,o!=null&&(m.callback=o),o=Gs(s,m,f),o!==null&&(Rr(o,s,f,l),lc(o,s,f))}};function Yg(s,o,l,f,m,v,S){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(f,v,S):o.prototype&&o.prototype.isPureReactComponent?!rl(l,f)||!rl(m,v):!0}function Zg(s,o,l){var f=!1,m=$s,v=o.contextType;return typeof v=="object"&&v!==null?v=rr(v):(m=Nn(o)?Fi:rn.current,f=o.contextTypes,v=(f=f!=null)?Go(s,m):$s),o=new o(l,v),s.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,o.updater=gc,s.stateNode=o,o._reactInternals=s,f&&(s=s.stateNode,s.__reactInternalMemoizedUnmaskedChildContext=m,s.__reactInternalMemoizedMaskedChildContext=v),o}function Jg(s,o,l,f){s=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(l,f),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(l,f),o.state!==s&&gc.enqueueReplaceState(o,o.state,null)}function sf(s,o,l,f){var m=s.stateNode;m.props=l,m.state=s.memoizedState,m.refs={},qd(s);var v=o.contextType;typeof v=="object"&&v!==null?m.context=rr(v):(v=Nn(o)?Fi:rn.current,m.context=Go(s,v)),m.state=s.memoizedState,v=o.getDerivedStateFromProps,typeof v=="function"&&(rf(s,o,v,l),m.state=s.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof m.getSnapshotBeforeUpdate=="function"||typeof m.UNSAFE_componentWillMount!="function"&&typeof m.componentWillMount!="function"||(o=m.state,typeof m.componentWillMount=="function"&&m.componentWillMount(),typeof m.UNSAFE_componentWillMount=="function"&&m.UNSAFE_componentWillMount(),o!==m.state&&gc.enqueueReplaceState(m,m.state,null),uc(s,l,m,f),m.state=s.memoizedState),typeof m.componentDidMount=="function"&&(s.flags|=4194308)}function ea(s,o){try{var l="",f=o;do l+=Q(f),f=f.return;while(f);var m=l}catch(v){m=`
Error generating stack: `+v.message+`
`+v.stack}return{value:s,source:o,stack:m,digest:null}}function of(s,o,l){return{value:s,source:null,stack:l??null,digest:o??null}}function af(s,o){try{console.error(o.value)}catch(l){setTimeout(function(){throw l})}}var lI=typeof WeakMap=="function"?WeakMap:Map;function ey(s,o,l){l=gs(-1,l),l.tag=3,l.payload={element:null};var f=o.value;return l.callback=function(){Ic||(Ic=!0,Tf=f),af(s,o)},l}function ty(s,o,l){l=gs(-1,l),l.tag=3;var f=s.type.getDerivedStateFromError;if(typeof f=="function"){var m=o.value;l.payload=function(){return f(m)},l.callback=function(){af(s,o)}}var v=s.stateNode;return v!==null&&typeof v.componentDidCatch=="function"&&(l.callback=function(){af(s,o),typeof f!="function"&&(Hs===null?Hs=new Set([this]):Hs.add(this));var S=o.stack;this.componentDidCatch(o.value,{componentStack:S!==null?S:""})}),l}function ny(s,o,l){var f=s.pingCache;if(f===null){f=s.pingCache=new lI;var m=new Set;f.set(o,m)}else m=f.get(o),m===void 0&&(m=new Set,f.set(o,m));m.has(l)||(m.add(l),s=TI.bind(null,s,o,l),o.then(s,s))}function ry(s){do{var o;if((o=s.tag===13)&&(o=s.memoizedState,o=o!==null?o.dehydrated!==null:!0),o)return s;s=s.return}while(s!==null);return null}function sy(s,o,l,f,m){return s.mode&1?(s.flags|=65536,s.lanes=m,s):(s===o?s.flags|=65536:(s.flags|=128,l.flags|=131072,l.flags&=-52805,l.tag===1&&(l.alternate===null?l.tag=17:(o=gs(-1,1),o.tag=2,Gs(l,o,1))),l.lanes|=1),s)}var uI=X.ReactCurrentOwner,Rn=!1;function _n(s,o,l,f){o.child=s===null?Sg(o,null,l,f):Xo(o,s.child,l,f)}function iy(s,o,l,f,m){l=l.render;var v=o.ref;return Zo(o,m),f=Yd(s,o,l,f,v,m),l=Zd(),s!==null&&!Rn?(o.updateQueue=s.updateQueue,o.flags&=-2053,s.lanes&=~m,ys(s,o,m)):(_t&&l&&Vd(o),o.flags|=1,_n(s,o,f,m),o.child)}function oy(s,o,l,f,m){if(s===null){var v=l.type;return typeof v=="function"&&!Rf(v)&&v.defaultProps===void 0&&l.compare===null&&l.defaultProps===void 0?(o.tag=15,o.type=v,ay(s,o,v,f,m)):(s=Rc(l.type,null,f,o,o.mode,m),s.ref=o.ref,s.return=o,o.child=s)}if(v=s.child,!(s.lanes&m)){var S=v.memoizedProps;if(l=l.compare,l=l!==null?l:rl,l(S,f)&&s.ref===o.ref)return ys(s,o,m)}return o.flags|=1,s=Zs(v,f),s.ref=o.ref,s.return=o,o.child=s}function ay(s,o,l,f,m){if(s!==null){var v=s.memoizedProps;if(rl(v,f)&&s.ref===o.ref)if(Rn=!1,o.pendingProps=f=v,(s.lanes&m)!==0)s.flags&131072&&(Rn=!0);else return o.lanes=s.lanes,ys(s,o,m)}return lf(s,o,l,f,m)}function ly(s,o,l){var f=o.pendingProps,m=f.children,v=s!==null?s.memoizedState:null;if(f.mode==="hidden")if(!(o.mode&1))o.memoizedState={baseLanes:0,cachePool:null,transitions:null},ht(na,Gn),Gn|=l;else{if(!(l&1073741824))return s=v!==null?v.baseLanes|l:l,o.lanes=o.childLanes=1073741824,o.memoizedState={baseLanes:s,cachePool:null,transitions:null},o.updateQueue=null,ht(na,Gn),Gn|=s,null;o.memoizedState={baseLanes:0,cachePool:null,transitions:null},f=v!==null?v.baseLanes:l,ht(na,Gn),Gn|=f}else v!==null?(f=v.baseLanes|l,o.memoizedState=null):f=l,ht(na,Gn),Gn|=f;return _n(s,o,m,l),o.child}function uy(s,o){var l=o.ref;(s===null&&l!==null||s!==null&&s.ref!==l)&&(o.flags|=512,o.flags|=2097152)}function lf(s,o,l,f,m){var v=Nn(l)?Fi:rn.current;return v=Go(o,v),Zo(o,m),l=Yd(s,o,l,f,v,m),f=Zd(),s!==null&&!Rn?(o.updateQueue=s.updateQueue,o.flags&=-2053,s.lanes&=~m,ys(s,o,m)):(_t&&f&&Vd(o),o.flags|=1,_n(s,o,l,m),o.child)}function cy(s,o,l,f,m){if(Nn(l)){var v=!0;ec(o)}else v=!1;if(Zo(o,m),o.stateNode===null)vc(s,o),Zg(o,l,f),sf(o,l,f,m),f=!0;else if(s===null){var S=o.stateNode,O=o.memoizedProps;S.props=O;var j=S.context,Y=l.contextType;typeof Y=="object"&&Y!==null?Y=rr(Y):(Y=Nn(l)?Fi:rn.current,Y=Go(o,Y));var ue=l.getDerivedStateFromProps,de=typeof ue=="function"||typeof S.getSnapshotBeforeUpdate=="function";de||typeof S.UNSAFE_componentWillReceiveProps!="function"&&typeof S.componentWillReceiveProps!="function"||(O!==f||j!==Y)&&Jg(o,S,f,Y),Ws=!1;var ae=o.memoizedState;S.state=ae,uc(o,f,S,m),j=o.memoizedState,O!==f||ae!==j||xn.current||Ws?(typeof ue=="function"&&(rf(o,l,ue,f),j=o.memoizedState),(O=Ws||Yg(o,l,O,f,ae,j,Y))?(de||typeof S.UNSAFE_componentWillMount!="function"&&typeof S.componentWillMount!="function"||(typeof S.componentWillMount=="function"&&S.componentWillMount(),typeof S.UNSAFE_componentWillMount=="function"&&S.UNSAFE_componentWillMount()),typeof S.componentDidMount=="function"&&(o.flags|=4194308)):(typeof S.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=f,o.memoizedState=j),S.props=f,S.state=j,S.context=Y,f=O):(typeof S.componentDidMount=="function"&&(o.flags|=4194308),f=!1)}else{S=o.stateNode,Ag(s,o),O=o.memoizedProps,Y=o.type===o.elementType?O:Ar(o.type,O),S.props=Y,de=o.pendingProps,ae=S.context,j=l.contextType,typeof j=="object"&&j!==null?j=rr(j):(j=Nn(l)?Fi:rn.current,j=Go(o,j));var we=l.getDerivedStateFromProps;(ue=typeof we=="function"||typeof S.getSnapshotBeforeUpdate=="function")||typeof S.UNSAFE_componentWillReceiveProps!="function"&&typeof S.componentWillReceiveProps!="function"||(O!==de||ae!==j)&&Jg(o,S,f,j),Ws=!1,ae=o.memoizedState,S.state=ae,uc(o,f,S,m);var Se=o.memoizedState;O!==de||ae!==Se||xn.current||Ws?(typeof we=="function"&&(rf(o,l,we,f),Se=o.memoizedState),(Y=Ws||Yg(o,l,Y,f,ae,Se,j)||!1)?(ue||typeof S.UNSAFE_componentWillUpdate!="function"&&typeof S.componentWillUpdate!="function"||(typeof S.componentWillUpdate=="function"&&S.componentWillUpdate(f,Se,j),typeof S.UNSAFE_componentWillUpdate=="function"&&S.UNSAFE_componentWillUpdate(f,Se,j)),typeof S.componentDidUpdate=="function"&&(o.flags|=4),typeof S.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof S.componentDidUpdate!="function"||O===s.memoizedProps&&ae===s.memoizedState||(o.flags|=4),typeof S.getSnapshotBeforeUpdate!="function"||O===s.memoizedProps&&ae===s.memoizedState||(o.flags|=1024),o.memoizedProps=f,o.memoizedState=Se),S.props=f,S.state=Se,S.context=j,f=Y):(typeof S.componentDidUpdate!="function"||O===s.memoizedProps&&ae===s.memoizedState||(o.flags|=4),typeof S.getSnapshotBeforeUpdate!="function"||O===s.memoizedProps&&ae===s.memoizedState||(o.flags|=1024),f=!1)}return uf(s,o,l,f,v,m)}function uf(s,o,l,f,m,v){uy(s,o);var S=(o.flags&128)!==0;if(!f&&!S)return m&&mg(o,l,!1),ys(s,o,v);f=o.stateNode,uI.current=o;var O=S&&typeof l.getDerivedStateFromError!="function"?null:f.render();return o.flags|=1,s!==null&&S?(o.child=Xo(o,s.child,null,v),o.child=Xo(o,null,O,v)):_n(s,o,O,v),o.memoizedState=f.state,m&&mg(o,l,!0),o.child}function hy(s){var o=s.stateNode;o.pendingContext?fg(s,o.pendingContext,o.pendingContext!==o.context):o.context&&fg(s,o.context,!1),Wd(s,o.containerInfo)}function dy(s,o,l,f,m){return Qo(),Ld(m),o.flags|=256,_n(s,o,l,f),o.child}var cf={dehydrated:null,treeContext:null,retryLane:0};function hf(s){return{baseLanes:s,cachePool:null,transitions:null}}function fy(s,o,l){var f=o.pendingProps,m=Tt.current,v=!1,S=(o.flags&128)!==0,O;if((O=S)||(O=s!==null&&s.memoizedState===null?!1:(m&2)!==0),O?(v=!0,o.flags&=-129):(s===null||s.memoizedState!==null)&&(m|=1),ht(Tt,m&1),s===null)return Fd(o),s=o.memoizedState,s!==null&&(s=s.dehydrated,s!==null)?(o.mode&1?s.data==="$!"?o.lanes=8:o.lanes=1073741824:o.lanes=1,null):(S=f.children,s=f.fallback,v?(f=o.mode,v=o.child,S={mode:"hidden",children:S},!(f&1)&&v!==null?(v.childLanes=0,v.pendingProps=S):v=Pc(S,f,0,null),s=Ki(s,f,l,null),v.return=o,s.return=o,v.sibling=s,o.child=v,o.child.memoizedState=hf(l),o.memoizedState=cf,s):df(o,S));if(m=s.memoizedState,m!==null&&(O=m.dehydrated,O!==null))return cI(s,o,S,f,O,m,l);if(v){v=f.fallback,S=o.mode,m=s.child,O=m.sibling;var j={mode:"hidden",children:f.children};return!(S&1)&&o.child!==m?(f=o.child,f.childLanes=0,f.pendingProps=j,o.deletions=null):(f=Zs(m,j),f.subtreeFlags=m.subtreeFlags&14680064),O!==null?v=Zs(O,v):(v=Ki(v,S,l,null),v.flags|=2),v.return=o,f.return=o,f.sibling=v,o.child=f,f=v,v=o.child,S=s.child.memoizedState,S=S===null?hf(l):{baseLanes:S.baseLanes|l,cachePool:null,transitions:S.transitions},v.memoizedState=S,v.childLanes=s.childLanes&~l,o.memoizedState=cf,f}return v=s.child,s=v.sibling,f=Zs(v,{mode:"visible",children:f.children}),!(o.mode&1)&&(f.lanes=l),f.return=o,f.sibling=null,s!==null&&(l=o.deletions,l===null?(o.deletions=[s],o.flags|=16):l.push(s)),o.child=f,o.memoizedState=null,f}function df(s,o){return o=Pc({mode:"visible",children:o},s.mode,0,null),o.return=s,s.child=o}function yc(s,o,l,f){return f!==null&&Ld(f),Xo(o,s.child,null,l),s=df(o,o.pendingProps.children),s.flags|=2,o.memoizedState=null,s}function cI(s,o,l,f,m,v,S){if(l)return o.flags&256?(o.flags&=-257,f=of(Error(t(422))),yc(s,o,S,f)):o.memoizedState!==null?(o.child=s.child,o.flags|=128,null):(v=f.fallback,m=o.mode,f=Pc({mode:"visible",children:f.children},m,0,null),v=Ki(v,m,S,null),v.flags|=2,f.return=o,v.return=o,f.sibling=v,o.child=f,o.mode&1&&Xo(o,s.child,null,S),o.child.memoizedState=hf(S),o.memoizedState=cf,v);if(!(o.mode&1))return yc(s,o,S,null);if(m.data==="$!"){if(f=m.nextSibling&&m.nextSibling.dataset,f)var O=f.dgst;return f=O,v=Error(t(419)),f=of(v,f,void 0),yc(s,o,S,f)}if(O=(S&s.childLanes)!==0,Rn||O){if(f=Kt,f!==null){switch(S&-S){case 4:m=2;break;case 16:m=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:m=32;break;case 536870912:m=268435456;break;default:m=0}m=m&(f.suspendedLanes|S)?0:m,m!==0&&m!==v.retryLane&&(v.retryLane=m,ms(s,m),Rr(f,s,m,-1))}return Nf(),f=of(Error(t(421))),yc(s,o,S,f)}return m.data==="$?"?(o.flags|=128,o.child=s.child,o=II.bind(null,s),m._reactRetry=o,null):(s=v.treeContext,Wn=zs(m.nextSibling),qn=o,_t=!0,Cr=null,s!==null&&(tr[nr++]=fs,tr[nr++]=ps,tr[nr++]=Li,fs=s.id,ps=s.overflow,Li=o),o=df(o,f.children),o.flags|=4096,o)}function py(s,o,l){s.lanes|=o;var f=s.alternate;f!==null&&(f.lanes|=o),Ud(s.return,o,l)}function ff(s,o,l,f,m){var v=s.memoizedState;v===null?s.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:f,tail:l,tailMode:m}:(v.isBackwards=o,v.rendering=null,v.renderingStartTime=0,v.last=f,v.tail=l,v.tailMode=m)}function my(s,o,l){var f=o.pendingProps,m=f.revealOrder,v=f.tail;if(_n(s,o,f.children,l),f=Tt.current,f&2)f=f&1|2,o.flags|=128;else{if(s!==null&&s.flags&128)e:for(s=o.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&py(s,l,o);else if(s.tag===19)py(s,l,o);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===o)break e;for(;s.sibling===null;){if(s.return===null||s.return===o)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}f&=1}if(ht(Tt,f),!(o.mode&1))o.memoizedState=null;else switch(m){case"forwards":for(l=o.child,m=null;l!==null;)s=l.alternate,s!==null&&cc(s)===null&&(m=l),l=l.sibling;l=m,l===null?(m=o.child,o.child=null):(m=l.sibling,l.sibling=null),ff(o,!1,m,l,v);break;case"backwards":for(l=null,m=o.child,o.child=null;m!==null;){if(s=m.alternate,s!==null&&cc(s)===null){o.child=m;break}s=m.sibling,m.sibling=l,l=m,m=s}ff(o,!0,l,null,v);break;case"together":ff(o,!1,null,null,void 0);break;default:o.memoizedState=null}return o.child}function vc(s,o){!(o.mode&1)&&s!==null&&(s.alternate=null,o.alternate=null,o.flags|=2)}function ys(s,o,l){if(s!==null&&(o.dependencies=s.dependencies),$i|=o.lanes,!(l&o.childLanes))return null;if(s!==null&&o.child!==s.child)throw Error(t(153));if(o.child!==null){for(s=o.child,l=Zs(s,s.pendingProps),o.child=l,l.return=o;s.sibling!==null;)s=s.sibling,l=l.sibling=Zs(s,s.pendingProps),l.return=o;l.sibling=null}return o.child}function hI(s,o,l){switch(o.tag){case 3:hy(o),Qo();break;case 5:Rg(o);break;case 1:Nn(o.type)&&ec(o);break;case 4:Wd(o,o.stateNode.containerInfo);break;case 10:var f=o.type._context,m=o.memoizedProps.value;ht(oc,f._currentValue),f._currentValue=m;break;case 13:if(f=o.memoizedState,f!==null)return f.dehydrated!==null?(ht(Tt,Tt.current&1),o.flags|=128,null):l&o.child.childLanes?fy(s,o,l):(ht(Tt,Tt.current&1),s=ys(s,o,l),s!==null?s.sibling:null);ht(Tt,Tt.current&1);break;case 19:if(f=(l&o.childLanes)!==0,s.flags&128){if(f)return my(s,o,l);o.flags|=128}if(m=o.memoizedState,m!==null&&(m.rendering=null,m.tail=null,m.lastEffect=null),ht(Tt,Tt.current),f)break;return null;case 22:case 23:return o.lanes=0,ly(s,o,l)}return ys(s,o,l)}var gy,pf,yy,vy;gy=function(s,o){for(var l=o.child;l!==null;){if(l.tag===5||l.tag===6)s.appendChild(l.stateNode);else if(l.tag!==4&&l.child!==null){l.child.return=l,l=l.child;continue}if(l===o)break;for(;l.sibling===null;){if(l.return===null||l.return===o)return;l=l.return}l.sibling.return=l.return,l=l.sibling}},pf=function(){},yy=function(s,o,l,f){var m=s.memoizedProps;if(m!==f){s=o.stateNode,zi(Wr.current);var v=null;switch(l){case"input":m=qe(s,m),f=qe(s,f),v=[];break;case"select":m=re({},m,{value:void 0}),f=re({},f,{value:void 0}),v=[];break;case"textarea":m=Or(s,m),f=Or(s,f),v=[];break;default:typeof m.onClick!="function"&&typeof f.onClick=="function"&&(s.onclick=Yu)}Si(l,f);var S;l=null;for(Y in m)if(!f.hasOwnProperty(Y)&&m.hasOwnProperty(Y)&&m[Y]!=null)if(Y==="style"){var O=m[Y];for(S in O)O.hasOwnProperty(S)&&(l||(l={}),l[S]="")}else Y!=="dangerouslySetInnerHTML"&&Y!=="children"&&Y!=="suppressContentEditableWarning"&&Y!=="suppressHydrationWarning"&&Y!=="autoFocus"&&(i.hasOwnProperty(Y)?v||(v=[]):(v=v||[]).push(Y,null));for(Y in f){var j=f[Y];if(O=m!=null?m[Y]:void 0,f.hasOwnProperty(Y)&&j!==O&&(j!=null||O!=null))if(Y==="style")if(O){for(S in O)!O.hasOwnProperty(S)||j&&j.hasOwnProperty(S)||(l||(l={}),l[S]="");for(S in j)j.hasOwnProperty(S)&&O[S]!==j[S]&&(l||(l={}),l[S]=j[S])}else l||(v||(v=[]),v.push(Y,l)),l=j;else Y==="dangerouslySetInnerHTML"?(j=j?j.__html:void 0,O=O?O.__html:void 0,j!=null&&O!==j&&(v=v||[]).push(Y,j)):Y==="children"?typeof j!="string"&&typeof j!="number"||(v=v||[]).push(Y,""+j):Y!=="suppressContentEditableWarning"&&Y!=="suppressHydrationWarning"&&(i.hasOwnProperty(Y)?(j!=null&&Y==="onScroll"&&mt("scroll",s),v||O===j||(v=[])):(v=v||[]).push(Y,j))}l&&(v=v||[]).push("style",l);var Y=v;(o.updateQueue=Y)&&(o.flags|=4)}},vy=function(s,o,l,f){l!==f&&(o.flags|=4)};function vl(s,o){if(!_t)switch(s.tailMode){case"hidden":o=s.tail;for(var l=null;o!==null;)o.alternate!==null&&(l=o),o=o.sibling;l===null?s.tail=null:l.sibling=null;break;case"collapsed":l=s.tail;for(var f=null;l!==null;)l.alternate!==null&&(f=l),l=l.sibling;f===null?o||s.tail===null?s.tail=null:s.tail.sibling=null:f.sibling=null}}function on(s){var o=s.alternate!==null&&s.alternate.child===s.child,l=0,f=0;if(o)for(var m=s.child;m!==null;)l|=m.lanes|m.childLanes,f|=m.subtreeFlags&14680064,f|=m.flags&14680064,m.return=s,m=m.sibling;else for(m=s.child;m!==null;)l|=m.lanes|m.childLanes,f|=m.subtreeFlags,f|=m.flags,m.return=s,m=m.sibling;return s.subtreeFlags|=f,s.childLanes=l,o}function dI(s,o,l){var f=o.pendingProps;switch(Md(o),o.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return on(o),null;case 1:return Nn(o.type)&&Ju(),on(o),null;case 3:return f=o.stateNode,Jo(),gt(xn),gt(rn),Hd(),f.pendingContext&&(f.context=f.pendingContext,f.pendingContext=null),(s===null||s.child===null)&&(sc(o)?o.flags|=4:s===null||s.memoizedState.isDehydrated&&!(o.flags&256)||(o.flags|=1024,Cr!==null&&(Cf(Cr),Cr=null))),pf(s,o),on(o),null;case 5:Gd(o);var m=zi(fl.current);if(l=o.type,s!==null&&o.stateNode!=null)yy(s,o,l,f,m),s.ref!==o.ref&&(o.flags|=512,o.flags|=2097152);else{if(!f){if(o.stateNode===null)throw Error(t(166));return on(o),null}if(s=zi(Wr.current),sc(o)){f=o.stateNode,l=o.type;var v=o.memoizedProps;switch(f[qr]=o,f[ll]=v,s=(o.mode&1)!==0,l){case"dialog":mt("cancel",f),mt("close",f);break;case"iframe":case"object":case"embed":mt("load",f);break;case"video":case"audio":for(m=0;m<il.length;m++)mt(il[m],f);break;case"source":mt("error",f);break;case"img":case"image":case"link":mt("error",f),mt("load",f);break;case"details":mt("toggle",f);break;case"input":hr(f,v),mt("invalid",f);break;case"select":f._wrapperState={wasMultiple:!!v.multiple},mt("invalid",f);break;case"textarea":Ye(f,v),mt("invalid",f)}Si(l,v),m=null;for(var S in v)if(v.hasOwnProperty(S)){var O=v[S];S==="children"?typeof O=="string"?f.textContent!==O&&(v.suppressHydrationWarning!==!0&&Xu(f.textContent,O,s),m=["children",O]):typeof O=="number"&&f.textContent!==""+O&&(v.suppressHydrationWarning!==!0&&Xu(f.textContent,O,s),m=["children",""+O]):i.hasOwnProperty(S)&&O!=null&&S==="onScroll"&&mt("scroll",f)}switch(l){case"input":Be(f),rs(f,v,!0);break;case"textarea":Be(f),mn(f);break;case"select":case"option":break;default:typeof v.onClick=="function"&&(f.onclick=Yu)}f=m,o.updateQueue=f,f!==null&&(o.flags|=4)}else{S=m.nodeType===9?m:m.ownerDocument,s==="http://www.w3.org/1999/xhtml"&&(s=dt(l)),s==="http://www.w3.org/1999/xhtml"?l==="script"?(s=S.createElement("div"),s.innerHTML="<script><\/script>",s=s.removeChild(s.firstChild)):typeof f.is=="string"?s=S.createElement(l,{is:f.is}):(s=S.createElement(l),l==="select"&&(S=s,f.multiple?S.multiple=!0:f.size&&(S.size=f.size))):s=S.createElementNS(s,l),s[qr]=o,s[ll]=f,gy(s,o,!1,!1),o.stateNode=s;e:{switch(S=Ps(l,f),l){case"dialog":mt("cancel",s),mt("close",s),m=f;break;case"iframe":case"object":case"embed":mt("load",s),m=f;break;case"video":case"audio":for(m=0;m<il.length;m++)mt(il[m],s);m=f;break;case"source":mt("error",s),m=f;break;case"img":case"image":case"link":mt("error",s),mt("load",s),m=f;break;case"details":mt("toggle",s),m=f;break;case"input":hr(s,f),m=qe(s,f),mt("invalid",s);break;case"option":m=f;break;case"select":s._wrapperState={wasMultiple:!!f.multiple},m=re({},f,{value:void 0}),mt("invalid",s);break;case"textarea":Ye(s,f),m=Or(s,f),mt("invalid",s);break;default:m=f}Si(l,m),O=m;for(v in O)if(O.hasOwnProperty(v)){var j=O[v];v==="style"?Ti(s,j):v==="dangerouslySetInnerHTML"?(j=j?j.__html:void 0,j!=null&&ss(s,j)):v==="children"?typeof j=="string"?(l!=="textarea"||j!=="")&&Yn(s,j):typeof j=="number"&&Yn(s,""+j):v!=="suppressContentEditableWarning"&&v!=="suppressHydrationWarning"&&v!=="autoFocus"&&(i.hasOwnProperty(v)?j!=null&&v==="onScroll"&&mt("scroll",s):j!=null&&$(s,v,j,S))}switch(l){case"input":Be(s),rs(s,f,!1);break;case"textarea":Be(s),mn(s);break;case"option":f.value!=null&&s.setAttribute("value",""+te(f.value));break;case"select":s.multiple=!!f.multiple,v=f.value,v!=null?ut(s,!!f.multiple,v,!1):f.defaultValue!=null&&ut(s,!!f.multiple,f.defaultValue,!0);break;default:typeof m.onClick=="function"&&(s.onclick=Yu)}switch(l){case"button":case"input":case"select":case"textarea":f=!!f.autoFocus;break e;case"img":f=!0;break e;default:f=!1}}f&&(o.flags|=4)}o.ref!==null&&(o.flags|=512,o.flags|=2097152)}return on(o),null;case 6:if(s&&o.stateNode!=null)vy(s,o,s.memoizedProps,f);else{if(typeof f!="string"&&o.stateNode===null)throw Error(t(166));if(l=zi(fl.current),zi(Wr.current),sc(o)){if(f=o.stateNode,l=o.memoizedProps,f[qr]=o,(v=f.nodeValue!==l)&&(s=qn,s!==null))switch(s.tag){case 3:Xu(f.nodeValue,l,(s.mode&1)!==0);break;case 5:s.memoizedProps.suppressHydrationWarning!==!0&&Xu(f.nodeValue,l,(s.mode&1)!==0)}v&&(o.flags|=4)}else f=(l.nodeType===9?l:l.ownerDocument).createTextNode(f),f[qr]=o,o.stateNode=f}return on(o),null;case 13:if(gt(Tt),f=o.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(_t&&Wn!==null&&o.mode&1&&!(o.flags&128))Eg(),Qo(),o.flags|=98560,v=!1;else if(v=sc(o),f!==null&&f.dehydrated!==null){if(s===null){if(!v)throw Error(t(318));if(v=o.memoizedState,v=v!==null?v.dehydrated:null,!v)throw Error(t(317));v[qr]=o}else Qo(),!(o.flags&128)&&(o.memoizedState=null),o.flags|=4;on(o),v=!1}else Cr!==null&&(Cf(Cr),Cr=null),v=!0;if(!v)return o.flags&65536?o:null}return o.flags&128?(o.lanes=l,o):(f=f!==null,f!==(s!==null&&s.memoizedState!==null)&&f&&(o.child.flags|=8192,o.mode&1&&(s===null||Tt.current&1?zt===0&&(zt=3):Nf())),o.updateQueue!==null&&(o.flags|=4),on(o),null);case 4:return Jo(),pf(s,o),s===null&&ol(o.stateNode.containerInfo),on(o),null;case 10:return zd(o.type._context),on(o),null;case 17:return Nn(o.type)&&Ju(),on(o),null;case 19:if(gt(Tt),v=o.memoizedState,v===null)return on(o),null;if(f=(o.flags&128)!==0,S=v.rendering,S===null)if(f)vl(v,!1);else{if(zt!==0||s!==null&&s.flags&128)for(s=o.child;s!==null;){if(S=cc(s),S!==null){for(o.flags|=128,vl(v,!1),f=S.updateQueue,f!==null&&(o.updateQueue=f,o.flags|=4),o.subtreeFlags=0,f=l,l=o.child;l!==null;)v=l,s=f,v.flags&=14680066,S=v.alternate,S===null?(v.childLanes=0,v.lanes=s,v.child=null,v.subtreeFlags=0,v.memoizedProps=null,v.memoizedState=null,v.updateQueue=null,v.dependencies=null,v.stateNode=null):(v.childLanes=S.childLanes,v.lanes=S.lanes,v.child=S.child,v.subtreeFlags=0,v.deletions=null,v.memoizedProps=S.memoizedProps,v.memoizedState=S.memoizedState,v.updateQueue=S.updateQueue,v.type=S.type,s=S.dependencies,v.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),l=l.sibling;return ht(Tt,Tt.current&1|2),o.child}s=s.sibling}v.tail!==null&&ct()>ra&&(o.flags|=128,f=!0,vl(v,!1),o.lanes=4194304)}else{if(!f)if(s=cc(S),s!==null){if(o.flags|=128,f=!0,l=s.updateQueue,l!==null&&(o.updateQueue=l,o.flags|=4),vl(v,!0),v.tail===null&&v.tailMode==="hidden"&&!S.alternate&&!_t)return on(o),null}else 2*ct()-v.renderingStartTime>ra&&l!==1073741824&&(o.flags|=128,f=!0,vl(v,!1),o.lanes=4194304);v.isBackwards?(S.sibling=o.child,o.child=S):(l=v.last,l!==null?l.sibling=S:o.child=S,v.last=S)}return v.tail!==null?(o=v.tail,v.rendering=o,v.tail=o.sibling,v.renderingStartTime=ct(),o.sibling=null,l=Tt.current,ht(Tt,f?l&1|2:l&1),o):(on(o),null);case 22:case 23:return xf(),f=o.memoizedState!==null,s!==null&&s.memoizedState!==null!==f&&(o.flags|=8192),f&&o.mode&1?Gn&1073741824&&(on(o),o.subtreeFlags&6&&(o.flags|=8192)):on(o),null;case 24:return null;case 25:return null}throw Error(t(156,o.tag))}function fI(s,o){switch(Md(o),o.tag){case 1:return Nn(o.type)&&Ju(),s=o.flags,s&65536?(o.flags=s&-65537|128,o):null;case 3:return Jo(),gt(xn),gt(rn),Hd(),s=o.flags,s&65536&&!(s&128)?(o.flags=s&-65537|128,o):null;case 5:return Gd(o),null;case 13:if(gt(Tt),s=o.memoizedState,s!==null&&s.dehydrated!==null){if(o.alternate===null)throw Error(t(340));Qo()}return s=o.flags,s&65536?(o.flags=s&-65537|128,o):null;case 19:return gt(Tt),null;case 4:return Jo(),null;case 10:return zd(o.type._context),null;case 22:case 23:return xf(),null;case 24:return null;default:return null}}var _c=!1,an=!1,pI=typeof WeakSet=="function"?WeakSet:Set,Ie=null;function ta(s,o){var l=s.ref;if(l!==null)if(typeof l=="function")try{l(null)}catch(f){Ct(s,o,f)}else l.current=null}function mf(s,o,l){try{l()}catch(f){Ct(s,o,f)}}var _y=!1;function mI(s,o){if(Ad=Ls,s=Ym(),vd(s)){if("selectionStart"in s)var l={start:s.selectionStart,end:s.selectionEnd};else e:{l=(l=s.ownerDocument)&&l.defaultView||window;var f=l.getSelection&&l.getSelection();if(f&&f.rangeCount!==0){l=f.anchorNode;var m=f.anchorOffset,v=f.focusNode;f=f.focusOffset;try{l.nodeType,v.nodeType}catch{l=null;break e}var S=0,O=-1,j=-1,Y=0,ue=0,de=s,ae=null;t:for(;;){for(var we;de!==l||m!==0&&de.nodeType!==3||(O=S+m),de!==v||f!==0&&de.nodeType!==3||(j=S+f),de.nodeType===3&&(S+=de.nodeValue.length),(we=de.firstChild)!==null;)ae=de,de=we;for(;;){if(de===s)break t;if(ae===l&&++Y===m&&(O=S),ae===v&&++ue===f&&(j=S),(we=de.nextSibling)!==null)break;de=ae,ae=de.parentNode}de=we}l=O===-1||j===-1?null:{start:O,end:j}}else l=null}l=l||{start:0,end:0}}else l=null;for(xd={focusedElem:s,selectionRange:l},Ls=!1,Ie=o;Ie!==null;)if(o=Ie,s=o.child,(o.subtreeFlags&1028)!==0&&s!==null)s.return=o,Ie=s;else for(;Ie!==null;){o=Ie;try{var Se=o.alternate;if(o.flags&1024)switch(o.tag){case 0:case 11:case 15:break;case 1:if(Se!==null){var xe=Se.memoizedProps,Pt=Se.memoizedState,K=o.stateNode,z=K.getSnapshotBeforeUpdate(o.elementType===o.type?xe:Ar(o.type,xe),Pt);K.__reactInternalSnapshotBeforeUpdate=z}break;case 3:var H=o.stateNode.containerInfo;H.nodeType===1?H.textContent="":H.nodeType===9&&H.documentElement&&H.removeChild(H.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(pe){Ct(o,o.return,pe)}if(s=o.sibling,s!==null){s.return=o.return,Ie=s;break}Ie=o.return}return Se=_y,_y=!1,Se}function _l(s,o,l){var f=o.updateQueue;if(f=f!==null?f.lastEffect:null,f!==null){var m=f=f.next;do{if((m.tag&s)===s){var v=m.destroy;m.destroy=void 0,v!==void 0&&mf(o,l,v)}m=m.next}while(m!==f)}}function wc(s,o){if(o=o.updateQueue,o=o!==null?o.lastEffect:null,o!==null){var l=o=o.next;do{if((l.tag&s)===s){var f=l.create;l.destroy=f()}l=l.next}while(l!==o)}}function gf(s){var o=s.ref;if(o!==null){var l=s.stateNode;switch(s.tag){case 5:s=l;break;default:s=l}typeof o=="function"?o(s):o.current=s}}function wy(s){var o=s.alternate;o!==null&&(s.alternate=null,wy(o)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(o=s.stateNode,o!==null&&(delete o[qr],delete o[ll],delete o[kd],delete o[YT],delete o[ZT])),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}function Ey(s){return s.tag===5||s.tag===3||s.tag===4}function Ty(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||Ey(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function yf(s,o,l){var f=s.tag;if(f===5||f===6)s=s.stateNode,o?l.nodeType===8?l.parentNode.insertBefore(s,o):l.insertBefore(s,o):(l.nodeType===8?(o=l.parentNode,o.insertBefore(s,l)):(o=l,o.appendChild(s)),l=l._reactRootContainer,l!=null||o.onclick!==null||(o.onclick=Yu));else if(f!==4&&(s=s.child,s!==null))for(yf(s,o,l),s=s.sibling;s!==null;)yf(s,o,l),s=s.sibling}function vf(s,o,l){var f=s.tag;if(f===5||f===6)s=s.stateNode,o?l.insertBefore(s,o):l.appendChild(s);else if(f!==4&&(s=s.child,s!==null))for(vf(s,o,l),s=s.sibling;s!==null;)vf(s,o,l),s=s.sibling}var en=null,xr=!1;function Ks(s,o,l){for(l=l.child;l!==null;)Iy(s,o,l),l=l.sibling}function Iy(s,o,l){if(Bn&&typeof Bn.onCommitFiberUnmount=="function")try{Bn.onCommitFiberUnmount(Ri,l)}catch{}switch(l.tag){case 5:an||ta(l,o);case 6:var f=en,m=xr;en=null,Ks(s,o,l),en=f,xr=m,en!==null&&(xr?(s=en,l=l.stateNode,s.nodeType===8?s.parentNode.removeChild(l):s.removeChild(l)):en.removeChild(l.stateNode));break;case 18:en!==null&&(xr?(s=en,l=l.stateNode,s.nodeType===8?Pd(s.parentNode,l):s.nodeType===1&&Pd(s,l),Tr(s)):Pd(en,l.stateNode));break;case 4:f=en,m=xr,en=l.stateNode.containerInfo,xr=!0,Ks(s,o,l),en=f,xr=m;break;case 0:case 11:case 14:case 15:if(!an&&(f=l.updateQueue,f!==null&&(f=f.lastEffect,f!==null))){m=f=f.next;do{var v=m,S=v.destroy;v=v.tag,S!==void 0&&(v&2||v&4)&&mf(l,o,S),m=m.next}while(m!==f)}Ks(s,o,l);break;case 1:if(!an&&(ta(l,o),f=l.stateNode,typeof f.componentWillUnmount=="function"))try{f.props=l.memoizedProps,f.state=l.memoizedState,f.componentWillUnmount()}catch(O){Ct(l,o,O)}Ks(s,o,l);break;case 21:Ks(s,o,l);break;case 22:l.mode&1?(an=(f=an)||l.memoizedState!==null,Ks(s,o,l),an=f):Ks(s,o,l);break;default:Ks(s,o,l)}}function Sy(s){var o=s.updateQueue;if(o!==null){s.updateQueue=null;var l=s.stateNode;l===null&&(l=s.stateNode=new pI),o.forEach(function(f){var m=SI.bind(null,s,f);l.has(f)||(l.add(f),f.then(m,m))})}}function Nr(s,o){var l=o.deletions;if(l!==null)for(var f=0;f<l.length;f++){var m=l[f];try{var v=s,S=o,O=S;e:for(;O!==null;){switch(O.tag){case 5:en=O.stateNode,xr=!1;break e;case 3:en=O.stateNode.containerInfo,xr=!0;break e;case 4:en=O.stateNode.containerInfo,xr=!0;break e}O=O.return}if(en===null)throw Error(t(160));Iy(v,S,m),en=null,xr=!1;var j=m.alternate;j!==null&&(j.return=null),m.return=null}catch(Y){Ct(m,o,Y)}}if(o.subtreeFlags&12854)for(o=o.child;o!==null;)Cy(o,s),o=o.sibling}function Cy(s,o){var l=s.alternate,f=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:if(Nr(o,s),Kr(s),f&4){try{_l(3,s,s.return),wc(3,s)}catch(xe){Ct(s,s.return,xe)}try{_l(5,s,s.return)}catch(xe){Ct(s,s.return,xe)}}break;case 1:Nr(o,s),Kr(s),f&512&&l!==null&&ta(l,l.return);break;case 5:if(Nr(o,s),Kr(s),f&512&&l!==null&&ta(l,l.return),s.flags&32){var m=s.stateNode;try{Yn(m,"")}catch(xe){Ct(s,s.return,xe)}}if(f&4&&(m=s.stateNode,m!=null)){var v=s.memoizedProps,S=l!==null?l.memoizedProps:v,O=s.type,j=s.updateQueue;if(s.updateQueue=null,j!==null)try{O==="input"&&v.type==="radio"&&v.name!=null&&Mr(m,v),Ps(O,S);var Y=Ps(O,v);for(S=0;S<j.length;S+=2){var ue=j[S],de=j[S+1];ue==="style"?Ti(m,de):ue==="dangerouslySetInnerHTML"?ss(m,de):ue==="children"?Yn(m,de):$(m,ue,de,Y)}switch(O){case"input":dr(m,v);break;case"textarea":In(m,v);break;case"select":var ae=m._wrapperState.wasMultiple;m._wrapperState.wasMultiple=!!v.multiple;var we=v.value;we!=null?ut(m,!!v.multiple,we,!1):ae!==!!v.multiple&&(v.defaultValue!=null?ut(m,!!v.multiple,v.defaultValue,!0):ut(m,!!v.multiple,v.multiple?[]:"",!1))}m[ll]=v}catch(xe){Ct(s,s.return,xe)}}break;case 6:if(Nr(o,s),Kr(s),f&4){if(s.stateNode===null)throw Error(t(162));m=s.stateNode,v=s.memoizedProps;try{m.nodeValue=v}catch(xe){Ct(s,s.return,xe)}}break;case 3:if(Nr(o,s),Kr(s),f&4&&l!==null&&l.memoizedState.isDehydrated)try{Tr(o.containerInfo)}catch(xe){Ct(s,s.return,xe)}break;case 4:Nr(o,s),Kr(s);break;case 13:Nr(o,s),Kr(s),m=s.child,m.flags&8192&&(v=m.memoizedState!==null,m.stateNode.isHidden=v,!v||m.alternate!==null&&m.alternate.memoizedState!==null||(Ef=ct())),f&4&&Sy(s);break;case 22:if(ue=l!==null&&l.memoizedState!==null,s.mode&1?(an=(Y=an)||ue,Nr(o,s),an=Y):Nr(o,s),Kr(s),f&8192){if(Y=s.memoizedState!==null,(s.stateNode.isHidden=Y)&&!ue&&s.mode&1)for(Ie=s,ue=s.child;ue!==null;){for(de=Ie=ue;Ie!==null;){switch(ae=Ie,we=ae.child,ae.tag){case 0:case 11:case 14:case 15:_l(4,ae,ae.return);break;case 1:ta(ae,ae.return);var Se=ae.stateNode;if(typeof Se.componentWillUnmount=="function"){f=ae,l=ae.return;try{o=f,Se.props=o.memoizedProps,Se.state=o.memoizedState,Se.componentWillUnmount()}catch(xe){Ct(f,l,xe)}}break;case 5:ta(ae,ae.return);break;case 22:if(ae.memoizedState!==null){Ny(de);continue}}we!==null?(we.return=ae,Ie=we):Ny(de)}ue=ue.sibling}e:for(ue=null,de=s;;){if(de.tag===5){if(ue===null){ue=de;try{m=de.stateNode,Y?(v=m.style,typeof v.setProperty=="function"?v.setProperty("display","none","important"):v.display="none"):(O=de.stateNode,j=de.memoizedProps.style,S=j!=null&&j.hasOwnProperty("display")?j.display:null,O.style.display=fr("display",S))}catch(xe){Ct(s,s.return,xe)}}}else if(de.tag===6){if(ue===null)try{de.stateNode.nodeValue=Y?"":de.memoizedProps}catch(xe){Ct(s,s.return,xe)}}else if((de.tag!==22&&de.tag!==23||de.memoizedState===null||de===s)&&de.child!==null){de.child.return=de,de=de.child;continue}if(de===s)break e;for(;de.sibling===null;){if(de.return===null||de.return===s)break e;ue===de&&(ue=null),de=de.return}ue===de&&(ue=null),de.sibling.return=de.return,de=de.sibling}}break;case 19:Nr(o,s),Kr(s),f&4&&Sy(s);break;case 21:break;default:Nr(o,s),Kr(s)}}function Kr(s){var o=s.flags;if(o&2){try{e:{for(var l=s.return;l!==null;){if(Ey(l)){var f=l;break e}l=l.return}throw Error(t(160))}switch(f.tag){case 5:var m=f.stateNode;f.flags&32&&(Yn(m,""),f.flags&=-33);var v=Ty(s);vf(s,v,m);break;case 3:case 4:var S=f.stateNode.containerInfo,O=Ty(s);yf(s,O,S);break;default:throw Error(t(161))}}catch(j){Ct(s,s.return,j)}s.flags&=-3}o&4096&&(s.flags&=-4097)}function gI(s,o,l){Ie=s,Ay(s)}function Ay(s,o,l){for(var f=(s.mode&1)!==0;Ie!==null;){var m=Ie,v=m.child;if(m.tag===22&&f){var S=m.memoizedState!==null||_c;if(!S){var O=m.alternate,j=O!==null&&O.memoizedState!==null||an;O=_c;var Y=an;if(_c=S,(an=j)&&!Y)for(Ie=m;Ie!==null;)S=Ie,j=S.child,S.tag===22&&S.memoizedState!==null?Ry(m):j!==null?(j.return=S,Ie=j):Ry(m);for(;v!==null;)Ie=v,Ay(v),v=v.sibling;Ie=m,_c=O,an=Y}xy(s)}else m.subtreeFlags&8772&&v!==null?(v.return=m,Ie=v):xy(s)}}function xy(s){for(;Ie!==null;){var o=Ie;if(o.flags&8772){var l=o.alternate;try{if(o.flags&8772)switch(o.tag){case 0:case 11:case 15:an||wc(5,o);break;case 1:var f=o.stateNode;if(o.flags&4&&!an)if(l===null)f.componentDidMount();else{var m=o.elementType===o.type?l.memoizedProps:Ar(o.type,l.memoizedProps);f.componentDidUpdate(m,l.memoizedState,f.__reactInternalSnapshotBeforeUpdate)}var v=o.updateQueue;v!==null&&Ng(o,v,f);break;case 3:var S=o.updateQueue;if(S!==null){if(l=null,o.child!==null)switch(o.child.tag){case 5:l=o.child.stateNode;break;case 1:l=o.child.stateNode}Ng(o,S,l)}break;case 5:var O=o.stateNode;if(l===null&&o.flags&4){l=O;var j=o.memoizedProps;switch(o.type){case"button":case"input":case"select":case"textarea":j.autoFocus&&l.focus();break;case"img":j.src&&(l.src=j.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(o.memoizedState===null){var Y=o.alternate;if(Y!==null){var ue=Y.memoizedState;if(ue!==null){var de=ue.dehydrated;de!==null&&Tr(de)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}an||o.flags&512&&gf(o)}catch(ae){Ct(o,o.return,ae)}}if(o===s){Ie=null;break}if(l=o.sibling,l!==null){l.return=o.return,Ie=l;break}Ie=o.return}}function Ny(s){for(;Ie!==null;){var o=Ie;if(o===s){Ie=null;break}var l=o.sibling;if(l!==null){l.return=o.return,Ie=l;break}Ie=o.return}}function Ry(s){for(;Ie!==null;){var o=Ie;try{switch(o.tag){case 0:case 11:case 15:var l=o.return;try{wc(4,o)}catch(j){Ct(o,l,j)}break;case 1:var f=o.stateNode;if(typeof f.componentDidMount=="function"){var m=o.return;try{f.componentDidMount()}catch(j){Ct(o,m,j)}}var v=o.return;try{gf(o)}catch(j){Ct(o,v,j)}break;case 5:var S=o.return;try{gf(o)}catch(j){Ct(o,S,j)}}}catch(j){Ct(o,o.return,j)}if(o===s){Ie=null;break}var O=o.sibling;if(O!==null){O.return=o.return,Ie=O;break}Ie=o.return}}var yI=Math.ceil,Ec=X.ReactCurrentDispatcher,_f=X.ReactCurrentOwner,ir=X.ReactCurrentBatchConfig,Xe=0,Kt=null,Ot=null,tn=0,Gn=0,na=Us(0),zt=0,wl=null,$i=0,Tc=0,wf=0,El=null,Pn=null,Ef=0,ra=1/0,vs=null,Ic=!1,Tf=null,Hs=null,Sc=!1,Qs=null,Cc=0,Tl=0,If=null,Ac=-1,xc=0;function wn(){return Xe&6?ct():Ac!==-1?Ac:Ac=ct()}function Xs(s){return s.mode&1?Xe&2&&tn!==0?tn&-tn:eI.transition!==null?(xc===0&&(xc=ki()),xc):(s=We,s!==0||(s=window.event,s=s===void 0?16:Xa(s.type)),s):1}function Rr(s,o,l,f){if(50<Tl)throw Tl=0,If=null,Error(t(185));Vs(s,l,f),(!(Xe&2)||s!==Kt)&&(s===Kt&&(!(Xe&2)&&(Tc|=l),zt===4&&Ys(s,tn)),kn(s,f),l===1&&Xe===0&&!(o.mode&1)&&(ra=ct()+500,tc&&qs()))}function kn(s,o){var l=s.callbackNode;os(s,o);var f=Pi(s,s===Kt?tn:0);if(f===0)l!==null&&Wa(l),s.callbackNode=null,s.callbackPriority=0;else if(o=f&-f,s.callbackPriority!==o){if(l!=null&&Wa(l),o===1)s.tag===0?JT(ky.bind(null,s)):gg(ky.bind(null,s)),QT(function(){!(Xe&6)&&qs()}),l=null;else{switch(Os(f)){case 1:l=Ni;break;case 4:l=ks;break;case 16:l=Zn;break;case 536870912:l=xu;break;default:l=Zn}l=jy(l,Py.bind(null,s))}s.callbackPriority=o,s.callbackNode=l}}function Py(s,o){if(Ac=-1,xc=0,Xe&6)throw Error(t(327));var l=s.callbackNode;if(sa()&&s.callbackNode!==l)return null;var f=Pi(s,s===Kt?tn:0);if(f===0)return null;if(f&30||f&s.expiredLanes||o)o=Nc(s,f);else{o=f;var m=Xe;Xe|=2;var v=Dy();(Kt!==s||tn!==o)&&(vs=null,ra=ct()+500,Wi(s,o));do try{wI();break}catch(O){by(s,O)}while(!0);Bd(),Ec.current=v,Xe=m,Ot!==null?o=0:(Kt=null,tn=0,o=zt)}if(o!==0){if(o===2&&(m=zn(s),m!==0&&(f=m,o=Sf(s,m))),o===1)throw l=wl,Wi(s,0),Ys(s,f),kn(s,ct()),l;if(o===6)Ys(s,f);else{if(m=s.current.alternate,!(f&30)&&!vI(m)&&(o=Nc(s,f),o===2&&(v=zn(s),v!==0&&(f=v,o=Sf(s,v))),o===1))throw l=wl,Wi(s,0),Ys(s,f),kn(s,ct()),l;switch(s.finishedWork=m,s.finishedLanes=f,o){case 0:case 1:throw Error(t(345));case 2:Gi(s,Pn,vs);break;case 3:if(Ys(s,f),(f&130023424)===f&&(o=Ef+500-ct(),10<o)){if(Pi(s,0)!==0)break;if(m=s.suspendedLanes,(m&f)!==f){wn(),s.pingedLanes|=s.suspendedLanes&m;break}s.timeoutHandle=Rd(Gi.bind(null,s,Pn,vs),o);break}Gi(s,Pn,vs);break;case 4:if(Ys(s,f),(f&4194240)===f)break;for(o=s.eventTimes,m=-1;0<f;){var S=31-yn(f);v=1<<S,S=o[S],S>m&&(m=S),f&=~v}if(f=m,f=ct()-f,f=(120>f?120:480>f?480:1080>f?1080:1920>f?1920:3e3>f?3e3:4320>f?4320:1960*yI(f/1960))-f,10<f){s.timeoutHandle=Rd(Gi.bind(null,s,Pn,vs),f);break}Gi(s,Pn,vs);break;case 5:Gi(s,Pn,vs);break;default:throw Error(t(329))}}}return kn(s,ct()),s.callbackNode===l?Py.bind(null,s):null}function Sf(s,o){var l=El;return s.current.memoizedState.isDehydrated&&(Wi(s,o).flags|=256),s=Nc(s,o),s!==2&&(o=Pn,Pn=l,o!==null&&Cf(o)),s}function Cf(s){Pn===null?Pn=s:Pn.push.apply(Pn,s)}function vI(s){for(var o=s;;){if(o.flags&16384){var l=o.updateQueue;if(l!==null&&(l=l.stores,l!==null))for(var f=0;f<l.length;f++){var m=l[f],v=m.getSnapshot;m=m.value;try{if(!Sr(v(),m))return!1}catch{return!1}}}if(l=o.child,o.subtreeFlags&16384&&l!==null)l.return=o,o=l;else{if(o===s)break;for(;o.sibling===null;){if(o.return===null||o.return===s)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function Ys(s,o){for(o&=~wf,o&=~Tc,s.suspendedLanes|=o,s.pingedLanes&=~o,s=s.expirationTimes;0<o;){var l=31-yn(o),f=1<<l;s[l]=-1,o&=~f}}function ky(s){if(Xe&6)throw Error(t(327));sa();var o=Pi(s,0);if(!(o&1))return kn(s,ct()),null;var l=Nc(s,o);if(s.tag!==0&&l===2){var f=zn(s);f!==0&&(o=f,l=Sf(s,f))}if(l===1)throw l=wl,Wi(s,0),Ys(s,o),kn(s,ct()),l;if(l===6)throw Error(t(345));return s.finishedWork=s.current.alternate,s.finishedLanes=o,Gi(s,Pn,vs),kn(s,ct()),null}function Af(s,o){var l=Xe;Xe|=1;try{return s(o)}finally{Xe=l,Xe===0&&(ra=ct()+500,tc&&qs())}}function qi(s){Qs!==null&&Qs.tag===0&&!(Xe&6)&&sa();var o=Xe;Xe|=1;var l=ir.transition,f=We;try{if(ir.transition=null,We=1,s)return s()}finally{We=f,ir.transition=l,Xe=o,!(Xe&6)&&qs()}}function xf(){Gn=na.current,gt(na)}function Wi(s,o){s.finishedWork=null,s.finishedLanes=0;var l=s.timeoutHandle;if(l!==-1&&(s.timeoutHandle=-1,HT(l)),Ot!==null)for(l=Ot.return;l!==null;){var f=l;switch(Md(f),f.tag){case 1:f=f.type.childContextTypes,f!=null&&Ju();break;case 3:Jo(),gt(xn),gt(rn),Hd();break;case 5:Gd(f);break;case 4:Jo();break;case 13:gt(Tt);break;case 19:gt(Tt);break;case 10:zd(f.type._context);break;case 22:case 23:xf()}l=l.return}if(Kt=s,Ot=s=Zs(s.current,null),tn=Gn=o,zt=0,wl=null,wf=Tc=$i=0,Pn=El=null,Bi!==null){for(o=0;o<Bi.length;o++)if(l=Bi[o],f=l.interleaved,f!==null){l.interleaved=null;var m=f.next,v=l.pending;if(v!==null){var S=v.next;v.next=m,f.next=S}l.pending=f}Bi=null}return s}function by(s,o){do{var l=Ot;try{if(Bd(),hc.current=mc,dc){for(var f=It.memoizedState;f!==null;){var m=f.queue;m!==null&&(m.pending=null),f=f.next}dc=!1}if(Ui=0,Gt=Bt=It=null,pl=!1,ml=0,_f.current=null,l===null||l.return===null){zt=1,wl=o,Ot=null;break}e:{var v=s,S=l.return,O=l,j=o;if(o=tn,O.flags|=32768,j!==null&&typeof j=="object"&&typeof j.then=="function"){var Y=j,ue=O,de=ue.tag;if(!(ue.mode&1)&&(de===0||de===11||de===15)){var ae=ue.alternate;ae?(ue.updateQueue=ae.updateQueue,ue.memoizedState=ae.memoizedState,ue.lanes=ae.lanes):(ue.updateQueue=null,ue.memoizedState=null)}var we=ry(S);if(we!==null){we.flags&=-257,sy(we,S,O,v,o),we.mode&1&&ny(v,Y,o),o=we,j=Y;var Se=o.updateQueue;if(Se===null){var xe=new Set;xe.add(j),o.updateQueue=xe}else Se.add(j);break e}else{if(!(o&1)){ny(v,Y,o),Nf();break e}j=Error(t(426))}}else if(_t&&O.mode&1){var Pt=ry(S);if(Pt!==null){!(Pt.flags&65536)&&(Pt.flags|=256),sy(Pt,S,O,v,o),Ld(ea(j,O));break e}}v=j=ea(j,O),zt!==4&&(zt=2),El===null?El=[v]:El.push(v),v=S;do{switch(v.tag){case 3:v.flags|=65536,o&=-o,v.lanes|=o;var K=ey(v,j,o);xg(v,K);break e;case 1:O=j;var z=v.type,H=v.stateNode;if(!(v.flags&128)&&(typeof z.getDerivedStateFromError=="function"||H!==null&&typeof H.componentDidCatch=="function"&&(Hs===null||!Hs.has(H)))){v.flags|=65536,o&=-o,v.lanes|=o;var pe=ty(v,O,o);xg(v,pe);break e}}v=v.return}while(v!==null)}My(l)}catch(Pe){o=Pe,Ot===l&&l!==null&&(Ot=l=l.return);continue}break}while(!0)}function Dy(){var s=Ec.current;return Ec.current=mc,s===null?mc:s}function Nf(){(zt===0||zt===3||zt===2)&&(zt=4),Kt===null||!($i&268435455)&&!(Tc&268435455)||Ys(Kt,tn)}function Nc(s,o){var l=Xe;Xe|=2;var f=Dy();(Kt!==s||tn!==o)&&(vs=null,Wi(s,o));do try{_I();break}catch(m){by(s,m)}while(!0);if(Bd(),Xe=l,Ec.current=f,Ot!==null)throw Error(t(261));return Kt=null,tn=0,zt}function _I(){for(;Ot!==null;)Vy(Ot)}function wI(){for(;Ot!==null&&!Cu();)Vy(Ot)}function Vy(s){var o=Ly(s.alternate,s,Gn);s.memoizedProps=s.pendingProps,o===null?My(s):Ot=o,_f.current=null}function My(s){var o=s;do{var l=o.alternate;if(s=o.return,o.flags&32768){if(l=fI(l,o),l!==null){l.flags&=32767,Ot=l;return}if(s!==null)s.flags|=32768,s.subtreeFlags=0,s.deletions=null;else{zt=6,Ot=null;return}}else if(l=dI(l,o,Gn),l!==null){Ot=l;return}if(o=o.sibling,o!==null){Ot=o;return}Ot=o=s}while(o!==null);zt===0&&(zt=5)}function Gi(s,o,l){var f=We,m=ir.transition;try{ir.transition=null,We=1,EI(s,o,l,f)}finally{ir.transition=m,We=f}return null}function EI(s,o,l,f){do sa();while(Qs!==null);if(Xe&6)throw Error(t(327));l=s.finishedWork;var m=s.finishedLanes;if(l===null)return null;if(s.finishedWork=null,s.finishedLanes=0,l===s.current)throw Error(t(177));s.callbackNode=null,s.callbackPriority=0;var v=l.lanes|l.childLanes;if(at(s,v),s===Kt&&(Ot=Kt=null,tn=0),!(l.subtreeFlags&2064)&&!(l.flags&2064)||Sc||(Sc=!0,jy(Zn,function(){return sa(),null})),v=(l.flags&15990)!==0,l.subtreeFlags&15990||v){v=ir.transition,ir.transition=null;var S=We;We=1;var O=Xe;Xe|=4,_f.current=null,mI(s,l),Cy(l,s),zT(xd),Ls=!!Ad,xd=Ad=null,s.current=l,gI(l),cd(),Xe=O,We=S,ir.transition=v}else s.current=l;if(Sc&&(Sc=!1,Qs=s,Cc=m),v=s.pendingLanes,v===0&&(Hs=null),Nu(l.stateNode),kn(s,ct()),o!==null)for(f=s.onRecoverableError,l=0;l<o.length;l++)m=o[l],f(m.value,{componentStack:m.stack,digest:m.digest});if(Ic)throw Ic=!1,s=Tf,Tf=null,s;return Cc&1&&s.tag!==0&&sa(),v=s.pendingLanes,v&1?s===If?Tl++:(Tl=0,If=s):Tl=0,qs(),null}function sa(){if(Qs!==null){var s=Os(Cc),o=ir.transition,l=We;try{if(ir.transition=null,We=16>s?16:s,Qs===null)var f=!1;else{if(s=Qs,Qs=null,Cc=0,Xe&6)throw Error(t(331));var m=Xe;for(Xe|=4,Ie=s.current;Ie!==null;){var v=Ie,S=v.child;if(Ie.flags&16){var O=v.deletions;if(O!==null){for(var j=0;j<O.length;j++){var Y=O[j];for(Ie=Y;Ie!==null;){var ue=Ie;switch(ue.tag){case 0:case 11:case 15:_l(8,ue,v)}var de=ue.child;if(de!==null)de.return=ue,Ie=de;else for(;Ie!==null;){ue=Ie;var ae=ue.sibling,we=ue.return;if(wy(ue),ue===Y){Ie=null;break}if(ae!==null){ae.return=we,Ie=ae;break}Ie=we}}}var Se=v.alternate;if(Se!==null){var xe=Se.child;if(xe!==null){Se.child=null;do{var Pt=xe.sibling;xe.sibling=null,xe=Pt}while(xe!==null)}}Ie=v}}if(v.subtreeFlags&2064&&S!==null)S.return=v,Ie=S;else e:for(;Ie!==null;){if(v=Ie,v.flags&2048)switch(v.tag){case 0:case 11:case 15:_l(9,v,v.return)}var K=v.sibling;if(K!==null){K.return=v.return,Ie=K;break e}Ie=v.return}}var z=s.current;for(Ie=z;Ie!==null;){S=Ie;var H=S.child;if(S.subtreeFlags&2064&&H!==null)H.return=S,Ie=H;else e:for(S=z;Ie!==null;){if(O=Ie,O.flags&2048)try{switch(O.tag){case 0:case 11:case 15:wc(9,O)}}catch(Pe){Ct(O,O.return,Pe)}if(O===S){Ie=null;break e}var pe=O.sibling;if(pe!==null){pe.return=O.return,Ie=pe;break e}Ie=O.return}}if(Xe=m,qs(),Bn&&typeof Bn.onPostCommitFiberRoot=="function")try{Bn.onPostCommitFiberRoot(Ri,s)}catch{}f=!0}return f}finally{We=l,ir.transition=o}}return!1}function Oy(s,o,l){o=ea(l,o),o=ey(s,o,1),s=Gs(s,o,1),o=wn(),s!==null&&(Vs(s,1,o),kn(s,o))}function Ct(s,o,l){if(s.tag===3)Oy(s,s,l);else for(;o!==null;){if(o.tag===3){Oy(o,s,l);break}else if(o.tag===1){var f=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof f.componentDidCatch=="function"&&(Hs===null||!Hs.has(f))){s=ea(l,s),s=ty(o,s,1),o=Gs(o,s,1),s=wn(),o!==null&&(Vs(o,1,s),kn(o,s));break}}o=o.return}}function TI(s,o,l){var f=s.pingCache;f!==null&&f.delete(o),o=wn(),s.pingedLanes|=s.suspendedLanes&l,Kt===s&&(tn&l)===l&&(zt===4||zt===3&&(tn&130023424)===tn&&500>ct()-Ef?Wi(s,0):wf|=l),kn(s,o)}function Fy(s,o){o===0&&(s.mode&1?(o=xo,xo<<=1,!(xo&130023424)&&(xo=4194304)):o=1);var l=wn();s=ms(s,o),s!==null&&(Vs(s,o,l),kn(s,l))}function II(s){var o=s.memoizedState,l=0;o!==null&&(l=o.retryLane),Fy(s,l)}function SI(s,o){var l=0;switch(s.tag){case 13:var f=s.stateNode,m=s.memoizedState;m!==null&&(l=m.retryLane);break;case 19:f=s.stateNode;break;default:throw Error(t(314))}f!==null&&f.delete(o),Fy(s,l)}var Ly;Ly=function(s,o,l){if(s!==null)if(s.memoizedProps!==o.pendingProps||xn.current)Rn=!0;else{if(!(s.lanes&l)&&!(o.flags&128))return Rn=!1,hI(s,o,l);Rn=!!(s.flags&131072)}else Rn=!1,_t&&o.flags&1048576&&yg(o,rc,o.index);switch(o.lanes=0,o.tag){case 2:var f=o.type;vc(s,o),s=o.pendingProps;var m=Go(o,rn.current);Zo(o,l),m=Yd(null,o,f,s,m,l);var v=Zd();return o.flags|=1,typeof m=="object"&&m!==null&&typeof m.render=="function"&&m.$$typeof===void 0?(o.tag=1,o.memoizedState=null,o.updateQueue=null,Nn(f)?(v=!0,ec(o)):v=!1,o.memoizedState=m.state!==null&&m.state!==void 0?m.state:null,qd(o),m.updater=gc,o.stateNode=m,m._reactInternals=o,sf(o,f,s,l),o=uf(null,o,f,!0,v,l)):(o.tag=0,_t&&v&&Vd(o),_n(null,o,m,l),o=o.child),o;case 16:f=o.elementType;e:{switch(vc(s,o),s=o.pendingProps,m=f._init,f=m(f._payload),o.type=f,m=o.tag=AI(f),s=Ar(f,s),m){case 0:o=lf(null,o,f,s,l);break e;case 1:o=cy(null,o,f,s,l);break e;case 11:o=iy(null,o,f,s,l);break e;case 14:o=oy(null,o,f,Ar(f.type,s),l);break e}throw Error(t(306,f,""))}return o;case 0:return f=o.type,m=o.pendingProps,m=o.elementType===f?m:Ar(f,m),lf(s,o,f,m,l);case 1:return f=o.type,m=o.pendingProps,m=o.elementType===f?m:Ar(f,m),cy(s,o,f,m,l);case 3:e:{if(hy(o),s===null)throw Error(t(387));f=o.pendingProps,v=o.memoizedState,m=v.element,Ag(s,o),uc(o,f,null,l);var S=o.memoizedState;if(f=S.element,v.isDehydrated)if(v={element:f,isDehydrated:!1,cache:S.cache,pendingSuspenseBoundaries:S.pendingSuspenseBoundaries,transitions:S.transitions},o.updateQueue.baseState=v,o.memoizedState=v,o.flags&256){m=ea(Error(t(423)),o),o=dy(s,o,f,l,m);break e}else if(f!==m){m=ea(Error(t(424)),o),o=dy(s,o,f,l,m);break e}else for(Wn=zs(o.stateNode.containerInfo.firstChild),qn=o,_t=!0,Cr=null,l=Sg(o,null,f,l),o.child=l;l;)l.flags=l.flags&-3|4096,l=l.sibling;else{if(Qo(),f===m){o=ys(s,o,l);break e}_n(s,o,f,l)}o=o.child}return o;case 5:return Rg(o),s===null&&Fd(o),f=o.type,m=o.pendingProps,v=s!==null?s.memoizedProps:null,S=m.children,Nd(f,m)?S=null:v!==null&&Nd(f,v)&&(o.flags|=32),uy(s,o),_n(s,o,S,l),o.child;case 6:return s===null&&Fd(o),null;case 13:return fy(s,o,l);case 4:return Wd(o,o.stateNode.containerInfo),f=o.pendingProps,s===null?o.child=Xo(o,null,f,l):_n(s,o,f,l),o.child;case 11:return f=o.type,m=o.pendingProps,m=o.elementType===f?m:Ar(f,m),iy(s,o,f,m,l);case 7:return _n(s,o,o.pendingProps,l),o.child;case 8:return _n(s,o,o.pendingProps.children,l),o.child;case 12:return _n(s,o,o.pendingProps.children,l),o.child;case 10:e:{if(f=o.type._context,m=o.pendingProps,v=o.memoizedProps,S=m.value,ht(oc,f._currentValue),f._currentValue=S,v!==null)if(Sr(v.value,S)){if(v.children===m.children&&!xn.current){o=ys(s,o,l);break e}}else for(v=o.child,v!==null&&(v.return=o);v!==null;){var O=v.dependencies;if(O!==null){S=v.child;for(var j=O.firstContext;j!==null;){if(j.context===f){if(v.tag===1){j=gs(-1,l&-l),j.tag=2;var Y=v.updateQueue;if(Y!==null){Y=Y.shared;var ue=Y.pending;ue===null?j.next=j:(j.next=ue.next,ue.next=j),Y.pending=j}}v.lanes|=l,j=v.alternate,j!==null&&(j.lanes|=l),Ud(v.return,l,o),O.lanes|=l;break}j=j.next}}else if(v.tag===10)S=v.type===o.type?null:v.child;else if(v.tag===18){if(S=v.return,S===null)throw Error(t(341));S.lanes|=l,O=S.alternate,O!==null&&(O.lanes|=l),Ud(S,l,o),S=v.sibling}else S=v.child;if(S!==null)S.return=v;else for(S=v;S!==null;){if(S===o){S=null;break}if(v=S.sibling,v!==null){v.return=S.return,S=v;break}S=S.return}v=S}_n(s,o,m.children,l),o=o.child}return o;case 9:return m=o.type,f=o.pendingProps.children,Zo(o,l),m=rr(m),f=f(m),o.flags|=1,_n(s,o,f,l),o.child;case 14:return f=o.type,m=Ar(f,o.pendingProps),m=Ar(f.type,m),oy(s,o,f,m,l);case 15:return ay(s,o,o.type,o.pendingProps,l);case 17:return f=o.type,m=o.pendingProps,m=o.elementType===f?m:Ar(f,m),vc(s,o),o.tag=1,Nn(f)?(s=!0,ec(o)):s=!1,Zo(o,l),Zg(o,f,m),sf(o,f,m,l),uf(null,o,f,!0,s,l);case 19:return my(s,o,l);case 22:return ly(s,o,l)}throw Error(t(156,o.tag))};function jy(s,o){return Co(s,o)}function CI(s,o,l,f){this.tag=s,this.key=l,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=f,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function or(s,o,l,f){return new CI(s,o,l,f)}function Rf(s){return s=s.prototype,!(!s||!s.isReactComponent)}function AI(s){if(typeof s=="function")return Rf(s)?1:0;if(s!=null){if(s=s.$$typeof,s===M)return 11;if(s===ce)return 14}return 2}function Zs(s,o){var l=s.alternate;return l===null?(l=or(s.tag,o,s.key,s.mode),l.elementType=s.elementType,l.type=s.type,l.stateNode=s.stateNode,l.alternate=s,s.alternate=l):(l.pendingProps=o,l.type=s.type,l.flags=0,l.subtreeFlags=0,l.deletions=null),l.flags=s.flags&14680064,l.childLanes=s.childLanes,l.lanes=s.lanes,l.child=s.child,l.memoizedProps=s.memoizedProps,l.memoizedState=s.memoizedState,l.updateQueue=s.updateQueue,o=s.dependencies,l.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},l.sibling=s.sibling,l.index=s.index,l.ref=s.ref,l}function Rc(s,o,l,f,m,v){var S=2;if(f=s,typeof s=="function")Rf(s)&&(S=1);else if(typeof s=="string")S=5;else e:switch(s){case N:return Ki(l.children,m,v,o);case I:S=8,m|=8;break;case R:return s=or(12,l,o,m|2),s.elementType=R,s.lanes=v,s;case k:return s=or(13,l,o,m),s.elementType=k,s.lanes=v,s;case me:return s=or(19,l,o,m),s.elementType=me,s.lanes=v,s;case oe:return Pc(l,m,v,o);default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case b:S=10;break e;case V:S=9;break e;case M:S=11;break e;case ce:S=14;break e;case fe:S=16,f=null;break e}throw Error(t(130,s==null?s:typeof s,""))}return o=or(S,l,o,m),o.elementType=s,o.type=f,o.lanes=v,o}function Ki(s,o,l,f){return s=or(7,s,f,o),s.lanes=l,s}function Pc(s,o,l,f){return s=or(22,s,f,o),s.elementType=oe,s.lanes=l,s.stateNode={isHidden:!1},s}function Pf(s,o,l){return s=or(6,s,null,o),s.lanes=l,s}function kf(s,o,l){return o=or(4,s.children!==null?s.children:[],s.key,o),o.lanes=l,o.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},o}function xI(s,o,l,f,m){this.tag=o,this.containerInfo=s,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Ds(0),this.expirationTimes=Ds(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ds(0),this.identifierPrefix=f,this.onRecoverableError=m,this.mutableSourceEagerHydrationData=null}function bf(s,o,l,f,m,v,S,O,j){return s=new xI(s,o,l,O,j),o===1?(o=1,v===!0&&(o|=8)):o=0,v=or(3,null,null,o),s.current=v,v.stateNode=s,v.memoizedState={element:f,isDehydrated:l,cache:null,transitions:null,pendingSuspenseBoundaries:null},qd(v),s}function NI(s,o,l){var f=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:U,key:f==null?null:""+f,children:s,containerInfo:o,implementation:l}}function By(s){if(!s)return $s;s=s._reactInternals;e:{if(yr(s)!==s||s.tag!==1)throw Error(t(170));var o=s;do{switch(o.tag){case 3:o=o.stateNode.context;break e;case 1:if(Nn(o.type)){o=o.stateNode.__reactInternalMemoizedMergedChildContext;break e}}o=o.return}while(o!==null);throw Error(t(171))}if(s.tag===1){var l=s.type;if(Nn(l))return pg(s,l,o)}return o}function zy(s,o,l,f,m,v,S,O,j){return s=bf(l,f,!0,s,m,v,S,O,j),s.context=By(null),l=s.current,f=wn(),m=Xs(l),v=gs(f,m),v.callback=o??null,Gs(l,v,m),s.current.lanes=m,Vs(s,m,f),kn(s,f),s}function kc(s,o,l,f){var m=o.current,v=wn(),S=Xs(m);return l=By(l),o.context===null?o.context=l:o.pendingContext=l,o=gs(v,S),o.payload={element:s},f=f===void 0?null:f,f!==null&&(o.callback=f),s=Gs(m,o,S),s!==null&&(Rr(s,m,S,v),lc(s,m,S)),S}function bc(s){if(s=s.current,!s.child)return null;switch(s.child.tag){case 5:return s.child.stateNode;default:return s.child.stateNode}}function Uy(s,o){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var l=s.retryLane;s.retryLane=l!==0&&l<o?l:o}}function Df(s,o){Uy(s,o),(s=s.alternate)&&Uy(s,o)}function RI(){return null}var $y=typeof reportError=="function"?reportError:function(s){console.error(s)};function Vf(s){this._internalRoot=s}Dc.prototype.render=Vf.prototype.render=function(s){var o=this._internalRoot;if(o===null)throw Error(t(409));kc(s,o,null,null)},Dc.prototype.unmount=Vf.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var o=s.containerInfo;qi(function(){kc(null,s,null,null)}),o[hs]=null}};function Dc(s){this._internalRoot=s}Dc.prototype.unstable_scheduleHydration=function(s){if(s){var o=Du();s={blockedOn:null,target:s,priority:o};for(var l=0;l<Br.length&&o!==0&&o<Br[l].priority;l++);Br.splice(l,0,s),l===0&&Ou(s)}};function Mf(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function Vc(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11&&(s.nodeType!==8||s.nodeValue!==" react-mount-point-unstable "))}function qy(){}function PI(s,o,l,f,m){if(m){if(typeof f=="function"){var v=f;f=function(){var Y=bc(S);v.call(Y)}}var S=zy(o,f,s,0,null,!1,!1,"",qy);return s._reactRootContainer=S,s[hs]=S.current,ol(s.nodeType===8?s.parentNode:s),qi(),S}for(;m=s.lastChild;)s.removeChild(m);if(typeof f=="function"){var O=f;f=function(){var Y=bc(j);O.call(Y)}}var j=bf(s,0,!1,null,null,!1,!1,"",qy);return s._reactRootContainer=j,s[hs]=j.current,ol(s.nodeType===8?s.parentNode:s),qi(function(){kc(o,j,l,f)}),j}function Mc(s,o,l,f,m){var v=l._reactRootContainer;if(v){var S=v;if(typeof m=="function"){var O=m;m=function(){var j=bc(S);O.call(j)}}kc(o,S,s,m)}else S=PI(l,o,s,m,f);return bc(S)}ku=function(s){switch(s.tag){case 3:var o=s.stateNode;if(o.current.memoizedState.isDehydrated){var l=bs(o.pendingLanes);l!==0&&(Ms(o,l|1),kn(o,ct()),!(Xe&6)&&(ra=ct()+500,qs()))}break;case 13:qi(function(){var f=ms(s,1);if(f!==null){var m=wn();Rr(f,s,1,m)}}),Df(s,1)}},No=function(s){if(s.tag===13){var o=ms(s,134217728);if(o!==null){var l=wn();Rr(o,s,134217728,l)}Df(s,134217728)}},bu=function(s){if(s.tag===13){var o=Xs(s),l=ms(s,o);if(l!==null){var f=wn();Rr(l,s,o,f)}Df(s,o)}},Du=function(){return We},Vu=function(s,o){var l=We;try{return We=s,o()}finally{We=l}},je=function(s,o,l){switch(o){case"input":if(dr(s,l),o=l.name,l.type==="radio"&&o!=null){for(l=s;l.parentNode;)l=l.parentNode;for(l=l.querySelectorAll("input[name="+JSON.stringify(""+o)+'][type="radio"]'),o=0;o<l.length;o++){var f=l[o];if(f!==s&&f.form===s.form){var m=Zu(f);if(!m)throw Error(t(90));it(f),dr(f,m)}}}break;case"textarea":In(s,l);break;case"select":o=l.value,o!=null&&ut(s,!!l.multiple,o,!1)}},Fr=Af,Ci=qi;var kI={usingClientEntryPoint:!1,Events:[ul,qo,Zu,Rt,pr,Af]},Il={findFiberByHostInstance:Oi,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},bI={bundleType:Il.bundleType,version:Il.version,rendererPackageName:Il.rendererPackageName,rendererConfig:Il.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:X.ReactCurrentDispatcher,findHostInstanceByFiber:function(s){return s=qa(s),s===null?null:s.stateNode},findFiberByHostInstance:Il.findFiberByHostInstance||RI,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Oc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Oc.isDisabled&&Oc.supportsFiber)try{Ri=Oc.inject(bI),Bn=Oc}catch{}}return bn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=kI,bn.createPortal=function(s,o){var l=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Mf(o))throw Error(t(200));return NI(s,o,null,l)},bn.createRoot=function(s,o){if(!Mf(s))throw Error(t(299));var l=!1,f="",m=$y;return o!=null&&(o.unstable_strictMode===!0&&(l=!0),o.identifierPrefix!==void 0&&(f=o.identifierPrefix),o.onRecoverableError!==void 0&&(m=o.onRecoverableError)),o=bf(s,1,!1,null,null,l,!1,f,m),s[hs]=o.current,ol(s.nodeType===8?s.parentNode:s),new Vf(o)},bn.findDOMNode=function(s){if(s==null)return null;if(s.nodeType===1)return s;var o=s._reactInternals;if(o===void 0)throw typeof s.render=="function"?Error(t(188)):(s=Object.keys(s).join(","),Error(t(268,s)));return s=qa(o),s=s===null?null:s.stateNode,s},bn.flushSync=function(s){return qi(s)},bn.hydrate=function(s,o,l){if(!Vc(o))throw Error(t(200));return Mc(null,s,o,!0,l)},bn.hydrateRoot=function(s,o,l){if(!Mf(s))throw Error(t(405));var f=l!=null&&l.hydratedSources||null,m=!1,v="",S=$y;if(l!=null&&(l.unstable_strictMode===!0&&(m=!0),l.identifierPrefix!==void 0&&(v=l.identifierPrefix),l.onRecoverableError!==void 0&&(S=l.onRecoverableError)),o=zy(o,null,s,1,l??null,m,!1,v,S),s[hs]=o.current,ol(s),f)for(s=0;s<f.length;s++)l=f[s],m=l._getVersion,m=m(l._source),o.mutableSourceEagerHydrationData==null?o.mutableSourceEagerHydrationData=[l,m]:o.mutableSourceEagerHydrationData.push(l,m);return new Dc(o)},bn.render=function(s,o,l){if(!Vc(o))throw Error(t(200));return Mc(null,s,o,!1,l)},bn.unmountComponentAtNode=function(s){if(!Vc(s))throw Error(t(40));return s._reactRootContainer?(qi(function(){Mc(null,null,s,!1,function(){s._reactRootContainer=null,s[hs]=null})}),!0):!1},bn.unstable_batchedUpdates=Af,bn.unstable_renderSubtreeIntoContainer=function(s,o,l,f){if(!Vc(l))throw Error(t(200));if(s==null||s._reactInternals===void 0)throw Error(t(38));return Mc(s,o,l,!1,f)},bn.version="18.3.1-next-f1338f8080-20240426",bn}var Jy;function zI(){if(Jy)return Lf.exports;Jy=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(e){console.error(e)}}return r(),Lf.exports=BI(),Lf.exports}var ev;function UI(){if(ev)return Fc;ev=1;var r=zI();return Fc.createRoot=r.createRoot,Fc.hydrateRoot=r.hydrateRoot,Fc}var $I=UI();/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qI=r=>r.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),lw=(...r)=>r.filter((e,t,n)=>!!e&&e.trim()!==""&&n.indexOf(e)===t).join(" ").trim();/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var WI={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GI=he.forwardRef(({color:r="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:n,className:i="",children:a,iconNode:u,...c},d)=>he.createElement("svg",{ref:d,...WI,width:e,height:e,stroke:r,strokeWidth:n?Number(t)*24/Number(e):t,className:lw("lucide",i),...c},[...u.map(([p,g])=>he.createElement(p,g)),...Array.isArray(a)?a:[a]]));/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tt=(r,e)=>{const t=he.forwardRef(({className:n,...i},a)=>he.createElement(GI,{ref:a,iconNode:e,className:lw(`lucide-${qI(r)}`,n),...i}));return t.displayName=`${r}`,t};/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KI=[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]],HI=tt("Award",KI);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QI=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],XI=tt("ChevronDown",QI);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YI=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],Qi=tt("ChevronLeft",YI);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZI=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],si=tt("ChevronRight",ZI);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JI=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],eS=tt("ChevronUp",JI);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tS=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]],nS=tt("CirclePlus",tS);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rS=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"9",x2:"15",y1:"15",y2:"9",key:"1dfufj"}]],sS=tt("CircleSlash",rS);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iS=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]],uw=tt("Clock",iS);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oS=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]],cw=tt("Download",oS);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aS=[["path",{d:"m15 15 6 6",key:"1s409w"}],["path",{d:"m15 9 6-6",key:"ko1vev"}],["path",{d:"M21 16.2V21h-4.8",key:"1hrera"}],["path",{d:"M21 7.8V3h-4.8",key:"ul1q53"}],["path",{d:"M3 16.2V21h4.8",key:"1x04uo"}],["path",{d:"m3 21 6-6",key:"wwnumi"}],["path",{d:"M3 7.8V3h4.8",key:"1ijppm"}],["path",{d:"M9 9 3 3",key:"v551iv"}]],lS=tt("Expand",aS);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uS=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],cS=tt("FileText",uS);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hS=[["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}],["line",{x1:"3",x2:"9",y1:"12",y2:"12",key:"1dyftd"}],["line",{x1:"15",x2:"21",y1:"12",y2:"12",key:"oup4p8"}]],dS=tt("GitCommitHorizontal",hS);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fS=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],pS=tt("Globe",fS);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mS=[["path",{d:"M16 5h6",key:"1vod17"}],["path",{d:"M19 2v6",key:"4bpg5p"}],["path",{d:"M21 11.5V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h7.5",key:"1ue2ih"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}]],gS=tt("ImagePlus",mS);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yS=[["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m16.2 7.8 2.9-2.9",key:"r700ao"}],["path",{d:"M18 12h4",key:"wj9ykh"}],["path",{d:"m16.2 16.2 2.9 2.9",key:"1bxg5t"}],["path",{d:"M12 18v4",key:"jadmvz"}],["path",{d:"m4.9 19.1 2.9-2.9",key:"bwix9q"}],["path",{d:"M2 12h4",key:"j09sii"}],["path",{d:"m4.9 4.9 2.9 2.9",key:"giyufr"}]],vS=tt("Loader",yS);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _S=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],wS=tt("Lock",_S);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ES=[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]],TS=tt("MessageSquare",ES);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IS=[["path",{d:"M8 3v3a2 2 0 0 1-2 2H3",key:"hohbtr"}],["path",{d:"M21 8h-3a2 2 0 0 1-2-2V3",key:"5jw1f3"}],["path",{d:"M3 16h3a2 2 0 0 1 2 2v3",key:"198tvr"}],["path",{d:"M16 21v-3a2 2 0 0 1 2-2h3",key:"ph8mxp"}]],SS=tt("Minimize",IS);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CS=[["path",{d:"M5 12h14",key:"1ays0h"}]],AS=tt("Minus",CS);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xS=[["path",{d:"M9 18V5l12-2v13",key:"1jmyc2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["circle",{cx:"18",cy:"16",r:"3",key:"1hluhg"}]],Up=tt("Music",xS);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NS=[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]],hw=tt("Pause",NS);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RS=[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]],dw=tt("Play",RS);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PS=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],kS=tt("Plus",PS);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bS=[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]],DS=tt("RotateCw",bS);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VS=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],fw=tt("Save",VS);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MS=[["path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8",key:"1b2hhj"}],["polyline",{points:"16 6 12 2 8 6",key:"m901s6"}],["line",{x1:"12",x2:"12",y1:"2",y2:"15",key:"1p0rca"}]],OS=tt("Share",MS);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FS=[["path",{d:"M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z",key:"hou9p0"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}]],LS=tt("ShoppingBag",FS);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jS=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],BS=tt("SquarePen",jS);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zS=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],US=tt("Trash2",zS);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $S=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],ao=tt("X",$S),qS=()=>{};var tv={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pw=function(r){const e=[];let t=0;for(let n=0;n<r.length;n++){let i=r.charCodeAt(n);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&n+1<r.length&&(r.charCodeAt(n+1)&64512)===56320?(i=65536+((i&1023)<<10)+(r.charCodeAt(++n)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},WS=function(r){const e=[];let t=0,n=0;for(;t<r.length;){const i=r[t++];if(i<128)e[n++]=String.fromCharCode(i);else if(i>191&&i<224){const a=r[t++];e[n++]=String.fromCharCode((i&31)<<6|a&63)}else if(i>239&&i<365){const a=r[t++],u=r[t++],c=r[t++],d=((i&7)<<18|(a&63)<<12|(u&63)<<6|c&63)-65536;e[n++]=String.fromCharCode(55296+(d>>10)),e[n++]=String.fromCharCode(56320+(d&1023))}else{const a=r[t++],u=r[t++];e[n++]=String.fromCharCode((i&15)<<12|(a&63)<<6|u&63)}}return e.join("")},mw={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(r,e){if(!Array.isArray(r))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let i=0;i<r.length;i+=3){const a=r[i],u=i+1<r.length,c=u?r[i+1]:0,d=i+2<r.length,p=d?r[i+2]:0,g=a>>2,_=(a&3)<<4|c>>4;let E=(c&15)<<2|p>>6,C=p&63;d||(C=64,u||(E=64)),n.push(t[g],t[_],t[E],t[C])}return n.join("")},encodeString(r,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(r):this.encodeByteArray(pw(r),e)},decodeString(r,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(r):WS(this.decodeStringToByteArray(r,e))},decodeStringToByteArray(r,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let i=0;i<r.length;){const a=t[r.charAt(i++)],c=i<r.length?t[r.charAt(i)]:0;++i;const p=i<r.length?t[r.charAt(i)]:64;++i;const _=i<r.length?t[r.charAt(i)]:64;if(++i,a==null||c==null||p==null||_==null)throw new GS;const E=a<<2|c>>4;if(n.push(E),p!==64){const C=c<<4&240|p>>2;if(n.push(C),_!==64){const A=p<<6&192|_;n.push(A)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let r=0;r<this.ENCODED_VALS.length;r++)this.byteToCharMap_[r]=this.ENCODED_VALS.charAt(r),this.charToByteMap_[this.byteToCharMap_[r]]=r,this.byteToCharMapWebSafe_[r]=this.ENCODED_VALS_WEBSAFE.charAt(r),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[r]]=r,r>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(r)]=r,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(r)]=r)}}};class GS extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const KS=function(r){const e=pw(r);return mw.encodeByteArray(e,!0)},rh=function(r){return KS(r).replace(/\./g,"")},HS=function(r){try{return mw.decodeString(r,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QS(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XS=()=>QS().__FIREBASE_DEFAULTS__,YS=()=>{if(typeof process>"u"||typeof tv>"u")return;const r=tv.__FIREBASE_DEFAULTS__;if(r)return JSON.parse(r)},ZS=()=>{if(typeof document>"u")return;let r;try{r=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=r&&HS(r[1]);return e&&JSON.parse(e)},$p=()=>{try{return qS()||XS()||YS()||ZS()}catch(r){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${r}`);return}},JS=r=>{var e,t;return(t=(e=$p())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[r]},e1=r=>{const e=JS(r);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),n]:[e.substring(0,t),n]},gw=()=>{var r;return(r=$p())===null||r===void 0?void 0:r.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t1{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,n))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function n1(r,e){if(r.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},n=e||"demo-project",i=r.iat||0,a=r.sub||r.user_id;if(!a)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const u=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:a,user_id:a,firebase:{sign_in_provider:"custom",identities:{}}},r);return[rh(JSON.stringify(t)),rh(JSON.stringify(u)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sh(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function r1(){var r;const e=(r=$p())===null||r===void 0?void 0:r.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function yw(){return!r1()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function vw(){try{return typeof indexedDB=="object"}catch{return!1}}function s1(){return new Promise((r,e)=>{try{let t=!0;const n="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(n);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(n),r(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{var a;e(((a=i.error)===null||a===void 0?void 0:a.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i1="FirebaseError";class yo extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name=i1,Object.setPrototypeOf(this,yo.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,_w.prototype.create)}}class _w{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){const n=t[0]||{},i=`${this.service}/${e}`,a=this.errors[e],u=a?o1(a,n):"Error",c=`${this.serviceName}: ${u} (${i}).`;return new yo(i,c,n)}}function o1(r,e){return r.replace(a1,(t,n)=>{const i=e[n];return i!=null?String(i):`<${n}?>`})}const a1=/\{\$([^}]+)}/g;function ih(r,e){if(r===e)return!0;const t=Object.keys(r),n=Object.keys(e);for(const i of t){if(!n.includes(i))return!1;const a=r[i],u=e[i];if(nv(a)&&nv(u)){if(!ih(a,u))return!1}else if(a!==u)return!1}for(const i of n)if(!t.includes(i))return!1;return!0}function nv(r){return r!==null&&typeof r=="object"}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ww(r){return r&&r._delegate?r._delegate:r}class va{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xi="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l1{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const n=new t1;if(this.instancesDeferred.set(t,n),this.isInitialized(t)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:t});i&&n.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(a){if(i)return null;throw a}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(c1(e))try{this.getOrInitializeService({instanceIdentifier:Xi})}catch{}for(const[t,n]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(t);try{const a=this.getOrInitializeService({instanceIdentifier:i});n.resolve(a)}catch{}}}}clearInstance(e=Xi){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Xi){return this.instances.has(e)}getOptions(e=Xi){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[a,u]of this.instancesDeferred.entries()){const c=this.normalizeInstanceIdentifier(a);n===c&&u.resolve(i)}return i}onInit(e,t){var n;const i=this.normalizeInstanceIdentifier(t),a=(n=this.onInitCallbacks.get(i))!==null&&n!==void 0?n:new Set;a.add(e),this.onInitCallbacks.set(i,a);const u=this.instances.get(i);return u&&e(u,i),()=>{a.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const i of n)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:u1(e),options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=Xi){return this.component?this.component.multipleInstances?e:Xi:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function u1(r){return r===Xi?void 0:r}function c1(r){return r.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h1{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new l1(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Qe;(function(r){r[r.DEBUG=0]="DEBUG",r[r.VERBOSE=1]="VERBOSE",r[r.INFO=2]="INFO",r[r.WARN=3]="WARN",r[r.ERROR=4]="ERROR",r[r.SILENT=5]="SILENT"})(Qe||(Qe={}));const d1={debug:Qe.DEBUG,verbose:Qe.VERBOSE,info:Qe.INFO,warn:Qe.WARN,error:Qe.ERROR,silent:Qe.SILENT},f1=Qe.INFO,p1={[Qe.DEBUG]:"log",[Qe.VERBOSE]:"log",[Qe.INFO]:"info",[Qe.WARN]:"warn",[Qe.ERROR]:"error"},m1=(r,e,...t)=>{if(e<r.logLevel)return;const n=new Date().toISOString(),i=p1[e];if(i)console[i](`[${n}]  ${r.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Ew{constructor(e){this.name=e,this._logLevel=f1,this._logHandler=m1,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Qe))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?d1[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Qe.DEBUG,...e),this._logHandler(this,Qe.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Qe.VERBOSE,...e),this._logHandler(this,Qe.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Qe.INFO,...e),this._logHandler(this,Qe.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Qe.WARN,...e),this._logHandler(this,Qe.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Qe.ERROR,...e),this._logHandler(this,Qe.ERROR,...e)}}const g1=(r,e)=>e.some(t=>r instanceof t);let rv,sv;function y1(){return rv||(rv=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function v1(){return sv||(sv=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Tw=new WeakMap,sp=new WeakMap,Iw=new WeakMap,zf=new WeakMap,qp=new WeakMap;function _1(r){const e=new Promise((t,n)=>{const i=()=>{r.removeEventListener("success",a),r.removeEventListener("error",u)},a=()=>{t(li(r.result)),i()},u=()=>{n(r.error),i()};r.addEventListener("success",a),r.addEventListener("error",u)});return e.then(t=>{t instanceof IDBCursor&&Tw.set(t,r)}).catch(()=>{}),qp.set(e,r),e}function w1(r){if(sp.has(r))return;const e=new Promise((t,n)=>{const i=()=>{r.removeEventListener("complete",a),r.removeEventListener("error",u),r.removeEventListener("abort",u)},a=()=>{t(),i()},u=()=>{n(r.error||new DOMException("AbortError","AbortError")),i()};r.addEventListener("complete",a),r.addEventListener("error",u),r.addEventListener("abort",u)});sp.set(r,e)}let ip={get(r,e,t){if(r instanceof IDBTransaction){if(e==="done")return sp.get(r);if(e==="objectStoreNames")return r.objectStoreNames||Iw.get(r);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return li(r[e])},set(r,e,t){return r[e]=t,!0},has(r,e){return r instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in r}};function E1(r){ip=r(ip)}function T1(r){return r===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const n=r.call(Uf(this),e,...t);return Iw.set(n,e.sort?e.sort():[e]),li(n)}:v1().includes(r)?function(...e){return r.apply(Uf(this),e),li(Tw.get(this))}:function(...e){return li(r.apply(Uf(this),e))}}function I1(r){return typeof r=="function"?T1(r):(r instanceof IDBTransaction&&w1(r),g1(r,y1())?new Proxy(r,ip):r)}function li(r){if(r instanceof IDBRequest)return _1(r);if(zf.has(r))return zf.get(r);const e=I1(r);return e!==r&&(zf.set(r,e),qp.set(e,r)),e}const Uf=r=>qp.get(r);function S1(r,e,{blocked:t,upgrade:n,blocking:i,terminated:a}={}){const u=indexedDB.open(r,e),c=li(u);return n&&u.addEventListener("upgradeneeded",d=>{n(li(u.result),d.oldVersion,d.newVersion,li(u.transaction),d)}),t&&u.addEventListener("blocked",d=>t(d.oldVersion,d.newVersion,d)),c.then(d=>{a&&d.addEventListener("close",()=>a()),i&&d.addEventListener("versionchange",p=>i(p.oldVersion,p.newVersion,p))}).catch(()=>{}),c}const C1=["get","getKey","getAll","getAllKeys","count"],A1=["put","add","delete","clear"],$f=new Map;function iv(r,e){if(!(r instanceof IDBDatabase&&!(e in r)&&typeof e=="string"))return;if($f.get(e))return $f.get(e);const t=e.replace(/FromIndex$/,""),n=e!==t,i=A1.includes(t);if(!(t in(n?IDBIndex:IDBObjectStore).prototype)||!(i||C1.includes(t)))return;const a=async function(u,...c){const d=this.transaction(u,i?"readwrite":"readonly");let p=d.store;return n&&(p=p.index(c.shift())),(await Promise.all([p[t](...c),i&&d.done]))[0]};return $f.set(e,a),a}E1(r=>({...r,get:(e,t,n)=>iv(e,t)||r.get(e,t,n),has:(e,t)=>!!iv(e,t)||r.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x1{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(N1(t)){const n=t.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(t=>t).join(" ")}}function N1(r){const e=r.getComponent();return(e==null?void 0:e.type)==="VERSION"}const op="@firebase/app",ov="0.11.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ss=new Ew("@firebase/app"),R1="@firebase/app-compat",P1="@firebase/analytics-compat",k1="@firebase/analytics",b1="@firebase/app-check-compat",D1="@firebase/app-check",V1="@firebase/auth",M1="@firebase/auth-compat",O1="@firebase/database",F1="@firebase/data-connect",L1="@firebase/database-compat",j1="@firebase/functions",B1="@firebase/functions-compat",z1="@firebase/installations",U1="@firebase/installations-compat",$1="@firebase/messaging",q1="@firebase/messaging-compat",W1="@firebase/performance",G1="@firebase/performance-compat",K1="@firebase/remote-config",H1="@firebase/remote-config-compat",Q1="@firebase/storage",X1="@firebase/storage-compat",Y1="@firebase/firestore",Z1="@firebase/vertexai",J1="@firebase/firestore-compat",eC="firebase",tC="11.4.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ap="[DEFAULT]",nC={[op]:"fire-core",[R1]:"fire-core-compat",[k1]:"fire-analytics",[P1]:"fire-analytics-compat",[D1]:"fire-app-check",[b1]:"fire-app-check-compat",[V1]:"fire-auth",[M1]:"fire-auth-compat",[O1]:"fire-rtdb",[F1]:"fire-data-connect",[L1]:"fire-rtdb-compat",[j1]:"fire-fn",[B1]:"fire-fn-compat",[z1]:"fire-iid",[U1]:"fire-iid-compat",[$1]:"fire-fcm",[q1]:"fire-fcm-compat",[W1]:"fire-perf",[G1]:"fire-perf-compat",[K1]:"fire-rc",[H1]:"fire-rc-compat",[Q1]:"fire-gcs",[X1]:"fire-gcs-compat",[Y1]:"fire-fst",[J1]:"fire-fst-compat",[Z1]:"fire-vertex","fire-js":"fire-js",[eC]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oh=new Map,rC=new Map,lp=new Map;function av(r,e){try{r.container.addComponent(e)}catch(t){Ss.debug(`Component ${e.name} failed to register with FirebaseApp ${r.name}`,t)}}function zl(r){const e=r.name;if(lp.has(e))return Ss.debug(`There were multiple attempts to register component ${e}.`),!1;lp.set(e,r);for(const t of oh.values())av(t,r);for(const t of rC.values())av(t,r);return!0}function Sw(r,e){const t=r.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),r.container.getProvider(e)}function Cw(r){return r==null?!1:r.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sC={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},ui=new _w("app","Firebase",sC);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iC{constructor(e,t,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new va("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ui.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Aw=tC;function xw(r,e={}){let t=r;typeof e!="object"&&(e={name:e});const n=Object.assign({name:ap,automaticDataCollectionEnabled:!1},e),i=n.name;if(typeof i!="string"||!i)throw ui.create("bad-app-name",{appName:String(i)});if(t||(t=gw()),!t)throw ui.create("no-options");const a=oh.get(i);if(a){if(ih(t,a.options)&&ih(n,a.config))return a;throw ui.create("duplicate-app",{appName:i})}const u=new h1(i);for(const d of lp.values())u.addComponent(d);const c=new iC(t,n,u);return oh.set(i,c),c}function oC(r=ap){const e=oh.get(r);if(!e&&r===ap&&gw())return xw();if(!e)throw ui.create("no-app",{appName:r});return e}function ci(r,e,t){var n;let i=(n=nC[r])!==null&&n!==void 0?n:r;t&&(i+=`-${t}`);const a=i.match(/\s|\//),u=e.match(/\s|\//);if(a||u){const c=[`Unable to register library "${i}" with version "${e}":`];a&&c.push(`library name "${i}" contains illegal characters (whitespace or "/")`),a&&u&&c.push("and"),u&&c.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Ss.warn(c.join(" "));return}zl(new va(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aC="firebase-heartbeat-database",lC=1,Ul="firebase-heartbeat-store";let qf=null;function Nw(){return qf||(qf=S1(aC,lC,{upgrade:(r,e)=>{switch(e){case 0:try{r.createObjectStore(Ul)}catch(t){console.warn(t)}}}}).catch(r=>{throw ui.create("idb-open",{originalErrorMessage:r.message})})),qf}async function uC(r){try{const t=(await Nw()).transaction(Ul),n=await t.objectStore(Ul).get(Rw(r));return await t.done,n}catch(e){if(e instanceof yo)Ss.warn(e.message);else{const t=ui.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Ss.warn(t.message)}}}async function lv(r,e){try{const n=(await Nw()).transaction(Ul,"readwrite");await n.objectStore(Ul).put(e,Rw(r)),await n.done}catch(t){if(t instanceof yo)Ss.warn(t.message);else{const n=ui.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});Ss.warn(n.message)}}}function Rw(r){return`${r.name}!${r.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cC=1024,hC=30;class dC{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new pC(t),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,t;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),a=uv();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===a||this._heartbeatsCache.heartbeats.some(u=>u.date===a))return;if(this._heartbeatsCache.heartbeats.push({date:a,agent:i}),this._heartbeatsCache.heartbeats.length>hC){const u=mC(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(u,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(n){Ss.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=uv(),{heartbeatsToSend:n,unsentEntries:i}=fC(this._heartbeatsCache.heartbeats),a=rh(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),a}catch(t){return Ss.warn(t),""}}}function uv(){return new Date().toISOString().substring(0,10)}function fC(r,e=cC){const t=[];let n=r.slice();for(const i of r){const a=t.find(u=>u.agent===i.agent);if(a){if(a.dates.push(i.date),cv(t)>e){a.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),cv(t)>e){t.pop();break}n=n.slice(1)}return{heartbeatsToSend:t,unsentEntries:n}}class pC{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return vw()?s1().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await uC(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const i=await this.read();return lv(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const i=await this.read();return lv(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function cv(r){return rh(JSON.stringify({version:2,heartbeats:r})).length}function mC(r){if(r.length===0)return-1;let e=0,t=r[0].date;for(let n=1;n<r.length;n++)r[n].date<t&&(t=r[n].date,e=n);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gC(r){zl(new va("platform-logger",e=>new x1(e),"PRIVATE")),zl(new va("heartbeat",e=>new dC(e),"PRIVATE")),ci(op,ov,r),ci(op,ov,"esm2017"),ci("fire-js","")}gC("");var yC="firebase",vC="11.4.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ci(yC,vC,"app");var hv=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var hi,Pw;(function(){var r;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(N,I){function R(){}R.prototype=I.prototype,N.D=I.prototype,N.prototype=new R,N.prototype.constructor=N,N.C=function(b,V,M){for(var k=Array(arguments.length-2),me=2;me<arguments.length;me++)k[me-2]=arguments[me];return I.prototype[V].apply(b,k)}}function t(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,t),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(N,I,R){R||(R=0);var b=Array(16);if(typeof I=="string")for(var V=0;16>V;++V)b[V]=I.charCodeAt(R++)|I.charCodeAt(R++)<<8|I.charCodeAt(R++)<<16|I.charCodeAt(R++)<<24;else for(V=0;16>V;++V)b[V]=I[R++]|I[R++]<<8|I[R++]<<16|I[R++]<<24;I=N.g[0],R=N.g[1],V=N.g[2];var M=N.g[3],k=I+(M^R&(V^M))+b[0]+3614090360&4294967295;I=R+(k<<7&4294967295|k>>>25),k=M+(V^I&(R^V))+b[1]+3905402710&4294967295,M=I+(k<<12&4294967295|k>>>20),k=V+(R^M&(I^R))+b[2]+606105819&4294967295,V=M+(k<<17&4294967295|k>>>15),k=R+(I^V&(M^I))+b[3]+3250441966&4294967295,R=V+(k<<22&4294967295|k>>>10),k=I+(M^R&(V^M))+b[4]+4118548399&4294967295,I=R+(k<<7&4294967295|k>>>25),k=M+(V^I&(R^V))+b[5]+1200080426&4294967295,M=I+(k<<12&4294967295|k>>>20),k=V+(R^M&(I^R))+b[6]+2821735955&4294967295,V=M+(k<<17&4294967295|k>>>15),k=R+(I^V&(M^I))+b[7]+4249261313&4294967295,R=V+(k<<22&4294967295|k>>>10),k=I+(M^R&(V^M))+b[8]+1770035416&4294967295,I=R+(k<<7&4294967295|k>>>25),k=M+(V^I&(R^V))+b[9]+2336552879&4294967295,M=I+(k<<12&4294967295|k>>>20),k=V+(R^M&(I^R))+b[10]+4294925233&4294967295,V=M+(k<<17&4294967295|k>>>15),k=R+(I^V&(M^I))+b[11]+2304563134&4294967295,R=V+(k<<22&4294967295|k>>>10),k=I+(M^R&(V^M))+b[12]+1804603682&4294967295,I=R+(k<<7&4294967295|k>>>25),k=M+(V^I&(R^V))+b[13]+4254626195&4294967295,M=I+(k<<12&4294967295|k>>>20),k=V+(R^M&(I^R))+b[14]+2792965006&4294967295,V=M+(k<<17&4294967295|k>>>15),k=R+(I^V&(M^I))+b[15]+1236535329&4294967295,R=V+(k<<22&4294967295|k>>>10),k=I+(V^M&(R^V))+b[1]+4129170786&4294967295,I=R+(k<<5&4294967295|k>>>27),k=M+(R^V&(I^R))+b[6]+3225465664&4294967295,M=I+(k<<9&4294967295|k>>>23),k=V+(I^R&(M^I))+b[11]+643717713&4294967295,V=M+(k<<14&4294967295|k>>>18),k=R+(M^I&(V^M))+b[0]+3921069994&4294967295,R=V+(k<<20&4294967295|k>>>12),k=I+(V^M&(R^V))+b[5]+3593408605&4294967295,I=R+(k<<5&4294967295|k>>>27),k=M+(R^V&(I^R))+b[10]+38016083&4294967295,M=I+(k<<9&4294967295|k>>>23),k=V+(I^R&(M^I))+b[15]+3634488961&4294967295,V=M+(k<<14&4294967295|k>>>18),k=R+(M^I&(V^M))+b[4]+3889429448&4294967295,R=V+(k<<20&4294967295|k>>>12),k=I+(V^M&(R^V))+b[9]+568446438&4294967295,I=R+(k<<5&4294967295|k>>>27),k=M+(R^V&(I^R))+b[14]+3275163606&4294967295,M=I+(k<<9&4294967295|k>>>23),k=V+(I^R&(M^I))+b[3]+4107603335&4294967295,V=M+(k<<14&4294967295|k>>>18),k=R+(M^I&(V^M))+b[8]+1163531501&4294967295,R=V+(k<<20&4294967295|k>>>12),k=I+(V^M&(R^V))+b[13]+2850285829&4294967295,I=R+(k<<5&4294967295|k>>>27),k=M+(R^V&(I^R))+b[2]+4243563512&4294967295,M=I+(k<<9&4294967295|k>>>23),k=V+(I^R&(M^I))+b[7]+1735328473&4294967295,V=M+(k<<14&4294967295|k>>>18),k=R+(M^I&(V^M))+b[12]+2368359562&4294967295,R=V+(k<<20&4294967295|k>>>12),k=I+(R^V^M)+b[5]+4294588738&4294967295,I=R+(k<<4&4294967295|k>>>28),k=M+(I^R^V)+b[8]+2272392833&4294967295,M=I+(k<<11&4294967295|k>>>21),k=V+(M^I^R)+b[11]+1839030562&4294967295,V=M+(k<<16&4294967295|k>>>16),k=R+(V^M^I)+b[14]+4259657740&4294967295,R=V+(k<<23&4294967295|k>>>9),k=I+(R^V^M)+b[1]+2763975236&4294967295,I=R+(k<<4&4294967295|k>>>28),k=M+(I^R^V)+b[4]+1272893353&4294967295,M=I+(k<<11&4294967295|k>>>21),k=V+(M^I^R)+b[7]+4139469664&4294967295,V=M+(k<<16&4294967295|k>>>16),k=R+(V^M^I)+b[10]+3200236656&4294967295,R=V+(k<<23&4294967295|k>>>9),k=I+(R^V^M)+b[13]+681279174&4294967295,I=R+(k<<4&4294967295|k>>>28),k=M+(I^R^V)+b[0]+3936430074&4294967295,M=I+(k<<11&4294967295|k>>>21),k=V+(M^I^R)+b[3]+3572445317&4294967295,V=M+(k<<16&4294967295|k>>>16),k=R+(V^M^I)+b[6]+76029189&4294967295,R=V+(k<<23&4294967295|k>>>9),k=I+(R^V^M)+b[9]+3654602809&4294967295,I=R+(k<<4&4294967295|k>>>28),k=M+(I^R^V)+b[12]+3873151461&4294967295,M=I+(k<<11&4294967295|k>>>21),k=V+(M^I^R)+b[15]+530742520&4294967295,V=M+(k<<16&4294967295|k>>>16),k=R+(V^M^I)+b[2]+3299628645&4294967295,R=V+(k<<23&4294967295|k>>>9),k=I+(V^(R|~M))+b[0]+4096336452&4294967295,I=R+(k<<6&4294967295|k>>>26),k=M+(R^(I|~V))+b[7]+1126891415&4294967295,M=I+(k<<10&4294967295|k>>>22),k=V+(I^(M|~R))+b[14]+2878612391&4294967295,V=M+(k<<15&4294967295|k>>>17),k=R+(M^(V|~I))+b[5]+4237533241&4294967295,R=V+(k<<21&4294967295|k>>>11),k=I+(V^(R|~M))+b[12]+1700485571&4294967295,I=R+(k<<6&4294967295|k>>>26),k=M+(R^(I|~V))+b[3]+2399980690&4294967295,M=I+(k<<10&4294967295|k>>>22),k=V+(I^(M|~R))+b[10]+4293915773&4294967295,V=M+(k<<15&4294967295|k>>>17),k=R+(M^(V|~I))+b[1]+2240044497&4294967295,R=V+(k<<21&4294967295|k>>>11),k=I+(V^(R|~M))+b[8]+1873313359&4294967295,I=R+(k<<6&4294967295|k>>>26),k=M+(R^(I|~V))+b[15]+4264355552&4294967295,M=I+(k<<10&4294967295|k>>>22),k=V+(I^(M|~R))+b[6]+2734768916&4294967295,V=M+(k<<15&4294967295|k>>>17),k=R+(M^(V|~I))+b[13]+1309151649&4294967295,R=V+(k<<21&4294967295|k>>>11),k=I+(V^(R|~M))+b[4]+4149444226&4294967295,I=R+(k<<6&4294967295|k>>>26),k=M+(R^(I|~V))+b[11]+3174756917&4294967295,M=I+(k<<10&4294967295|k>>>22),k=V+(I^(M|~R))+b[2]+718787259&4294967295,V=M+(k<<15&4294967295|k>>>17),k=R+(M^(V|~I))+b[9]+3951481745&4294967295,N.g[0]=N.g[0]+I&4294967295,N.g[1]=N.g[1]+(V+(k<<21&4294967295|k>>>11))&4294967295,N.g[2]=N.g[2]+V&4294967295,N.g[3]=N.g[3]+M&4294967295}n.prototype.u=function(N,I){I===void 0&&(I=N.length);for(var R=I-this.blockSize,b=this.B,V=this.h,M=0;M<I;){if(V==0)for(;M<=R;)i(this,N,M),M+=this.blockSize;if(typeof N=="string"){for(;M<I;)if(b[V++]=N.charCodeAt(M++),V==this.blockSize){i(this,b),V=0;break}}else for(;M<I;)if(b[V++]=N[M++],V==this.blockSize){i(this,b),V=0;break}}this.h=V,this.o+=I},n.prototype.v=function(){var N=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);N[0]=128;for(var I=1;I<N.length-8;++I)N[I]=0;var R=8*this.o;for(I=N.length-8;I<N.length;++I)N[I]=R&255,R/=256;for(this.u(N),N=Array(16),I=R=0;4>I;++I)for(var b=0;32>b;b+=8)N[R++]=this.g[I]>>>b&255;return N};function a(N,I){var R=c;return Object.prototype.hasOwnProperty.call(R,N)?R[N]:R[N]=I(N)}function u(N,I){this.h=I;for(var R=[],b=!0,V=N.length-1;0<=V;V--){var M=N[V]|0;b&&M==I||(R[V]=M,b=!1)}this.g=R}var c={};function d(N){return-128<=N&&128>N?a(N,function(I){return new u([I|0],0>I?-1:0)}):new u([N|0],0>N?-1:0)}function p(N){if(isNaN(N)||!isFinite(N))return _;if(0>N)return D(p(-N));for(var I=[],R=1,b=0;N>=R;b++)I[b]=N/R|0,R*=4294967296;return new u(I,0)}function g(N,I){if(N.length==0)throw Error("number format error: empty string");if(I=I||10,2>I||36<I)throw Error("radix out of range: "+I);if(N.charAt(0)=="-")return D(g(N.substring(1),I));if(0<=N.indexOf("-"))throw Error('number format error: interior "-" character');for(var R=p(Math.pow(I,8)),b=_,V=0;V<N.length;V+=8){var M=Math.min(8,N.length-V),k=parseInt(N.substring(V,V+M),I);8>M?(M=p(Math.pow(I,M)),b=b.j(M).add(p(k))):(b=b.j(R),b=b.add(p(k)))}return b}var _=d(0),E=d(1),C=d(16777216);r=u.prototype,r.m=function(){if(P(this))return-D(this).m();for(var N=0,I=1,R=0;R<this.g.length;R++){var b=this.i(R);N+=(0<=b?b:4294967296+b)*I,I*=4294967296}return N},r.toString=function(N){if(N=N||10,2>N||36<N)throw Error("radix out of range: "+N);if(A(this))return"0";if(P(this))return"-"+D(this).toString(N);for(var I=p(Math.pow(N,6)),R=this,b="";;){var V=X(R,I).g;R=B(R,V.j(I));var M=((0<R.g.length?R.g[0]:R.h)>>>0).toString(N);if(R=V,A(R))return M+b;for(;6>M.length;)M="0"+M;b=M+b}},r.i=function(N){return 0>N?0:N<this.g.length?this.g[N]:this.h};function A(N){if(N.h!=0)return!1;for(var I=0;I<N.g.length;I++)if(N.g[I]!=0)return!1;return!0}function P(N){return N.h==-1}r.l=function(N){return N=B(this,N),P(N)?-1:A(N)?0:1};function D(N){for(var I=N.g.length,R=[],b=0;b<I;b++)R[b]=~N.g[b];return new u(R,~N.h).add(E)}r.abs=function(){return P(this)?D(this):this},r.add=function(N){for(var I=Math.max(this.g.length,N.g.length),R=[],b=0,V=0;V<=I;V++){var M=b+(this.i(V)&65535)+(N.i(V)&65535),k=(M>>>16)+(this.i(V)>>>16)+(N.i(V)>>>16);b=k>>>16,M&=65535,k&=65535,R[V]=k<<16|M}return new u(R,R[R.length-1]&-2147483648?-1:0)};function B(N,I){return N.add(D(I))}r.j=function(N){if(A(this)||A(N))return _;if(P(this))return P(N)?D(this).j(D(N)):D(D(this).j(N));if(P(N))return D(this.j(D(N)));if(0>this.l(C)&&0>N.l(C))return p(this.m()*N.m());for(var I=this.g.length+N.g.length,R=[],b=0;b<2*I;b++)R[b]=0;for(b=0;b<this.g.length;b++)for(var V=0;V<N.g.length;V++){var M=this.i(b)>>>16,k=this.i(b)&65535,me=N.i(V)>>>16,ce=N.i(V)&65535;R[2*b+2*V]+=k*ce,W(R,2*b+2*V),R[2*b+2*V+1]+=M*ce,W(R,2*b+2*V+1),R[2*b+2*V+1]+=k*me,W(R,2*b+2*V+1),R[2*b+2*V+2]+=M*me,W(R,2*b+2*V+2)}for(b=0;b<I;b++)R[b]=R[2*b+1]<<16|R[2*b];for(b=I;b<2*I;b++)R[b]=0;return new u(R,0)};function W(N,I){for(;(N[I]&65535)!=N[I];)N[I+1]+=N[I]>>>16,N[I]&=65535,I++}function $(N,I){this.g=N,this.h=I}function X(N,I){if(A(I))throw Error("division by zero");if(A(N))return new $(_,_);if(P(N))return I=X(D(N),I),new $(D(I.g),D(I.h));if(P(I))return I=X(N,D(I)),new $(D(I.g),I.h);if(30<N.g.length){if(P(N)||P(I))throw Error("slowDivide_ only works with positive integers.");for(var R=E,b=I;0>=b.l(N);)R=F(R),b=F(b);var V=U(R,1),M=U(b,1);for(b=U(b,2),R=U(R,2);!A(b);){var k=M.add(b);0>=k.l(N)&&(V=V.add(R),M=k),b=U(b,1),R=U(R,1)}return I=B(N,V.j(I)),new $(V,I)}for(V=_;0<=N.l(I);){for(R=Math.max(1,Math.floor(N.m()/I.m())),b=Math.ceil(Math.log(R)/Math.LN2),b=48>=b?1:Math.pow(2,b-48),M=p(R),k=M.j(I);P(k)||0<k.l(N);)R-=b,M=p(R),k=M.j(I);A(M)&&(M=E),V=V.add(M),N=B(N,k)}return new $(V,N)}r.A=function(N){return X(this,N).h},r.and=function(N){for(var I=Math.max(this.g.length,N.g.length),R=[],b=0;b<I;b++)R[b]=this.i(b)&N.i(b);return new u(R,this.h&N.h)},r.or=function(N){for(var I=Math.max(this.g.length,N.g.length),R=[],b=0;b<I;b++)R[b]=this.i(b)|N.i(b);return new u(R,this.h|N.h)},r.xor=function(N){for(var I=Math.max(this.g.length,N.g.length),R=[],b=0;b<I;b++)R[b]=this.i(b)^N.i(b);return new u(R,this.h^N.h)};function F(N){for(var I=N.g.length+1,R=[],b=0;b<I;b++)R[b]=N.i(b)<<1|N.i(b-1)>>>31;return new u(R,N.h)}function U(N,I){var R=I>>5;I%=32;for(var b=N.g.length-R,V=[],M=0;M<b;M++)V[M]=0<I?N.i(M+R)>>>I|N.i(M+R+1)<<32-I:N.i(M+R);return new u(V,N.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,Pw=n,u.prototype.add=u.prototype.add,u.prototype.multiply=u.prototype.j,u.prototype.modulo=u.prototype.A,u.prototype.compare=u.prototype.l,u.prototype.toNumber=u.prototype.m,u.prototype.toString=u.prototype.toString,u.prototype.getBits=u.prototype.i,u.fromNumber=p,u.fromString=g,hi=u}).apply(typeof hv<"u"?hv:typeof self<"u"?self:typeof window<"u"?window:{});var Lc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var kw,Pl,bw,Kc,up,Dw,Vw,Mw;(function(){var r,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(h,y,w){return h==Array.prototype||h==Object.prototype||(h[y]=w.value),h};function t(h){h=[typeof globalThis=="object"&&globalThis,h,typeof window=="object"&&window,typeof self=="object"&&self,typeof Lc=="object"&&Lc];for(var y=0;y<h.length;++y){var w=h[y];if(w&&w.Math==Math)return w}throw Error("Cannot find global object")}var n=t(this);function i(h,y){if(y)e:{var w=n;h=h.split(".");for(var x=0;x<h.length-1;x++){var G=h[x];if(!(G in w))break e;w=w[G]}h=h[h.length-1],x=w[h],y=y(x),y!=x&&y!=null&&e(w,h,{configurable:!0,writable:!0,value:y})}}function a(h,y){h instanceof String&&(h+="");var w=0,x=!1,G={next:function(){if(!x&&w<h.length){var J=w++;return{value:y(J,h[J]),done:!1}}return x=!0,{done:!0,value:void 0}}};return G[Symbol.iterator]=function(){return G},G}i("Array.prototype.values",function(h){return h||function(){return a(this,function(y,w){return w})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var u=u||{},c=this||self;function d(h){var y=typeof h;return y=y!="object"?y:h?Array.isArray(h)?"array":y:"null",y=="array"||y=="object"&&typeof h.length=="number"}function p(h){var y=typeof h;return y=="object"&&h!=null||y=="function"}function g(h,y,w){return h.call.apply(h.bind,arguments)}function _(h,y,w){if(!h)throw Error();if(2<arguments.length){var x=Array.prototype.slice.call(arguments,2);return function(){var G=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(G,x),h.apply(y,G)}}return function(){return h.apply(y,arguments)}}function E(h,y,w){return E=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?g:_,E.apply(null,arguments)}function C(h,y){var w=Array.prototype.slice.call(arguments,1);return function(){var x=w.slice();return x.push.apply(x,arguments),h.apply(this,x)}}function A(h,y){function w(){}w.prototype=y.prototype,h.aa=y.prototype,h.prototype=new w,h.prototype.constructor=h,h.Qb=function(x,G,J){for(var ge=Array(arguments.length-2),rt=2;rt<arguments.length;rt++)ge[rt-2]=arguments[rt];return y.prototype[G].apply(x,ge)}}function P(h){const y=h.length;if(0<y){const w=Array(y);for(let x=0;x<y;x++)w[x]=h[x];return w}return[]}function D(h,y){for(let w=1;w<arguments.length;w++){const x=arguments[w];if(d(x)){const G=h.length||0,J=x.length||0;h.length=G+J;for(let ge=0;ge<J;ge++)h[G+ge]=x[ge]}else h.push(x)}}class B{constructor(y,w){this.i=y,this.j=w,this.h=0,this.g=null}get(){let y;return 0<this.h?(this.h--,y=this.g,this.g=y.next,y.next=null):y=this.i(),y}}function W(h){return/^[\s\xa0]*$/.test(h)}function $(){var h=c.navigator;return h&&(h=h.userAgent)?h:""}function X(h){return X[" "](h),h}X[" "]=function(){};var F=$().indexOf("Gecko")!=-1&&!($().toLowerCase().indexOf("webkit")!=-1&&$().indexOf("Edge")==-1)&&!($().indexOf("Trident")!=-1||$().indexOf("MSIE")!=-1)&&$().indexOf("Edge")==-1;function U(h,y,w){for(const x in h)y.call(w,h[x],x,h)}function N(h,y){for(const w in h)y.call(void 0,h[w],w,h)}function I(h){const y={};for(const w in h)y[w]=h[w];return y}const R="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function b(h,y){let w,x;for(let G=1;G<arguments.length;G++){x=arguments[G];for(w in x)h[w]=x[w];for(let J=0;J<R.length;J++)w=R[J],Object.prototype.hasOwnProperty.call(x,w)&&(h[w]=x[w])}}function V(h){var y=1;h=h.split(":");const w=[];for(;0<y&&h.length;)w.push(h.shift()),y--;return h.length&&w.push(h.join(":")),w}function M(h){c.setTimeout(()=>{throw h},0)}function k(){var h=se;let y=null;return h.g&&(y=h.g,h.g=h.g.next,h.g||(h.h=null),y.next=null),y}class me{constructor(){this.h=this.g=null}add(y,w){const x=ce.get();x.set(y,w),this.h?this.h.next=x:this.g=x,this.h=x}}var ce=new B(()=>new fe,h=>h.reset());class fe{constructor(){this.next=this.g=this.h=null}set(y,w){this.h=y,this.g=w,this.next=null}reset(){this.next=this.g=this.h=null}}let oe,ne=!1,se=new me,re=()=>{const h=c.Promise.resolve(void 0);oe=()=>{h.then(L)}};var L=()=>{for(var h;h=k();){try{h.h.call(h.g)}catch(w){M(w)}var y=ce;y.j(h),100>y.h&&(y.h++,h.next=y.g,y.g=h)}ne=!1};function Z(){this.s=this.s,this.C=this.C}Z.prototype.s=!1,Z.prototype.ma=function(){this.s||(this.s=!0,this.N())},Z.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function Ee(h,y){this.type=h,this.g=this.target=y,this.defaultPrevented=!1}Ee.prototype.h=function(){this.defaultPrevented=!0};var be=function(){if(!c.addEventListener||!Object.defineProperty)return!1;var h=!1,y=Object.defineProperty({},"passive",{get:function(){h=!0}});try{const w=()=>{};c.addEventListener("test",w,y),c.removeEventListener("test",w,y)}catch{}return h}();function Q(h,y){if(Ee.call(this,h?h.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,h){var w=this.type=h.type,x=h.changedTouches&&h.changedTouches.length?h.changedTouches[0]:null;if(this.target=h.target||h.srcElement,this.g=y,y=h.relatedTarget){if(F){e:{try{X(y.nodeName);var G=!0;break e}catch{}G=!1}G||(y=null)}}else w=="mouseover"?y=h.fromElement:w=="mouseout"&&(y=h.toElement);this.relatedTarget=y,x?(this.clientX=x.clientX!==void 0?x.clientX:x.pageX,this.clientY=x.clientY!==void 0?x.clientY:x.pageY,this.screenX=x.screenX||0,this.screenY=x.screenY||0):(this.clientX=h.clientX!==void 0?h.clientX:h.pageX,this.clientY=h.clientY!==void 0?h.clientY:h.pageY,this.screenX=h.screenX||0,this.screenY=h.screenY||0),this.button=h.button,this.key=h.key||"",this.ctrlKey=h.ctrlKey,this.altKey=h.altKey,this.shiftKey=h.shiftKey,this.metaKey=h.metaKey,this.pointerId=h.pointerId||0,this.pointerType=typeof h.pointerType=="string"?h.pointerType:ee[h.pointerType]||"",this.state=h.state,this.i=h,h.defaultPrevented&&Q.aa.h.call(this)}}A(Q,Ee);var ee={2:"touch",3:"pen",4:"mouse"};Q.prototype.h=function(){Q.aa.h.call(this);var h=this.i;h.preventDefault?h.preventDefault():h.returnValue=!1};var ye="closure_listenable_"+(1e6*Math.random()|0),te=0;function ve(h,y,w,x,G){this.listener=h,this.proxy=null,this.src=y,this.type=w,this.capture=!!x,this.ha=G,this.key=++te,this.da=this.fa=!1}function Oe(h){h.da=!0,h.listener=null,h.proxy=null,h.src=null,h.ha=null}function Be(h){this.src=h,this.g={},this.h=0}Be.prototype.add=function(h,y,w,x,G){var J=h.toString();h=this.g[J],h||(h=this.g[J]=[],this.h++);var ge=Lt(h,y,x,G);return-1<ge?(y=h[ge],w||(y.fa=!1)):(y=new ve(y,this.src,J,!!x,G),y.fa=w,h.push(y)),y};function it(h,y){var w=y.type;if(w in h.g){var x=h.g[w],G=Array.prototype.indexOf.call(x,y,void 0),J;(J=0<=G)&&Array.prototype.splice.call(x,G,1),J&&(Oe(y),h.g[w].length==0&&(delete h.g[w],h.h--))}}function Lt(h,y,w,x){for(var G=0;G<h.length;++G){var J=h[G];if(!J.da&&J.listener==y&&J.capture==!!w&&J.ha==x)return G}return-1}var qe="closure_lm_"+(1e6*Math.random()|0),hr={};function Mr(h,y,w,x,G){if(Array.isArray(y)){for(var J=0;J<y.length;J++)Mr(h,y[J],w,x,G);return null}return w=mn(w),h&&h[ye]?h.K(y,w,p(x)?!!x.capture:!1,G):dr(h,y,w,!1,x,G)}function dr(h,y,w,x,G,J){if(!y)throw Error("Invalid event type");var ge=p(G)?!!G.capture:!!G,rt=Ye(h);if(rt||(h[qe]=rt=new Be(h)),w=rt.add(y,w,x,ge,J),w.proxy)return w;if(x=rs(),w.proxy=x,x.src=h,x.listener=w,h.addEventListener)be||(G=ge),G===void 0&&(G=!1),h.addEventListener(y.toString(),x,G);else if(h.attachEvent)h.attachEvent(ut(y.toString()),x);else if(h.addListener&&h.removeListener)h.addListener(x);else throw Error("addEventListener and attachEvent are unavailable.");return w}function rs(){function h(w){return y.call(h.src,h.listener,w)}const y=Or;return h}function On(h,y,w,x,G){if(Array.isArray(y))for(var J=0;J<y.length;J++)On(h,y[J],w,x,G);else x=p(x)?!!x.capture:!!x,w=mn(w),h&&h[ye]?(h=h.i,y=String(y).toString(),y in h.g&&(J=h.g[y],w=Lt(J,w,x,G),-1<w&&(Oe(J[w]),Array.prototype.splice.call(J,w,1),J.length==0&&(delete h.g[y],h.h--)))):h&&(h=Ye(h))&&(y=h.g[y.toString()],h=-1,y&&(h=Lt(y,w,x,G)),(w=-1<h?y[h]:null)&&Fn(w))}function Fn(h){if(typeof h!="number"&&h&&!h.da){var y=h.src;if(y&&y[ye])it(y.i,h);else{var w=h.type,x=h.proxy;y.removeEventListener?y.removeEventListener(w,x,h.capture):y.detachEvent?y.detachEvent(ut(w),x):y.addListener&&y.removeListener&&y.removeListener(x),(w=Ye(y))?(it(w,h),w.h==0&&(w.src=null,y[qe]=null)):Oe(h)}}}function ut(h){return h in hr?hr[h]:hr[h]="on"+h}function Or(h,y){if(h.da)h=!0;else{y=new Q(y,this);var w=h.listener,x=h.ha||h.src;h.fa&&Fn(h),h=w.call(x,y)}return h}function Ye(h){return h=h[qe],h instanceof Be?h:null}var In="__closure_events_fn_"+(1e9*Math.random()>>>0);function mn(h){return typeof h=="function"?h:(h[In]||(h[In]=function(y){return h.handleEvent(y)}),h[In])}function dt(){Z.call(this),this.i=new Be(this),this.M=this,this.F=null}A(dt,Z),dt.prototype[ye]=!0,dt.prototype.removeEventListener=function(h,y,w,x){On(this,h,y,w,x)};function ft(h,y){var w,x=h.F;if(x)for(w=[];x;x=x.F)w.push(x);if(h=h.M,x=y.type||y,typeof y=="string")y=new Ee(y,h);else if(y instanceof Ee)y.target=y.target||h;else{var G=y;y=new Ee(x,h),b(y,G)}if(G=!0,w)for(var J=w.length-1;0<=J;J--){var ge=y.g=w[J];G=Sn(ge,x,!0,y)&&G}if(ge=y.g=h,G=Sn(ge,x,!0,y)&&G,G=Sn(ge,x,!1,y)&&G,w)for(J=0;J<w.length;J++)ge=y.g=w[J],G=Sn(ge,x,!1,y)&&G}dt.prototype.N=function(){if(dt.aa.N.call(this),this.i){var h=this.i,y;for(y in h.g){for(var w=h.g[y],x=0;x<w.length;x++)Oe(w[x]);delete h.g[y],h.h--}}this.F=null},dt.prototype.K=function(h,y,w,x){return this.i.add(String(h),y,!1,w,x)},dt.prototype.L=function(h,y,w,x){return this.i.add(String(h),y,!0,w,x)};function Sn(h,y,w,x){if(y=h.i.g[String(y)],!y)return!0;y=y.concat();for(var G=!0,J=0;J<y.length;++J){var ge=y[J];if(ge&&!ge.da&&ge.capture==w){var rt=ge.listener,jt=ge.ha||ge.src;ge.fa&&it(h.i,ge),G=rt.call(jt,x)!==!1&&G}}return G&&!x.defaultPrevented}function ss(h,y,w){if(typeof h=="function")w&&(h=E(h,w));else if(h&&typeof h.handleEvent=="function")h=E(h.handleEvent,h);else throw Error("Invalid listener argument");return 2147483647<Number(y)?-1:c.setTimeout(h,y||0)}function Yn(h){h.g=ss(()=>{h.g=null,h.i&&(h.i=!1,Yn(h))},h.l);const y=h.h;h.h=null,h.m.apply(null,y)}class Ln extends Z{constructor(y,w){super(),this.m=y,this.l=w,this.h=null,this.i=!1,this.g=null}j(y){this.h=arguments,this.g?this.i=!0:Yn(this)}N(){super.N(),this.g&&(c.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function jn(h){Z.call(this),this.h=h,this.g={}}A(jn,Z);var fr=[];function Ti(h){U(h.g,function(y,w){this.g.hasOwnProperty(w)&&Fn(y)},h),h.g={}}jn.prototype.N=function(){jn.aa.N.call(this),Ti(this)},jn.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Ii=c.JSON.stringify,Si=c.JSON.parse,Ps=class{stringify(h){return c.JSON.stringify(h,void 0)}parse(h){return c.JSON.parse(h,void 0)}};function Te(){}Te.prototype.h=null;function Re(h){return h.h||(h.h=h.i())}function je(){}var Ue={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function nt(){Ee.call(this,"d")}A(nt,Ee);function $t(){Ee.call(this,"c")}A($t,Ee);var Rt={},pr=null;function Fr(){return pr=pr||new dt}Rt.La="serverreachability";function Ci(h){Ee.call(this,Rt.La,h)}A(Ci,Ee);function mr(h){const y=Fr();ft(y,new Ci(y))}Rt.STAT_EVENT="statevent";function Ai(h,y){Ee.call(this,Rt.STAT_EVENT,h),this.stat=y}A(Ai,Ee);function pt(h){const y=Fr();ft(y,new Ai(y,h))}Rt.Ma="timingevent";function Ze(h,y){Ee.call(this,Rt.Ma,h),this.size=y}A(Ze,Ee);function et(h,y){if(typeof h!="function")throw Error("Fn must not be null and must be a function");return c.setTimeout(function(){h()},y)}function qt(){this.g=!0}qt.prototype.xa=function(){this.g=!1};function gr(h,y,w,x,G,J){h.info(function(){if(h.g)if(J)for(var ge="",rt=J.split("&"),jt=0;jt<rt.length;jt++){var Ke=rt[jt].split("=");if(1<Ke.length){var Wt=Ke[0];Ke=Ke[1];var Mt=Wt.split("_");ge=2<=Mt.length&&Mt[1]=="type"?ge+(Wt+"="+Ke+"&"):ge+(Wt+"=redacted&")}}else ge=null;else ge=J;return"XMLHTTP REQ ("+x+") [attempt "+G+"]: "+y+`
`+w+`
`+ge})}function Lr(h,y,w,x,G,J,ge){h.info(function(){return"XMLHTTP RESP ("+x+") [ attempt "+G+"]: "+y+`
`+w+`
`+J+" "+ge})}function gn(h,y,w,x){h.info(function(){return"XMLHTTP TEXT ("+y+"): "+ud(h,w)+(x?" "+x:"")})}function is(h,y){h.info(function(){return"TIMEOUT: "+y})}qt.prototype.info=function(){};function ud(h,y){if(!h.g)return y;if(!y)return null;try{var w=JSON.parse(y);if(w){for(h=0;h<w.length;h++)if(Array.isArray(w[h])){var x=w[h];if(!(2>x.length)){var G=x[1];if(Array.isArray(G)&&!(1>G.length)){var J=G[0];if(J!="noop"&&J!="stop"&&J!="close")for(var ge=1;ge<G.length;ge++)G[ge]=""}}}}return Ii(w)}catch{return y}}var Io={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Iu={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},yr;function xi(){}A(xi,Te),xi.prototype.g=function(){return new XMLHttpRequest},xi.prototype.i=function(){return{}},yr=new xi;function vr(h,y,w,x){this.j=h,this.i=y,this.l=w,this.R=x||1,this.U=new jn(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Su}function Su(){this.i=null,this.g="",this.h=!1}var qa={},So={};function Co(h,y,w){h.L=1,h.v=Ms(zn(y)),h.m=w,h.P=!0,Wa(h,null)}function Wa(h,y){h.F=Date.now(),ct(h),h.A=zn(h.v);var w=h.A,x=h.R;Array.isArray(x)||(x=[String(x)]),Fs(w.i,"t",x),h.C=0,w=h.j.J,h.h=new Su,h.g=Uu(h.j,w?y:null,!h.m),0<h.O&&(h.M=new Ln(E(h.Y,h,h.g),h.O)),y=h.U,w=h.g,x=h.ca;var G="readystatechange";Array.isArray(G)||(G&&(fr[0]=G.toString()),G=fr);for(var J=0;J<G.length;J++){var ge=Mr(w,G[J],x||y.handleEvent,!1,y.h||y);if(!ge)break;y.g[ge.key]=ge}y=h.H?I(h.H):{},h.m?(h.u||(h.u="POST"),y["Content-Type"]="application/x-www-form-urlencoded",h.g.ea(h.A,h.u,h.m,y)):(h.u="GET",h.g.ea(h.A,h.u,null,y)),mr(),gr(h.i,h.u,h.A,h.l,h.R,h.m)}vr.prototype.ca=function(h){h=h.target;const y=this.M;y&&An(h)==3?y.j():this.Y(h)},vr.prototype.Y=function(h){try{if(h==this.g)e:{const Mt=An(this.g);var y=this.g.Ba();const er=this.g.Z();if(!(3>Mt)&&(Mt!=3||this.g&&(this.h.h||this.g.oa()||Ya(this.g)))){this.J||Mt!=4||y==7||(y==8||0>=er?mr(3):mr(2)),Ni(this);var w=this.g.Z();this.X=w;t:if(Cu(this)){var x=Ya(this.g);h="";var G=x.length,J=An(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Zn(this),ks(this);var ge="";break t}this.h.i=new c.TextDecoder}for(y=0;y<G;y++)this.h.h=!0,h+=this.h.i.decode(x[y],{stream:!(J&&y==G-1)});x.length=0,this.h.g+=h,this.C=0,ge=this.h.g}else ge=this.g.oa();if(this.o=w==200,Lr(this.i,this.u,this.A,this.l,this.R,Mt,w),this.o){if(this.T&&!this.K){t:{if(this.g){var rt,jt=this.g;if((rt=jt.g?jt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!W(rt)){var Ke=rt;break t}}Ke=null}if(w=Ke)gn(this.i,this.l,w,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Ga(this,w);else{this.o=!1,this.s=3,pt(12),Zn(this),ks(this);break e}}if(this.P){w=!0;let $n;for(;!this.J&&this.C<ge.length;)if($n=cd(this,ge),$n==So){Mt==4&&(this.s=4,pt(14),w=!1),gn(this.i,this.l,null,"[Incomplete Response]");break}else if($n==qa){this.s=4,pt(15),gn(this.i,this.l,ge,"[Invalid Chunk]"),w=!1;break}else gn(this.i,this.l,$n,null),Ga(this,$n);if(Cu(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Mt!=4||ge.length!=0||this.h.h||(this.s=1,pt(16),w=!1),this.o=this.o&&w,!w)gn(this.i,this.l,ge,"[Invalid Chunked Response]"),Zn(this),ks(this);else if(0<ge.length&&!this.W){this.W=!0;var Wt=this.j;Wt.g==this&&Wt.ba&&!Wt.M&&(Wt.j.info("Great, no buffering proxy detected. Bytes received: "+ge.length),Ja(Wt),Wt.M=!0,pt(11))}}else gn(this.i,this.l,ge,null),Ga(this,ge);Mt==4&&Zn(this),this.o&&!this.J&&(Mt==4?Oo(this.j,this):(this.o=!1,ct(this)))}else ko(this.g),w==400&&0<ge.indexOf("Unknown SID")?(this.s=3,pt(12)):(this.s=0,pt(13)),Zn(this),ks(this)}}}catch{}finally{}};function Cu(h){return h.g?h.u=="GET"&&h.L!=2&&h.j.Ca:!1}function cd(h,y){var w=h.C,x=y.indexOf(`
`,w);return x==-1?So:(w=Number(y.substring(w,x)),isNaN(w)?qa:(x+=1,x+w>y.length?So:(y=y.slice(x,x+w),h.C=x+w,y)))}vr.prototype.cancel=function(){this.J=!0,Zn(this)};function ct(h){h.S=Date.now()+h.I,Au(h,h.I)}function Au(h,y){if(h.B!=null)throw Error("WatchDog timer not null");h.B=et(E(h.ba,h),y)}function Ni(h){h.B&&(c.clearTimeout(h.B),h.B=null)}vr.prototype.ba=function(){this.B=null;const h=Date.now();0<=h-this.S?(is(this.i,this.A),this.L!=2&&(mr(),pt(17)),Zn(this),this.s=2,ks(this)):Au(this,this.S-h)};function ks(h){h.j.G==0||h.J||Oo(h.j,h)}function Zn(h){Ni(h);var y=h.M;y&&typeof y.ma=="function"&&y.ma(),h.M=null,Ti(h.U),h.g&&(y=h.g,h.g=null,y.abort(),y.ma())}function Ga(h,y){try{var w=h.j;if(w.G!=0&&(w.g==h||yn(w.h,h))){if(!h.K&&yn(w.h,h)&&w.G==3){try{var x=w.Da.g.parse(y)}catch{x=null}if(Array.isArray(x)&&x.length==3){var G=x;if(G[0]==0){e:if(!w.u){if(w.g)if(w.g.F+3e3<h.F)Mo(w),Ir(w);else break e;Vo(w),pt(18)}}else w.za=G[1],0<w.za-w.T&&37500>G[2]&&w.F&&w.v==0&&!w.C&&(w.C=et(E(w.Za,w),6e3));if(1>=Nu(w.h)&&w.ca){try{w.ca()}catch{}w.ca=void 0}}else cs(w,11)}else if((h.K||w.g==h)&&Mo(w),!W(y))for(G=w.Da.g.parse(y),y=0;y<G.length;y++){let Ke=G[y];if(w.T=Ke[0],Ke=Ke[1],w.G==2)if(Ke[0]=="c"){w.K=Ke[1],w.ia=Ke[2];const Wt=Ke[3];Wt!=null&&(w.la=Wt,w.j.info("VER="+w.la));const Mt=Ke[4];Mt!=null&&(w.Aa=Mt,w.j.info("SVER="+w.Aa));const er=Ke[5];er!=null&&typeof er=="number"&&0<er&&(x=1.5*er,w.L=x,w.j.info("backChannelRequestTimeoutMs_="+x)),x=w;const $n=h.g;if($n){const Mi=$n.g?$n.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Mi){var J=x.h;J.g||Mi.indexOf("spdy")==-1&&Mi.indexOf("quic")==-1&&Mi.indexOf("h2")==-1||(J.j=J.l,J.g=new Set,J.h&&(Ka(J,J.h),J.h=null))}if(x.D){const Lo=$n.g?$n.g.getResponseHeader("X-HTTP-Session-Id"):null;Lo&&(x.ya=Lo,at(x.I,x.D,Lo))}}w.G=3,w.l&&w.l.ua(),w.ba&&(w.R=Date.now()-h.F,w.j.info("Handshake RTT: "+w.R+"ms")),x=w;var ge=h;if(x.qa=zu(x,x.J?x.ia:null,x.W),ge.K){Ru(x.h,ge);var rt=ge,jt=x.L;jt&&(rt.I=jt),rt.B&&(Ni(rt),ct(rt)),x.g=ge}else Vi(x);0<w.i.length&&Ur(w)}else Ke[0]!="stop"&&Ke[0]!="close"||cs(w,7);else w.G==3&&(Ke[0]=="stop"||Ke[0]=="close"?Ke[0]=="stop"?cs(w,7):Jt(w):Ke[0]!="noop"&&w.l&&w.l.ta(Ke),w.v=0)}}mr(4)}catch{}}var xu=class{constructor(h,y){this.g=h,this.map=y}};function Ri(h){this.l=h||10,c.PerformanceNavigationTiming?(h=c.performance.getEntriesByType("navigation"),h=0<h.length&&(h[0].nextHopProtocol=="hq"||h[0].nextHopProtocol=="h2")):h=!!(c.chrome&&c.chrome.loadTimes&&c.chrome.loadTimes()&&c.chrome.loadTimes().wasFetchedViaSpdy),this.j=h?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Bn(h){return h.h?!0:h.g?h.g.size>=h.j:!1}function Nu(h){return h.h?1:h.g?h.g.size:0}function yn(h,y){return h.h?h.h==y:h.g?h.g.has(y):!1}function Ka(h,y){h.g?h.g.add(y):h.h=y}function Ru(h,y){h.h&&h.h==y?h.h=null:h.g&&h.g.has(y)&&h.g.delete(y)}Ri.prototype.cancel=function(){if(this.i=Pu(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const h of this.g.values())h.cancel();this.g.clear()}};function Pu(h){if(h.h!=null)return h.i.concat(h.h.D);if(h.g!=null&&h.g.size!==0){let y=h.i;for(const w of h.g.values())y=y.concat(w.D);return y}return P(h.i)}function Ao(h){if(h.V&&typeof h.V=="function")return h.V();if(typeof Map<"u"&&h instanceof Map||typeof Set<"u"&&h instanceof Set)return Array.from(h.values());if(typeof h=="string")return h.split("");if(d(h)){for(var y=[],w=h.length,x=0;x<w;x++)y.push(h[x]);return y}y=[],w=0;for(x in h)y[w++]=h[x];return y}function xo(h){if(h.na&&typeof h.na=="function")return h.na();if(!h.V||typeof h.V!="function"){if(typeof Map<"u"&&h instanceof Map)return Array.from(h.keys());if(!(typeof Set<"u"&&h instanceof Set)){if(d(h)||typeof h=="string"){var y=[];h=h.length;for(var w=0;w<h;w++)y.push(w);return y}y=[],w=0;for(const x in h)y[w++]=x;return y}}}function bs(h,y){if(h.forEach&&typeof h.forEach=="function")h.forEach(y,void 0);else if(d(h)||typeof h=="string")Array.prototype.forEach.call(h,y,void 0);else for(var w=xo(h),x=Ao(h),G=x.length,J=0;J<G;J++)y.call(void 0,x[J],w&&w[J],h)}var Pi=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function hd(h,y){if(h){h=h.split("&");for(var w=0;w<h.length;w++){var x=h[w].indexOf("="),G=null;if(0<=x){var J=h[w].substring(0,x);G=h[w].substring(x+1)}else J=h[w];y(J,G?decodeURIComponent(G.replace(/\+/g," ")):"")}}}function os(h){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,h instanceof os){this.h=h.h,ki(this,h.j),this.o=h.o,this.g=h.g,Ds(this,h.s),this.l=h.l;var y=h.i,w=new jr;w.i=y.i,y.g&&(w.g=new Map(y.g),w.h=y.h),Vs(this,w),this.m=h.m}else h&&(y=String(h).match(Pi))?(this.h=!1,ki(this,y[1]||"",!0),this.o=We(y[2]||""),this.g=We(y[3]||"",!0),Ds(this,y[4]),this.l=We(y[5]||"",!0),Vs(this,y[6]||"",!0),this.m=We(y[7]||"")):(this.h=!1,this.i=new jr(null,this.h))}os.prototype.toString=function(){var h=[],y=this.j;y&&h.push(Os(y,No,!0),":");var w=this.g;return(w||y=="file")&&(h.push("//"),(y=this.o)&&h.push(Os(y,No,!0),"@"),h.push(encodeURIComponent(String(w)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),w=this.s,w!=null&&h.push(":",String(w))),(w=this.l)&&(this.g&&w.charAt(0)!="/"&&h.push("/"),h.push(Os(w,w.charAt(0)=="/"?Du:bu,!0))),(w=this.i.toString())&&h.push("?",w),(w=this.m)&&h.push("#",Os(w,Ha)),h.join("")};function zn(h){return new os(h)}function ki(h,y,w){h.j=w?We(y,!0):y,h.j&&(h.j=h.j.replace(/:$/,""))}function Ds(h,y){if(y){if(y=Number(y),isNaN(y)||0>y)throw Error("Bad port number "+y);h.s=y}else h.s=null}function Vs(h,y,w){y instanceof jr?(h.i=y,Br(h.i,h.h)):(w||(y=Os(y,Vu)),h.i=new jr(y,h.h))}function at(h,y,w){h.i.set(y,w)}function Ms(h){return at(h,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),h}function We(h,y){return h?y?decodeURI(h.replace(/%25/g,"%2525")):decodeURIComponent(h):""}function Os(h,y,w){return typeof h=="string"?(h=encodeURI(h).replace(y,ku),w&&(h=h.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),h):null}function ku(h){return h=h.charCodeAt(0),"%"+(h>>4&15).toString(16)+(h&15).toString(16)}var No=/[#\/\?@]/g,bu=/[#\?:]/g,Du=/[#\?]/g,Vu=/[#\?@]/g,Ha=/#/g;function jr(h,y){this.h=this.g=null,this.i=h||null,this.j=!!y}function Zt(h){h.g||(h.g=new Map,h.h=0,h.i&&hd(h.i,function(y,w){h.add(decodeURIComponent(y.replace(/\+/g," ")),w)}))}r=jr.prototype,r.add=function(h,y){Zt(this),this.i=null,h=Jn(this,h);var w=this.g.get(h);return w||this.g.set(h,w=[]),w.push(y),this.h+=1,this};function _r(h,y){Zt(h),y=Jn(h,y),h.g.has(y)&&(h.i=null,h.h-=h.g.get(y).length,h.g.delete(y))}function wr(h,y){return Zt(h),y=Jn(h,y),h.g.has(y)}r.forEach=function(h,y){Zt(this),this.g.forEach(function(w,x){w.forEach(function(G){h.call(y,G,x,this)},this)},this)},r.na=function(){Zt(this);const h=Array.from(this.g.values()),y=Array.from(this.g.keys()),w=[];for(let x=0;x<y.length;x++){const G=h[x];for(let J=0;J<G.length;J++)w.push(y[x])}return w},r.V=function(h){Zt(this);let y=[];if(typeof h=="string")wr(this,h)&&(y=y.concat(this.g.get(Jn(this,h))));else{h=Array.from(this.g.values());for(let w=0;w<h.length;w++)y=y.concat(h[w])}return y},r.set=function(h,y){return Zt(this),this.i=null,h=Jn(this,h),wr(this,h)&&(this.h-=this.g.get(h).length),this.g.set(h,[y]),this.h+=1,this},r.get=function(h,y){return h?(h=this.V(h),0<h.length?String(h[0]):y):y};function Fs(h,y,w){_r(h,y),0<w.length&&(h.i=null,h.g.set(Jn(h,y),P(w)),h.h+=w.length)}r.toString=function(){if(this.i)return this.i;if(!this.g)return"";const h=[],y=Array.from(this.g.keys());for(var w=0;w<y.length;w++){var x=y[w];const J=encodeURIComponent(String(x)),ge=this.V(x);for(x=0;x<ge.length;x++){var G=J;ge[x]!==""&&(G+="="+encodeURIComponent(String(ge[x]))),h.push(G)}}return this.i=h.join("&")};function Jn(h,y){return y=String(y),h.j&&(y=y.toLowerCase()),y}function Br(h,y){y&&!h.j&&(Zt(h),h.i=null,h.g.forEach(function(w,x){var G=x.toLowerCase();x!=G&&(_r(this,x),Fs(this,G,w))},h)),h.j=y}function dd(h,y){const w=new qt;if(c.Image){const x=new Image;x.onload=C(Cn,w,"TestLoadImage: loaded",!0,y,x),x.onerror=C(Cn,w,"TestLoadImage: error",!1,y,x),x.onabort=C(Cn,w,"TestLoadImage: abort",!1,y,x),x.ontimeout=C(Cn,w,"TestLoadImage: timeout",!1,y,x),c.setTimeout(function(){x.ontimeout&&x.ontimeout()},1e4),x.src=h}else y(!1)}function Mu(h,y){const w=new qt,x=new AbortController,G=setTimeout(()=>{x.abort(),Cn(w,"TestPingServer: timeout",!1,y)},1e4);fetch(h,{signal:x.signal}).then(J=>{clearTimeout(G),J.ok?Cn(w,"TestPingServer: ok",!0,y):Cn(w,"TestPingServer: server error",!1,y)}).catch(()=>{clearTimeout(G),Cn(w,"TestPingServer: error",!1,y)})}function Cn(h,y,w,x,G){try{G&&(G.onload=null,G.onerror=null,G.onabort=null,G.ontimeout=null),x(w)}catch{}}function fd(){this.g=new Ps}function Ou(h,y,w){const x=w||"";try{bs(h,function(G,J){let ge=G;p(G)&&(ge=Ii(G)),y.push(x+J+"="+encodeURIComponent(ge))})}catch(G){throw y.push(x+"type="+encodeURIComponent("_badmap")),G}}function as(h){this.l=h.Ub||null,this.j=h.eb||!1}A(as,Te),as.prototype.g=function(){return new bi(this.l,this.j)},as.prototype.i=function(h){return function(){return h}}({});function bi(h,y){dt.call(this),this.D=h,this.o=y,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}A(bi,dt),r=bi.prototype,r.open=function(h,y){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=h,this.A=y,this.readyState=1,Tr(this)},r.send=function(h){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const y={headers:this.u,method:this.B,credentials:this.m,cache:void 0};h&&(y.body=h),(this.D||c).fetch(new Request(this.A,y)).then(this.Sa.bind(this),this.ga.bind(this))},r.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Er(this)),this.readyState=0},r.Sa=function(h){if(this.g&&(this.l=h,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=h.headers,this.readyState=2,Tr(this)),this.g&&(this.readyState=3,Tr(this),this.g)))if(this.responseType==="arraybuffer")h.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof c.ReadableStream<"u"&&"body"in h){if(this.j=h.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Fu(this)}else h.text().then(this.Ra.bind(this),this.ga.bind(this))};function Fu(h){h.j.read().then(h.Pa.bind(h)).catch(h.ga.bind(h))}r.Pa=function(h){if(this.g){if(this.o&&h.value)this.response.push(h.value);else if(!this.o){var y=h.value?h.value:new Uint8Array(0);(y=this.v.decode(y,{stream:!h.done}))&&(this.response=this.responseText+=y)}h.done?Er(this):Tr(this),this.readyState==3&&Fu(this)}},r.Ra=function(h){this.g&&(this.response=this.responseText=h,Er(this))},r.Qa=function(h){this.g&&(this.response=h,Er(this))},r.ga=function(){this.g&&Er(this)};function Er(h){h.readyState=4,h.l=null,h.j=null,h.v=null,Tr(h)}r.setRequestHeader=function(h,y){this.u.append(h,y)},r.getResponseHeader=function(h){return this.h&&this.h.get(h.toLowerCase())||""},r.getAllResponseHeaders=function(){if(!this.h)return"";const h=[],y=this.h.entries();for(var w=y.next();!w.done;)w=w.value,h.push(w[0]+": "+w[1]),w=y.next();return h.join(`\r
`)};function Tr(h){h.onreadystatechange&&h.onreadystatechange.call(h)}Object.defineProperty(bi.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(h){this.m=h?"include":"same-origin"}});function ls(h){let y="";return U(h,function(w,x){y+=x,y+=":",y+=w,y+=`\r
`}),y}function Ls(h,y,w){e:{for(x in w){var x=!1;break e}x=!0}x||(w=ls(w),typeof h=="string"?w!=null&&encodeURIComponent(String(w)):at(h,y,w))}function vt(h){dt.call(this),this.headers=new Map,this.o=h||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}A(vt,dt);var pd=/^https?$/i,Qa=["POST","PUT"];r=vt.prototype,r.Ha=function(h){this.J=h},r.ea=function(h,y,w,x){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+h);y=y?y.toUpperCase():"GET",this.D=h,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():yr.g(),this.v=this.o?Re(this.o):Re(yr),this.g.onreadystatechange=E(this.Ea,this);try{this.B=!0,this.g.open(y,String(h),!0),this.B=!1}catch(J){Di(this,J);return}if(h=w||"",w=new Map(this.headers),x)if(Object.getPrototypeOf(x)===Object.prototype)for(var G in x)w.set(G,x[G]);else if(typeof x.keys=="function"&&typeof x.get=="function")for(const J of x.keys())w.set(J,x.get(J));else throw Error("Unknown input type for opt_headers: "+String(x));x=Array.from(w.keys()).find(J=>J.toLowerCase()=="content-type"),G=c.FormData&&h instanceof c.FormData,!(0<=Array.prototype.indexOf.call(Qa,y,void 0))||x||G||w.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[J,ge]of w)this.g.setRequestHeader(J,ge);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Po(this),this.u=!0,this.g.send(h),this.u=!1}catch(J){Di(this,J)}};function Di(h,y){h.h=!1,h.g&&(h.j=!0,h.g.abort(),h.j=!1),h.l=y,h.m=5,Ro(h),Un(h)}function Ro(h){h.A||(h.A=!0,ft(h,"complete"),ft(h,"error"))}r.abort=function(h){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=h||7,ft(this,"complete"),ft(this,"abort"),Un(this))},r.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Un(this,!0)),vt.aa.N.call(this)},r.Ea=function(){this.s||(this.B||this.u||this.j?Xa(this):this.bb())},r.bb=function(){Xa(this)};function Xa(h){if(h.h&&typeof u<"u"&&(!h.v[1]||An(h)!=4||h.Z()!=2)){if(h.u&&An(h)==4)ss(h.Ea,0,h);else if(ft(h,"readystatechange"),An(h)==4){h.h=!1;try{const ge=h.Z();e:switch(ge){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var y=!0;break e;default:y=!1}var w;if(!(w=y)){var x;if(x=ge===0){var G=String(h.D).match(Pi)[1]||null;!G&&c.self&&c.self.location&&(G=c.self.location.protocol.slice(0,-1)),x=!pd.test(G?G.toLowerCase():"")}w=x}if(w)ft(h,"complete"),ft(h,"success");else{h.m=6;try{var J=2<An(h)?h.g.statusText:""}catch{J=""}h.l=J+" ["+h.Z()+"]",Ro(h)}}finally{Un(h)}}}}function Un(h,y){if(h.g){Po(h);const w=h.g,x=h.v[0]?()=>{}:null;h.g=null,h.v=null,y||ft(h,"ready");try{w.onreadystatechange=x}catch{}}}function Po(h){h.I&&(c.clearTimeout(h.I),h.I=null)}r.isActive=function(){return!!this.g};function An(h){return h.g?h.g.readyState:0}r.Z=function(){try{return 2<An(this)?this.g.status:-1}catch{return-1}},r.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},r.Oa=function(h){if(this.g){var y=this.g.responseText;return h&&y.indexOf(h)==0&&(y=y.substring(h.length)),Si(y)}};function Ya(h){try{if(!h.g)return null;if("response"in h.g)return h.g.response;switch(h.H){case"":case"text":return h.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in h.g)return h.g.mozResponseArrayBuffer}return null}catch{return null}}function ko(h){const y={};h=(h.g&&2<=An(h)&&h.g.getAllResponseHeaders()||"").split(`\r
`);for(let x=0;x<h.length;x++){if(W(h[x]))continue;var w=V(h[x]);const G=w[0];if(w=w[1],typeof w!="string")continue;w=w.trim();const J=y[G]||[];y[G]=J,J.push(w)}N(y,function(x){return x.join(", ")})}r.Ba=function(){return this.m},r.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function zr(h,y,w){return w&&w.internalChannelParams&&w.internalChannelParams[h]||y}function Za(h){this.Aa=0,this.i=[],this.j=new qt,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=zr("failFast",!1,h),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=zr("baseRetryDelayMs",5e3,h),this.cb=zr("retryDelaySeedMs",1e4,h),this.Wa=zr("forwardChannelMaxRetries",2,h),this.wa=zr("forwardChannelRequestTimeoutMs",2e4,h),this.pa=h&&h.xmlHttpFactory||void 0,this.Xa=h&&h.Tb||void 0,this.Ca=h&&h.useFetchStreams||!1,this.L=void 0,this.J=h&&h.supportsCrossDomainXhr||!1,this.K="",this.h=new Ri(h&&h.concurrentRequestLimit),this.Da=new fd,this.P=h&&h.fastHandshake||!1,this.O=h&&h.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=h&&h.Rb||!1,h&&h.xa&&this.j.xa(),h&&h.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&h&&h.detectBufferingProxy||!1,this.ja=void 0,h&&h.longPollingTimeout&&0<h.longPollingTimeout&&(this.ja=h.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}r=Za.prototype,r.la=8,r.G=1,r.connect=function(h,y,w,x){pt(0),this.W=h,this.H=y||{},w&&x!==void 0&&(this.H.OSID=w,this.H.OAID=x),this.F=this.X,this.I=zu(this,null,this.W),Ur(this)};function Jt(h){if(bo(h),h.G==3){var y=h.U++,w=zn(h.I);if(at(w,"SID",h.K),at(w,"RID",y),at(w,"TYPE","terminate"),us(h,w),y=new vr(h,h.j,y),y.L=2,y.v=Ms(zn(w)),w=!1,c.navigator&&c.navigator.sendBeacon)try{w=c.navigator.sendBeacon(y.v.toString(),"")}catch{}!w&&c.Image&&(new Image().src=y.v,w=!0),w||(y.g=Uu(y.j,null),y.g.ea(y.v)),y.F=Date.now(),ct(y)}Bu(h)}function Ir(h){h.g&&(Ja(h),h.g.cancel(),h.g=null)}function bo(h){Ir(h),h.u&&(c.clearTimeout(h.u),h.u=null),Mo(h),h.h.cancel(),h.s&&(typeof h.s=="number"&&c.clearTimeout(h.s),h.s=null)}function Ur(h){if(!Bn(h.h)&&!h.s){h.s=!0;var y=h.Ga;oe||re(),ne||(oe(),ne=!0),se.add(y,h),h.B=0}}function md(h,y){return Nu(h.h)>=h.h.j-(h.s?1:0)?!1:h.s?(h.i=y.D.concat(h.i),!0):h.G==1||h.G==2||h.B>=(h.Va?0:h.Wa)?!1:(h.s=et(E(h.Ga,h,y),ju(h,h.B)),h.B++,!0)}r.Ga=function(h){if(this.s)if(this.s=null,this.G==1){if(!h){this.U=Math.floor(1e5*Math.random()),h=this.U++;const G=new vr(this,this.j,h);let J=this.o;if(this.S&&(J?(J=I(J),b(J,this.S)):J=this.S),this.m!==null||this.O||(G.H=J,J=null),this.P)e:{for(var y=0,w=0;w<this.i.length;w++){t:{var x=this.i[w];if("__data__"in x.map&&(x=x.map.__data__,typeof x=="string")){x=x.length;break t}x=void 0}if(x===void 0)break;if(y+=x,4096<y){y=w;break e}if(y===4096||w===this.i.length-1){y=w+1;break e}}y=1e3}else y=1e3;y=js(this,G,y),w=zn(this.I),at(w,"RID",h),at(w,"CVER",22),this.D&&at(w,"X-HTTP-Session-Id",this.D),us(this,w),J&&(this.O?y="headers="+encodeURIComponent(String(ls(J)))+"&"+y:this.m&&Ls(w,this.m,J)),Ka(this.h,G),this.Ua&&at(w,"TYPE","init"),this.P?(at(w,"$req",y),at(w,"SID","null"),G.T=!0,Co(G,w,null)):Co(G,w,y),this.G=2}}else this.G==3&&(h?Do(this,h):this.i.length==0||Bn(this.h)||Do(this))};function Do(h,y){var w;y?w=y.l:w=h.U++;const x=zn(h.I);at(x,"SID",h.K),at(x,"RID",w),at(x,"AID",h.T),us(h,x),h.m&&h.o&&Ls(x,h.m,h.o),w=new vr(h,h.j,w,h.B+1),h.m===null&&(w.H=h.o),y&&(h.i=y.D.concat(h.i)),y=js(h,w,1e3),w.I=Math.round(.5*h.wa)+Math.round(.5*h.wa*Math.random()),Ka(h.h,w),Co(w,x,y)}function us(h,y){h.H&&U(h.H,function(w,x){at(y,x,w)}),h.l&&bs({},function(w,x){at(y,x,w)})}function js(h,y,w){w=Math.min(h.i.length,w);var x=h.l?E(h.l.Na,h.l,h):null;e:{var G=h.i;let J=-1;for(;;){const ge=["count="+w];J==-1?0<w?(J=G[0].g,ge.push("ofs="+J)):J=0:ge.push("ofs="+J);let rt=!0;for(let jt=0;jt<w;jt++){let Ke=G[jt].g;const Wt=G[jt].map;if(Ke-=J,0>Ke)J=Math.max(0,G[jt].g-100),rt=!1;else try{Ou(Wt,ge,"req"+Ke+"_")}catch{x&&x(Wt)}}if(rt){x=ge.join("&");break e}}}return h=h.i.splice(0,w),y.D=h,x}function Vi(h){if(!h.g&&!h.u){h.Y=1;var y=h.Fa;oe||re(),ne||(oe(),ne=!0),se.add(y,h),h.v=0}}function Vo(h){return h.g||h.u||3<=h.v?!1:(h.Y++,h.u=et(E(h.Fa,h),ju(h,h.v)),h.v++,!0)}r.Fa=function(){if(this.u=null,Lu(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var h=2*this.R;this.j.info("BP detection timer enabled: "+h),this.A=et(E(this.ab,this),h)}},r.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,pt(10),Ir(this),Lu(this))};function Ja(h){h.A!=null&&(c.clearTimeout(h.A),h.A=null)}function Lu(h){h.g=new vr(h,h.j,"rpc",h.Y),h.m===null&&(h.g.H=h.o),h.g.O=0;var y=zn(h.qa);at(y,"RID","rpc"),at(y,"SID",h.K),at(y,"AID",h.T),at(y,"CI",h.F?"0":"1"),!h.F&&h.ja&&at(y,"TO",h.ja),at(y,"TYPE","xmlhttp"),us(h,y),h.m&&h.o&&Ls(y,h.m,h.o),h.L&&(h.g.I=h.L);var w=h.g;h=h.ia,w.L=1,w.v=Ms(zn(y)),w.m=null,w.P=!0,Wa(w,h)}r.Za=function(){this.C!=null&&(this.C=null,Ir(this),Vo(this),pt(19))};function Mo(h){h.C!=null&&(c.clearTimeout(h.C),h.C=null)}function Oo(h,y){var w=null;if(h.g==y){Mo(h),Ja(h),h.g=null;var x=2}else if(yn(h.h,y))w=y.D,Ru(h.h,y),x=1;else return;if(h.G!=0){if(y.o)if(x==1){w=y.m?y.m.length:0,y=Date.now()-y.F;var G=h.B;x=Fr(),ft(x,new Ze(x,w)),Ur(h)}else Vi(h);else if(G=y.s,G==3||G==0&&0<y.X||!(x==1&&md(h,y)||x==2&&Vo(h)))switch(w&&0<w.length&&(y=h.h,y.i=y.i.concat(w)),G){case 1:cs(h,5);break;case 4:cs(h,10);break;case 3:cs(h,6);break;default:cs(h,2)}}}function ju(h,y){let w=h.Ta+Math.floor(Math.random()*h.cb);return h.isActive()||(w*=2),w*y}function cs(h,y){if(h.j.info("Error code "+y),y==2){var w=E(h.fb,h),x=h.Xa;const G=!x;x=new os(x||"//www.google.com/images/cleardot.gif"),c.location&&c.location.protocol=="http"||ki(x,"https"),Ms(x),G?dd(x.toString(),w):Mu(x.toString(),w)}else pt(2);h.G=0,h.l&&h.l.sa(y),Bu(h),bo(h)}r.fb=function(h){h?(this.j.info("Successfully pinged google.com"),pt(2)):(this.j.info("Failed to ping google.com"),pt(1))};function Bu(h){if(h.G=0,h.ka=[],h.l){const y=Pu(h.h);(y.length!=0||h.i.length!=0)&&(D(h.ka,y),D(h.ka,h.i),h.h.i.length=0,P(h.i),h.i.length=0),h.l.ra()}}function zu(h,y,w){var x=w instanceof os?zn(w):new os(w);if(x.g!="")y&&(x.g=y+"."+x.g),Ds(x,x.s);else{var G=c.location;x=G.protocol,y=y?y+"."+G.hostname:G.hostname,G=+G.port;var J=new os(null);x&&ki(J,x),y&&(J.g=y),G&&Ds(J,G),w&&(J.l=w),x=J}return w=h.D,y=h.ya,w&&y&&at(x,w,y),at(x,"VER",h.la),us(h,x),x}function Uu(h,y,w){if(y&&!h.J)throw Error("Can't create secondary domain capable XhrIo object.");return y=h.Ca&&!h.pa?new vt(new as({eb:w})):new vt(h.pa),y.Ha(h.J),y}r.isActive=function(){return!!this.l&&this.l.isActive(this)};function el(){}r=el.prototype,r.ua=function(){},r.ta=function(){},r.sa=function(){},r.ra=function(){},r.isActive=function(){return!0},r.Na=function(){};function Fo(){}Fo.prototype.g=function(h,y){return new vn(h,y)};function vn(h,y){dt.call(this),this.g=new Za(y),this.l=h,this.h=y&&y.messageUrlParams||null,h=y&&y.messageHeaders||null,y&&y.clientProtocolHeaderRequired&&(h?h["X-Client-Protocol"]="webchannel":h={"X-Client-Protocol":"webchannel"}),this.g.o=h,h=y&&y.initMessageHeaders||null,y&&y.messageContentType&&(h?h["X-WebChannel-Content-Type"]=y.messageContentType:h={"X-WebChannel-Content-Type":y.messageContentType}),y&&y.va&&(h?h["X-WebChannel-Client-Profile"]=y.va:h={"X-WebChannel-Client-Profile":y.va}),this.g.S=h,(h=y&&y.Sb)&&!W(h)&&(this.g.m=h),this.v=y&&y.supportsCrossDomainXhr||!1,this.u=y&&y.sendRawJson||!1,(y=y&&y.httpSessionIdParam)&&!W(y)&&(this.g.D=y,h=this.h,h!==null&&y in h&&(h=this.h,y in h&&delete h[y])),this.j=new $r(this)}A(vn,dt),vn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},vn.prototype.close=function(){Jt(this.g)},vn.prototype.o=function(h){var y=this.g;if(typeof h=="string"){var w={};w.__data__=h,h=w}else this.u&&(w={},w.__data__=Ii(h),h=w);y.i.push(new xu(y.Ya++,h)),y.G==3&&Ur(y)},vn.prototype.N=function(){this.g.l=null,delete this.j,Jt(this.g),delete this.g,vn.aa.N.call(this)};function $u(h){nt.call(this),h.__headers__&&(this.headers=h.__headers__,this.statusCode=h.__status__,delete h.__headers__,delete h.__status__);var y=h.__sm__;if(y){e:{for(const w in y){h=w;break e}h=void 0}(this.i=h)&&(h=this.i,y=y!==null&&h in y?y[h]:void 0),this.data=y}else this.data=h}A($u,nt);function qu(){$t.call(this),this.status=1}A(qu,$t);function $r(h){this.g=h}A($r,el),$r.prototype.ua=function(){ft(this.g,"a")},$r.prototype.ta=function(h){ft(this.g,new $u(h))},$r.prototype.sa=function(h){ft(this.g,new qu)},$r.prototype.ra=function(){ft(this.g,"b")},Fo.prototype.createWebChannel=Fo.prototype.g,vn.prototype.send=vn.prototype.o,vn.prototype.open=vn.prototype.m,vn.prototype.close=vn.prototype.close,Mw=function(){return new Fo},Vw=function(){return Fr()},Dw=Rt,up={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Io.NO_ERROR=0,Io.TIMEOUT=8,Io.HTTP_ERROR=6,Kc=Io,Iu.COMPLETE="complete",bw=Iu,je.EventType=Ue,Ue.OPEN="a",Ue.CLOSE="b",Ue.ERROR="c",Ue.MESSAGE="d",dt.prototype.listen=dt.prototype.K,Pl=je,vt.prototype.listenOnce=vt.prototype.L,vt.prototype.getLastError=vt.prototype.Ka,vt.prototype.getLastErrorCode=vt.prototype.Ba,vt.prototype.getStatus=vt.prototype.Z,vt.prototype.getResponseJson=vt.prototype.Oa,vt.prototype.getResponseText=vt.prototype.oa,vt.prototype.send=vt.prototype.ea,vt.prototype.setWithCredentials=vt.prototype.Ha,kw=vt}).apply(typeof Lc<"u"?Lc:typeof self<"u"?self:typeof window<"u"?window:{});const dv="@firebase/firestore",fv="4.7.9";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}cn.UNAUTHENTICATED=new cn(null),cn.GOOGLE_CREDENTIALS=new cn("google-credentials-uid"),cn.FIRST_PARTY=new cn("first-party-uid"),cn.MOCK_USER=new cn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Oa="11.4.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lo=new Ew("@firebase/firestore");function ha(){return lo.logLevel}function le(r,...e){if(lo.logLevel<=Qe.DEBUG){const t=e.map(Wp);lo.debug(`Firestore (${Oa}): ${r}`,...t)}}function kt(r,...e){if(lo.logLevel<=Qe.ERROR){const t=e.map(Wp);lo.error(`Firestore (${Oa}): ${r}`,...t)}}function $l(r,...e){if(lo.logLevel<=Qe.WARN){const t=e.map(Wp);lo.warn(`Firestore (${Oa}): ${r}`,...t)}}function Wp(r){if(typeof r=="string")return r;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(t){return JSON.stringify(t)}(r)}catch{return r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ae(r="Unexpected state"){const e=`FIRESTORE (${Oa}) INTERNAL ASSERTION FAILED: `+r;throw kt(e),new Error(e)}function ke(r,e){r||Ae()}function Ne(r,e){return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ie={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ce extends yo{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class di{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _C{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class wC{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(cn.UNAUTHENTICATED))}shutdown(){}}class EC{constructor(e){this.t=e,this.currentUser=cn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){ke(this.o===void 0);let n=this.i;const i=d=>this.i!==n?(n=this.i,t(d)):Promise.resolve();let a=new di;this.o=()=>{this.i++,this.currentUser=this.u(),a.resolve(),a=new di,e.enqueueRetryable(()=>i(this.currentUser))};const u=()=>{const d=a;e.enqueueRetryable(async()=>{await d.promise,await i(this.currentUser)})},c=d=>{le("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=d,this.o&&(this.auth.addAuthTokenListener(this.o),u())};this.t.onInit(d=>c(d)),setTimeout(()=>{if(!this.auth){const d=this.t.getImmediate({optional:!0});d?c(d):(le("FirebaseAuthCredentialsProvider","Auth not yet detected"),a.resolve(),a=new di)}},0),u()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(n=>this.i!==e?(le("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(ke(typeof n.accessToken=="string"),new _C(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return ke(e===null||typeof e=="string"),new cn(e)}}class TC{constructor(e,t,n){this.l=e,this.h=t,this.P=n,this.type="FirstParty",this.user=cn.FIRST_PARTY,this.T=new Map}I(){return this.P?this.P():null}get headers(){this.T.set("X-Goog-AuthUser",this.l);const e=this.I();return e&&this.T.set("Authorization",e),this.h&&this.T.set("X-Goog-Iam-Authorization-Token",this.h),this.T}}class IC{constructor(e,t,n){this.l=e,this.h=t,this.P=n}getToken(){return Promise.resolve(new TC(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(cn.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class pv{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class SC{constructor(e,t){this.A=t,this.forceRefresh=!1,this.appCheck=null,this.R=null,this.V=null,Cw(e)&&e.settings.appCheckToken&&(this.V=e.settings.appCheckToken)}start(e,t){ke(this.o===void 0);const n=a=>{a.error!=null&&le("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${a.error.message}`);const u=a.token!==this.R;return this.R=a.token,le("FirebaseAppCheckTokenProvider",`Received ${u?"new":"existing"} token.`),u?t(a.token):Promise.resolve()};this.o=a=>{e.enqueueRetryable(()=>n(a))};const i=a=>{le("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=a,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(a=>i(a)),setTimeout(()=>{if(!this.appCheck){const a=this.A.getImmediate({optional:!0});a?i(a):le("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.V)return Promise.resolve(new pv(this.V));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(ke(typeof t.token=="string"),this.R=t.token,new pv(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CC(r){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(r);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let n=0;n<r;n++)t[n]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ow{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const i=CC(40);for(let a=0;a<i.length;++a)n.length<20&&i[a]<t&&(n+=e.charAt(i[a]%62))}return n}}function Le(r,e){return r<e?-1:r>e?1:0}function _a(r,e,t){return r.length===e.length&&r.every((n,i)=>t(n,e[i]))}function Fw(r){return r+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mv=-62135596800,gv=1e6;class Xt{static now(){return Xt.fromMillis(Date.now())}static fromDate(e){return Xt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor((e-1e3*t)*gv);return new Xt(t,n)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Ce(ie.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Ce(ie.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<mv)throw new Ce(ie.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Ce(ie.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/gv}_compareTo(e){return this.seconds===e.seconds?Le(this.nanoseconds,e.nanoseconds):Le(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds-mv;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class De{static fromTimestamp(e){return new De(e)}static min(){return new De(new Xt(0,0))}static max(){return new De(new Xt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yv="__name__";class Hr{constructor(e,t,n){t===void 0?t=0:t>e.length&&Ae(),n===void 0?n=e.length-t:n>e.length-t&&Ae(),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return Hr.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Hr?e.forEach(n=>{t.push(n)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let i=0;i<n;i++){const a=Hr.compareSegments(e.get(i),t.get(i));if(a!==0)return a}return Math.sign(e.length-t.length)}static compareSegments(e,t){const n=Hr.isNumericId(e),i=Hr.isNumericId(t);return n&&!i?-1:!n&&i?1:n&&i?Hr.extractNumericId(e).compare(Hr.extractNumericId(t)):e<t?-1:e>t?1:0}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return hi.fromString(e.substring(4,e.length-2))}}class lt extends Hr{construct(e,t,n){return new lt(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const n of e){if(n.indexOf("//")>=0)throw new Ce(ie.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter(i=>i.length>0))}return new lt(t)}static emptyPath(){return new lt([])}}const AC=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class bt extends Hr{construct(e,t,n){return new bt(e,t,n)}static isValidIdentifier(e){return AC.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),bt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===yv}static keyField(){return new bt([yv])}static fromServerFormat(e){const t=[];let n="",i=0;const a=()=>{if(n.length===0)throw new Ce(ie.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let u=!1;for(;i<e.length;){const c=e[i];if(c==="\\"){if(i+1===e.length)throw new Ce(ie.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const d=e[i+1];if(d!=="\\"&&d!=="."&&d!=="`")throw new Ce(ie.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=d,i+=2}else c==="`"?(u=!u,i++):c!=="."||u?(n+=c,i++):(a(),i++)}if(a(),u)throw new Ce(ie.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new bt(t)}static emptyPath(){return new bt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _e{constructor(e){this.path=e}static fromPath(e){return new _e(lt.fromString(e))}static fromName(e){return new _e(lt.fromString(e).popFirst(5))}static empty(){return new _e(lt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&lt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return lt.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new _e(new lt(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wa=-1;class ah{constructor(e,t,n,i){this.indexId=e,this.collectionGroup=t,this.fields=n,this.indexState=i}}function cp(r){return r.fields.find(e=>e.kind===2)}function Yi(r){return r.fields.filter(e=>e.kind!==2)}ah.UNKNOWN_ID=-1;class Hc{constructor(e,t){this.fieldPath=e,this.kind=t}}class ql{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new ql(0,Xn.min())}}function Lw(r,e){const t=r.toTimestamp().seconds,n=r.toTimestamp().nanoseconds+1,i=De.fromTimestamp(n===1e9?new Xt(t+1,0):new Xt(t,n));return new Xn(i,_e.empty(),e)}function jw(r){return new Xn(r.readTime,r.key,wa)}class Xn{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new Xn(De.min(),_e.empty(),wa)}static max(){return new Xn(De.max(),_e.empty(),wa)}}function Gp(r,e){let t=r.readTime.compareTo(e.readTime);return t!==0?t:(t=_e.comparator(r.documentKey,e.documentKey),t!==0?t:Le(r.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bw="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class zw{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vi(r){if(r.code!==ie.FAILED_PRECONDITION||r.message!==Bw)throw r;le("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Ae(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new q((n,i)=>{this.nextCallback=a=>{this.wrapSuccess(e,a).next(n,i)},this.catchCallback=a=>{this.wrapFailure(t,a).next(n,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof q?t:q.resolve(t)}catch(t){return q.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):q.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):q.reject(t)}static resolve(e){return new q((t,n)=>{t(e)})}static reject(e){return new q((t,n)=>{n(e)})}static waitFor(e){return new q((t,n)=>{let i=0,a=0,u=!1;e.forEach(c=>{++i,c.next(()=>{++a,u&&a===i&&t()},d=>n(d))}),u=!0,a===i&&t()})}static or(e){let t=q.resolve(!1);for(const n of e)t=t.next(i=>i?q.resolve(i):n());return t}static forEach(e,t){const n=[];return e.forEach((i,a)=>{n.push(t.call(this,i,a))}),this.waitFor(n)}static mapArray(e,t){return new q((n,i)=>{const a=e.length,u=new Array(a);let c=0;for(let d=0;d<a;d++){const p=d;t(e[p]).next(g=>{u[p]=g,++c,c===a&&n(u)},g=>i(g))}})}static doWhile(e,t){return new q((n,i)=>{const a=()=>{e()===!0?t().next(()=>{a()},i):n()};a()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kn="SimpleDb";class Fh{static open(e,t,n,i){try{return new Fh(t,e.transaction(i,n))}catch(a){throw new Vl(t,a)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.m=new di,this.transaction.oncomplete=()=>{this.m.resolve()},this.transaction.onabort=()=>{t.error?this.m.reject(new Vl(e,t.error)):this.m.resolve()},this.transaction.onerror=n=>{const i=Kp(n.target.error);this.m.reject(new Vl(e,i))}}get p(){return this.m.promise}abort(e){e&&this.m.reject(e),this.aborted||(le(Kn,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}S(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new NC(t)}}class fi{static delete(e){return le(Kn,"Removing database:",e),Ji(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!vw())return!1;if(fi.v())return!0;const e=sh(),t=fi.C(e),n=0<t&&t<10,i=Uw(e),a=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||n||a)}static v(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.F)==="YES"}static M(e,t){return e.store(t)}static C(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(n)}constructor(e,t,n){this.name=e,this.version=t,this.O=n,fi.C(sh())===12.2&&kt("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async N(e){return this.db||(le(Kn,"Opening database:",this.name),this.db=await new Promise((t,n)=>{const i=indexedDB.open(this.name,this.version);i.onsuccess=a=>{const u=a.target.result;t(u)},i.onblocked=()=>{n(new Vl(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=a=>{const u=a.target.error;u.name==="VersionError"?n(new Ce(ie.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):u.name==="InvalidStateError"?n(new Ce(ie.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+u)):n(new Vl(e,u))},i.onupgradeneeded=a=>{le(Kn,'Database "'+this.name+'" requires upgrade from version:',a.oldVersion);const u=a.target.result;this.O.B(u,i.transaction,a.oldVersion,this.version).next(()=>{le(Kn,"Database upgrade to version "+this.version+" complete")})}})),this.L&&(this.db.onversionchange=t=>this.L(t)),this.db}k(e){this.L=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,n,i){const a=t==="readonly";let u=0;for(;;){++u;try{this.db=await this.N(e);const c=Fh.open(this.db,e,a?"readonly":"readwrite",n),d=i(c).next(p=>(c.S(),p)).catch(p=>(c.abort(p),q.reject(p))).toPromise();return d.catch(()=>{}),await c.p,d}catch(c){const d=c,p=d.name!=="FirebaseError"&&u<3;if(le(Kn,"Transaction failed with error:",d.message,"Retrying:",p),this.close(),!p)return Promise.reject(d)}}}close(){this.db&&this.db.close(),this.db=void 0}}function Uw(r){const e=r.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class xC{constructor(e){this.q=e,this.$=!1,this.K=null}get isDone(){return this.$}get U(){return this.K}set cursor(e){this.q=e}done(){this.$=!0}W(e){this.K=e}delete(){return Ji(this.q.delete())}}class Vl extends Ce{constructor(e,t){super(ie.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function _i(r){return r.name==="IndexedDbTransactionError"}class NC{constructor(e){this.store=e}put(e,t){let n;return t!==void 0?(le(Kn,"PUT",this.store.name,e,t),n=this.store.put(t,e)):(le(Kn,"PUT",this.store.name,"<auto-key>",e),n=this.store.put(e)),Ji(n)}add(e){return le(Kn,"ADD",this.store.name,e,e),Ji(this.store.add(e))}get(e){return Ji(this.store.get(e)).next(t=>(t===void 0&&(t=null),le(Kn,"GET",this.store.name,e,t),t))}delete(e){return le(Kn,"DELETE",this.store.name,e),Ji(this.store.delete(e))}count(){return le(Kn,"COUNT",this.store.name),Ji(this.store.count())}G(e,t){const n=this.options(e,t),i=n.index?this.store.index(n.index):this.store;if(typeof i.getAll=="function"){const a=i.getAll(n.range);return new q((u,c)=>{a.onerror=d=>{c(d.target.error)},a.onsuccess=d=>{u(d.target.result)}})}{const a=this.cursor(n),u=[];return this.j(a,(c,d)=>{u.push(d)}).next(()=>u)}}H(e,t){const n=this.store.getAll(e,t===null?void 0:t);return new q((i,a)=>{n.onerror=u=>{a(u.target.error)},n.onsuccess=u=>{i(u.target.result)}})}J(e,t){le(Kn,"DELETE ALL",this.store.name);const n=this.options(e,t);n.Y=!1;const i=this.cursor(n);return this.j(i,(a,u,c)=>c.delete())}Z(e,t){let n;t?n=e:(n={},t=e);const i=this.cursor(n);return this.j(i,t)}X(e){const t=this.cursor({});return new q((n,i)=>{t.onerror=a=>{const u=Kp(a.target.error);i(u)},t.onsuccess=a=>{const u=a.target.result;u?e(u.primaryKey,u.value).next(c=>{c?u.continue():n()}):n()}})}j(e,t){const n=[];return new q((i,a)=>{e.onerror=u=>{a(u.target.error)},e.onsuccess=u=>{const c=u.target.result;if(!c)return void i();const d=new xC(c),p=t(c.primaryKey,c.value,d);if(p instanceof q){const g=p.catch(_=>(d.done(),q.reject(_)));n.push(g)}d.isDone?i():d.U===null?c.continue():c.continue(d.U)}}).next(()=>q.waitFor(n))}options(e,t){let n;return e!==void 0&&(typeof e=="string"?n=e:t=e),{index:n,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const n=this.store.index(e.index);return e.Y?n.openKeyCursor(e.range,t):n.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Ji(r){return new q((e,t)=>{r.onsuccess=n=>{const i=n.target.result;e(i)},r.onerror=n=>{const i=Kp(n.target.error);t(i)}})}let vv=!1;function Kp(r){const e=fi.C(sh());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(r.message.indexOf(t)>=0){const n=new Ce("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return vv||(vv=!0,setTimeout(()=>{throw n},0)),n}}return r}const Ml="IndexBackfiller";class RC{constructor(e,t){this.asyncQueue=e,this.ee=t,this.task=null}start(){this.te(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}te(e){le(Ml,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{const t=await this.ee.ne();le(Ml,`Documents written: ${t}`)}catch(t){_i(t)?le(Ml,"Ignoring IndexedDB error during index backfill: ",t):await vi(t)}await this.te(6e4)})}}class PC{constructor(e,t){this.localStore=e,this.persistence=t}async ne(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",t=>this.re(t,e))}re(e,t){const n=new Set;let i=t,a=!0;return q.doWhile(()=>a===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(u=>{if(u!==null&&!n.has(u))return le(Ml,`Processing collection: ${u}`),this.ie(e,u,i).next(c=>{i-=c,n.add(u)});a=!1})).next(()=>t-i)}ie(e,t,n){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(i=>this.localStore.localDocuments.getNextDocuments(e,t,i,n).next(a=>{const u=a.changes;return this.localStore.indexManager.updateIndexEntries(e,u).next(()=>this.se(i,a)).next(c=>(le(Ml,`Updating offset: ${c}`),this.localStore.indexManager.updateCollectionGroup(e,t,c))).next(()=>u.size)}))}se(e,t){let n=e;return t.changes.forEach((i,a)=>{const u=jw(a);Gp(u,n)>0&&(n=u)}),new Xn(n.readTime,n.documentKey,Math.max(t.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vn{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=n=>this.oe(n),this._e=n=>t.writeSequenceNumber(n))}oe(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this._e&&this._e(e),e}}Vn.ae=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const so=-1;function Lh(r){return r==null}function Wl(r){return r===0&&1/r==-1/0}function kC(r){return typeof r=="number"&&Number.isInteger(r)&&!Wl(r)&&r<=Number.MAX_SAFE_INTEGER&&r>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lh="";function dn(r){let e="";for(let t=0;t<r.length;t++)e.length>0&&(e=_v(e)),e=bC(r.get(t),e);return _v(e)}function bC(r,e){let t=e;const n=r.length;for(let i=0;i<n;i++){const a=r.charAt(i);switch(a){case"\0":t+="";break;case lh:t+="";break;default:t+=a}}return t}function _v(r){return r+lh+""}function Xr(r){const e=r.length;if(ke(e>=2),e===2)return ke(r.charAt(0)===lh&&r.charAt(1)===""),lt.emptyPath();const t=e-2,n=[];let i="";for(let a=0;a<e;){const u=r.indexOf(lh,a);switch((u<0||u>t)&&Ae(),r.charAt(u+1)){case"":const c=r.substring(a,u);let d;i.length===0?d=c:(i+=c,d=i,i=""),n.push(d);break;case"":i+=r.substring(a,u),i+="\0";break;case"":i+=r.substring(a,u+1);break;default:Ae()}a=u+2}return new lt(n)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zi="remoteDocuments",ou="owner",ia="owner",Gl="mutationQueues",DC="userId",Pr="mutations",wv="batchId",ro="userMutationsIndex",Ev=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qc(r,e){return[r,dn(e)]}function $w(r,e,t){return[r,dn(e),t]}const VC={},Ea="documentMutations",uh="remoteDocumentsV14",MC=["prefixPath","collectionGroup","readTime","documentId"],Xc="documentKeyIndex",OC=["prefixPath","collectionGroup","documentId"],qw="collectionGroupIndex",FC=["collectionGroup","readTime","prefixPath","documentId"],Kl="remoteDocumentGlobal",hp="remoteDocumentGlobalKey",Ta="targets",Ww="queryTargetsIndex",LC=["canonicalId","targetId"],Ia="targetDocuments",jC=["targetId","path"],Hp="documentTargetsIndex",BC=["path","targetId"],ch="targetGlobalKey",io="targetGlobal",Hl="collectionParents",zC=["collectionId","parent"],Sa="clientMetadata",UC="clientId",jh="bundles",$C="bundleId",Bh="namedQueries",qC="name",Qp="indexConfiguration",WC="indexId",dp="collectionGroupIndex",GC="collectionGroup",hh="indexState",KC=["indexId","uid"],Gw="sequenceNumberIndex",HC=["uid","sequenceNumber"],dh="indexEntries",QC=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],Kw="documentKeyIndex",XC=["indexId","uid","orderedDocumentKey"],zh="documentOverlays",YC=["userId","collectionPath","documentId"],fp="collectionPathOverlayIndex",ZC=["userId","collectionPath","largestBatchId"],Hw="collectionGroupOverlayIndex",JC=["userId","collectionGroup","largestBatchId"],Xp="globals",eA="name",Qw=[Gl,Pr,Ea,Zi,Ta,ou,io,Ia,Sa,Kl,Hl,jh,Bh],tA=[...Qw,zh],Xw=[Gl,Pr,Ea,uh,Ta,ou,io,Ia,Sa,Kl,Hl,jh,Bh,zh],Yw=Xw,Yp=[...Yw,Qp,hh,dh],nA=Yp,rA=[...Yp,Xp];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pp extends zw{constructor(e,t){super(),this.ue=e,this.currentSequenceNumber=t}}function Ut(r,e){const t=Ne(r);return fi.M(t.ue,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tv(r){let e=0;for(const t in r)Object.prototype.hasOwnProperty.call(r,t)&&e++;return e}function au(r,e){for(const t in r)Object.prototype.hasOwnProperty.call(r,t)&&e(t,r[t])}function sA(r){for(const e in r)if(Object.prototype.hasOwnProperty.call(r,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yt{constructor(e,t){this.comparator=e,this.root=t||nn.EMPTY}insert(e,t){return new yt(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,nn.BLACK,null,null))}remove(e){return new yt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,nn.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(n===0)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(i===0)return t+n.left.size;i<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,n)=>(e(t,n),!1))}toString(){const e=[];return this.inorderTraversal((t,n)=>(e.push(`${t}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new jc(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new jc(this.root,e,this.comparator,!1)}getReverseIterator(){return new jc(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new jc(this.root,e,this.comparator,!0)}}class jc{constructor(e,t,n,i){this.isReverse=i,this.nodeStack=[];let a=1;for(;!e.isEmpty();)if(a=t?n(e.key,t):1,t&&i&&(a*=-1),a<0)e=this.isReverse?e.left:e.right;else{if(a===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class nn{constructor(e,t,n,i,a){this.key=e,this.value=t,this.color=n??nn.RED,this.left=i??nn.EMPTY,this.right=a??nn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,i,a){return new nn(e??this.key,t??this.value,n??this.color,i??this.left,a??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let i=this;const a=n(e,i.key);return i=a<0?i.copy(null,null,null,i.left.insert(e,t,n),null):a===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return nn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return nn.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,nn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,nn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw Ae();const e=this.left.check();if(e!==this.right.check())throw Ae();return e+(this.isRed()?0:1)}}nn.EMPTY=null,nn.RED=!0,nn.BLACK=!1;nn.EMPTY=new class{constructor(){this.size=0}get key(){throw Ae()}get value(){throw Ae()}get color(){throw Ae()}get left(){throw Ae()}get right(){throw Ae()}copy(e,t,n,i,a){return this}insert(e,t,n){return new nn(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class st{constructor(e){this.comparator=e,this.data=new yt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,n)=>(e(t),!1))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let n;for(n=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Iv(this.data.getIterator())}getIteratorFrom(e){return new Iv(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(n=>{t=t.add(n)}),t}isEqual(e){if(!(e instanceof st)||this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const i=t.getNext().key,a=n.getNext().key;if(this.comparator(i,a)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new st(this.comparator);return t.data=e,t}}class Iv{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function oa(r){return r.hasNext()?r.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ws{constructor(e){this.fields=e,e.sort(bt.comparator)}static empty(){return new ws([])}unionWith(e){let t=new st(bt.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new ws(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return _a(this.fields,e.fields,(t,n)=>t.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zw extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dt{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(i){try{return atob(i)}catch(a){throw typeof DOMException<"u"&&a instanceof DOMException?new Zw("Invalid base64 string: "+a):a}}(e);return new Dt(t)}static fromUint8Array(e){const t=function(i){let a="";for(let u=0;u<i.length;++u)a+=String.fromCharCode(i[u]);return a}(e);return new Dt(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const n=new Uint8Array(t.length);for(let i=0;i<t.length;i++)n[i]=t.charCodeAt(i);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Le(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Dt.EMPTY_BYTE_STRING=new Dt("");const iA=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Cs(r){if(ke(!!r),typeof r=="string"){let e=0;const t=iA.exec(r);if(ke(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}const n=new Date(r);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:wt(r.seconds),nanos:wt(r.nanos)}}function wt(r){return typeof r=="number"?r:typeof r=="string"?Number(r):0}function As(r){return typeof r=="string"?Dt.fromBase64String(r):Dt.fromUint8Array(r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jw="server_timestamp",e0="__type__",t0="__previous_value__",n0="__local_write_time__";function Zp(r){var e,t;return((t=(((e=r==null?void 0:r.mapValue)===null||e===void 0?void 0:e.fields)||{})[e0])===null||t===void 0?void 0:t.stringValue)===Jw}function Uh(r){const e=r.mapValue.fields[t0];return Zp(e)?Uh(e):e}function Ql(r){const e=Cs(r.mapValue.fields[n0].timestampValue);return new Xt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oA{constructor(e,t,n,i,a,u,c,d,p){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=i,this.ssl=a,this.forceLongPolling=u,this.autoDetectLongPolling=c,this.longPollingOptions=d,this.useFetchStreams=p}}const fh="(default)";class uo{constructor(e,t){this.projectId=e,this.database=t||fh}static empty(){return new uo("","")}get isDefaultDatabase(){return this.database===fh}isEqual(e){return e instanceof uo&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const r0="__type__",s0="__max__",ai={mapValue:{fields:{__type__:{stringValue:s0}}}},i0="__vector__",Xl="value",Yc={nullValue:"NULL_VALUE"};function pi(r){return"nullValue"in r?0:"booleanValue"in r?1:"integerValue"in r||"doubleValue"in r?2:"timestampValue"in r?3:"stringValue"in r?5:"bytesValue"in r?6:"referenceValue"in r?7:"geoPointValue"in r?8:"arrayValue"in r?9:"mapValue"in r?Zp(r)?4:o0(r)?9007199254740991:$h(r)?10:11:Ae()}function Zr(r,e){if(r===e)return!0;const t=pi(r);if(t!==pi(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return r.booleanValue===e.booleanValue;case 4:return Ql(r).isEqual(Ql(e));case 3:return function(i,a){if(typeof i.timestampValue=="string"&&typeof a.timestampValue=="string"&&i.timestampValue.length===a.timestampValue.length)return i.timestampValue===a.timestampValue;const u=Cs(i.timestampValue),c=Cs(a.timestampValue);return u.seconds===c.seconds&&u.nanos===c.nanos}(r,e);case 5:return r.stringValue===e.stringValue;case 6:return function(i,a){return As(i.bytesValue).isEqual(As(a.bytesValue))}(r,e);case 7:return r.referenceValue===e.referenceValue;case 8:return function(i,a){return wt(i.geoPointValue.latitude)===wt(a.geoPointValue.latitude)&&wt(i.geoPointValue.longitude)===wt(a.geoPointValue.longitude)}(r,e);case 2:return function(i,a){if("integerValue"in i&&"integerValue"in a)return wt(i.integerValue)===wt(a.integerValue);if("doubleValue"in i&&"doubleValue"in a){const u=wt(i.doubleValue),c=wt(a.doubleValue);return u===c?Wl(u)===Wl(c):isNaN(u)&&isNaN(c)}return!1}(r,e);case 9:return _a(r.arrayValue.values||[],e.arrayValue.values||[],Zr);case 10:case 11:return function(i,a){const u=i.mapValue.fields||{},c=a.mapValue.fields||{};if(Tv(u)!==Tv(c))return!1;for(const d in u)if(u.hasOwnProperty(d)&&(c[d]===void 0||!Zr(u[d],c[d])))return!1;return!0}(r,e);default:return Ae()}}function Yl(r,e){return(r.values||[]).find(t=>Zr(t,e))!==void 0}function mi(r,e){if(r===e)return 0;const t=pi(r),n=pi(e);if(t!==n)return Le(t,n);switch(t){case 0:case 9007199254740991:return 0;case 1:return Le(r.booleanValue,e.booleanValue);case 2:return function(a,u){const c=wt(a.integerValue||a.doubleValue),d=wt(u.integerValue||u.doubleValue);return c<d?-1:c>d?1:c===d?0:isNaN(c)?isNaN(d)?0:-1:1}(r,e);case 3:return Sv(r.timestampValue,e.timestampValue);case 4:return Sv(Ql(r),Ql(e));case 5:return Le(r.stringValue,e.stringValue);case 6:return function(a,u){const c=As(a),d=As(u);return c.compareTo(d)}(r.bytesValue,e.bytesValue);case 7:return function(a,u){const c=a.split("/"),d=u.split("/");for(let p=0;p<c.length&&p<d.length;p++){const g=Le(c[p],d[p]);if(g!==0)return g}return Le(c.length,d.length)}(r.referenceValue,e.referenceValue);case 8:return function(a,u){const c=Le(wt(a.latitude),wt(u.latitude));return c!==0?c:Le(wt(a.longitude),wt(u.longitude))}(r.geoPointValue,e.geoPointValue);case 9:return Cv(r.arrayValue,e.arrayValue);case 10:return function(a,u){var c,d,p,g;const _=a.fields||{},E=u.fields||{},C=(c=_[Xl])===null||c===void 0?void 0:c.arrayValue,A=(d=E[Xl])===null||d===void 0?void 0:d.arrayValue,P=Le(((p=C==null?void 0:C.values)===null||p===void 0?void 0:p.length)||0,((g=A==null?void 0:A.values)===null||g===void 0?void 0:g.length)||0);return P!==0?P:Cv(C,A)}(r.mapValue,e.mapValue);case 11:return function(a,u){if(a===ai.mapValue&&u===ai.mapValue)return 0;if(a===ai.mapValue)return 1;if(u===ai.mapValue)return-1;const c=a.fields||{},d=Object.keys(c),p=u.fields||{},g=Object.keys(p);d.sort(),g.sort();for(let _=0;_<d.length&&_<g.length;++_){const E=Le(d[_],g[_]);if(E!==0)return E;const C=mi(c[d[_]],p[g[_]]);if(C!==0)return C}return Le(d.length,g.length)}(r.mapValue,e.mapValue);default:throw Ae()}}function Sv(r,e){if(typeof r=="string"&&typeof e=="string"&&r.length===e.length)return Le(r,e);const t=Cs(r),n=Cs(e),i=Le(t.seconds,n.seconds);return i!==0?i:Le(t.nanos,n.nanos)}function Cv(r,e){const t=r.values||[],n=e.values||[];for(let i=0;i<t.length&&i<n.length;++i){const a=mi(t[i],n[i]);if(a)return a}return Le(t.length,n.length)}function Ca(r){return mp(r)}function mp(r){return"nullValue"in r?"null":"booleanValue"in r?""+r.booleanValue:"integerValue"in r?""+r.integerValue:"doubleValue"in r?""+r.doubleValue:"timestampValue"in r?function(t){const n=Cs(t);return`time(${n.seconds},${n.nanos})`}(r.timestampValue):"stringValue"in r?r.stringValue:"bytesValue"in r?function(t){return As(t).toBase64()}(r.bytesValue):"referenceValue"in r?function(t){return _e.fromName(t).toString()}(r.referenceValue):"geoPointValue"in r?function(t){return`geo(${t.latitude},${t.longitude})`}(r.geoPointValue):"arrayValue"in r?function(t){let n="[",i=!0;for(const a of t.values||[])i?i=!1:n+=",",n+=mp(a);return n+"]"}(r.arrayValue):"mapValue"in r?function(t){const n=Object.keys(t.fields||{}).sort();let i="{",a=!0;for(const u of n)a?a=!1:i+=",",i+=`${u}:${mp(t.fields[u])}`;return i+"}"}(r.mapValue):Ae()}function Zc(r){switch(pi(r)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Uh(r);return e?16+Zc(e):16;case 5:return 2*r.stringValue.length;case 6:return As(r.bytesValue).approximateByteSize();case 7:return r.referenceValue.length;case 9:return function(n){return(n.values||[]).reduce((i,a)=>i+Zc(a),0)}(r.arrayValue);case 10:case 11:return function(n){let i=0;return au(n.fields,(a,u)=>{i+=a.length+Zc(u)}),i}(r.mapValue);default:throw Ae()}}function Jp(r,e){return{referenceValue:`projects/${r.projectId}/databases/${r.database}/documents/${e.path.canonicalString()}`}}function gp(r){return!!r&&"integerValue"in r}function Zl(r){return!!r&&"arrayValue"in r}function Av(r){return!!r&&"nullValue"in r}function xv(r){return!!r&&"doubleValue"in r&&isNaN(Number(r.doubleValue))}function Wf(r){return!!r&&"mapValue"in r}function $h(r){var e,t;return((t=(((e=r==null?void 0:r.mapValue)===null||e===void 0?void 0:e.fields)||{})[r0])===null||t===void 0?void 0:t.stringValue)===i0}function Ol(r){if(r.geoPointValue)return{geoPointValue:Object.assign({},r.geoPointValue)};if(r.timestampValue&&typeof r.timestampValue=="object")return{timestampValue:Object.assign({},r.timestampValue)};if(r.mapValue){const e={mapValue:{fields:{}}};return au(r.mapValue.fields,(t,n)=>e.mapValue.fields[t]=Ol(n)),e}if(r.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(r.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Ol(r.arrayValue.values[t]);return e}return Object.assign({},r)}function o0(r){return(((r.mapValue||{}).fields||{}).__type__||{}).stringValue===s0}const a0={mapValue:{fields:{[r0]:{stringValue:i0},[Xl]:{arrayValue:{}}}}};function aA(r){return"nullValue"in r?Yc:"booleanValue"in r?{booleanValue:!1}:"integerValue"in r||"doubleValue"in r?{doubleValue:NaN}:"timestampValue"in r?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in r?{stringValue:""}:"bytesValue"in r?{bytesValue:""}:"referenceValue"in r?Jp(uo.empty(),_e.empty()):"geoPointValue"in r?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in r?{arrayValue:{}}:"mapValue"in r?$h(r)?a0:{mapValue:{}}:Ae()}function lA(r){return"nullValue"in r?{booleanValue:!1}:"booleanValue"in r?{doubleValue:NaN}:"integerValue"in r||"doubleValue"in r?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in r?{stringValue:""}:"stringValue"in r?{bytesValue:""}:"bytesValue"in r?Jp(uo.empty(),_e.empty()):"referenceValue"in r?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in r?{arrayValue:{}}:"arrayValue"in r?a0:"mapValue"in r?$h(r)?{mapValue:{}}:ai:Ae()}function Nv(r,e){const t=mi(r.value,e.value);return t!==0?t:r.inclusive&&!e.inclusive?-1:!r.inclusive&&e.inclusive?1:0}function Rv(r,e){const t=mi(r.value,e.value);return t!==0?t:r.inclusive&&!e.inclusive?1:!r.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lr{constructor(e){this.value=e}static empty(){return new lr({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!Wf(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Ol(t)}setAll(e){let t=bt.emptyPath(),n={},i=[];e.forEach((u,c)=>{if(!t.isImmediateParentOf(c)){const d=this.getFieldsMap(t);this.applyChanges(d,n,i),n={},i=[],t=c.popLast()}u?n[c.lastSegment()]=Ol(u):i.push(c.lastSegment())});const a=this.getFieldsMap(t);this.applyChanges(a,n,i)}delete(e){const t=this.field(e.popLast());Wf(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Zr(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let i=t.mapValue.fields[e.get(n)];Wf(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,n){au(t,(i,a)=>e[i]=a);for(const i of n)delete e[i]}clone(){return new lr(Ol(this.value))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class At{constructor(e,t,n,i,a,u,c){this.key=e,this.documentType=t,this.version=n,this.readTime=i,this.createTime=a,this.data=u,this.documentState=c}static newInvalidDocument(e){return new At(e,0,De.min(),De.min(),De.min(),lr.empty(),0)}static newFoundDocument(e,t,n,i){return new At(e,1,t,De.min(),n,i,0)}static newNoDocument(e,t){return new At(e,2,t,De.min(),De.min(),lr.empty(),0)}static newUnknownDocument(e,t){return new At(e,3,t,De.min(),De.min(),lr.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(De.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=lr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=lr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=De.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof At&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new At(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Aa{constructor(e,t){this.position=e,this.inclusive=t}}function Pv(r,e,t){let n=0;for(let i=0;i<r.position.length;i++){const a=e[i],u=r.position[i];if(a.field.isKeyField()?n=_e.comparator(_e.fromName(u.referenceValue),t.key):n=mi(u,t.data.field(a.field)),a.dir==="desc"&&(n*=-1),n!==0)break}return n}function kv(r,e){if(r===null)return e===null;if(e===null||r.inclusive!==e.inclusive||r.position.length!==e.position.length)return!1;for(let t=0;t<r.position.length;t++)if(!Zr(r.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ph{constructor(e,t="asc"){this.field=e,this.dir=t}}function uA(r,e){return r.dir===e.dir&&r.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l0{}class Ge extends l0{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,n):new cA(e,t,n):t==="array-contains"?new fA(e,n):t==="in"?new p0(e,n):t==="not-in"?new pA(e,n):t==="array-contains-any"?new mA(e,n):new Ge(e,t,n)}static createKeyFieldInFilter(e,t,n){return t==="in"?new hA(e,n):new dA(e,n)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(mi(t,this.value)):t!==null&&pi(this.value)===pi(t)&&this.matchesComparison(mi(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Ae()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class ot extends l0{constructor(e,t){super(),this.filters=e,this.op=t,this.ce=null}static create(e,t){return new ot(e,t)}matches(e){return xa(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ce!==null||(this.ce=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ce}getFilters(){return Object.assign([],this.filters)}}function xa(r){return r.op==="and"}function yp(r){return r.op==="or"}function em(r){return u0(r)&&xa(r)}function u0(r){for(const e of r.filters)if(e instanceof ot)return!1;return!0}function vp(r){if(r instanceof Ge)return r.field.canonicalString()+r.op.toString()+Ca(r.value);if(em(r))return r.filters.map(e=>vp(e)).join(",");{const e=r.filters.map(t=>vp(t)).join(",");return`${r.op}(${e})`}}function c0(r,e){return r instanceof Ge?function(n,i){return i instanceof Ge&&n.op===i.op&&n.field.isEqual(i.field)&&Zr(n.value,i.value)}(r,e):r instanceof ot?function(n,i){return i instanceof ot&&n.op===i.op&&n.filters.length===i.filters.length?n.filters.reduce((a,u,c)=>a&&c0(u,i.filters[c]),!0):!1}(r,e):void Ae()}function h0(r,e){const t=r.filters.concat(e);return ot.create(t,r.op)}function d0(r){return r instanceof Ge?function(t){return`${t.field.canonicalString()} ${t.op} ${Ca(t.value)}`}(r):r instanceof ot?function(t){return t.op.toString()+" {"+t.getFilters().map(d0).join(" ,")+"}"}(r):"Filter"}class cA extends Ge{constructor(e,t,n){super(e,t,n),this.key=_e.fromName(n.referenceValue)}matches(e){const t=_e.comparator(e.key,this.key);return this.matchesComparison(t)}}class hA extends Ge{constructor(e,t){super(e,"in",t),this.keys=f0("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class dA extends Ge{constructor(e,t){super(e,"not-in",t),this.keys=f0("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function f0(r,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(n=>_e.fromName(n.referenceValue))}class fA extends Ge{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Zl(t)&&Yl(t.arrayValue,this.value)}}class p0 extends Ge{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Yl(this.value.arrayValue,t)}}class pA extends Ge{constructor(e,t){super(e,"not-in",t)}matches(e){if(Yl(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&!Yl(this.value.arrayValue,t)}}class mA extends Ge{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Zl(t)||!t.arrayValue.values)&&t.arrayValue.values.some(n=>Yl(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gA{constructor(e,t=null,n=[],i=[],a=null,u=null,c=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=i,this.limit=a,this.startAt=u,this.endAt=c,this.le=null}}function _p(r,e=null,t=[],n=[],i=null,a=null,u=null){return new gA(r,e,t,n,i,a,u)}function co(r){const e=Ne(r);if(e.le===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(n=>vp(n)).join(","),t+="|ob:",t+=e.orderBy.map(n=>function(a){return a.field.canonicalString()+a.dir}(n)).join(","),Lh(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(n=>Ca(n)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(n=>Ca(n)).join(",")),e.le=t}return e.le}function lu(r,e){if(r.limit!==e.limit||r.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<r.orderBy.length;t++)if(!uA(r.orderBy[t],e.orderBy[t]))return!1;if(r.filters.length!==e.filters.length)return!1;for(let t=0;t<r.filters.length;t++)if(!c0(r.filters[t],e.filters[t]))return!1;return r.collectionGroup===e.collectionGroup&&!!r.path.isEqual(e.path)&&!!kv(r.startAt,e.startAt)&&kv(r.endAt,e.endAt)}function mh(r){return _e.isDocumentKey(r.path)&&r.collectionGroup===null&&r.filters.length===0}function gh(r,e){return r.filters.filter(t=>t instanceof Ge&&t.field.isEqual(e))}function bv(r,e,t){let n=Yc,i=!0;for(const a of gh(r,e)){let u=Yc,c=!0;switch(a.op){case"<":case"<=":u=aA(a.value);break;case"==":case"in":case">=":u=a.value;break;case">":u=a.value,c=!1;break;case"!=":case"not-in":u=Yc}Nv({value:n,inclusive:i},{value:u,inclusive:c})<0&&(n=u,i=c)}if(t!==null){for(let a=0;a<r.orderBy.length;++a)if(r.orderBy[a].field.isEqual(e)){const u=t.position[a];Nv({value:n,inclusive:i},{value:u,inclusive:t.inclusive})<0&&(n=u,i=t.inclusive);break}}return{value:n,inclusive:i}}function Dv(r,e,t){let n=ai,i=!0;for(const a of gh(r,e)){let u=ai,c=!0;switch(a.op){case">=":case">":u=lA(a.value),c=!1;break;case"==":case"in":case"<=":u=a.value;break;case"<":u=a.value,c=!1;break;case"!=":case"not-in":u=ai}Rv({value:n,inclusive:i},{value:u,inclusive:c})>0&&(n=u,i=c)}if(t!==null){for(let a=0;a<r.orderBy.length;++a)if(r.orderBy[a].field.isEqual(e)){const u=t.position[a];Rv({value:n,inclusive:i},{value:u,inclusive:t.inclusive})>0&&(n=u,i=t.inclusive);break}}return{value:n,inclusive:i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qh{constructor(e,t=null,n=[],i=[],a=null,u="F",c=null,d=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=i,this.limit=a,this.limitType=u,this.startAt=c,this.endAt=d,this.he=null,this.Pe=null,this.Te=null,this.startAt,this.endAt}}function m0(r,e,t,n,i,a,u,c){return new qh(r,e,t,n,i,a,u,c)}function Wh(r){return new qh(r)}function Vv(r){return r.filters.length===0&&r.limit===null&&r.startAt==null&&r.endAt==null&&(r.explicitOrderBy.length===0||r.explicitOrderBy.length===1&&r.explicitOrderBy[0].field.isKeyField())}function yA(r){return r.collectionGroup!==null}function Fl(r){const e=Ne(r);if(e.he===null){e.he=[];const t=new Set;for(const a of e.explicitOrderBy)e.he.push(a),t.add(a.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(u){let c=new st(bt.comparator);return u.filters.forEach(d=>{d.getFlattenedFilters().forEach(p=>{p.isInequality()&&(c=c.add(p.field))})}),c})(e).forEach(a=>{t.has(a.canonicalString())||a.isKeyField()||e.he.push(new ph(a,n))}),t.has(bt.keyField().canonicalString())||e.he.push(new ph(bt.keyField(),n))}return e.he}function Qn(r){const e=Ne(r);return e.Pe||(e.Pe=vA(e,Fl(r))),e.Pe}function vA(r,e){if(r.limitType==="F")return _p(r.path,r.collectionGroup,e,r.filters,r.limit,r.startAt,r.endAt);{e=e.map(i=>{const a=i.dir==="desc"?"asc":"desc";return new ph(i.field,a)});const t=r.endAt?new Aa(r.endAt.position,r.endAt.inclusive):null,n=r.startAt?new Aa(r.startAt.position,r.startAt.inclusive):null;return _p(r.path,r.collectionGroup,e,r.filters,r.limit,t,n)}}function wp(r,e,t){return new qh(r.path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),e,t,r.startAt,r.endAt)}function Gh(r,e){return lu(Qn(r),Qn(e))&&r.limitType===e.limitType}function g0(r){return`${co(Qn(r))}|lt:${r.limitType}`}function da(r){return`Query(target=${function(t){let n=t.path.canonicalString();return t.collectionGroup!==null&&(n+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(n+=`, filters: [${t.filters.map(i=>d0(i)).join(", ")}]`),Lh(t.limit)||(n+=", limit: "+t.limit),t.orderBy.length>0&&(n+=`, orderBy: [${t.orderBy.map(i=>function(u){return`${u.field.canonicalString()} (${u.dir})`}(i)).join(", ")}]`),t.startAt&&(n+=", startAt: ",n+=t.startAt.inclusive?"b:":"a:",n+=t.startAt.position.map(i=>Ca(i)).join(",")),t.endAt&&(n+=", endAt: ",n+=t.endAt.inclusive?"a:":"b:",n+=t.endAt.position.map(i=>Ca(i)).join(",")),`Target(${n})`}(Qn(r))}; limitType=${r.limitType})`}function uu(r,e){return e.isFoundDocument()&&function(n,i){const a=i.key.path;return n.collectionGroup!==null?i.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(a):_e.isDocumentKey(n.path)?n.path.isEqual(a):n.path.isImmediateParentOf(a)}(r,e)&&function(n,i){for(const a of Fl(n))if(!a.field.isKeyField()&&i.data.field(a.field)===null)return!1;return!0}(r,e)&&function(n,i){for(const a of n.filters)if(!a.matches(i))return!1;return!0}(r,e)&&function(n,i){return!(n.startAt&&!function(u,c,d){const p=Pv(u,c,d);return u.inclusive?p<=0:p<0}(n.startAt,Fl(n),i)||n.endAt&&!function(u,c,d){const p=Pv(u,c,d);return u.inclusive?p>=0:p>0}(n.endAt,Fl(n),i))}(r,e)}function y0(r){return r.collectionGroup||(r.path.length%2==1?r.path.lastSegment():r.path.get(r.path.length-2))}function v0(r){return(e,t)=>{let n=!1;for(const i of Fl(r)){const a=_A(i,e,t);if(a!==0)return a;n=n||i.field.isKeyField()}return 0}}function _A(r,e,t){const n=r.field.isKeyField()?_e.comparator(e.key,t.key):function(a,u,c){const d=u.data.field(a),p=c.data.field(a);return d!==null&&p!==null?mi(d,p):Ae()}(r.field,e,t);switch(r.dir){case"asc":return n;case"desc":return-1*n;default:return Ae()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xs{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(n!==void 0){for(const[i,a]of n)if(this.equalsFn(i,e))return a}}has(e){return this.get(e)!==void 0}set(e,t){const n=this.mapKeyFn(e),i=this.inner[n];if(i===void 0)return this.inner[n]=[[e,t]],void this.innerSize++;for(let a=0;a<i.length;a++)if(this.equalsFn(i[a][0],e))return void(i[a]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(n===void 0)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],e))return n.length===1?delete this.inner[t]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(e){au(this.inner,(t,n)=>{for(const[i,a]of n)e(i,a)})}isEmpty(){return sA(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wA=new yt(_e.comparator);function ur(){return wA}const _0=new yt(_e.comparator);function kl(...r){let e=_0;for(const t of r)e=e.insert(t.key,t);return e}function EA(r){let e=_0;return r.forEach((t,n)=>e=e.insert(t,n.overlayedDocument)),e}function Yr(){return Ll()}function w0(){return Ll()}function Ll(){return new xs(r=>r.toString(),(r,e)=>r.isEqual(e))}const TA=new yt(_e.comparator),IA=new st(_e.comparator);function $e(...r){let e=IA;for(const t of r)e=e.add(t);return e}const SA=new st(Le);function tm(){return SA}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CA(r,e){if(r.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Wl(e)?"-0":e}}function AA(r){return{integerValue:""+r}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kh{constructor(){this._=void 0}}function xA(r,e,t){return r instanceof Jl?function(i,a){const u={fields:{[e0]:{stringValue:Jw},[n0]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return a&&Zp(a)&&(a=Uh(a)),a&&(u.fields[t0]=a),{mapValue:u}}(t,e):r instanceof Na?E0(r,e):r instanceof Ra?T0(r,e):function(i,a){const u=RA(i,a),c=Mv(u)+Mv(i.Ie);return gp(u)&&gp(i.Ie)?AA(c):CA(i.serializer,c)}(r,e)}function NA(r,e,t){return r instanceof Na?E0(r,e):r instanceof Ra?T0(r,e):t}function RA(r,e){return r instanceof eu?function(n){return gp(n)||function(a){return!!a&&"doubleValue"in a}(n)}(e)?e:{integerValue:0}:null}class Jl extends Kh{}class Na extends Kh{constructor(e){super(),this.elements=e}}function E0(r,e){const t=I0(e);for(const n of r.elements)t.some(i=>Zr(i,n))||t.push(n);return{arrayValue:{values:t}}}class Ra extends Kh{constructor(e){super(),this.elements=e}}function T0(r,e){let t=I0(e);for(const n of r.elements)t=t.filter(i=>!Zr(i,n));return{arrayValue:{values:t}}}class eu extends Kh{constructor(e,t){super(),this.serializer=e,this.Ie=t}}function Mv(r){return wt(r.integerValue||r.doubleValue)}function I0(r){return Zl(r)&&r.arrayValue.values?r.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PA{constructor(e,t){this.field=e,this.transform=t}}function kA(r,e){return r.field.isEqual(e.field)&&function(n,i){return n instanceof Na&&i instanceof Na||n instanceof Ra&&i instanceof Ra?_a(n.elements,i.elements,Zr):n instanceof eu&&i instanceof eu?Zr(n.Ie,i.Ie):n instanceof Jl&&i instanceof Jl}(r.transform,e.transform)}class bA{constructor(e,t){this.version=e,this.transformResults=t}}class kr{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new kr}static exists(e){return new kr(void 0,e)}static updateTime(e){return new kr(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Jc(r,e){return r.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(r.updateTime):r.exists===void 0||r.exists===e.isFoundDocument()}class Hh{}function S0(r,e){if(!r.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return r.isNoDocument()?new nm(r.key,kr.none()):new cu(r.key,r.data,kr.none());{const t=r.data,n=lr.empty();let i=new st(bt.comparator);for(let a of e.fields)if(!i.has(a)){let u=t.field(a);u===null&&a.length>1&&(a=a.popLast(),u=t.field(a)),u===null?n.delete(a):n.set(a,u),i=i.add(a)}return new Fa(r.key,n,new ws(i.toArray()),kr.none())}}function DA(r,e,t){r instanceof cu?function(i,a,u){const c=i.value.clone(),d=Fv(i.fieldTransforms,a,u.transformResults);c.setAll(d),a.convertToFoundDocument(u.version,c).setHasCommittedMutations()}(r,e,t):r instanceof Fa?function(i,a,u){if(!Jc(i.precondition,a))return void a.convertToUnknownDocument(u.version);const c=Fv(i.fieldTransforms,a,u.transformResults),d=a.data;d.setAll(C0(i)),d.setAll(c),a.convertToFoundDocument(u.version,d).setHasCommittedMutations()}(r,e,t):function(i,a,u){a.convertToNoDocument(u.version).setHasCommittedMutations()}(0,e,t)}function jl(r,e,t,n){return r instanceof cu?function(a,u,c,d){if(!Jc(a.precondition,u))return c;const p=a.value.clone(),g=Lv(a.fieldTransforms,d,u);return p.setAll(g),u.convertToFoundDocument(u.version,p).setHasLocalMutations(),null}(r,e,t,n):r instanceof Fa?function(a,u,c,d){if(!Jc(a.precondition,u))return c;const p=Lv(a.fieldTransforms,d,u),g=u.data;return g.setAll(C0(a)),g.setAll(p),u.convertToFoundDocument(u.version,g).setHasLocalMutations(),c===null?null:c.unionWith(a.fieldMask.fields).unionWith(a.fieldTransforms.map(_=>_.field))}(r,e,t,n):function(a,u,c){return Jc(a.precondition,u)?(u.convertToNoDocument(u.version).setHasLocalMutations(),null):c}(r,e,t)}function Ov(r,e){return r.type===e.type&&!!r.key.isEqual(e.key)&&!!r.precondition.isEqual(e.precondition)&&!!function(n,i){return n===void 0&&i===void 0||!(!n||!i)&&_a(n,i,(a,u)=>kA(a,u))}(r.fieldTransforms,e.fieldTransforms)&&(r.type===0?r.value.isEqual(e.value):r.type!==1||r.data.isEqual(e.data)&&r.fieldMask.isEqual(e.fieldMask))}class cu extends Hh{constructor(e,t,n,i=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Fa extends Hh{constructor(e,t,n,i,a=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=i,this.fieldTransforms=a,this.type=1}getFieldMask(){return this.fieldMask}}function C0(r){const e=new Map;return r.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const n=r.data.field(t);e.set(t,n)}}),e}function Fv(r,e,t){const n=new Map;ke(r.length===t.length);for(let i=0;i<t.length;i++){const a=r[i],u=a.transform,c=e.data.field(a.field);n.set(a.field,NA(u,c,t[i]))}return n}function Lv(r,e,t){const n=new Map;for(const i of r){const a=i.transform,u=t.data.field(i.field);n.set(i.field,xA(a,u,e))}return n}class nm extends Hh{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class A0 extends Hh{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rm{constructor(e,t,n,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const a=this.mutations[i];a.key.isEqual(e.key)&&DA(a,e,n[i])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=jl(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=jl(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=w0();return this.mutations.forEach(i=>{const a=e.get(i.key),u=a.overlayedDocument;let c=this.applyToLocalView(u,a.mutatedFields);c=t.has(i.key)?null:c;const d=S0(u,c);d!==null&&n.set(i.key,d),u.isValidDocument()||u.convertToNoDocument(De.min())}),n}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),$e())}isEqual(e){return this.batchId===e.batchId&&_a(this.mutations,e.mutations,(t,n)=>Ov(t,n))&&_a(this.baseMutations,e.baseMutations,(t,n)=>Ov(t,n))}}class sm{constructor(e,t,n,i){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=i}static from(e,t,n){ke(e.mutations.length===n.length);let i=function(){return TA}();const a=e.mutations;for(let u=0;u<a.length;u++)i=i.insert(a[u].key,n[u].version);return new sm(e,t,n,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class im{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VA{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ft,He;function MA(r){switch(r){case ie.OK:return Ae();case ie.CANCELLED:case ie.UNKNOWN:case ie.DEADLINE_EXCEEDED:case ie.RESOURCE_EXHAUSTED:case ie.INTERNAL:case ie.UNAVAILABLE:case ie.UNAUTHENTICATED:return!1;case ie.INVALID_ARGUMENT:case ie.NOT_FOUND:case ie.ALREADY_EXISTS:case ie.PERMISSION_DENIED:case ie.FAILED_PRECONDITION:case ie.ABORTED:case ie.OUT_OF_RANGE:case ie.UNIMPLEMENTED:case ie.DATA_LOSS:return!0;default:return Ae()}}function x0(r){if(r===void 0)return kt("GRPC error has no .code"),ie.UNKNOWN;switch(r){case Ft.OK:return ie.OK;case Ft.CANCELLED:return ie.CANCELLED;case Ft.UNKNOWN:return ie.UNKNOWN;case Ft.DEADLINE_EXCEEDED:return ie.DEADLINE_EXCEEDED;case Ft.RESOURCE_EXHAUSTED:return ie.RESOURCE_EXHAUSTED;case Ft.INTERNAL:return ie.INTERNAL;case Ft.UNAVAILABLE:return ie.UNAVAILABLE;case Ft.UNAUTHENTICATED:return ie.UNAUTHENTICATED;case Ft.INVALID_ARGUMENT:return ie.INVALID_ARGUMENT;case Ft.NOT_FOUND:return ie.NOT_FOUND;case Ft.ALREADY_EXISTS:return ie.ALREADY_EXISTS;case Ft.PERMISSION_DENIED:return ie.PERMISSION_DENIED;case Ft.FAILED_PRECONDITION:return ie.FAILED_PRECONDITION;case Ft.ABORTED:return ie.ABORTED;case Ft.OUT_OF_RANGE:return ie.OUT_OF_RANGE;case Ft.UNIMPLEMENTED:return ie.UNIMPLEMENTED;case Ft.DATA_LOSS:return ie.DATA_LOSS;default:return Ae()}}(He=Ft||(Ft={}))[He.OK=0]="OK",He[He.CANCELLED=1]="CANCELLED",He[He.UNKNOWN=2]="UNKNOWN",He[He.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",He[He.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",He[He.NOT_FOUND=5]="NOT_FOUND",He[He.ALREADY_EXISTS=6]="ALREADY_EXISTS",He[He.PERMISSION_DENIED=7]="PERMISSION_DENIED",He[He.UNAUTHENTICATED=16]="UNAUTHENTICATED",He[He.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",He[He.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",He[He.ABORTED=10]="ABORTED",He[He.OUT_OF_RANGE=11]="OUT_OF_RANGE",He[He.UNIMPLEMENTED=12]="UNIMPLEMENTED",He[He.INTERNAL=13]="INTERNAL",He[He.UNAVAILABLE=14]="UNAVAILABLE",He[He.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OA(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FA=new hi([4294967295,4294967295],0);function jv(r){const e=OA().encode(r),t=new Pw;return t.update(e),new Uint8Array(t.digest())}function Bv(r){const e=new DataView(r.buffer),t=e.getUint32(0,!0),n=e.getUint32(4,!0),i=e.getUint32(8,!0),a=e.getUint32(12,!0);return[new hi([t,n],0),new hi([i,a],0)]}class om{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new bl(`Invalid padding: ${t}`);if(n<0)throw new bl(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new bl(`Invalid hash count: ${n}`);if(e.length===0&&t!==0)throw new bl(`Invalid padding when bitmap length is 0: ${t}`);this.Ee=8*e.length-t,this.de=hi.fromNumber(this.Ee)}Ae(e,t,n){let i=e.add(t.multiply(hi.fromNumber(n)));return i.compare(FA)===1&&(i=new hi([i.getBits(0),i.getBits(1)],0)),i.modulo(this.de).toNumber()}Re(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.Ee===0)return!1;const t=jv(e),[n,i]=Bv(t);for(let a=0;a<this.hashCount;a++){const u=this.Ae(n,i,a);if(!this.Re(u))return!1}return!0}static create(e,t,n){const i=e%8==0?0:8-e%8,a=new Uint8Array(Math.ceil(e/8)),u=new om(a,i,t);return n.forEach(c=>u.insert(c)),u}insert(e){if(this.Ee===0)return;const t=jv(e),[n,i]=Bv(t);for(let a=0;a<this.hashCount;a++){const u=this.Ae(n,i,a);this.Ve(u)}}Ve(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class bl extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hu{constructor(e,t,n,i,a){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=a}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const i=new Map;return i.set(e,du.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new hu(De.min(),i,new yt(Le),ur(),$e())}}class du{constructor(e,t,n,i,a){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=a}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new du(n,t,$e(),$e(),$e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eh{constructor(e,t,n,i){this.me=e,this.removedTargetIds=t,this.key=n,this.fe=i}}class N0{constructor(e,t){this.targetId=e,this.ge=t}}class R0{constructor(e,t,n=Dt.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=i}}class zv{constructor(){this.pe=0,this.ye=Uv(),this.we=Dt.EMPTY_BYTE_STRING,this.be=!1,this.Se=!0}get current(){return this.be}get resumeToken(){return this.we}get De(){return this.pe!==0}get ve(){return this.Se}Ce(e){e.approximateByteSize()>0&&(this.Se=!0,this.we=e)}Fe(){let e=$e(),t=$e(),n=$e();return this.ye.forEach((i,a)=>{switch(a){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:n=n.add(i);break;default:Ae()}}),new du(this.we,this.be,e,t,n)}Me(){this.Se=!1,this.ye=Uv()}xe(e,t){this.Se=!0,this.ye=this.ye.insert(e,t)}Oe(e){this.Se=!0,this.ye=this.ye.remove(e)}Ne(){this.pe+=1}Be(){this.pe-=1,ke(this.pe>=0)}Le(){this.Se=!0,this.be=!0}}class LA{constructor(e){this.ke=e,this.qe=new Map,this.Qe=ur(),this.$e=Bc(),this.Ke=Bc(),this.Ue=new yt(Le)}We(e){for(const t of e.me)e.fe&&e.fe.isFoundDocument()?this.Ge(t,e.fe):this.ze(t,e.key,e.fe);for(const t of e.removedTargetIds)this.ze(t,e.key,e.fe)}je(e){this.forEachTarget(e,t=>{const n=this.He(t);switch(e.state){case 0:this.Je(t)&&n.Ce(e.resumeToken);break;case 1:n.Be(),n.De||n.Me(),n.Ce(e.resumeToken);break;case 2:n.Be(),n.De||this.removeTarget(t);break;case 3:this.Je(t)&&(n.Le(),n.Ce(e.resumeToken));break;case 4:this.Je(t)&&(this.Ye(t),n.Ce(e.resumeToken));break;default:Ae()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.qe.forEach((n,i)=>{this.Je(i)&&t(i)})}Ze(e){const t=e.targetId,n=e.ge.count,i=this.Xe(t);if(i){const a=i.target;if(mh(a))if(n===0){const u=new _e(a.path);this.ze(t,u,At.newNoDocument(u,De.min()))}else ke(n===1);else{const u=this.et(t);if(u!==n){const c=this.tt(e),d=c?this.nt(c,e,u):1;if(d!==0){this.Ye(t);const p=d===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ue=this.Ue.insert(t,p)}}}}}tt(e){const t=e.ge.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:n="",padding:i=0},hashCount:a=0}=t;let u,c;try{u=As(n).toUint8Array()}catch(d){if(d instanceof Zw)return $l("Decoding the base64 bloom filter in existence filter failed ("+d.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw d}try{c=new om(u,i,a)}catch(d){return $l(d instanceof bl?"BloomFilter error: ":"Applying bloom filter failed: ",d),null}return c.Ee===0?null:c}nt(e,t,n){return t.ge.count===n-this.st(e,t.targetId)?0:2}st(e,t){const n=this.ke.getRemoteKeysForTarget(t);let i=0;return n.forEach(a=>{const u=this.ke.it(),c=`projects/${u.projectId}/databases/${u.database}/documents/${a.path.canonicalString()}`;e.mightContain(c)||(this.ze(t,a,null),i++)}),i}ot(e){const t=new Map;this.qe.forEach((a,u)=>{const c=this.Xe(u);if(c){if(a.current&&mh(c.target)){const d=new _e(c.target.path);this._t(d).has(u)||this.ut(u,d)||this.ze(u,d,At.newNoDocument(d,e))}a.ve&&(t.set(u,a.Fe()),a.Me())}});let n=$e();this.Ke.forEach((a,u)=>{let c=!0;u.forEachWhile(d=>{const p=this.Xe(d);return!p||p.purpose==="TargetPurposeLimboResolution"||(c=!1,!1)}),c&&(n=n.add(a))}),this.Qe.forEach((a,u)=>u.setReadTime(e));const i=new hu(e,t,this.Ue,this.Qe,n);return this.Qe=ur(),this.$e=Bc(),this.Ke=Bc(),this.Ue=new yt(Le),i}Ge(e,t){if(!this.Je(e))return;const n=this.ut(e,t.key)?2:0;this.He(e).xe(t.key,n),this.Qe=this.Qe.insert(t.key,t),this.$e=this.$e.insert(t.key,this._t(t.key).add(e)),this.Ke=this.Ke.insert(t.key,this.ct(t.key).add(e))}ze(e,t,n){if(!this.Je(e))return;const i=this.He(e);this.ut(e,t)?i.xe(t,1):i.Oe(t),this.Ke=this.Ke.insert(t,this.ct(t).delete(e)),this.Ke=this.Ke.insert(t,this.ct(t).add(e)),n&&(this.Qe=this.Qe.insert(t,n))}removeTarget(e){this.qe.delete(e)}et(e){const t=this.He(e).Fe();return this.ke.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ne(e){this.He(e).Ne()}He(e){let t=this.qe.get(e);return t||(t=new zv,this.qe.set(e,t)),t}ct(e){let t=this.Ke.get(e);return t||(t=new st(Le),this.Ke=this.Ke.insert(e,t)),t}_t(e){let t=this.$e.get(e);return t||(t=new st(Le),this.$e=this.$e.insert(e,t)),t}Je(e){const t=this.Xe(e)!==null;return t||le("WatchChangeAggregator","Detected inactive target",e),t}Xe(e){const t=this.qe.get(e);return t&&t.De?null:this.ke.lt(e)}Ye(e){this.qe.set(e,new zv),this.ke.getRemoteKeysForTarget(e).forEach(t=>{this.ze(e,t,null)})}ut(e,t){return this.ke.getRemoteKeysForTarget(e).has(t)}}function Bc(){return new yt(_e.comparator)}function Uv(){return new yt(_e.comparator)}const jA={asc:"ASCENDING",desc:"DESCENDING"},BA={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},zA={and:"AND",or:"OR"};class UA{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Ep(r,e){return r.useProto3Json||Lh(e)?e:{value:e}}function yh(r,e){return r.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function $A(r,e){return r.useProto3Json?e.toBase64():e.toUint8Array()}function qA(r,e){return yh(r,e.toTimestamp())}function En(r){return ke(!!r),De.fromTimestamp(function(t){const n=Cs(t);return new Xt(n.seconds,n.nanos)}(r))}function P0(r,e){return Tp(r,e).canonicalString()}function Tp(r,e){const t=function(i){return new lt(["projects",i.projectId,"databases",i.database])}(r).child("documents");return e===void 0?t:t.child(e)}function k0(r){const e=lt.fromString(r);return ke(B0(e)),e}function vh(r,e){return P0(r.databaseId,e.path)}function oo(r,e){const t=k0(e);if(t.get(1)!==r.databaseId.projectId)throw new Ce(ie.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+r.databaseId.projectId);if(t.get(3)!==r.databaseId.database)throw new Ce(ie.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+r.databaseId.database);return new _e(V0(t))}function b0(r,e){return P0(r.databaseId,e)}function D0(r){const e=k0(r);return e.length===4?lt.emptyPath():V0(e)}function Ip(r){return new lt(["projects",r.databaseId.projectId,"databases",r.databaseId.database]).canonicalString()}function V0(r){return ke(r.length>4&&r.get(4)==="documents"),r.popFirst(5)}function $v(r,e,t){return{name:vh(r,e),fields:t.value.mapValue.fields}}function WA(r,e,t){const n=oo(r,e.name),i=En(e.updateTime),a=e.createTime?En(e.createTime):De.min(),u=new lr({mapValue:{fields:e.fields}}),c=At.newFoundDocument(n,i,a,u);return t&&c.setHasCommittedMutations(),t?c.setHasCommittedMutations():c}function GA(r,e){let t;if("targetChange"in e){e.targetChange;const n=function(p){return p==="NO_CHANGE"?0:p==="ADD"?1:p==="REMOVE"?2:p==="CURRENT"?3:p==="RESET"?4:Ae()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],a=function(p,g){return p.useProto3Json?(ke(g===void 0||typeof g=="string"),Dt.fromBase64String(g||"")):(ke(g===void 0||g instanceof Buffer||g instanceof Uint8Array),Dt.fromUint8Array(g||new Uint8Array))}(r,e.targetChange.resumeToken),u=e.targetChange.cause,c=u&&function(p){const g=p.code===void 0?ie.UNKNOWN:x0(p.code);return new Ce(g,p.message||"")}(u);t=new R0(n,i,a,c||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const i=oo(r,n.document.name),a=En(n.document.updateTime),u=n.document.createTime?En(n.document.createTime):De.min(),c=new lr({mapValue:{fields:n.document.fields}}),d=At.newFoundDocument(i,a,u,c),p=n.targetIds||[],g=n.removedTargetIds||[];t=new eh(p,g,d.key,d)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const i=oo(r,n.document),a=n.readTime?En(n.readTime):De.min(),u=At.newNoDocument(i,a),c=n.removedTargetIds||[];t=new eh([],c,u.key,u)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const i=oo(r,n.document),a=n.removedTargetIds||[];t=new eh([],a,i,null)}else{if(!("filter"in e))return Ae();{e.filter;const n=e.filter;n.targetId;const{count:i=0,unchangedNames:a}=n,u=new VA(i,a),c=n.targetId;t=new N0(c,u)}}return t}function _h(r,e){let t;if(e instanceof cu)t={update:$v(r,e.key,e.value)};else if(e instanceof nm)t={delete:vh(r,e.key)};else if(e instanceof Fa)t={update:$v(r,e.key,e.data),updateMask:ZA(e.fieldMask)};else{if(!(e instanceof A0))return Ae();t={verify:vh(r,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(n=>function(a,u){const c=u.transform;if(c instanceof Jl)return{fieldPath:u.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof Na)return{fieldPath:u.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof Ra)return{fieldPath:u.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof eu)return{fieldPath:u.field.canonicalString(),increment:c.Ie};throw Ae()}(0,n))),e.precondition.isNone||(t.currentDocument=function(i,a){return a.updateTime!==void 0?{updateTime:qA(i,a.updateTime)}:a.exists!==void 0?{exists:a.exists}:Ae()}(r,e.precondition)),t}function Sp(r,e){const t=e.currentDocument?function(a){return a.updateTime!==void 0?kr.updateTime(En(a.updateTime)):a.exists!==void 0?kr.exists(a.exists):kr.none()}(e.currentDocument):kr.none(),n=e.updateTransforms?e.updateTransforms.map(i=>function(u,c){let d=null;if("setToServerValue"in c)ke(c.setToServerValue==="REQUEST_TIME"),d=new Jl;else if("appendMissingElements"in c){const g=c.appendMissingElements.values||[];d=new Na(g)}else if("removeAllFromArray"in c){const g=c.removeAllFromArray.values||[];d=new Ra(g)}else"increment"in c?d=new eu(u,c.increment):Ae();const p=bt.fromServerFormat(c.fieldPath);return new PA(p,d)}(r,i)):[];if(e.update){e.update.name;const i=oo(r,e.update.name),a=new lr({mapValue:{fields:e.update.fields}});if(e.updateMask){const u=function(d){const p=d.fieldPaths||[];return new ws(p.map(g=>bt.fromServerFormat(g)))}(e.updateMask);return new Fa(i,a,u,t,n)}return new cu(i,a,t,n)}if(e.delete){const i=oo(r,e.delete);return new nm(i,t)}if(e.verify){const i=oo(r,e.verify);return new A0(i,t)}return Ae()}function KA(r,e){return r&&r.length>0?(ke(e!==void 0),r.map(t=>function(i,a){let u=i.updateTime?En(i.updateTime):En(a);return u.isEqual(De.min())&&(u=En(a)),new bA(u,i.transformResults||[])}(t,e))):[]}function M0(r,e){return{documents:[b0(r,e.path)]}}function O0(r,e){const t={structuredQuery:{}},n=e.path;let i;e.collectionGroup!==null?(i=n,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=n.popLast(),t.structuredQuery.from=[{collectionId:n.lastSegment()}]),t.parent=b0(r,i);const a=function(p){if(p.length!==0)return j0(ot.create(p,"and"))}(e.filters);a&&(t.structuredQuery.where=a);const u=function(p){if(p.length!==0)return p.map(g=>function(E){return{field:fa(E.field),direction:QA(E.dir)}}(g))}(e.orderBy);u&&(t.structuredQuery.orderBy=u);const c=Ep(r,e.limit);return c!==null&&(t.structuredQuery.limit=c),e.startAt&&(t.structuredQuery.startAt=function(p){return{before:p.inclusive,values:p.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(p){return{before:!p.inclusive,values:p.position}}(e.endAt)),{ht:t,parent:i}}function F0(r){let e=D0(r.parent);const t=r.structuredQuery,n=t.from?t.from.length:0;let i=null;if(n>0){ke(n===1);const g=t.from[0];g.allDescendants?i=g.collectionId:e=e.child(g.collectionId)}let a=[];t.where&&(a=function(_){const E=L0(_);return E instanceof ot&&em(E)?E.getFilters():[E]}(t.where));let u=[];t.orderBy&&(u=function(_){return _.map(E=>function(A){return new ph(pa(A.field),function(D){switch(D){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(A.direction))}(E))}(t.orderBy));let c=null;t.limit&&(c=function(_){let E;return E=typeof _=="object"?_.value:_,Lh(E)?null:E}(t.limit));let d=null;t.startAt&&(d=function(_){const E=!!_.before,C=_.values||[];return new Aa(C,E)}(t.startAt));let p=null;return t.endAt&&(p=function(_){const E=!_.before,C=_.values||[];return new Aa(C,E)}(t.endAt)),m0(e,i,u,a,c,"F",d,p)}function HA(r,e){const t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Ae()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function L0(r){return r.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const n=pa(t.unaryFilter.field);return Ge.create(n,"==",{doubleValue:NaN});case"IS_NULL":const i=pa(t.unaryFilter.field);return Ge.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const a=pa(t.unaryFilter.field);return Ge.create(a,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const u=pa(t.unaryFilter.field);return Ge.create(u,"!=",{nullValue:"NULL_VALUE"});default:return Ae()}}(r):r.fieldFilter!==void 0?function(t){return Ge.create(pa(t.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Ae()}}(t.fieldFilter.op),t.fieldFilter.value)}(r):r.compositeFilter!==void 0?function(t){return ot.create(t.compositeFilter.filters.map(n=>L0(n)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return Ae()}}(t.compositeFilter.op))}(r):Ae()}function QA(r){return jA[r]}function XA(r){return BA[r]}function YA(r){return zA[r]}function fa(r){return{fieldPath:r.canonicalString()}}function pa(r){return bt.fromServerFormat(r.fieldPath)}function j0(r){return r instanceof Ge?function(t){if(t.op==="=="){if(xv(t.value))return{unaryFilter:{field:fa(t.field),op:"IS_NAN"}};if(Av(t.value))return{unaryFilter:{field:fa(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(xv(t.value))return{unaryFilter:{field:fa(t.field),op:"IS_NOT_NAN"}};if(Av(t.value))return{unaryFilter:{field:fa(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:fa(t.field),op:XA(t.op),value:t.value}}}(r):r instanceof ot?function(t){const n=t.getFilters().map(i=>j0(i));return n.length===1?n[0]:{compositeFilter:{op:YA(t.op),filters:n}}}(r):Ae()}function ZA(r){const e=[];return r.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function B0(r){return r.length>=4&&r.get(0)==="projects"&&r.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Es{constructor(e,t,n,i,a=De.min(),u=De.min(),c=Dt.EMPTY_BYTE_STRING,d=null){this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=u,this.resumeToken=c,this.expectedCount=d}withSequenceNumber(e){return new Es(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Es(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Es(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Es(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z0{constructor(e){this.Tt=e}}function JA(r,e){let t;if(e.document)t=WA(r.Tt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const n=_e.fromSegments(e.noDocument.path),i=fo(e.noDocument.readTime);t=At.newNoDocument(n,i),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return Ae();{const n=_e.fromSegments(e.unknownDocument.path),i=fo(e.unknownDocument.version);t=At.newUnknownDocument(n,i)}}return e.readTime&&t.setReadTime(function(i){const a=new Xt(i[0],i[1]);return De.fromTimestamp(a)}(e.readTime)),t}function qv(r,e){const t=e.key,n={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:wh(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())n.document=function(a,u){return{name:vh(a,u.key),fields:u.data.value.mapValue.fields,updateTime:yh(a,u.version.toTimestamp()),createTime:yh(a,u.createTime.toTimestamp())}}(r.Tt,e);else if(e.isNoDocument())n.noDocument={path:t.path.toArray(),readTime:ho(e.version)};else{if(!e.isUnknownDocument())return Ae();n.unknownDocument={path:t.path.toArray(),version:ho(e.version)}}return n}function wh(r){const e=r.toTimestamp();return[e.seconds,e.nanoseconds]}function ho(r){const e=r.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function fo(r){const e=new Xt(r.seconds,r.nanoseconds);return De.fromTimestamp(e)}function eo(r,e){const t=(e.baseMutations||[]).map(a=>Sp(r.Tt,a));for(let a=0;a<e.mutations.length-1;++a){const u=e.mutations[a];if(a+1<e.mutations.length&&e.mutations[a+1].transform!==void 0){const c=e.mutations[a+1];u.updateTransforms=c.transform.fieldTransforms,e.mutations.splice(a+1,1),++a}}const n=e.mutations.map(a=>Sp(r.Tt,a)),i=Xt.fromMillis(e.localWriteTimeMs);return new rm(e.batchId,i,t,n)}function Dl(r){const e=fo(r.readTime),t=r.lastLimboFreeSnapshotVersion!==void 0?fo(r.lastLimboFreeSnapshotVersion):De.min();let n;return n=function(a){return a.documents!==void 0}(r.query)?function(a){return ke(a.documents.length===1),Qn(Wh(D0(a.documents[0])))}(r.query):function(a){return Qn(F0(a))}(r.query),new Es(n,r.targetId,"TargetPurposeListen",r.lastListenSequenceNumber,e,t,Dt.fromBase64String(r.resumeToken))}function U0(r,e){const t=ho(e.snapshotVersion),n=ho(e.lastLimboFreeSnapshotVersion);let i;i=mh(e.target)?M0(r.Tt,e.target):O0(r.Tt,e.target).ht;const a=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:co(e.target),readTime:t,resumeToken:a,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:n,query:i}}function $0(r){const e=F0({parent:r.parent,structuredQuery:r.structuredQuery});return r.limitType==="LAST"?wp(e,e.limit,"L"):e}function Gf(r,e){return new im(e.largestBatchId,Sp(r.Tt,e.overlayMutation))}function Wv(r,e){const t=e.path.lastSegment();return[r,dn(e.path.popLast()),t]}function Gv(r,e,t,n){return{indexId:r,uid:e,sequenceNumber:t,readTime:ho(n.readTime),documentKey:dn(n.documentKey.path),largestBatchId:n.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ex{getBundleMetadata(e,t){return Kv(e).get(t).next(n=>{if(n)return function(a){return{id:a.bundleId,createTime:fo(a.createTime),version:a.version}}(n)})}saveBundleMetadata(e,t){return Kv(e).put(function(i){return{bundleId:i.id,createTime:ho(En(i.createTime)),version:i.version}}(t))}getNamedQuery(e,t){return Hv(e).get(t).next(n=>{if(n)return function(a){return{name:a.name,query:$0(a.bundledQuery),readTime:fo(a.readTime)}}(n)})}saveNamedQuery(e,t){return Hv(e).put(function(i){return{name:i.name,readTime:ho(En(i.readTime)),bundledQuery:i.bundledQuery}}(t))}}function Kv(r){return Ut(r,jh)}function Hv(r){return Ut(r,Bh)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qh{constructor(e,t){this.serializer=e,this.userId=t}static It(e,t){const n=t.uid||"";return new Qh(e,n)}getOverlay(e,t){return Cl(e).get(Wv(this.userId,t)).next(n=>n?Gf(this.serializer,n):null)}getOverlays(e,t){const n=Yr();return q.forEach(t,i=>this.getOverlay(e,i).next(a=>{a!==null&&n.set(i,a)})).next(()=>n)}saveOverlays(e,t,n){const i=[];return n.forEach((a,u)=>{const c=new im(t,u);i.push(this.Et(e,c))}),q.waitFor(i)}removeOverlaysForBatchId(e,t,n){const i=new Set;t.forEach(u=>i.add(dn(u.getCollectionPath())));const a=[];return i.forEach(u=>{const c=IDBKeyRange.bound([this.userId,u,n],[this.userId,u,n+1],!1,!0);a.push(Cl(e).J(fp,c))}),q.waitFor(a)}getOverlaysForCollection(e,t,n){const i=Yr(),a=dn(t),u=IDBKeyRange.bound([this.userId,a,n],[this.userId,a,Number.POSITIVE_INFINITY],!0);return Cl(e).G(fp,u).next(c=>{for(const d of c){const p=Gf(this.serializer,d);i.set(p.getKey(),p)}return i})}getOverlaysForCollectionGroup(e,t,n,i){const a=Yr();let u;const c=IDBKeyRange.bound([this.userId,t,n],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Cl(e).Z({index:Hw,range:c},(d,p,g)=>{const _=Gf(this.serializer,p);a.size()<i||_.largestBatchId===u?(a.set(_.getKey(),_),u=_.largestBatchId):g.done()}).next(()=>a)}Et(e,t){return Cl(e).put(function(i,a,u){const[c,d,p]=Wv(a,u.mutation.key);return{userId:a,collectionPath:d,documentId:p,collectionGroup:u.mutation.key.getCollectionGroup(),largestBatchId:u.largestBatchId,overlayMutation:_h(i.Tt,u.mutation)}}(this.serializer,this.userId,t))}}function Cl(r){return Ut(r,zh)}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tx{dt(e){return Ut(e,Xp)}getSessionToken(e){return this.dt(e).get("sessionToken").next(t=>{const n=t==null?void 0:t.value;return n?Dt.fromUint8Array(n):Dt.EMPTY_BYTE_STRING})}setSessionToken(e,t){return this.dt(e).put({name:"sessionToken",value:t.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class to{constructor(){}At(e,t){this.Rt(e,t),t.Vt()}Rt(e,t){if("nullValue"in e)this.ft(t,5);else if("booleanValue"in e)this.ft(t,10),t.gt(e.booleanValue?1:0);else if("integerValue"in e)this.ft(t,15),t.gt(wt(e.integerValue));else if("doubleValue"in e){const n=wt(e.doubleValue);isNaN(n)?this.ft(t,13):(this.ft(t,15),Wl(n)?t.gt(0):t.gt(n))}else if("timestampValue"in e){let n=e.timestampValue;this.ft(t,20),typeof n=="string"&&(n=Cs(n)),t.yt(`${n.seconds||""}`),t.gt(n.nanos||0)}else if("stringValue"in e)this.wt(e.stringValue,t),this.bt(t);else if("bytesValue"in e)this.ft(t,30),t.St(As(e.bytesValue)),this.bt(t);else if("referenceValue"in e)this.Dt(e.referenceValue,t);else if("geoPointValue"in e){const n=e.geoPointValue;this.ft(t,45),t.gt(n.latitude||0),t.gt(n.longitude||0)}else"mapValue"in e?o0(e)?this.ft(t,Number.MAX_SAFE_INTEGER):$h(e)?this.vt(e.mapValue,t):(this.Ct(e.mapValue,t),this.bt(t)):"arrayValue"in e?(this.Ft(e.arrayValue,t),this.bt(t)):Ae()}wt(e,t){this.ft(t,25),this.Mt(e,t)}Mt(e,t){t.yt(e)}Ct(e,t){const n=e.fields||{};this.ft(t,55);for(const i of Object.keys(n))this.wt(i,t),this.Rt(n[i],t)}vt(e,t){var n,i;const a=e.fields||{};this.ft(t,53);const u=Xl,c=((i=(n=a[u].arrayValue)===null||n===void 0?void 0:n.values)===null||i===void 0?void 0:i.length)||0;this.ft(t,15),t.gt(wt(c)),this.wt(u,t),this.Rt(a[u],t)}Ft(e,t){const n=e.values||[];this.ft(t,50);for(const i of n)this.Rt(i,t)}Dt(e,t){this.ft(t,37),_e.fromName(e).path.forEach(n=>{this.ft(t,60),this.Mt(n,t)})}ft(e,t){e.gt(t)}bt(e){e.gt(2)}}to.xt=new to;/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law | agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES | CONDITIONS OF ANY KIND, either express | implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aa=255;function nx(r){if(r===0)return 8;let e=0;return r>>4||(e+=4,r<<=4),r>>6||(e+=2,r<<=2),r>>7||(e+=1),e}function Qv(r){const e=64-function(n){let i=0;for(let a=0;a<8;++a){const u=nx(255&n[a]);if(i+=u,u!==8)break}return i}(r);return Math.ceil(e/8)}class rx{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Ot(e){const t=e[Symbol.iterator]();let n=t.next();for(;!n.done;)this.Nt(n.value),n=t.next();this.Bt()}Lt(e){const t=e[Symbol.iterator]();let n=t.next();for(;!n.done;)this.kt(n.value),n=t.next();this.qt()}Qt(e){for(const t of e){const n=t.charCodeAt(0);if(n<128)this.Nt(n);else if(n<2048)this.Nt(960|n>>>6),this.Nt(128|63&n);else if(t<"\uD800"||"\uDBFF"<t)this.Nt(480|n>>>12),this.Nt(128|63&n>>>6),this.Nt(128|63&n);else{const i=t.codePointAt(0);this.Nt(240|i>>>18),this.Nt(128|63&i>>>12),this.Nt(128|63&i>>>6),this.Nt(128|63&i)}}this.Bt()}$t(e){for(const t of e){const n=t.charCodeAt(0);if(n<128)this.kt(n);else if(n<2048)this.kt(960|n>>>6),this.kt(128|63&n);else if(t<"\uD800"||"\uDBFF"<t)this.kt(480|n>>>12),this.kt(128|63&n>>>6),this.kt(128|63&n);else{const i=t.codePointAt(0);this.kt(240|i>>>18),this.kt(128|63&i>>>12),this.kt(128|63&i>>>6),this.kt(128|63&i)}}this.qt()}Kt(e){const t=this.Ut(e),n=Qv(t);this.Wt(1+n),this.buffer[this.position++]=255&n;for(let i=t.length-n;i<t.length;++i)this.buffer[this.position++]=255&t[i]}Gt(e){const t=this.Ut(e),n=Qv(t);this.Wt(1+n),this.buffer[this.position++]=~(255&n);for(let i=t.length-n;i<t.length;++i)this.buffer[this.position++]=~(255&t[i])}zt(){this.jt(aa),this.jt(255)}Ht(){this.Jt(aa),this.Jt(255)}reset(){this.position=0}seed(e){this.Wt(e.length),this.buffer.set(e,this.position),this.position+=e.length}Yt(){return this.buffer.slice(0,this.position)}Ut(e){const t=function(a){const u=new DataView(new ArrayBuffer(8));return u.setFloat64(0,a,!1),new Uint8Array(u.buffer)}(e),n=!!(128&t[0]);t[0]^=n?255:128;for(let i=1;i<t.length;++i)t[i]^=n?255:0;return t}Nt(e){const t=255&e;t===0?(this.jt(0),this.jt(255)):t===aa?(this.jt(aa),this.jt(0)):this.jt(t)}kt(e){const t=255&e;t===0?(this.Jt(0),this.Jt(255)):t===aa?(this.Jt(aa),this.Jt(0)):this.Jt(e)}Bt(){this.jt(0),this.jt(1)}qt(){this.Jt(0),this.Jt(1)}jt(e){this.Wt(1),this.buffer[this.position++]=e}Jt(e){this.Wt(1),this.buffer[this.position++]=~e}Wt(e){const t=e+this.position;if(t<=this.buffer.length)return;let n=2*this.buffer.length;n<t&&(n=t);const i=new Uint8Array(n);i.set(this.buffer),this.buffer=i}}class sx{constructor(e){this.Zt=e}St(e){this.Zt.Ot(e)}yt(e){this.Zt.Qt(e)}gt(e){this.Zt.Kt(e)}Vt(){this.Zt.zt()}}class ix{constructor(e){this.Zt=e}St(e){this.Zt.Lt(e)}yt(e){this.Zt.$t(e)}gt(e){this.Zt.Gt(e)}Vt(){this.Zt.Ht()}}class Al{constructor(){this.Zt=new rx,this.Xt=new sx(this.Zt),this.en=new ix(this.Zt)}seed(e){this.Zt.seed(e)}tn(e){return e===0?this.Xt:this.en}Yt(){return this.Zt.Yt()}reset(){this.Zt.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class no{constructor(e,t,n,i){this.indexId=e,this.documentKey=t,this.arrayValue=n,this.directionalValue=i}nn(){const e=this.directionalValue.length,t=e===0||this.directionalValue[e-1]===255?e+1:e,n=new Uint8Array(t);return n.set(this.directionalValue,0),t!==e?n.set([0],this.directionalValue.length):++n[n.length-1],new no(this.indexId,this.documentKey,this.arrayValue,n)}}function ei(r,e){let t=r.indexId-e.indexId;return t!==0?t:(t=Xv(r.arrayValue,e.arrayValue),t!==0?t:(t=Xv(r.directionalValue,e.directionalValue),t!==0?t:_e.comparator(r.documentKey,e.documentKey)))}function Xv(r,e){for(let t=0;t<r.length&&t<e.length;++t){const n=r[t]-e[t];if(n!==0)return n}return r.length-e.length}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yv{constructor(e){this.rn=new st((t,n)=>bt.comparator(t.field,n.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.sn=e.orderBy,this._n=[];for(const t of e.filters){const n=t;n.isInequality()?this.rn=this.rn.add(n):this._n.push(n)}}get an(){return this.rn.size>1}un(e){if(ke(e.collectionGroup===this.collectionId),this.an)return!1;const t=cp(e);if(t!==void 0&&!this.cn(t))return!1;const n=Yi(e);let i=new Set,a=0,u=0;for(;a<n.length&&this.cn(n[a]);++a)i=i.add(n[a].fieldPath.canonicalString());if(a===n.length)return!0;if(this.rn.size>0){const c=this.rn.getIterator().getNext();if(!i.has(c.field.canonicalString())){const d=n[a];if(!this.ln(c,d)||!this.hn(this.sn[u++],d))return!1}++a}for(;a<n.length;++a){const c=n[a];if(u>=this.sn.length||!this.hn(this.sn[u++],c))return!1}return!0}Pn(){if(this.an)return null;let e=new st(bt.comparator);const t=[];for(const n of this._n)if(!n.field.isKeyField())if(n.op==="array-contains"||n.op==="array-contains-any")t.push(new Hc(n.field,2));else{if(e.has(n.field))continue;e=e.add(n.field),t.push(new Hc(n.field,0))}for(const n of this.sn)n.field.isKeyField()||e.has(n.field)||(e=e.add(n.field),t.push(new Hc(n.field,n.dir==="asc"?0:1)));return new ah(ah.UNKNOWN_ID,this.collectionId,t,ql.empty())}cn(e){for(const t of this._n)if(this.ln(t,e))return!0;return!1}ln(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const n=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===n}hn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function q0(r){var e,t;if(ke(r instanceof Ge||r instanceof ot),r instanceof Ge){if(r instanceof p0){const i=((t=(e=r.value.arrayValue)===null||e===void 0?void 0:e.values)===null||t===void 0?void 0:t.map(a=>Ge.create(r.field,"==",a)))||[];return ot.create(i,"or")}return r}const n=r.filters.map(i=>q0(i));return ot.create(n,r.op)}function ox(r){if(r.getFilters().length===0)return[];const e=xp(q0(r));return ke(W0(e)),Cp(e)||Ap(e)?[e]:e.getFilters()}function Cp(r){return r instanceof Ge}function Ap(r){return r instanceof ot&&em(r)}function W0(r){return Cp(r)||Ap(r)||function(t){if(t instanceof ot&&yp(t)){for(const n of t.getFilters())if(!Cp(n)&&!Ap(n))return!1;return!0}return!1}(r)}function xp(r){if(ke(r instanceof Ge||r instanceof ot),r instanceof Ge)return r;if(r.filters.length===1)return xp(r.filters[0]);const e=r.filters.map(n=>xp(n));let t=ot.create(e,r.op);return t=Eh(t),W0(t)?t:(ke(t instanceof ot),ke(xa(t)),ke(t.filters.length>1),t.filters.reduce((n,i)=>am(n,i)))}function am(r,e){let t;return ke(r instanceof Ge||r instanceof ot),ke(e instanceof Ge||e instanceof ot),t=r instanceof Ge?e instanceof Ge?function(i,a){return ot.create([i,a],"and")}(r,e):Zv(r,e):e instanceof Ge?Zv(e,r):function(i,a){if(ke(i.filters.length>0&&a.filters.length>0),xa(i)&&xa(a))return h0(i,a.getFilters());const u=yp(i)?i:a,c=yp(i)?a:i,d=u.filters.map(p=>am(p,c));return ot.create(d,"or")}(r,e),Eh(t)}function Zv(r,e){if(xa(e))return h0(e,r.getFilters());{const t=e.filters.map(n=>am(r,n));return ot.create(t,"or")}}function Eh(r){if(ke(r instanceof Ge||r instanceof ot),r instanceof Ge)return r;const e=r.getFilters();if(e.length===1)return Eh(e[0]);if(u0(r))return r;const t=e.map(i=>Eh(i)),n=[];return t.forEach(i=>{i instanceof Ge?n.push(i):i instanceof ot&&(i.op===r.op?n.push(...i.filters):n.push(i))}),n.length===1?n[0]:ot.create(n,r.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ax{constructor(){this.Tn=new lm}addToCollectionParentIndex(e,t){return this.Tn.add(t),q.resolve()}getCollectionParents(e,t){return q.resolve(this.Tn.getEntries(t))}addFieldIndex(e,t){return q.resolve()}deleteFieldIndex(e,t){return q.resolve()}deleteAllFieldIndexes(e){return q.resolve()}createTargetIndexes(e,t){return q.resolve()}getDocumentsMatchingTarget(e,t){return q.resolve(null)}getIndexType(e,t){return q.resolve(0)}getFieldIndexes(e,t){return q.resolve([])}getNextCollectionGroupToUpdate(e){return q.resolve(null)}getMinOffset(e,t){return q.resolve(Xn.min())}getMinOffsetFromCollectionGroup(e,t){return q.resolve(Xn.min())}updateCollectionGroup(e,t,n){return q.resolve()}updateIndexEntries(e,t){return q.resolve()}}class lm{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),i=this.index[t]||new st(lt.comparator),a=!i.has(n);return this.index[t]=i.add(n),a}has(e){const t=e.lastSegment(),n=e.popLast(),i=this.index[t];return i&&i.has(n)}getEntries(e){return(this.index[e]||new st(lt.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jv="IndexedDbIndexManager",zc=new Uint8Array(0);class lx{constructor(e,t){this.databaseId=t,this.In=new lm,this.En=new xs(n=>co(n),(n,i)=>lu(n,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.In.has(t)){const n=t.lastSegment(),i=t.popLast();e.addOnCommittedListener(()=>{this.In.add(t)});const a={collectionId:n,parent:dn(i)};return e_(e).put(a)}return q.resolve()}getCollectionParents(e,t){const n=[],i=IDBKeyRange.bound([t,""],[Fw(t),""],!1,!0);return e_(e).G(i).next(a=>{for(const u of a){if(u.collectionId!==t)break;n.push(Xr(u.parent))}return n})}addFieldIndex(e,t){const n=xl(e),i=function(c){return{indexId:c.indexId,collectionGroup:c.collectionGroup,fields:c.fields.map(d=>[d.fieldPath.canonicalString(),d.kind])}}(t);delete i.indexId;const a=n.add(i);if(t.indexState){const u=ua(e);return a.next(c=>{u.put(Gv(c,this.uid,t.indexState.sequenceNumber,t.indexState.offset))})}return a.next()}deleteFieldIndex(e,t){const n=xl(e),i=ua(e),a=la(e);return n.delete(t.indexId).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>a.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const t=xl(e),n=la(e),i=ua(e);return t.J().next(()=>n.J()).next(()=>i.J())}createTargetIndexes(e,t){return q.forEach(this.dn(t),n=>this.getIndexType(e,n).next(i=>{if(i===0||i===1){const a=new Yv(n).Pn();if(a!=null)return this.addFieldIndex(e,a)}}))}getDocumentsMatchingTarget(e,t){const n=la(e);let i=!0;const a=new Map;return q.forEach(this.dn(t),u=>this.An(e,u).next(c=>{i&&(i=!!c),a.set(u,c)})).next(()=>{if(i){let u=$e();const c=[];return q.forEach(a,(d,p)=>{le(Jv,`Using index ${function($){return`id=${$.indexId}|cg=${$.collectionGroup}|f=${$.fields.map(X=>`${X.fieldPath}:${X.kind}`).join(",")}`}(d)} to execute ${co(t)}`);const g=function($,X){const F=cp(X);if(F===void 0)return null;for(const U of gh($,F.fieldPath))switch(U.op){case"array-contains-any":return U.value.arrayValue.values||[];case"array-contains":return[U.value]}return null}(p,d),_=function($,X){const F=new Map;for(const U of Yi(X))for(const N of gh($,U.fieldPath))switch(N.op){case"==":case"in":F.set(U.fieldPath.canonicalString(),N.value);break;case"not-in":case"!=":return F.set(U.fieldPath.canonicalString(),N.value),Array.from(F.values())}return null}(p,d),E=function($,X){const F=[];let U=!0;for(const N of Yi(X)){const I=N.kind===0?bv($,N.fieldPath,$.startAt):Dv($,N.fieldPath,$.startAt);F.push(I.value),U&&(U=I.inclusive)}return new Aa(F,U)}(p,d),C=function($,X){const F=[];let U=!0;for(const N of Yi(X)){const I=N.kind===0?Dv($,N.fieldPath,$.endAt):bv($,N.fieldPath,$.endAt);F.push(I.value),U&&(U=I.inclusive)}return new Aa(F,U)}(p,d),A=this.Rn(d,p,E),P=this.Rn(d,p,C),D=this.Vn(d,p,_),B=this.mn(d.indexId,g,A,E.inclusive,P,C.inclusive,D);return q.forEach(B,W=>n.H(W,t.limit).next($=>{$.forEach(X=>{const F=_e.fromSegments(X.documentKey);u.has(F)||(u=u.add(F),c.push(F))})}))}).next(()=>c)}return q.resolve(null)})}dn(e){let t=this.En.get(e);return t||(e.filters.length===0?t=[e]:t=ox(ot.create(e.filters,"and")).map(n=>_p(e.path,e.collectionGroup,e.orderBy,n.getFilters(),e.limit,e.startAt,e.endAt)),this.En.set(e,t),t)}mn(e,t,n,i,a,u,c){const d=(t!=null?t.length:1)*Math.max(n.length,a.length),p=d/(t!=null?t.length:1),g=[];for(let _=0;_<d;++_){const E=t?this.fn(t[_/p]):zc,C=this.gn(e,E,n[_%p],i),A=this.pn(e,E,a[_%p],u),P=c.map(D=>this.gn(e,E,D,!0));g.push(...this.createRange(C,A,P))}return g}gn(e,t,n,i){const a=new no(e,_e.empty(),t,n);return i?a:a.nn()}pn(e,t,n,i){const a=new no(e,_e.empty(),t,n);return i?a.nn():a}An(e,t){const n=new Yv(t),i=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,i).next(a=>{let u=null;for(const c of a)n.un(c)&&(!u||c.fields.length>u.fields.length)&&(u=c);return u})}getIndexType(e,t){let n=2;const i=this.dn(t);return q.forEach(i,a=>this.An(e,a).next(u=>{u?n!==0&&u.fields.length<function(d){let p=new st(bt.comparator),g=!1;for(const _ of d.filters)for(const E of _.getFlattenedFilters())E.field.isKeyField()||(E.op==="array-contains"||E.op==="array-contains-any"?g=!0:p=p.add(E.field));for(const _ of d.orderBy)_.field.isKeyField()||(p=p.add(_.field));return p.size+(g?1:0)}(a)&&(n=1):n=0})).next(()=>function(u){return u.limit!==null}(t)&&i.length>1&&n===2?1:n)}yn(e,t){const n=new Al;for(const i of Yi(e)){const a=t.data.field(i.fieldPath);if(a==null)return null;const u=n.tn(i.kind);to.xt.At(a,u)}return n.Yt()}fn(e){const t=new Al;return to.xt.At(e,t.tn(0)),t.Yt()}wn(e,t){const n=new Al;return to.xt.At(Jp(this.databaseId,t),n.tn(function(a){const u=Yi(a);return u.length===0?0:u[u.length-1].kind}(e))),n.Yt()}Vn(e,t,n){if(n===null)return[];let i=[];i.push(new Al);let a=0;for(const u of Yi(e)){const c=n[a++];for(const d of i)if(this.bn(t,u.fieldPath)&&Zl(c))i=this.Sn(i,u,c);else{const p=d.tn(u.kind);to.xt.At(c,p)}}return this.Dn(i)}Rn(e,t,n){return this.Vn(e,t,n.position)}Dn(e){const t=[];for(let n=0;n<e.length;++n)t[n]=e[n].Yt();return t}Sn(e,t,n){const i=[...e],a=[];for(const u of n.arrayValue.values||[])for(const c of i){const d=new Al;d.seed(c.Yt()),to.xt.At(u,d.tn(t.kind)),a.push(d)}return a}bn(e,t){return!!e.filters.find(n=>n instanceof Ge&&n.field.isEqual(t)&&(n.op==="in"||n.op==="not-in"))}getFieldIndexes(e,t){const n=xl(e),i=ua(e);return(t?n.G(dp,IDBKeyRange.bound(t,t)):n.G()).next(a=>{const u=[];return q.forEach(a,c=>i.get([c.indexId,this.uid]).next(d=>{u.push(function(g,_){const E=_?new ql(_.sequenceNumber,new Xn(fo(_.readTime),new _e(Xr(_.documentKey)),_.largestBatchId)):ql.empty(),C=g.fields.map(([A,P])=>new Hc(bt.fromServerFormat(A),P));return new ah(g.indexId,g.collectionGroup,C,E)}(c,d))})).next(()=>u)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>t.length===0?null:(t.sort((n,i)=>{const a=n.indexState.sequenceNumber-i.indexState.sequenceNumber;return a!==0?a:Le(n.collectionGroup,i.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,n){const i=xl(e),a=ua(e);return this.vn(e).next(u=>i.G(dp,IDBKeyRange.bound(t,t)).next(c=>q.forEach(c,d=>a.put(Gv(d.indexId,this.uid,u,n)))))}updateIndexEntries(e,t){const n=new Map;return q.forEach(t,(i,a)=>{const u=n.get(i.collectionGroup);return(u?q.resolve(u):this.getFieldIndexes(e,i.collectionGroup)).next(c=>(n.set(i.collectionGroup,c),q.forEach(c,d=>this.Cn(e,i,d).next(p=>{const g=this.Fn(a,d);return p.isEqual(g)?q.resolve():this.Mn(e,a,d,p,g)}))))})}xn(e,t,n,i){return la(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.wn(n,t.key),documentKey:t.key.path.toArray()})}On(e,t,n,i){return la(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.wn(n,t.key),t.key.path.toArray()])}Cn(e,t,n){const i=la(e);let a=new st(ei);return i.Z({index:Kw,range:IDBKeyRange.only([n.indexId,this.uid,this.wn(n,t)])},(u,c)=>{a=a.add(new no(n.indexId,t,c.arrayValue,c.directionalValue))}).next(()=>a)}Fn(e,t){let n=new st(ei);const i=this.yn(t,e);if(i==null)return n;const a=cp(t);if(a!=null){const u=e.data.field(a.fieldPath);if(Zl(u))for(const c of u.arrayValue.values||[])n=n.add(new no(t.indexId,e.key,this.fn(c),i))}else n=n.add(new no(t.indexId,e.key,zc,i));return n}Mn(e,t,n,i,a){le(Jv,"Updating index entries for document '%s'",t.key);const u=[];return function(d,p,g,_,E){const C=d.getIterator(),A=p.getIterator();let P=oa(C),D=oa(A);for(;P||D;){let B=!1,W=!1;if(P&&D){const $=g(P,D);$<0?W=!0:$>0&&(B=!0)}else P!=null?W=!0:B=!0;B?(_(D),D=oa(A)):W?(E(P),P=oa(C)):(P=oa(C),D=oa(A))}}(i,a,ei,c=>{u.push(this.xn(e,t,n,c))},c=>{u.push(this.On(e,t,n,c))}),q.waitFor(u)}vn(e){let t=1;return ua(e).Z({index:Gw,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(n,i,a)=>{a.done(),t=i.sequenceNumber+1}).next(()=>t)}createRange(e,t,n){n=n.sort((u,c)=>ei(u,c)).filter((u,c,d)=>!c||ei(u,d[c-1])!==0);const i=[];i.push(e);for(const u of n){const c=ei(u,e),d=ei(u,t);if(c===0)i[0]=e.nn();else if(c>0&&d<0)i.push(u),i.push(u.nn());else if(d>0)break}i.push(t);const a=[];for(let u=0;u<i.length;u+=2){if(this.Nn(i[u],i[u+1]))return[];const c=[i[u].indexId,this.uid,i[u].arrayValue,i[u].directionalValue,zc,[]],d=[i[u+1].indexId,this.uid,i[u+1].arrayValue,i[u+1].directionalValue,zc,[]];a.push(IDBKeyRange.bound(c,d))}return a}Nn(e,t){return ei(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(t_)}getMinOffset(e,t){return q.mapArray(this.dn(t),n=>this.An(e,n).next(i=>i||Ae())).next(t_)}}function e_(r){return Ut(r,Hl)}function la(r){return Ut(r,dh)}function xl(r){return Ut(r,Qp)}function ua(r){return Ut(r,hh)}function t_(r){ke(r.length!==0);let e=r[0].indexState.offset,t=e.largestBatchId;for(let n=1;n<r.length;n++){const i=r[n].indexState.offset;Gp(i,e)<0&&(e=i),t<i.largestBatchId&&(t=i.largestBatchId)}return new Xn(e.readTime,e.documentKey,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n_={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},G0=41943040;class hn{static withCacheSize(e){return new hn(e,hn.DEFAULT_COLLECTION_PERCENTILE,hn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function K0(r,e,t){const n=r.store(Pr),i=r.store(Ea),a=[],u=IDBKeyRange.only(t.batchId);let c=0;const d=n.Z({range:u},(g,_,E)=>(c++,E.delete()));a.push(d.next(()=>{ke(c===1)}));const p=[];for(const g of t.mutations){const _=$w(e,g.key.path,t.batchId);a.push(i.delete(_)),p.push(g.key)}return q.waitFor(a).next(()=>p)}function Th(r){if(!r)return 0;let e;if(r.document)e=r.document;else if(r.unknownDocument)e=r.unknownDocument;else{if(!r.noDocument)throw Ae();e=r.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */hn.DEFAULT_COLLECTION_PERCENTILE=10,hn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,hn.DEFAULT=new hn(G0,hn.DEFAULT_COLLECTION_PERCENTILE,hn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),hn.DISABLED=new hn(-1,0,0);class Xh{constructor(e,t,n,i){this.userId=e,this.serializer=t,this.indexManager=n,this.referenceDelegate=i,this.Bn={}}static It(e,t,n,i){ke(e.uid!=="");const a=e.isAuthenticated()?e.uid:"";return new Xh(a,t,n,i)}checkEmpty(e){let t=!0;const n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return ti(e).Z({index:ro,range:n},(i,a,u)=>{t=!1,u.done()}).next(()=>t)}addMutationBatch(e,t,n,i){const a=ma(e),u=ti(e);return u.add({}).next(c=>{ke(typeof c=="number");const d=new rm(c,t,n,i),p=function(C,A,P){const D=P.baseMutations.map(W=>_h(C.Tt,W)),B=P.mutations.map(W=>_h(C.Tt,W));return{userId:A,batchId:P.batchId,localWriteTimeMs:P.localWriteTime.toMillis(),baseMutations:D,mutations:B}}(this.serializer,this.userId,d),g=[];let _=new st((E,C)=>Le(E.canonicalString(),C.canonicalString()));for(const E of i){const C=$w(this.userId,E.key.path,c);_=_.add(E.key.path.popLast()),g.push(u.put(p)),g.push(a.put(C,VC))}return _.forEach(E=>{g.push(this.indexManager.addToCollectionParentIndex(e,E))}),e.addOnCommittedListener(()=>{this.Bn[c]=d.keys()}),q.waitFor(g).next(()=>d)})}lookupMutationBatch(e,t){return ti(e).get(t).next(n=>n?(ke(n.userId===this.userId),eo(this.serializer,n)):null)}Ln(e,t){return this.Bn[t]?q.resolve(this.Bn[t]):this.lookupMutationBatch(e,t).next(n=>{if(n){const i=n.keys();return this.Bn[t]=i,i}return null})}getNextMutationBatchAfterBatchId(e,t){const n=t+1,i=IDBKeyRange.lowerBound([this.userId,n]);let a=null;return ti(e).Z({index:ro,range:i},(u,c,d)=>{c.userId===this.userId&&(ke(c.batchId>=n),a=eo(this.serializer,c)),d.done()}).next(()=>a)}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let n=so;return ti(e).Z({index:ro,range:t,reverse:!0},(i,a,u)=>{n=a.batchId,u.done()}).next(()=>n)}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,so],[this.userId,Number.POSITIVE_INFINITY]);return ti(e).G(ro,t).next(n=>n.map(i=>eo(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,t){const n=Qc(this.userId,t.path),i=IDBKeyRange.lowerBound(n),a=[];return ma(e).Z({range:i},(u,c,d)=>{const[p,g,_]=u,E=Xr(g);if(p===this.userId&&t.path.isEqual(E))return ti(e).get(_).next(C=>{if(!C)throw Ae();ke(C.userId===this.userId),a.push(eo(this.serializer,C))});d.done()}).next(()=>a)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new st(Le);const i=[];return t.forEach(a=>{const u=Qc(this.userId,a.path),c=IDBKeyRange.lowerBound(u),d=ma(e).Z({range:c},(p,g,_)=>{const[E,C,A]=p,P=Xr(C);E===this.userId&&a.path.isEqual(P)?n=n.add(A):_.done()});i.push(d)}),q.waitFor(i).next(()=>this.kn(e,n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,i=n.length+1,a=Qc(this.userId,n),u=IDBKeyRange.lowerBound(a);let c=new st(Le);return ma(e).Z({range:u},(d,p,g)=>{const[_,E,C]=d,A=Xr(E);_===this.userId&&n.isPrefixOf(A)?A.length===i&&(c=c.add(C)):g.done()}).next(()=>this.kn(e,c))}kn(e,t){const n=[],i=[];return t.forEach(a=>{i.push(ti(e).get(a).next(u=>{if(u===null)throw Ae();ke(u.userId===this.userId),n.push(eo(this.serializer,u))}))}),q.waitFor(i).next(()=>n)}removeMutationBatch(e,t){return K0(e.ue,this.userId,t).next(n=>(e.addOnCommittedListener(()=>{this.qn(t.batchId)}),q.forEach(n,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}qn(e){delete this.Bn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return q.resolve();const n=IDBKeyRange.lowerBound(function(u){return[u]}(this.userId)),i=[];return ma(e).Z({range:n},(a,u,c)=>{if(a[0]===this.userId){const d=Xr(a[1]);i.push(d)}else c.done()}).next(()=>{ke(i.length===0)})})}containsKey(e,t){return H0(e,this.userId,t)}Qn(e){return Q0(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:so,lastStreamToken:""})}}function H0(r,e,t){const n=Qc(e,t.path),i=n[1],a=IDBKeyRange.lowerBound(n);let u=!1;return ma(r).Z({range:a,Y:!0},(c,d,p)=>{const[g,_,E]=c;g===e&&_===i&&(u=!0),p.done()}).next(()=>u)}function ti(r){return Ut(r,Pr)}function ma(r){return Ut(r,Ea)}function Q0(r){return Ut(r,Gl)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class po{constructor(e){this.$n=e}next(){return this.$n+=2,this.$n}static Kn(){return new po(0)}static Un(){return new po(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ux{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.Wn(e).next(t=>{const n=new po(t.highestTargetId);return t.highestTargetId=n.next(),this.Gn(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.Wn(e).next(t=>De.fromTimestamp(new Xt(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.Wn(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,n){return this.Wn(e).next(i=>(i.highestListenSequenceNumber=t,n&&(i.lastRemoteSnapshotVersion=n.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this.Gn(e,i)))}addTargetData(e,t){return this.zn(e,t).next(()=>this.Wn(e).next(n=>(n.targetCount+=1,this.jn(t,n),this.Gn(e,n))))}updateTargetData(e,t){return this.zn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>ca(e).delete(t.targetId)).next(()=>this.Wn(e)).next(n=>(ke(n.targetCount>0),n.targetCount-=1,this.Gn(e,n)))}removeTargets(e,t,n){let i=0;const a=[];return ca(e).Z((u,c)=>{const d=Dl(c);d.sequenceNumber<=t&&n.get(d.targetId)===null&&(i++,a.push(this.removeTargetData(e,d)))}).next(()=>q.waitFor(a)).next(()=>i)}forEachTarget(e,t){return ca(e).Z((n,i)=>{const a=Dl(i);t(a)})}Wn(e){return r_(e).get(ch).next(t=>(ke(t!==null),t))}Gn(e,t){return r_(e).put(ch,t)}zn(e,t){return ca(e).put(U0(this.serializer,t))}jn(e,t){let n=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,n=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,n=!0),n}getTargetCount(e){return this.Wn(e).next(t=>t.targetCount)}getTargetData(e,t){const n=co(t),i=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]);let a=null;return ca(e).Z({range:i,index:Ww},(u,c,d)=>{const p=Dl(c);lu(t,p.target)&&(a=p,d.done())}).next(()=>a)}addMatchingKeys(e,t,n){const i=[],a=oi(e);return t.forEach(u=>{const c=dn(u.path);i.push(a.put({targetId:n,path:c})),i.push(this.referenceDelegate.addReference(e,n,u))}),q.waitFor(i)}removeMatchingKeys(e,t,n){const i=oi(e);return q.forEach(t,a=>{const u=dn(a.path);return q.waitFor([i.delete([n,u]),this.referenceDelegate.removeReference(e,n,a)])})}removeMatchingKeysForTargetId(e,t){const n=oi(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return n.delete(i)}getMatchingKeysForTargetId(e,t){const n=IDBKeyRange.bound([t],[t+1],!1,!0),i=oi(e);let a=$e();return i.Z({range:n,Y:!0},(u,c,d)=>{const p=Xr(u[1]),g=new _e(p);a=a.add(g)}).next(()=>a)}containsKey(e,t){const n=dn(t.path),i=IDBKeyRange.bound([n],[Fw(n)],!1,!0);let a=0;return oi(e).Z({index:Hp,Y:!0,range:i},([u,c],d,p)=>{u!==0&&(a++,p.done())}).next(()=>a>0)}lt(e,t){return ca(e).get(t).next(n=>n?Dl(n):null)}}function ca(r){return Ut(r,Ta)}function r_(r){return Ut(r,io)}function oi(r){return Ut(r,Ia)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s_="LruGarbageCollector",X0=1048576;function i_([r,e],[t,n]){const i=Le(r,t);return i===0?Le(e,n):i}class cx{constructor(e){this.Hn=e,this.buffer=new st(i_),this.Jn=0}Yn(){return++this.Jn}Zn(e){const t=[e,this.Yn()];if(this.buffer.size<this.Hn)this.buffer=this.buffer.add(t);else{const n=this.buffer.last();i_(t,n)<0&&(this.buffer=this.buffer.delete(n).add(t))}}get maxValue(){return this.buffer.last()[0]}}class Y0{constructor(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.Xn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.er(6e4)}stop(){this.Xn&&(this.Xn.cancel(),this.Xn=null)}get started(){return this.Xn!==null}er(e){le(s_,`Garbage collection scheduled in ${e}ms`),this.Xn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Xn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){_i(t)?le(s_,"Ignoring IndexedDB error during garbage collection: ",t):await vi(t)}await this.er(3e5)})}}class hx{constructor(e,t){this.tr=e,this.params=t}calculateTargetCount(e,t){return this.tr.nr(e).next(n=>Math.floor(t/100*n))}nthSequenceNumber(e,t){if(t===0)return q.resolve(Vn.ae);const n=new cx(t);return this.tr.forEachTarget(e,i=>n.Zn(i.sequenceNumber)).next(()=>this.tr.rr(e,i=>n.Zn(i))).next(()=>n.maxValue)}removeTargets(e,t,n){return this.tr.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.tr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(le("LruGarbageCollector","Garbage collection skipped; disabled"),q.resolve(n_)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(le("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),n_):this.ir(e,t))}getCacheSize(e){return this.tr.getCacheSize(e)}ir(e,t){let n,i,a,u,c,d,p;const g=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(_=>(_>this.params.maximumSequenceNumbersToCollect?(le("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${_}`),i=this.params.maximumSequenceNumbersToCollect):i=_,u=Date.now(),this.nthSequenceNumber(e,i))).next(_=>(n=_,c=Date.now(),this.removeTargets(e,n,t))).next(_=>(a=_,d=Date.now(),this.removeOrphanedDocuments(e,n))).next(_=>(p=Date.now(),ha()<=Qe.DEBUG&&le("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${u-g}ms
	Determined least recently used ${i} in `+(c-u)+`ms
	Removed ${a} targets in `+(d-c)+`ms
	Removed ${_} documents in `+(p-d)+`ms
Total Duration: ${p-g}ms`),q.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:a,documentsRemoved:_})))}}function Z0(r,e){return new hx(r,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dx{constructor(e,t){this.db=e,this.garbageCollector=Z0(this,t)}nr(e){const t=this.sr(e);return this.db.getTargetCache().getTargetCount(e).next(n=>t.next(i=>n+i))}sr(e){let t=0;return this.rr(e,n=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}rr(e,t){return this._r(e,(n,i)=>t(i))}addReference(e,t,n){return Uc(e,n)}removeReference(e,t,n){return Uc(e,n)}removeTargets(e,t,n){return this.db.getTargetCache().removeTargets(e,t,n)}markPotentiallyOrphaned(e,t){return Uc(e,t)}ar(e,t){return function(i,a){let u=!1;return Q0(i).X(c=>H0(i,c,a).next(d=>(d&&(u=!0),q.resolve(!d)))).next(()=>u)}(e,t)}removeOrphanedDocuments(e,t){const n=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let a=0;return this._r(e,(u,c)=>{if(c<=t){const d=this.ar(e,u).next(p=>{if(!p)return a++,n.getEntry(e,u).next(()=>(n.removeEntry(u,De.min()),oi(e).delete(function(_){return[0,dn(_.path)]}(u))))});i.push(d)}}).next(()=>q.waitFor(i)).next(()=>n.apply(e)).next(()=>a)}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,n)}updateLimboDocument(e,t){return Uc(e,t)}_r(e,t){const n=oi(e);let i,a=Vn.ae;return n.Z({index:Hp},([u,c],{path:d,sequenceNumber:p})=>{u===0?(a!==Vn.ae&&t(new _e(Xr(i)),a),a=p,i=d):a=Vn.ae}).next(()=>{a!==Vn.ae&&t(new _e(Xr(i)),a)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Uc(r,e){return oi(r).put(function(n,i){return{targetId:0,path:dn(n.path),sequenceNumber:i}}(e,r.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J0{constructor(){this.changes=new xs(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,At.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return n!==void 0?q.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fx{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,n){return Hi(e).put(n)}removeEntry(e,t,n){return Hi(e).delete(function(a,u){const c=a.path.toArray();return[c.slice(0,c.length-2),c[c.length-2],wh(u),c[c.length-1]]}(t,n))}updateMetadata(e,t){return this.getMetadata(e).next(n=>(n.byteSize+=t,this.ur(e,n)))}getEntry(e,t){let n=At.newInvalidDocument(t);return Hi(e).Z({index:Xc,range:IDBKeyRange.only(Nl(t))},(i,a)=>{n=this.cr(t,a)}).next(()=>n)}lr(e,t){let n={size:0,document:At.newInvalidDocument(t)};return Hi(e).Z({index:Xc,range:IDBKeyRange.only(Nl(t))},(i,a)=>{n={document:this.cr(t,a),size:Th(a)}}).next(()=>n)}getEntries(e,t){let n=ur();return this.hr(e,t,(i,a)=>{const u=this.cr(i,a);n=n.insert(i,u)}).next(()=>n)}Pr(e,t){let n=ur(),i=new yt(_e.comparator);return this.hr(e,t,(a,u)=>{const c=this.cr(a,u);n=n.insert(a,c),i=i.insert(a,Th(u))}).next(()=>({documents:n,Tr:i}))}hr(e,t,n){if(t.isEmpty())return q.resolve();let i=new st(l_);t.forEach(d=>i=i.add(d));const a=IDBKeyRange.bound(Nl(i.first()),Nl(i.last())),u=i.getIterator();let c=u.getNext();return Hi(e).Z({index:Xc,range:a},(d,p,g)=>{const _=_e.fromSegments([...p.prefixPath,p.collectionGroup,p.documentId]);for(;c&&l_(c,_)<0;)n(c,null),c=u.getNext();c&&c.isEqual(_)&&(n(c,p),c=u.hasNext()?u.getNext():null),c?g.W(Nl(c)):g.done()}).next(()=>{for(;c;)n(c,null),c=u.hasNext()?u.getNext():null})}getDocumentsMatchingQuery(e,t,n,i,a){const u=t.path,c=[u.popLast().toArray(),u.lastSegment(),wh(n.readTime),n.documentKey.path.isEmpty()?"":n.documentKey.path.lastSegment()],d=[u.popLast().toArray(),u.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Hi(e).G(IDBKeyRange.bound(c,d,!0)).next(p=>{a==null||a.incrementDocumentReadCount(p.length);let g=ur();for(const _ of p){const E=this.cr(_e.fromSegments(_.prefixPath.concat(_.collectionGroup,_.documentId)),_);E.isFoundDocument()&&(uu(t,E)||i.has(E.key))&&(g=g.insert(E.key,E))}return g})}getAllFromCollectionGroup(e,t,n,i){let a=ur();const u=a_(t,n),c=a_(t,Xn.max());return Hi(e).Z({index:qw,range:IDBKeyRange.bound(u,c,!0)},(d,p,g)=>{const _=this.cr(_e.fromSegments(p.prefixPath.concat(p.collectionGroup,p.documentId)),p);a=a.insert(_.key,_),a.size===i&&g.done()}).next(()=>a)}newChangeBuffer(e){return new px(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return o_(e).get(hp).next(t=>(ke(!!t),t))}ur(e,t){return o_(e).put(hp,t)}cr(e,t){if(t){const n=JA(this.serializer,t);if(!(n.isNoDocument()&&n.version.isEqual(De.min())))return n}return At.newInvalidDocument(e)}}function eE(r){return new fx(r)}class px extends J0{constructor(e,t){super(),this.Ir=e,this.trackRemovals=t,this.Er=new xs(n=>n.toString(),(n,i)=>n.isEqual(i))}applyChanges(e){const t=[];let n=0,i=new st((a,u)=>Le(a.canonicalString(),u.canonicalString()));return this.changes.forEach((a,u)=>{const c=this.Er.get(a);if(t.push(this.Ir.removeEntry(e,a,c.readTime)),u.isValidDocument()){const d=qv(this.Ir.serializer,u);i=i.add(a.path.popLast());const p=Th(d);n+=p-c.size,t.push(this.Ir.addEntry(e,a,d))}else if(n-=c.size,this.trackRemovals){const d=qv(this.Ir.serializer,u.convertToNoDocument(De.min()));t.push(this.Ir.addEntry(e,a,d))}}),i.forEach(a=>{t.push(this.Ir.indexManager.addToCollectionParentIndex(e,a))}),t.push(this.Ir.updateMetadata(e,n)),q.waitFor(t)}getFromCache(e,t){return this.Ir.lr(e,t).next(n=>(this.Er.set(t,{size:n.size,readTime:n.document.readTime}),n.document))}getAllFromCache(e,t){return this.Ir.Pr(e,t).next(({documents:n,Tr:i})=>(i.forEach((a,u)=>{this.Er.set(a,{size:u,readTime:n.get(a).readTime})}),n))}}function o_(r){return Ut(r,Kl)}function Hi(r){return Ut(r,uh)}function Nl(r){const e=r.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function a_(r,e){const t=e.documentKey.path.toArray();return[r,wh(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function l_(r,e){const t=r.path.toArray(),n=e.path.toArray();let i=0;for(let a=0;a<t.length-2&&a<n.length-2;++a)if(i=Le(t[a],n[a]),i)return i;return i=Le(t.length,n.length),i||(i=Le(t[t.length-2],n[n.length-2]),i||Le(t[t.length-1],n[n.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mx{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tE{constructor(e,t,n,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=i}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(n=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(n!==null&&jl(n.mutation,i,ws.empty(),Xt.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(n=>this.getLocalViewOfDocuments(e,n,$e()).next(()=>n))}getLocalViewOfDocuments(e,t,n=$e()){const i=Yr();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,n).next(a=>{let u=kl();return a.forEach((c,d)=>{u=u.insert(c,d.overlayedDocument)}),u}))}getOverlayedDocuments(e,t){const n=Yr();return this.populateOverlays(e,n,t).next(()=>this.computeViews(e,t,n,$e()))}populateOverlays(e,t,n){const i=[];return n.forEach(a=>{t.has(a)||i.push(a)}),this.documentOverlayCache.getOverlays(e,i).next(a=>{a.forEach((u,c)=>{t.set(u,c)})})}computeViews(e,t,n,i){let a=ur();const u=Ll(),c=function(){return Ll()}();return t.forEach((d,p)=>{const g=n.get(p.key);i.has(p.key)&&(g===void 0||g.mutation instanceof Fa)?a=a.insert(p.key,p):g!==void 0?(u.set(p.key,g.mutation.getFieldMask()),jl(g.mutation,p,g.mutation.getFieldMask(),Xt.now())):u.set(p.key,ws.empty())}),this.recalculateAndSaveOverlays(e,a).next(d=>(d.forEach((p,g)=>u.set(p,g)),t.forEach((p,g)=>{var _;return c.set(p,new mx(g,(_=u.get(p))!==null&&_!==void 0?_:null))}),c))}recalculateAndSaveOverlays(e,t){const n=Ll();let i=new yt((u,c)=>u-c),a=$e();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(u=>{for(const c of u)c.keys().forEach(d=>{const p=t.get(d);if(p===null)return;let g=n.get(d)||ws.empty();g=c.applyToLocalView(p,g),n.set(d,g);const _=(i.get(c.batchId)||$e()).add(d);i=i.insert(c.batchId,_)})}).next(()=>{const u=[],c=i.getReverseIterator();for(;c.hasNext();){const d=c.getNext(),p=d.key,g=d.value,_=w0();g.forEach(E=>{if(!a.has(E)){const C=S0(t.get(E),n.get(E));C!==null&&_.set(E,C),a=a.add(E)}}),u.push(this.documentOverlayCache.saveOverlays(e,p,_))}return q.waitFor(u)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,t,n,i){return function(u){return _e.isDocumentKey(u.path)&&u.collectionGroup===null&&u.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):yA(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,i):this.getDocumentsMatchingCollectionQuery(e,t,n,i)}getNextDocuments(e,t,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,i).next(a=>{const u=i-a.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,i-a.size):q.resolve(Yr());let c=wa,d=a;return u.next(p=>q.forEach(p,(g,_)=>(c<_.largestBatchId&&(c=_.largestBatchId),a.get(g)?q.resolve():this.remoteDocumentCache.getEntry(e,g).next(E=>{d=d.insert(g,E)}))).next(()=>this.populateOverlays(e,p,a)).next(()=>this.computeViews(e,d,p,$e())).next(g=>({batchId:c,changes:EA(g)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new _e(t)).next(n=>{let i=kl();return n.isFoundDocument()&&(i=i.insert(n.key,n)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,n,i){const a=t.collectionGroup;let u=kl();return this.indexManager.getCollectionParents(e,a).next(c=>q.forEach(c,d=>{const p=function(_,E){return new qh(E,null,_.explicitOrderBy.slice(),_.filters.slice(),_.limit,_.limitType,_.startAt,_.endAt)}(t,d.child(a));return this.getDocumentsMatchingCollectionQuery(e,p,n,i).next(g=>{g.forEach((_,E)=>{u=u.insert(_,E)})})}).next(()=>u))}getDocumentsMatchingCollectionQuery(e,t,n,i){let a;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next(u=>(a=u,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,a,i))).next(u=>{a.forEach((d,p)=>{const g=p.getKey();u.get(g)===null&&(u=u.insert(g,At.newInvalidDocument(g)))});let c=kl();return u.forEach((d,p)=>{const g=a.get(d);g!==void 0&&jl(g.mutation,p,ws.empty(),Xt.now()),uu(t,p)&&(c=c.insert(d,p))}),c})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gx{constructor(e){this.serializer=e,this.dr=new Map,this.Ar=new Map}getBundleMetadata(e,t){return q.resolve(this.dr.get(t))}saveBundleMetadata(e,t){return this.dr.set(t.id,function(i){return{id:i.id,version:i.version,createTime:En(i.createTime)}}(t)),q.resolve()}getNamedQuery(e,t){return q.resolve(this.Ar.get(t))}saveNamedQuery(e,t){return this.Ar.set(t.name,function(i){return{name:i.name,query:$0(i.bundledQuery),readTime:En(i.readTime)}}(t)),q.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yx{constructor(){this.overlays=new yt(_e.comparator),this.Rr=new Map}getOverlay(e,t){return q.resolve(this.overlays.get(t))}getOverlays(e,t){const n=Yr();return q.forEach(t,i=>this.getOverlay(e,i).next(a=>{a!==null&&n.set(i,a)})).next(()=>n)}saveOverlays(e,t,n){return n.forEach((i,a)=>{this.Et(e,t,a)}),q.resolve()}removeOverlaysForBatchId(e,t,n){const i=this.Rr.get(n);return i!==void 0&&(i.forEach(a=>this.overlays=this.overlays.remove(a)),this.Rr.delete(n)),q.resolve()}getOverlaysForCollection(e,t,n){const i=Yr(),a=t.length+1,u=new _e(t.child("")),c=this.overlays.getIteratorFrom(u);for(;c.hasNext();){const d=c.getNext().value,p=d.getKey();if(!t.isPrefixOf(p.path))break;p.path.length===a&&d.largestBatchId>n&&i.set(d.getKey(),d)}return q.resolve(i)}getOverlaysForCollectionGroup(e,t,n,i){let a=new yt((p,g)=>p-g);const u=this.overlays.getIterator();for(;u.hasNext();){const p=u.getNext().value;if(p.getKey().getCollectionGroup()===t&&p.largestBatchId>n){let g=a.get(p.largestBatchId);g===null&&(g=Yr(),a=a.insert(p.largestBatchId,g)),g.set(p.getKey(),p)}}const c=Yr(),d=a.getIterator();for(;d.hasNext()&&(d.getNext().value.forEach((p,g)=>c.set(p,g)),!(c.size()>=i)););return q.resolve(c)}Et(e,t,n){const i=this.overlays.get(n.key);if(i!==null){const u=this.Rr.get(i.largestBatchId).delete(n.key);this.Rr.set(i.largestBatchId,u)}this.overlays=this.overlays.insert(n.key,new im(t,n));let a=this.Rr.get(t);a===void 0&&(a=$e(),this.Rr.set(t,a)),this.Rr.set(t,a.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vx{constructor(){this.sessionToken=Dt.EMPTY_BYTE_STRING}getSessionToken(e){return q.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,q.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class um{constructor(){this.Vr=new st(Qt.mr),this.gr=new st(Qt.pr)}isEmpty(){return this.Vr.isEmpty()}addReference(e,t){const n=new Qt(e,t);this.Vr=this.Vr.add(n),this.gr=this.gr.add(n)}yr(e,t){e.forEach(n=>this.addReference(n,t))}removeReference(e,t){this.wr(new Qt(e,t))}br(e,t){e.forEach(n=>this.removeReference(n,t))}Sr(e){const t=new _e(new lt([])),n=new Qt(t,e),i=new Qt(t,e+1),a=[];return this.gr.forEachInRange([n,i],u=>{this.wr(u),a.push(u.key)}),a}Dr(){this.Vr.forEach(e=>this.wr(e))}wr(e){this.Vr=this.Vr.delete(e),this.gr=this.gr.delete(e)}vr(e){const t=new _e(new lt([])),n=new Qt(t,e),i=new Qt(t,e+1);let a=$e();return this.gr.forEachInRange([n,i],u=>{a=a.add(u.key)}),a}containsKey(e){const t=new Qt(e,0),n=this.Vr.firstAfterOrEqual(t);return n!==null&&e.isEqual(n.key)}}class Qt{constructor(e,t){this.key=e,this.Cr=t}static mr(e,t){return _e.comparator(e.key,t.key)||Le(e.Cr,t.Cr)}static pr(e,t){return Le(e.Cr,t.Cr)||_e.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _x{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Fr=1,this.Mr=new st(Qt.mr)}checkEmpty(e){return q.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,n,i){const a=this.Fr;this.Fr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const u=new rm(a,t,n,i);this.mutationQueue.push(u);for(const c of i)this.Mr=this.Mr.add(new Qt(c.key,a)),this.indexManager.addToCollectionParentIndex(e,c.key.path.popLast());return q.resolve(u)}lookupMutationBatch(e,t){return q.resolve(this.Or(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,i=this.Nr(n),a=i<0?0:i;return q.resolve(this.mutationQueue.length>a?this.mutationQueue[a]:null)}getHighestUnacknowledgedBatchId(){return q.resolve(this.mutationQueue.length===0?so:this.Fr-1)}getAllMutationBatches(e){return q.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new Qt(t,0),i=new Qt(t,Number.POSITIVE_INFINITY),a=[];return this.Mr.forEachInRange([n,i],u=>{const c=this.Or(u.Cr);a.push(c)}),q.resolve(a)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new st(Le);return t.forEach(i=>{const a=new Qt(i,0),u=new Qt(i,Number.POSITIVE_INFINITY);this.Mr.forEachInRange([a,u],c=>{n=n.add(c.Cr)})}),q.resolve(this.Br(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,i=n.length+1;let a=n;_e.isDocumentKey(a)||(a=a.child(""));const u=new Qt(new _e(a),0);let c=new st(Le);return this.Mr.forEachWhile(d=>{const p=d.key.path;return!!n.isPrefixOf(p)&&(p.length===i&&(c=c.add(d.Cr)),!0)},u),q.resolve(this.Br(c))}Br(e){const t=[];return e.forEach(n=>{const i=this.Or(n);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){ke(this.Lr(t.batchId,"removed")===0),this.mutationQueue.shift();let n=this.Mr;return q.forEach(t.mutations,i=>{const a=new Qt(i.key,t.batchId);return n=n.delete(a),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Mr=n})}qn(e){}containsKey(e,t){const n=new Qt(t,0),i=this.Mr.firstAfterOrEqual(n);return q.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,q.resolve()}Lr(e,t){return this.Nr(e)}Nr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Or(e){const t=this.Nr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wx{constructor(e){this.kr=e,this.docs=function(){return new yt(_e.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,i=this.docs.get(n),a=i?i.size:0,u=this.kr(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:u}),this.size+=u-a,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return q.resolve(n?n.document.mutableCopy():At.newInvalidDocument(t))}getEntries(e,t){let n=ur();return t.forEach(i=>{const a=this.docs.get(i);n=n.insert(i,a?a.document.mutableCopy():At.newInvalidDocument(i))}),q.resolve(n)}getDocumentsMatchingQuery(e,t,n,i){let a=ur();const u=t.path,c=new _e(u.child("__id-9223372036854775808__")),d=this.docs.getIteratorFrom(c);for(;d.hasNext();){const{key:p,value:{document:g}}=d.getNext();if(!u.isPrefixOf(p.path))break;p.path.length>u.length+1||Gp(jw(g),n)<=0||(i.has(g.key)||uu(t,g))&&(a=a.insert(g.key,g.mutableCopy()))}return q.resolve(a)}getAllFromCollectionGroup(e,t,n,i){Ae()}qr(e,t){return q.forEach(this.docs,n=>t(n))}newChangeBuffer(e){return new Ex(this)}getSize(e){return q.resolve(this.size)}}class Ex extends J0{constructor(e){super(),this.Ir=e}applyChanges(e){const t=[];return this.changes.forEach((n,i)=>{i.isValidDocument()?t.push(this.Ir.addEntry(e,i)):this.Ir.removeEntry(n)}),q.waitFor(t)}getFromCache(e,t){return this.Ir.getEntry(e,t)}getAllFromCache(e,t){return this.Ir.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tx{constructor(e){this.persistence=e,this.Qr=new xs(t=>co(t),lu),this.lastRemoteSnapshotVersion=De.min(),this.highestTargetId=0,this.$r=0,this.Kr=new um,this.targetCount=0,this.Ur=po.Kn()}forEachTarget(e,t){return this.Qr.forEach((n,i)=>t(i)),q.resolve()}getLastRemoteSnapshotVersion(e){return q.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return q.resolve(this.$r)}allocateTargetId(e){return this.highestTargetId=this.Ur.next(),q.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.$r&&(this.$r=t),q.resolve()}zn(e){this.Qr.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.Ur=new po(t),this.highestTargetId=t),e.sequenceNumber>this.$r&&(this.$r=e.sequenceNumber)}addTargetData(e,t){return this.zn(t),this.targetCount+=1,q.resolve()}updateTargetData(e,t){return this.zn(t),q.resolve()}removeTargetData(e,t){return this.Qr.delete(t.target),this.Kr.Sr(t.targetId),this.targetCount-=1,q.resolve()}removeTargets(e,t,n){let i=0;const a=[];return this.Qr.forEach((u,c)=>{c.sequenceNumber<=t&&n.get(c.targetId)===null&&(this.Qr.delete(u),a.push(this.removeMatchingKeysForTargetId(e,c.targetId)),i++)}),q.waitFor(a).next(()=>i)}getTargetCount(e){return q.resolve(this.targetCount)}getTargetData(e,t){const n=this.Qr.get(t)||null;return q.resolve(n)}addMatchingKeys(e,t,n){return this.Kr.yr(t,n),q.resolve()}removeMatchingKeys(e,t,n){this.Kr.br(t,n);const i=this.persistence.referenceDelegate,a=[];return i&&t.forEach(u=>{a.push(i.markPotentiallyOrphaned(e,u))}),q.waitFor(a)}removeMatchingKeysForTargetId(e,t){return this.Kr.Sr(t),q.resolve()}getMatchingKeysForTargetId(e,t){const n=this.Kr.vr(t);return q.resolve(n)}containsKey(e,t){return q.resolve(this.Kr.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cm{constructor(e,t){this.Wr={},this.overlays={},this.Gr=new Vn(0),this.zr=!1,this.zr=!0,this.jr=new vx,this.referenceDelegate=e(this),this.Hr=new Tx(this),this.indexManager=new ax,this.remoteDocumentCache=function(i){return new wx(i)}(n=>this.referenceDelegate.Jr(n)),this.serializer=new z0(t),this.Yr=new gx(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.zr=!1,Promise.resolve()}get started(){return this.zr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new yx,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.Wr[e.toKey()];return n||(n=new _x(t,this.referenceDelegate),this.Wr[e.toKey()]=n),n}getGlobalsCache(){return this.jr}getTargetCache(){return this.Hr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Yr}runTransaction(e,t,n){le("MemoryPersistence","Starting transaction:",e);const i=new Ix(this.Gr.next());return this.referenceDelegate.Zr(),n(i).next(a=>this.referenceDelegate.Xr(i).next(()=>a)).toPromise().then(a=>(i.raiseOnCommittedEvent(),a))}ei(e,t){return q.or(Object.values(this.Wr).map(n=>()=>n.containsKey(e,t)))}}class Ix extends zw{constructor(e){super(),this.currentSequenceNumber=e}}class Yh{constructor(e){this.persistence=e,this.ti=new um,this.ni=null}static ri(e){return new Yh(e)}get ii(){if(this.ni)return this.ni;throw Ae()}addReference(e,t,n){return this.ti.addReference(n,t),this.ii.delete(n.toString()),q.resolve()}removeReference(e,t,n){return this.ti.removeReference(n,t),this.ii.add(n.toString()),q.resolve()}markPotentiallyOrphaned(e,t){return this.ii.add(t.toString()),q.resolve()}removeTarget(e,t){this.ti.Sr(t.targetId).forEach(i=>this.ii.add(i.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(a=>this.ii.add(a.toString()))}).next(()=>n.removeTargetData(e,t))}Zr(){this.ni=new Set}Xr(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return q.forEach(this.ii,n=>{const i=_e.fromPath(n);return this.si(e,i).next(a=>{a||t.removeEntry(i,De.min())})}).next(()=>(this.ni=null,t.apply(e)))}updateLimboDocument(e,t){return this.si(e,t).next(n=>{n?this.ii.delete(t.toString()):this.ii.add(t.toString())})}Jr(e){return 0}si(e,t){return q.or([()=>q.resolve(this.ti.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.ei(e,t)])}}class Ih{constructor(e,t){this.persistence=e,this.oi=new xs(n=>dn(n.path),(n,i)=>n.isEqual(i)),this.garbageCollector=Z0(this,t)}static ri(e,t){return new Ih(e,t)}Zr(){}Xr(e){return q.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}nr(e){const t=this.sr(e);return this.persistence.getTargetCache().getTargetCount(e).next(n=>t.next(i=>n+i))}sr(e){let t=0;return this.rr(e,n=>{t++}).next(()=>t)}rr(e,t){return q.forEach(this.oi,(n,i)=>this.ar(e,n,i).next(a=>a?q.resolve():t(i)))}removeTargets(e,t,n){return this.persistence.getTargetCache().removeTargets(e,t,n)}removeOrphanedDocuments(e,t){let n=0;const i=this.persistence.getRemoteDocumentCache(),a=i.newChangeBuffer();return i.qr(e,u=>this.ar(e,u,t).next(c=>{c||(n++,a.removeEntry(u,De.min()))})).next(()=>a.apply(e)).next(()=>n)}markPotentiallyOrphaned(e,t){return this.oi.set(t,e.currentSequenceNumber),q.resolve()}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,t,n){return this.oi.set(n,e.currentSequenceNumber),q.resolve()}removeReference(e,t,n){return this.oi.set(n,e.currentSequenceNumber),q.resolve()}updateLimboDocument(e,t){return this.oi.set(t,e.currentSequenceNumber),q.resolve()}Jr(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Zc(e.data.value)),t}ar(e,t,n){return q.or([()=>this.persistence.ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const i=this.oi.get(t);return q.resolve(i!==void 0&&i>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sx{constructor(e){this.serializer=e}B(e,t,n,i){const a=new Fh("createOrUpgrade",t);n<1&&i>=1&&(function(d){d.createObjectStore(ou)}(e),function(d){d.createObjectStore(Gl,{keyPath:DC}),d.createObjectStore(Pr,{keyPath:wv,autoIncrement:!0}).createIndex(ro,Ev,{unique:!0}),d.createObjectStore(Ea)}(e),u_(e),function(d){d.createObjectStore(Zi)}(e));let u=q.resolve();return n<3&&i>=3&&(n!==0&&(function(d){d.deleteObjectStore(Ia),d.deleteObjectStore(Ta),d.deleteObjectStore(io)}(e),u_(e)),u=u.next(()=>function(d){const p=d.store(io),g={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:De.min().toTimestamp(),targetCount:0};return p.put(ch,g)}(a))),n<4&&i>=4&&(n!==0&&(u=u.next(()=>function(d,p){return p.store(Pr).G().next(_=>{d.deleteObjectStore(Pr),d.createObjectStore(Pr,{keyPath:wv,autoIncrement:!0}).createIndex(ro,Ev,{unique:!0});const E=p.store(Pr),C=_.map(A=>E.put(A));return q.waitFor(C)})}(e,a))),u=u.next(()=>{(function(d){d.createObjectStore(Sa,{keyPath:UC})})(e)})),n<5&&i>=5&&(u=u.next(()=>this._i(a))),n<6&&i>=6&&(u=u.next(()=>(function(d){d.createObjectStore(Kl)}(e),this.ai(a)))),n<7&&i>=7&&(u=u.next(()=>this.ui(a))),n<8&&i>=8&&(u=u.next(()=>this.ci(e,a))),n<9&&i>=9&&(u=u.next(()=>{(function(d){d.objectStoreNames.contains("remoteDocumentChanges")&&d.deleteObjectStore("remoteDocumentChanges")})(e)})),n<10&&i>=10&&(u=u.next(()=>this.li(a))),n<11&&i>=11&&(u=u.next(()=>{(function(d){d.createObjectStore(jh,{keyPath:$C})})(e),function(d){d.createObjectStore(Bh,{keyPath:qC})}(e)})),n<12&&i>=12&&(u=u.next(()=>{(function(d){const p=d.createObjectStore(zh,{keyPath:YC});p.createIndex(fp,ZC,{unique:!1}),p.createIndex(Hw,JC,{unique:!1})})(e)})),n<13&&i>=13&&(u=u.next(()=>function(d){const p=d.createObjectStore(uh,{keyPath:MC});p.createIndex(Xc,OC),p.createIndex(qw,FC)}(e)).next(()=>this.hi(e,a)).next(()=>e.deleteObjectStore(Zi))),n<14&&i>=14&&(u=u.next(()=>this.Pi(e,a))),n<15&&i>=15&&(u=u.next(()=>function(d){d.createObjectStore(Qp,{keyPath:WC,autoIncrement:!0}).createIndex(dp,GC,{unique:!1}),d.createObjectStore(hh,{keyPath:KC}).createIndex(Gw,HC,{unique:!1}),d.createObjectStore(dh,{keyPath:QC}).createIndex(Kw,XC,{unique:!1})}(e))),n<16&&i>=16&&(u=u.next(()=>{t.objectStore(hh).clear()}).next(()=>{t.objectStore(dh).clear()})),n<17&&i>=17&&(u=u.next(()=>{(function(d){d.createObjectStore(Xp,{keyPath:eA})})(e)})),u}ai(e){let t=0;return e.store(Zi).Z((n,i)=>{t+=Th(i)}).next(()=>{const n={byteSize:t};return e.store(Kl).put(hp,n)})}_i(e){const t=e.store(Gl),n=e.store(Pr);return t.G().next(i=>q.forEach(i,a=>{const u=IDBKeyRange.bound([a.userId,so],[a.userId,a.lastAcknowledgedBatchId]);return n.G(ro,u).next(c=>q.forEach(c,d=>{ke(d.userId===a.userId);const p=eo(this.serializer,d);return K0(e,a.userId,p).next(()=>{})}))}))}ui(e){const t=e.store(Ia),n=e.store(Zi);return e.store(io).get(ch).next(i=>{const a=[];return n.Z((u,c)=>{const d=new lt(u),p=function(_){return[0,dn(_)]}(d);a.push(t.get(p).next(g=>g?q.resolve():(_=>t.put({targetId:0,path:dn(_),sequenceNumber:i.highestListenSequenceNumber}))(d)))}).next(()=>q.waitFor(a))})}ci(e,t){e.createObjectStore(Hl,{keyPath:zC});const n=t.store(Hl),i=new lm,a=u=>{if(i.add(u)){const c=u.lastSegment(),d=u.popLast();return n.put({collectionId:c,parent:dn(d)})}};return t.store(Zi).Z({Y:!0},(u,c)=>{const d=new lt(u);return a(d.popLast())}).next(()=>t.store(Ea).Z({Y:!0},([u,c,d],p)=>{const g=Xr(c);return a(g.popLast())}))}li(e){const t=e.store(Ta);return t.Z((n,i)=>{const a=Dl(i),u=U0(this.serializer,a);return t.put(u)})}hi(e,t){const n=t.store(Zi),i=[];return n.Z((a,u)=>{const c=t.store(uh),d=function(_){return _.document?new _e(lt.fromString(_.document.name).popFirst(5)):_.noDocument?_e.fromSegments(_.noDocument.path):_.unknownDocument?_e.fromSegments(_.unknownDocument.path):Ae()}(u).path.toArray(),p={prefixPath:d.slice(0,d.length-2),collectionGroup:d[d.length-2],documentId:d[d.length-1],readTime:u.readTime||[0,0],unknownDocument:u.unknownDocument,noDocument:u.noDocument,document:u.document,hasCommittedMutations:!!u.hasCommittedMutations};i.push(c.put(p))}).next(()=>q.waitFor(i))}Pi(e,t){const n=t.store(Pr),i=eE(this.serializer),a=new cm(Yh.ri,this.serializer.Tt);return n.G().next(u=>{const c=new Map;return u.forEach(d=>{var p;let g=(p=c.get(d.userId))!==null&&p!==void 0?p:$e();eo(this.serializer,d).keys().forEach(_=>g=g.add(_)),c.set(d.userId,g)}),q.forEach(c,(d,p)=>{const g=new cn(p),_=Qh.It(this.serializer,g),E=a.getIndexManager(g),C=Xh.It(g,this.serializer,E,a.referenceDelegate);return new tE(i,C,_,E).recalculateAndSaveOverlaysForDocumentKeys(new pp(t,Vn.ae),d).next()})})}}function u_(r){r.createObjectStore(Ia,{keyPath:jC}).createIndex(Hp,BC,{unique:!0}),r.createObjectStore(Ta,{keyPath:"targetId"}).createIndex(Ww,LC,{unique:!0}),r.createObjectStore(io)}const ni="IndexedDbPersistence",Kf=18e5,Hf=5e3,Qf="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",Cx="main";class hm{constructor(e,t,n,i,a,u,c,d,p,g,_=17){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=n,this.Ti=a,this.window=u,this.document=c,this.Ii=p,this.Ei=g,this.di=_,this.Gr=null,this.zr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Ai=null,this.inForeground=!1,this.Ri=null,this.Vi=null,this.mi=Number.NEGATIVE_INFINITY,this.fi=E=>Promise.resolve(),!hm.D())throw new Ce(ie.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new dx(this,i),this.gi=t+Cx,this.serializer=new z0(d),this.pi=new fi(this.gi,this.di,new Sx(this.serializer)),this.jr=new tx,this.Hr=new ux(this.referenceDelegate,this.serializer),this.remoteDocumentCache=eE(this.serializer),this.Yr=new ex,this.window&&this.window.localStorage?this.yi=this.window.localStorage:(this.yi=null,g===!1&&kt(ni,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.wi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new Ce(ie.FAILED_PRECONDITION,Qf);return this.bi(),this.Si(),this.Di(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Hr.getHighestSequenceNumber(e))}).then(e=>{this.Gr=new Vn(e,this.Ii)}).then(()=>{this.zr=!0}).catch(e=>(this.pi&&this.pi.close(),Promise.reject(e)))}Ci(e){return this.fi=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.pi.k(async t=>{t.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Ti.enqueueAndForget(async()=>{this.started&&await this.wi()}))}wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>$c(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.Fi(e).next(t=>{t||(this.isPrimary=!1,this.Ti.enqueueRetryable(()=>this.fi(!1)))})}).next(()=>this.Mi(e)).next(t=>this.isPrimary&&!t?this.xi(e).next(()=>!1):!!t&&this.Oi(e).next(()=>!0))).catch(e=>{if(_i(e))return le(ni,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return le(ni,"Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.Ti.enqueueRetryable(()=>this.fi(e)),this.isPrimary=e})}Fi(e){return Rl(e).get(ia).next(t=>q.resolve(this.Ni(t)))}Bi(e){return $c(e).delete(this.clientId)}async Li(){if(this.isPrimary&&!this.ki(this.mi,Kf)){this.mi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",t=>{const n=Ut(t,Sa);return n.G().next(i=>{const a=this.qi(i,Kf),u=i.filter(c=>a.indexOf(c)===-1);return q.forEach(u,c=>n.delete(c.clientId)).next(()=>u)})}).catch(()=>[]);if(this.yi)for(const t of e)this.yi.removeItem(this.Qi(t.clientId))}}Di(){this.Vi=this.Ti.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.wi().then(()=>this.Li()).then(()=>this.Di()))}Ni(e){return!!e&&e.ownerId===this.clientId}Mi(e){return this.Ei?q.resolve(!0):Rl(e).get(ia).next(t=>{if(t!==null&&this.ki(t.leaseTimestampMs,Hf)&&!this.$i(t.ownerId)){if(this.Ni(t)&&this.networkEnabled)return!0;if(!this.Ni(t)){if(!t.allowTabSynchronization)throw new Ce(ie.FAILED_PRECONDITION,Qf);return!1}}return!(!this.networkEnabled||!this.inForeground)||$c(e).G().next(n=>this.qi(n,Hf).find(i=>{if(this.clientId!==i.clientId){const a=!this.networkEnabled&&i.networkEnabled,u=!this.inForeground&&i.inForeground,c=this.networkEnabled===i.networkEnabled;if(a||u&&c)return!0}return!1})===void 0)}).next(t=>(this.isPrimary!==t&&le(ni,`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}async shutdown(){this.zr=!1,this.Ki(),this.Vi&&(this.Vi.cancel(),this.Vi=null),this.Ui(),this.Wi(),await this.pi.runTransaction("shutdown","readwrite",[ou,Sa],e=>{const t=new pp(e,Vn.ae);return this.xi(t).next(()=>this.Bi(t))}),this.pi.close(),this.Gi()}qi(e,t){return e.filter(n=>this.ki(n.updateTimeMs,t)&&!this.$i(n.clientId))}zi(){return this.runTransaction("getActiveClients","readonly",e=>$c(e).G().next(t=>this.qi(t,Kf).map(n=>n.clientId)))}get started(){return this.zr}getGlobalsCache(){return this.jr}getMutationQueue(e,t){return Xh.It(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Hr}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new lx(e,this.serializer.Tt.databaseId)}getDocumentOverlayCache(e){return Qh.It(this.serializer,e)}getBundleCache(){return this.Yr}runTransaction(e,t,n){le(ni,"Starting transaction:",e);const i=t==="readonly"?"readonly":"readwrite",a=function(d){return d===17?rA:d===16?nA:d===15?Yp:d===14?Yw:d===13?Xw:d===12?tA:d===11?Qw:void Ae()}(this.di);let u;return this.pi.runTransaction(e,i,a,c=>(u=new pp(c,this.Gr?this.Gr.next():Vn.ae),t==="readwrite-primary"?this.Fi(u).next(d=>!!d||this.Mi(u)).next(d=>{if(!d)throw kt(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Ti.enqueueRetryable(()=>this.fi(!1)),new Ce(ie.FAILED_PRECONDITION,Bw);return n(u)}).next(d=>this.Oi(u).next(()=>d)):this.ji(u).next(()=>n(u)))).then(c=>(u.raiseOnCommittedEvent(),c))}ji(e){return Rl(e).get(ia).next(t=>{if(t!==null&&this.ki(t.leaseTimestampMs,Hf)&&!this.$i(t.ownerId)&&!this.Ni(t)&&!(this.Ei||this.allowTabSynchronization&&t.allowTabSynchronization))throw new Ce(ie.FAILED_PRECONDITION,Qf)})}Oi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Rl(e).put(ia,t)}static D(){return fi.D()}xi(e){const t=Rl(e);return t.get(ia).next(n=>this.Ni(n)?(le(ni,"Releasing primary lease."),t.delete(ia)):q.resolve())}ki(e,t){const n=Date.now();return!(e<n-t)&&(!(e>n)||(kt(`Detected an update time that is in the future: ${e} > ${n}`),!1))}bi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ri=()=>{this.Ti.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.wi()))},this.document.addEventListener("visibilitychange",this.Ri),this.inForeground=this.document.visibilityState==="visible")}Ui(){this.Ri&&(this.document.removeEventListener("visibilitychange",this.Ri),this.Ri=null)}Si(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Ai=()=>{this.Ki();const t=/(?:Version|Mobile)\/1[456]/;yw()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.Ti.enterRestrictedMode(!0),this.Ti.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Ai))}Wi(){this.Ai&&(this.window.removeEventListener("pagehide",this.Ai),this.Ai=null)}$i(e){var t;try{const n=((t=this.yi)===null||t===void 0?void 0:t.getItem(this.Qi(e)))!==null;return le(ni,`Client '${e}' ${n?"is":"is not"} zombied in LocalStorage`),n}catch(n){return kt(ni,"Failed to get zombied client id.",n),!1}}Ki(){if(this.yi)try{this.yi.setItem(this.Qi(this.clientId),String(Date.now()))}catch(e){kt("Failed to set zombie client id.",e)}}Gi(){if(this.yi)try{this.yi.removeItem(this.Qi(this.clientId))}catch{}}Qi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Rl(r){return Ut(r,ou)}function $c(r){return Ut(r,Sa)}function nE(r,e){let t=r.projectId;return r.isDefaultDatabase||(t+="."+r.database),"firestore/"+e+"/"+t+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dm{constructor(e,t,n,i){this.targetId=e,this.fromCache=t,this.Hi=n,this.Ji=i}static Yi(e,t){let n=$e(),i=$e();for(const a of t.docChanges)switch(a.type){case 0:n=n.add(a.doc.key);break;case 1:i=i.add(a.doc.key)}return new dm(e,t.fromCache,n,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ax{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rE{constructor(){this.Zi=!1,this.Xi=!1,this.es=100,this.ts=function(){return yw()?8:Uw(sh())>0?6:4}()}initialize(e,t){this.ns=e,this.indexManager=t,this.Zi=!0}getDocumentsMatchingQuery(e,t,n,i){const a={result:null};return this.rs(e,t).next(u=>{a.result=u}).next(()=>{if(!a.result)return this.ss(e,t,i,n).next(u=>{a.result=u})}).next(()=>{if(a.result)return;const u=new Ax;return this._s(e,t,u).next(c=>{if(a.result=c,this.Xi)return this.us(e,t,u,c.size)})}).next(()=>a.result)}us(e,t,n,i){return n.documentReadCount<this.es?(ha()<=Qe.DEBUG&&le("QueryEngine","SDK will not create cache indexes for query:",da(t),"since it only creates cache indexes for collection contains","more than or equal to",this.es,"documents"),q.resolve()):(ha()<=Qe.DEBUG&&le("QueryEngine","Query:",da(t),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.ts*i?(ha()<=Qe.DEBUG&&le("QueryEngine","The SDK decides to create cache indexes for query:",da(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Qn(t))):q.resolve())}rs(e,t){if(Vv(t))return q.resolve(null);let n=Qn(t);return this.indexManager.getIndexType(e,n).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=wp(t,null,"F"),n=Qn(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next(a=>{const u=$e(...a);return this.ns.getDocuments(e,u).next(c=>this.indexManager.getMinOffset(e,n).next(d=>{const p=this.cs(t,c);return this.ls(t,p,u,d.readTime)?this.rs(e,wp(t,null,"F")):this.hs(e,p,t,d)}))})))}ss(e,t,n,i){return Vv(t)||i.isEqual(De.min())?q.resolve(null):this.ns.getDocuments(e,n).next(a=>{const u=this.cs(t,a);return this.ls(t,u,n,i)?q.resolve(null):(ha()<=Qe.DEBUG&&le("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),da(t)),this.hs(e,u,t,Lw(i,wa)).next(c=>c))})}cs(e,t){let n=new st(v0(e));return t.forEach((i,a)=>{uu(e,a)&&(n=n.add(a))}),n}ls(e,t,n,i){if(e.limit===null)return!1;if(n.size!==t.size)return!0;const a=e.limitType==="F"?t.last():t.first();return!!a&&(a.hasPendingWrites||a.version.compareTo(i)>0)}_s(e,t,n){return ha()<=Qe.DEBUG&&le("QueryEngine","Using full collection scan to execute query:",da(t)),this.ns.getDocumentsMatchingQuery(e,t,Xn.min(),n)}hs(e,t,n,i){return this.ns.getDocumentsMatchingQuery(e,n,i).next(a=>(t.forEach(u=>{a=a.insert(u.key,u)}),a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fm="LocalStore",xx=3e8;class Nx{constructor(e,t,n,i){this.persistence=e,this.Ps=t,this.serializer=i,this.Ts=new yt(Le),this.Is=new xs(a=>co(a),lu),this.Es=new Map,this.ds=e.getRemoteDocumentCache(),this.Hr=e.getTargetCache(),this.Yr=e.getBundleCache(),this.As(n)}As(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new tE(this.ds,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.ds.setIndexManager(this.indexManager),this.Ps.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Ts))}}function sE(r,e,t,n){return new Nx(r,e,t,n)}async function iE(r,e){const t=Ne(r);return await t.persistence.runTransaction("Handle user change","readonly",n=>{let i;return t.mutationQueue.getAllMutationBatches(n).next(a=>(i=a,t.As(e),t.mutationQueue.getAllMutationBatches(n))).next(a=>{const u=[],c=[];let d=$e();for(const p of i){u.push(p.batchId);for(const g of p.mutations)d=d.add(g.key)}for(const p of a){c.push(p.batchId);for(const g of p.mutations)d=d.add(g.key)}return t.localDocuments.getDocuments(n,d).next(p=>({Rs:p,removedBatchIds:u,addedBatchIds:c}))})})}function Rx(r,e){const t=Ne(r);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const i=e.batch.keys(),a=t.ds.newChangeBuffer({trackRemovals:!0});return function(c,d,p,g){const _=p.batch,E=_.keys();let C=q.resolve();return E.forEach(A=>{C=C.next(()=>g.getEntry(d,A)).next(P=>{const D=p.docVersions.get(A);ke(D!==null),P.version.compareTo(D)<0&&(_.applyToRemoteDocument(P,p),P.isValidDocument()&&(P.setReadTime(p.commitVersion),g.addEntry(P)))})}),C.next(()=>c.mutationQueue.removeMutationBatch(d,_))}(t,n,e,a).next(()=>a.apply(n)).next(()=>t.mutationQueue.performConsistencyCheck(n)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(n,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(c){let d=$e();for(let p=0;p<c.mutationResults.length;++p)c.mutationResults[p].transformResults.length>0&&(d=d.add(c.batch.mutations[p].key));return d}(e))).next(()=>t.localDocuments.getDocuments(n,i))})}function oE(r){const e=Ne(r);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Hr.getLastRemoteSnapshotVersion(t))}function Px(r,e){const t=Ne(r),n=e.snapshotVersion;let i=t.Ts;return t.persistence.runTransaction("Apply remote event","readwrite-primary",a=>{const u=t.ds.newChangeBuffer({trackRemovals:!0});i=t.Ts;const c=[];e.targetChanges.forEach((g,_)=>{const E=i.get(_);if(!E)return;c.push(t.Hr.removeMatchingKeys(a,g.removedDocuments,_).next(()=>t.Hr.addMatchingKeys(a,g.addedDocuments,_)));let C=E.withSequenceNumber(a.currentSequenceNumber);e.targetMismatches.get(_)!==null?C=C.withResumeToken(Dt.EMPTY_BYTE_STRING,De.min()).withLastLimboFreeSnapshotVersion(De.min()):g.resumeToken.approximateByteSize()>0&&(C=C.withResumeToken(g.resumeToken,n)),i=i.insert(_,C),function(P,D,B){return P.resumeToken.approximateByteSize()===0||D.snapshotVersion.toMicroseconds()-P.snapshotVersion.toMicroseconds()>=xx?!0:B.addedDocuments.size+B.modifiedDocuments.size+B.removedDocuments.size>0}(E,C,g)&&c.push(t.Hr.updateTargetData(a,C))});let d=ur(),p=$e();if(e.documentUpdates.forEach(g=>{e.resolvedLimboDocuments.has(g)&&c.push(t.persistence.referenceDelegate.updateLimboDocument(a,g))}),c.push(kx(a,u,e.documentUpdates).next(g=>{d=g.Vs,p=g.fs})),!n.isEqual(De.min())){const g=t.Hr.getLastRemoteSnapshotVersion(a).next(_=>t.Hr.setTargetsMetadata(a,a.currentSequenceNumber,n));c.push(g)}return q.waitFor(c).next(()=>u.apply(a)).next(()=>t.localDocuments.getLocalViewOfDocuments(a,d,p)).next(()=>d)}).then(a=>(t.Ts=i,a))}function kx(r,e,t){let n=$e(),i=$e();return t.forEach(a=>n=n.add(a)),e.getEntries(r,n).next(a=>{let u=ur();return t.forEach((c,d)=>{const p=a.get(c);d.isFoundDocument()!==p.isFoundDocument()&&(i=i.add(c)),d.isNoDocument()&&d.version.isEqual(De.min())?(e.removeEntry(c,d.readTime),u=u.insert(c,d)):!p.isValidDocument()||d.version.compareTo(p.version)>0||d.version.compareTo(p.version)===0&&p.hasPendingWrites?(e.addEntry(d),u=u.insert(c,d)):le(fm,"Ignoring outdated watch update for ",c,". Current version:",p.version," Watch version:",d.version)}),{Vs:u,fs:i}})}function bx(r,e){const t=Ne(r);return t.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=so),t.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function Sh(r,e){const t=Ne(r);return t.persistence.runTransaction("Allocate target","readwrite",n=>{let i;return t.Hr.getTargetData(n,e).next(a=>a?(i=a,q.resolve(i)):t.Hr.allocateTargetId(n).next(u=>(i=new Es(e,u,"TargetPurposeListen",n.currentSequenceNumber),t.Hr.addTargetData(n,i).next(()=>i))))}).then(n=>{const i=t.Ts.get(n.targetId);return(i===null||n.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.Ts=t.Ts.insert(n.targetId,n),t.Is.set(e,n.targetId)),n})}async function Pa(r,e,t){const n=Ne(r),i=n.Ts.get(e),a=t?"readwrite":"readwrite-primary";try{t||await n.persistence.runTransaction("Release target",a,u=>n.persistence.referenceDelegate.removeTarget(u,i))}catch(u){if(!_i(u))throw u;le(fm,`Failed to update sequence numbers for target ${e}: ${u}`)}n.Ts=n.Ts.remove(e),n.Is.delete(i.target)}function Np(r,e,t){const n=Ne(r);let i=De.min(),a=$e();return n.persistence.runTransaction("Execute query","readwrite",u=>function(d,p,g){const _=Ne(d),E=_.Is.get(g);return E!==void 0?q.resolve(_.Ts.get(E)):_.Hr.getTargetData(p,g)}(n,u,Qn(e)).next(c=>{if(c)return i=c.lastLimboFreeSnapshotVersion,n.Hr.getMatchingKeysForTargetId(u,c.targetId).next(d=>{a=d})}).next(()=>n.Ps.getDocumentsMatchingQuery(u,e,t?i:De.min(),t?a:$e())).next(c=>(uE(n,y0(e),c),{documents:c,gs:a})))}function aE(r,e){const t=Ne(r),n=Ne(t.Hr),i=t.Ts.get(e);return i?Promise.resolve(i.target):t.persistence.runTransaction("Get target data","readonly",a=>n.lt(a,e).next(u=>u?u.target:null))}function lE(r,e){const t=Ne(r),n=t.Es.get(e)||De.min();return t.persistence.runTransaction("Get new document changes","readonly",i=>t.ds.getAllFromCollectionGroup(i,e,Lw(n,wa),Number.MAX_SAFE_INTEGER)).then(i=>(uE(t,e,i),i))}function uE(r,e,t){let n=r.Es.get(e)||De.min();t.forEach((i,a)=>{a.readTime.compareTo(n)>0&&(n=a.readTime)}),r.Es.set(e,n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cE="firestore_clients";function c_(r,e){return`${cE}_${r}_${e}`}const hE="firestore_mutations";function h_(r,e,t){let n=`${hE}_${r}_${t}`;return e.isAuthenticated()&&(n+=`_${e.uid}`),n}const dE="firestore_targets";function Xf(r,e){return`${dE}_${r}_${e}`}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qr="SharedClientState";class Ch{constructor(e,t,n,i){this.user=e,this.batchId=t,this.state=n,this.error=i}static bs(e,t,n){const i=JSON.parse(n);let a,u=typeof i=="object"&&["pending","acknowledged","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return u&&i.error&&(u=typeof i.error.message=="string"&&typeof i.error.code=="string",u&&(a=new Ce(i.error.code,i.error.message))),u?new Ch(e,t,i.state,a):(kt(Qr,`Failed to parse mutation state for ID '${t}': ${n}`),null)}Ss(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Bl{constructor(e,t,n){this.targetId=e,this.state=t,this.error=n}static bs(e,t){const n=JSON.parse(t);let i,a=typeof n=="object"&&["not-current","current","rejected"].indexOf(n.state)!==-1&&(n.error===void 0||typeof n.error=="object");return a&&n.error&&(a=typeof n.error.message=="string"&&typeof n.error.code=="string",a&&(i=new Ce(n.error.code,n.error.message))),a?new Bl(e,n.state,i):(kt(Qr,`Failed to parse target state for ID '${e}': ${t}`),null)}Ss(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Ah{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static bs(e,t){const n=JSON.parse(t);let i=typeof n=="object"&&n.activeTargetIds instanceof Array,a=tm();for(let u=0;i&&u<n.activeTargetIds.length;++u)i=kC(n.activeTargetIds[u]),a=a.add(n.activeTargetIds[u]);return i?new Ah(e,a):(kt(Qr,`Failed to parse client data for instance '${e}': ${t}`),null)}}class pm{constructor(e,t){this.clientId=e,this.onlineState=t}static bs(e){const t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new pm(t.clientId,t.onlineState):(kt(Qr,`Failed to parse online state: ${e}`),null)}}class Rp{constructor(){this.activeTargetIds=tm()}Ds(e){this.activeTargetIds=this.activeTargetIds.add(e)}vs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ss(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Yf{constructor(e,t,n,i,a){this.window=e,this.Ti=t,this.persistenceKey=n,this.Cs=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.Fs=this.Ms.bind(this),this.xs=new yt(Le),this.started=!1,this.Os=[];const u=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=a,this.Ns=c_(this.persistenceKey,this.Cs),this.Bs=function(d){return`firestore_sequence_number_${d}`}(this.persistenceKey),this.xs=this.xs.insert(this.Cs,new Rp),this.Ls=new RegExp(`^${cE}_${u}_([^_]*)$`),this.ks=new RegExp(`^${hE}_${u}_(\\d+)(?:_(.*))?$`),this.qs=new RegExp(`^${dE}_${u}_(\\d+)$`),this.Qs=function(d){return`firestore_online_state_${d}`}(this.persistenceKey),this.$s=function(d){return`firestore_bundle_loaded_v2_${d}`}(this.persistenceKey),this.window.addEventListener("storage",this.Fs)}static D(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.zi();for(const n of e){if(n===this.Cs)continue;const i=this.getItem(c_(this.persistenceKey,n));if(i){const a=Ah.bs(n,i);a&&(this.xs=this.xs.insert(a.clientId,a))}}this.Ks();const t=this.storage.getItem(this.Qs);if(t){const n=this.Us(t);n&&this.Ws(n)}for(const n of this.Os)this.Ms(n);this.Os=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(e){this.setItem(this.Bs,JSON.stringify(e))}getAllActiveQueryTargets(){return this.Gs(this.xs)}isActiveQueryTarget(e){let t=!1;return this.xs.forEach((n,i)=>{i.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.zs(e,"pending")}updateMutationState(e,t,n){this.zs(e,t,n),this.js(e)}addLocalQueryTarget(e,t=!0){let n="not-current";if(this.isActiveQueryTarget(e)){const i=this.storage.getItem(Xf(this.persistenceKey,e));if(i){const a=Bl.bs(e,i);a&&(n=a.state)}}return t&&this.Hs.Ds(e),this.Ks(),n}removeLocalQueryTarget(e){this.Hs.vs(e),this.Ks()}isLocalQueryTarget(e){return this.Hs.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(Xf(this.persistenceKey,e))}updateQueryState(e,t,n){this.Js(e,t,n)}handleUserChange(e,t,n){t.forEach(i=>{this.js(i)}),this.currentUser=e,n.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.Ys(e)}notifyBundleLoaded(e){this.Zs(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.Fs),this.removeItem(this.Ns),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return le(Qr,"READ",e,t),t}setItem(e,t){le(Qr,"SET",e,t),this.storage.setItem(e,t)}removeItem(e){le(Qr,"REMOVE",e),this.storage.removeItem(e)}Ms(e){const t=e;if(t.storageArea===this.storage){if(le(Qr,"EVENT",t.key,t.newValue),t.key===this.Ns)return void kt("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Ti.enqueueRetryable(async()=>{if(this.started){if(t.key!==null){if(this.Ls.test(t.key)){if(t.newValue==null){const n=this.Xs(t.key);return this.eo(n,null)}{const n=this.no(t.key,t.newValue);if(n)return this.eo(n.clientId,n)}}else if(this.ks.test(t.key)){if(t.newValue!==null){const n=this.ro(t.key,t.newValue);if(n)return this.io(n)}}else if(this.qs.test(t.key)){if(t.newValue!==null){const n=this.so(t.key,t.newValue);if(n)return this.oo(n)}}else if(t.key===this.Qs){if(t.newValue!==null){const n=this.Us(t.newValue);if(n)return this.Ws(n)}}else if(t.key===this.Bs){const n=function(a){let u=Vn.ae;if(a!=null)try{const c=JSON.parse(a);ke(typeof c=="number"),u=c}catch(c){kt(Qr,"Failed to read sequence number from WebStorage",c)}return u}(t.newValue);n!==Vn.ae&&this.sequenceNumberHandler(n)}else if(t.key===this.$s){const n=this._o(t.newValue);await Promise.all(n.map(i=>this.syncEngine.ao(i)))}}}else this.Os.push(t)})}}get Hs(){return this.xs.get(this.Cs)}Ks(){this.setItem(this.Ns,this.Hs.Ss())}zs(e,t,n){const i=new Ch(this.currentUser,e,t,n),a=h_(this.persistenceKey,this.currentUser,e);this.setItem(a,i.Ss())}js(e){const t=h_(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Ys(e){const t={clientId:this.Cs,onlineState:e};this.storage.setItem(this.Qs,JSON.stringify(t))}Js(e,t,n){const i=Xf(this.persistenceKey,e),a=new Bl(e,t,n);this.setItem(i,a.Ss())}Zs(e){const t=JSON.stringify(Array.from(e));this.setItem(this.$s,t)}Xs(e){const t=this.Ls.exec(e);return t?t[1]:null}no(e,t){const n=this.Xs(e);return Ah.bs(n,t)}ro(e,t){const n=this.ks.exec(e),i=Number(n[1]),a=n[2]!==void 0?n[2]:null;return Ch.bs(new cn(a),i,t)}so(e,t){const n=this.qs.exec(e),i=Number(n[1]);return Bl.bs(i,t)}Us(e){return pm.bs(e)}_o(e){return JSON.parse(e)}async io(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.uo(e.batchId,e.state,e.error);le(Qr,`Ignoring mutation for non-active user ${e.user.uid}`)}oo(e){return this.syncEngine.co(e.targetId,e.state,e.error)}eo(e,t){const n=t?this.xs.insert(e,t):this.xs.remove(e),i=this.Gs(this.xs),a=this.Gs(n),u=[],c=[];return a.forEach(d=>{i.has(d)||u.push(d)}),i.forEach(d=>{a.has(d)||c.push(d)}),this.syncEngine.lo(u,c).then(()=>{this.xs=n})}Ws(e){this.xs.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}Gs(e){let t=tm();return e.forEach((n,i)=>{t=t.unionWith(i.activeTargetIds)}),t}}class fE{constructor(){this.ho=new Rp,this.Po={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e,t=!0){return t&&this.ho.Ds(e),this.Po[e]||"not-current"}updateQueryState(e,t,n){this.Po[e]=t}removeLocalQueryTarget(e){this.ho.vs(e)}isLocalQueryTarget(e){return this.ho.activeTargetIds.has(e)}clearQueryState(e){delete this.Po[e]}getAllActiveQueryTargets(){return this.ho.activeTargetIds}isActiveQueryTarget(e){return this.ho.activeTargetIds.has(e)}start(){return this.ho=new Rp,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dx{To(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const d_="ConnectivityMonitor";class f_{constructor(){this.Io=()=>this.Eo(),this.Ao=()=>this.Ro(),this.Vo=[],this.mo()}To(e){this.Vo.push(e)}shutdown(){window.removeEventListener("online",this.Io),window.removeEventListener("offline",this.Ao)}mo(){window.addEventListener("online",this.Io),window.addEventListener("offline",this.Ao)}Eo(){le(d_,"Network connectivity changed: AVAILABLE");for(const e of this.Vo)e(0)}Ro(){le(d_,"Network connectivity changed: UNAVAILABLE");for(const e of this.Vo)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let qc=null;function Pp(){return qc===null?qc=function(){return 268435456+Math.round(2147483648*Math.random())}():qc++,"0x"+qc.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zf="RestConnection",Vx={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Mx{get fo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.po=t+"://"+e.host,this.yo=`projects/${n}/databases/${i}`,this.wo=this.databaseId.database===fh?`project_id=${n}`:`project_id=${n}&database_id=${i}`}bo(e,t,n,i,a){const u=Pp(),c=this.So(e,t.toUriEncodedString());le(Zf,`Sending RPC '${e}' ${u}:`,c,n);const d={"google-cloud-resource-prefix":this.yo,"x-goog-request-params":this.wo};return this.Do(d,i,a),this.vo(e,c,d,n).then(p=>(le(Zf,`Received RPC '${e}' ${u}: `,p),p),p=>{throw $l(Zf,`RPC '${e}' ${u} failed with error: `,p,"url: ",c,"request:",n),p})}Co(e,t,n,i,a,u){return this.bo(e,t,n,i,a)}Do(e,t,n){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Oa}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((i,a)=>e[a]=i),n&&n.headers.forEach((i,a)=>e[a]=i)}So(e,t){const n=Vx[e];return`${this.po}/v1/${t}:${n}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ox{constructor(e){this.Fo=e.Fo,this.Mo=e.Mo}xo(e){this.Oo=e}No(e){this.Bo=e}Lo(e){this.ko=e}onMessage(e){this.qo=e}close(){this.Mo()}send(e){this.Fo(e)}Qo(){this.Oo()}$o(){this.Bo()}Ko(e){this.ko(e)}Uo(e){this.qo(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ln="WebChannelConnection";class Fx extends Mx{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}vo(e,t,n,i){const a=Pp();return new Promise((u,c)=>{const d=new kw;d.setWithCredentials(!0),d.listenOnce(bw.COMPLETE,()=>{try{switch(d.getLastErrorCode()){case Kc.NO_ERROR:const g=d.getResponseJson();le(ln,`XHR for RPC '${e}' ${a} received:`,JSON.stringify(g)),u(g);break;case Kc.TIMEOUT:le(ln,`RPC '${e}' ${a} timed out`),c(new Ce(ie.DEADLINE_EXCEEDED,"Request time out"));break;case Kc.HTTP_ERROR:const _=d.getStatus();if(le(ln,`RPC '${e}' ${a} failed with status:`,_,"response text:",d.getResponseText()),_>0){let E=d.getResponseJson();Array.isArray(E)&&(E=E[0]);const C=E==null?void 0:E.error;if(C&&C.status&&C.message){const A=function(D){const B=D.toLowerCase().replace(/_/g,"-");return Object.values(ie).indexOf(B)>=0?B:ie.UNKNOWN}(C.status);c(new Ce(A,C.message))}else c(new Ce(ie.UNKNOWN,"Server responded with status "+d.getStatus()))}else c(new Ce(ie.UNAVAILABLE,"Connection failed."));break;default:Ae()}}finally{le(ln,`RPC '${e}' ${a} completed.`)}});const p=JSON.stringify(i);le(ln,`RPC '${e}' ${a} sending request:`,i),d.send(t,"POST",p,n,15)})}Wo(e,t,n){const i=Pp(),a=[this.po,"/","google.firestore.v1.Firestore","/",e,"/channel"],u=Mw(),c=Vw(),d={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},p=this.longPollingOptions.timeoutSeconds;p!==void 0&&(d.longPollingTimeout=Math.round(1e3*p)),this.useFetchStreams&&(d.useFetchStreams=!0),this.Do(d.initMessageHeaders,t,n),d.encodeInitMessageHeaders=!0;const g=a.join("");le(ln,`Creating RPC '${e}' stream ${i}: ${g}`,d);const _=u.createWebChannel(g,d);let E=!1,C=!1;const A=new Ox({Fo:D=>{C?le(ln,`Not sending because RPC '${e}' stream ${i} is closed:`,D):(E||(le(ln,`Opening RPC '${e}' stream ${i} transport.`),_.open(),E=!0),le(ln,`RPC '${e}' stream ${i} sending:`,D),_.send(D))},Mo:()=>_.close()}),P=(D,B,W)=>{D.listen(B,$=>{try{W($)}catch(X){setTimeout(()=>{throw X},0)}})};return P(_,Pl.EventType.OPEN,()=>{C||(le(ln,`RPC '${e}' stream ${i} transport opened.`),A.Qo())}),P(_,Pl.EventType.CLOSE,()=>{C||(C=!0,le(ln,`RPC '${e}' stream ${i} transport closed`),A.Ko())}),P(_,Pl.EventType.ERROR,D=>{C||(C=!0,$l(ln,`RPC '${e}' stream ${i} transport errored:`,D),A.Ko(new Ce(ie.UNAVAILABLE,"The operation could not be completed")))}),P(_,Pl.EventType.MESSAGE,D=>{var B;if(!C){const W=D.data[0];ke(!!W);const $=W,X=($==null?void 0:$.error)||((B=$[0])===null||B===void 0?void 0:B.error);if(X){le(ln,`RPC '${e}' stream ${i} received error:`,X);const F=X.status;let U=function(R){const b=Ft[R];if(b!==void 0)return x0(b)}(F),N=X.message;U===void 0&&(U=ie.INTERNAL,N="Unknown error status: "+F+" with message "+X.message),C=!0,A.Ko(new Ce(U,N)),_.close()}else le(ln,`RPC '${e}' stream ${i} received:`,W),A.Uo(W)}}),P(c,Dw.STAT_EVENT,D=>{D.stat===up.PROXY?le(ln,`RPC '${e}' stream ${i} detected buffering proxy`):D.stat===up.NOPROXY&&le(ln,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{A.$o()},0),A}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pE(){return typeof window<"u"?window:null}function th(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mE(r){return new UA(r,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gE{constructor(e,t,n=1e3,i=1.5,a=6e4){this.Ti=e,this.timerId=t,this.Go=n,this.zo=i,this.jo=a,this.Ho=0,this.Jo=null,this.Yo=Date.now(),this.reset()}reset(){this.Ho=0}Zo(){this.Ho=this.jo}Xo(e){this.cancel();const t=Math.floor(this.Ho+this.e_()),n=Math.max(0,Date.now()-this.Yo),i=Math.max(0,t-n);i>0&&le("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ho} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.Jo=this.Ti.enqueueAfterDelay(this.timerId,i,()=>(this.Yo=Date.now(),e())),this.Ho*=this.zo,this.Ho<this.Go&&(this.Ho=this.Go),this.Ho>this.jo&&(this.Ho=this.jo)}t_(){this.Jo!==null&&(this.Jo.skipDelay(),this.Jo=null)}cancel(){this.Jo!==null&&(this.Jo.cancel(),this.Jo=null)}e_(){return(Math.random()-.5)*this.Ho}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p_="PersistentStream";class yE{constructor(e,t,n,i,a,u,c,d){this.Ti=e,this.n_=n,this.r_=i,this.connection=a,this.authCredentialsProvider=u,this.appCheckCredentialsProvider=c,this.listener=d,this.state=0,this.i_=0,this.s_=null,this.o_=null,this.stream=null,this.__=0,this.a_=new gE(e,t)}u_(){return this.state===1||this.state===5||this.c_()}c_(){return this.state===2||this.state===3}start(){this.__=0,this.state!==4?this.auth():this.l_()}async stop(){this.u_()&&await this.close(0)}h_(){this.state=0,this.a_.reset()}P_(){this.c_()&&this.s_===null&&(this.s_=this.Ti.enqueueAfterDelay(this.n_,6e4,()=>this.T_()))}I_(e){this.E_(),this.stream.send(e)}async T_(){if(this.c_())return this.close(0)}E_(){this.s_&&(this.s_.cancel(),this.s_=null)}d_(){this.o_&&(this.o_.cancel(),this.o_=null)}async close(e,t){this.E_(),this.d_(),this.a_.cancel(),this.i_++,e!==4?this.a_.reset():t&&t.code===ie.RESOURCE_EXHAUSTED?(kt(t.toString()),kt("Using maximum backoff delay to prevent overloading the backend."),this.a_.Zo()):t&&t.code===ie.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.A_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.Lo(t)}A_(){}auth(){this.state=1;const e=this.R_(this.i_),t=this.i_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,i])=>{this.i_===t&&this.V_(n,i)},n=>{e(()=>{const i=new Ce(ie.UNKNOWN,"Fetching auth token failed: "+n.message);return this.m_(i)})})}V_(e,t){const n=this.R_(this.i_);this.stream=this.f_(e,t),this.stream.xo(()=>{n(()=>this.listener.xo())}),this.stream.No(()=>{n(()=>(this.state=2,this.o_=this.Ti.enqueueAfterDelay(this.r_,1e4,()=>(this.c_()&&(this.state=3),Promise.resolve())),this.listener.No()))}),this.stream.Lo(i=>{n(()=>this.m_(i))}),this.stream.onMessage(i=>{n(()=>++this.__==1?this.g_(i):this.onNext(i))})}l_(){this.state=5,this.a_.Xo(async()=>{this.state=0,this.start()})}m_(e){return le(p_,`close with error: ${e}`),this.stream=null,this.close(4,e)}R_(e){return t=>{this.Ti.enqueueAndForget(()=>this.i_===e?t():(le(p_,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class Lx extends yE{constructor(e,t,n,i,a,u){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,i,u),this.serializer=a}f_(e,t){return this.connection.Wo("Listen",e,t)}g_(e){return this.onNext(e)}onNext(e){this.a_.reset();const t=GA(this.serializer,e),n=function(a){if(!("targetChange"in a))return De.min();const u=a.targetChange;return u.targetIds&&u.targetIds.length?De.min():u.readTime?En(u.readTime):De.min()}(e);return this.listener.p_(t,n)}y_(e){const t={};t.database=Ip(this.serializer),t.addTarget=function(a,u){let c;const d=u.target;if(c=mh(d)?{documents:M0(a,d)}:{query:O0(a,d).ht},c.targetId=u.targetId,u.resumeToken.approximateByteSize()>0){c.resumeToken=$A(a,u.resumeToken);const p=Ep(a,u.expectedCount);p!==null&&(c.expectedCount=p)}else if(u.snapshotVersion.compareTo(De.min())>0){c.readTime=yh(a,u.snapshotVersion.toTimestamp());const p=Ep(a,u.expectedCount);p!==null&&(c.expectedCount=p)}return c}(this.serializer,e);const n=HA(this.serializer,e);n&&(t.labels=n),this.I_(t)}w_(e){const t={};t.database=Ip(this.serializer),t.removeTarget=e,this.I_(t)}}class jx extends yE{constructor(e,t,n,i,a,u){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,i,u),this.serializer=a}get b_(){return this.__>0}start(){this.lastStreamToken=void 0,super.start()}A_(){this.b_&&this.S_([])}f_(e,t){return this.connection.Wo("Write",e,t)}g_(e){return ke(!!e.streamToken),this.lastStreamToken=e.streamToken,ke(!e.writeResults||e.writeResults.length===0),this.listener.D_()}onNext(e){ke(!!e.streamToken),this.lastStreamToken=e.streamToken,this.a_.reset();const t=KA(e.writeResults,e.commitTime),n=En(e.commitTime);return this.listener.v_(n,t)}C_(){const e={};e.database=Ip(this.serializer),this.I_(e)}S_(e){const t={streamToken:this.lastStreamToken,writes:e.map(n=>_h(this.serializer,n))};this.I_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bx{}class zx extends Bx{constructor(e,t,n,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=i,this.F_=!1}M_(){if(this.F_)throw new Ce(ie.FAILED_PRECONDITION,"The client has already been terminated.")}bo(e,t,n,i){return this.M_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,u])=>this.connection.bo(e,Tp(t,n),i,a,u)).catch(a=>{throw a.name==="FirebaseError"?(a.code===ie.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new Ce(ie.UNKNOWN,a.toString())})}Co(e,t,n,i,a){return this.M_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([u,c])=>this.connection.Co(e,Tp(t,n),i,u,c,a)).catch(u=>{throw u.name==="FirebaseError"?(u.code===ie.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),u):new Ce(ie.UNKNOWN,u.toString())})}terminate(){this.F_=!0,this.connection.terminate()}}class Ux{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.x_=0,this.O_=null,this.N_=!0}B_(){this.x_===0&&(this.L_("Unknown"),this.O_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.O_=null,this.k_("Backend didn't respond within 10 seconds."),this.L_("Offline"),Promise.resolve())))}q_(e){this.state==="Online"?this.L_("Unknown"):(this.x_++,this.x_>=1&&(this.Q_(),this.k_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.L_("Offline")))}set(e){this.Q_(),this.x_=0,e==="Online"&&(this.N_=!1),this.L_(e)}L_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}k_(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.N_?(kt(t),this.N_=!1):le("OnlineStateTracker",t)}Q_(){this.O_!==null&&(this.O_.cancel(),this.O_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mo="RemoteStore";class $x{constructor(e,t,n,i,a){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.K_=[],this.U_=new Map,this.W_=new Set,this.G_=[],this.z_=a,this.z_.To(u=>{n.enqueueAndForget(async()=>{vo(this)&&(le(mo,"Restarting streams for network reachability change."),await async function(d){const p=Ne(d);p.W_.add(4),await fu(p),p.j_.set("Unknown"),p.W_.delete(4),await Zh(p)}(this))})}),this.j_=new Ux(n,i)}}async function Zh(r){if(vo(r))for(const e of r.G_)await e(!0)}async function fu(r){for(const e of r.G_)await e(!1)}function Jh(r,e){const t=Ne(r);t.U_.has(e.targetId)||(t.U_.set(e.targetId,e),ym(t)?gm(t):La(t).c_()&&mm(t,e))}function ka(r,e){const t=Ne(r),n=La(t);t.U_.delete(e),n.c_()&&vE(t,e),t.U_.size===0&&(n.c_()?n.P_():vo(t)&&t.j_.set("Unknown"))}function mm(r,e){if(r.H_.Ne(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(De.min())>0){const t=r.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}La(r).y_(e)}function vE(r,e){r.H_.Ne(e),La(r).w_(e)}function gm(r){r.H_=new LA({getRemoteKeysForTarget:e=>r.remoteSyncer.getRemoteKeysForTarget(e),lt:e=>r.U_.get(e)||null,it:()=>r.datastore.serializer.databaseId}),La(r).start(),r.j_.B_()}function ym(r){return vo(r)&&!La(r).u_()&&r.U_.size>0}function vo(r){return Ne(r).W_.size===0}function _E(r){r.H_=void 0}async function qx(r){r.j_.set("Online")}async function Wx(r){r.U_.forEach((e,t)=>{mm(r,e)})}async function Gx(r,e){_E(r),ym(r)?(r.j_.q_(e),gm(r)):r.j_.set("Unknown")}async function Kx(r,e,t){if(r.j_.set("Online"),e instanceof R0&&e.state===2&&e.cause)try{await async function(i,a){const u=a.cause;for(const c of a.targetIds)i.U_.has(c)&&(await i.remoteSyncer.rejectListen(c,u),i.U_.delete(c),i.H_.removeTarget(c))}(r,e)}catch(n){le(mo,"Failed to remove targets %s: %s ",e.targetIds.join(","),n),await xh(r,n)}else if(e instanceof eh?r.H_.We(e):e instanceof N0?r.H_.Ze(e):r.H_.je(e),!t.isEqual(De.min()))try{const n=await oE(r.localStore);t.compareTo(n)>=0&&await function(a,u){const c=a.H_.ot(u);return c.targetChanges.forEach((d,p)=>{if(d.resumeToken.approximateByteSize()>0){const g=a.U_.get(p);g&&a.U_.set(p,g.withResumeToken(d.resumeToken,u))}}),c.targetMismatches.forEach((d,p)=>{const g=a.U_.get(d);if(!g)return;a.U_.set(d,g.withResumeToken(Dt.EMPTY_BYTE_STRING,g.snapshotVersion)),vE(a,d);const _=new Es(g.target,d,p,g.sequenceNumber);mm(a,_)}),a.remoteSyncer.applyRemoteEvent(c)}(r,t)}catch(n){le(mo,"Failed to raise snapshot:",n),await xh(r,n)}}async function xh(r,e,t){if(!_i(e))throw e;r.W_.add(1),await fu(r),r.j_.set("Offline"),t||(t=()=>oE(r.localStore)),r.asyncQueue.enqueueRetryable(async()=>{le(mo,"Retrying IndexedDB access"),await t(),r.W_.delete(1),await Zh(r)})}function wE(r,e){return e().catch(t=>xh(r,t,e))}async function pu(r){const e=Ne(r),t=gi(e);let n=e.K_.length>0?e.K_[e.K_.length-1].batchId:so;for(;Hx(e);)try{const i=await bx(e.localStore,n);if(i===null){e.K_.length===0&&t.P_();break}n=i.batchId,Qx(e,i)}catch(i){await xh(e,i)}EE(e)&&TE(e)}function Hx(r){return vo(r)&&r.K_.length<10}function Qx(r,e){r.K_.push(e);const t=gi(r);t.c_()&&t.b_&&t.S_(e.mutations)}function EE(r){return vo(r)&&!gi(r).u_()&&r.K_.length>0}function TE(r){gi(r).start()}async function Xx(r){gi(r).C_()}async function Yx(r){const e=gi(r);for(const t of r.K_)e.S_(t.mutations)}async function Zx(r,e,t){const n=r.K_.shift(),i=sm.from(n,e,t);await wE(r,()=>r.remoteSyncer.applySuccessfulWrite(i)),await pu(r)}async function Jx(r,e){e&&gi(r).b_&&await async function(n,i){if(function(u){return MA(u)&&u!==ie.ABORTED}(i.code)){const a=n.K_.shift();gi(n).h_(),await wE(n,()=>n.remoteSyncer.rejectFailedWrite(a.batchId,i)),await pu(n)}}(r,e),EE(r)&&TE(r)}async function m_(r,e){const t=Ne(r);t.asyncQueue.verifyOperationInProgress(),le(mo,"RemoteStore received new credentials");const n=vo(t);t.W_.add(3),await fu(t),n&&t.j_.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.W_.delete(3),await Zh(t)}async function kp(r,e){const t=Ne(r);e?(t.W_.delete(2),await Zh(t)):e||(t.W_.add(2),await fu(t),t.j_.set("Unknown"))}function La(r){return r.J_||(r.J_=function(t,n,i){const a=Ne(t);return a.M_(),new Lx(n,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,i)}(r.datastore,r.asyncQueue,{xo:qx.bind(null,r),No:Wx.bind(null,r),Lo:Gx.bind(null,r),p_:Kx.bind(null,r)}),r.G_.push(async e=>{e?(r.J_.h_(),ym(r)?gm(r):r.j_.set("Unknown")):(await r.J_.stop(),_E(r))})),r.J_}function gi(r){return r.Y_||(r.Y_=function(t,n,i){const a=Ne(t);return a.M_(),new jx(n,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,i)}(r.datastore,r.asyncQueue,{xo:()=>Promise.resolve(),No:Xx.bind(null,r),Lo:Jx.bind(null,r),D_:Yx.bind(null,r),v_:Zx.bind(null,r)}),r.G_.push(async e=>{e?(r.Y_.h_(),await pu(r)):(await r.Y_.stop(),r.K_.length>0&&(le(mo,`Stopping write stream with ${r.K_.length} pending writes`),r.K_=[]))})),r.Y_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vm{constructor(e,t,n,i,a){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=i,this.removalCallback=a,this.deferred=new di,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(u=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,i,a){const u=Date.now()+n,c=new vm(e,t,u,i,a);return c.start(n),c}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Ce(ie.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function IE(r,e){if(kt("AsyncQueue",`${e}: ${r}`),_i(r))return new Ce(ie.UNAVAILABLE,`${e}: ${r}`);throw r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ya{static emptySet(e){return new ya(e.comparator)}constructor(e){this.comparator=e?(t,n)=>e(t,n)||_e.comparator(t.key,n.key):(t,n)=>_e.comparator(t.key,n.key),this.keyedMap=kl(),this.sortedSet=new yt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,n)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof ya)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const i=t.getNext().key,a=n.getNext().key;if(!i.isEqual(a))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const n=new ya;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g_{constructor(){this.Z_=new yt(_e.comparator)}track(e){const t=e.doc.key,n=this.Z_.get(t);n?e.type!==0&&n.type===3?this.Z_=this.Z_.insert(t,e):e.type===3&&n.type!==1?this.Z_=this.Z_.insert(t,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.Z_=this.Z_.insert(t,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.Z_=this.Z_.insert(t,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.Z_=this.Z_.remove(t):e.type===1&&n.type===2?this.Z_=this.Z_.insert(t,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.Z_=this.Z_.insert(t,{type:2,doc:e.doc}):Ae():this.Z_=this.Z_.insert(t,e)}X_(){const e=[];return this.Z_.inorderTraversal((t,n)=>{e.push(n)}),e}}class ba{constructor(e,t,n,i,a,u,c,d,p){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=a,this.fromCache=u,this.syncStateChanged=c,this.excludesMetadataChanges=d,this.hasCachedResults=p}static fromInitialDocuments(e,t,n,i,a){const u=[];return t.forEach(c=>{u.push({type:0,doc:c})}),new ba(e,t,ya.emptySet(t),u,n,i,!0,!1,a)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Gh(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==n[i].type||!t[i].doc.isEqual(n[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eN{constructor(){this.ea=void 0,this.ta=[]}na(){return this.ta.some(e=>e.ra())}}class tN{constructor(){this.queries=y_(),this.onlineState="Unknown",this.ia=new Set}terminate(){(function(t,n){const i=Ne(t),a=i.queries;i.queries=y_(),a.forEach((u,c)=>{for(const d of c.ta)d.onError(n)})})(this,new Ce(ie.ABORTED,"Firestore shutting down"))}}function y_(){return new xs(r=>g0(r),Gh)}async function nN(r,e){const t=Ne(r);let n=3;const i=e.query;let a=t.queries.get(i);a?!a.na()&&e.ra()&&(n=2):(a=new eN,n=e.ra()?0:1);try{switch(n){case 0:a.ea=await t.onListen(i,!0);break;case 1:a.ea=await t.onListen(i,!1);break;case 2:await t.onFirstRemoteStoreListen(i)}}catch(u){const c=IE(u,`Initialization of query '${da(e.query)}' failed`);return void e.onError(c)}t.queries.set(i,a),a.ta.push(e),e.sa(t.onlineState),a.ea&&e.oa(a.ea)&&_m(t)}async function rN(r,e){const t=Ne(r),n=e.query;let i=3;const a=t.queries.get(n);if(a){const u=a.ta.indexOf(e);u>=0&&(a.ta.splice(u,1),a.ta.length===0?i=e.ra()?0:1:!a.na()&&e.ra()&&(i=2))}switch(i){case 0:return t.queries.delete(n),t.onUnlisten(n,!0);case 1:return t.queries.delete(n),t.onUnlisten(n,!1);case 2:return t.onLastRemoteStoreUnlisten(n);default:return}}function sN(r,e){const t=Ne(r);let n=!1;for(const i of e){const a=i.query,u=t.queries.get(a);if(u){for(const c of u.ta)c.oa(i)&&(n=!0);u.ea=i}}n&&_m(t)}function iN(r,e,t){const n=Ne(r),i=n.queries.get(e);if(i)for(const a of i.ta)a.onError(t);n.queries.delete(e)}function _m(r){r.ia.forEach(e=>{e.next()})}var bp,v_;(v_=bp||(bp={}))._a="default",v_.Cache="cache";class oN{constructor(e,t,n){this.query=e,this.aa=t,this.ua=!1,this.ca=null,this.onlineState="Unknown",this.options=n||{}}oa(e){if(!this.options.includeMetadataChanges){const n=[];for(const i of e.docChanges)i.type!==3&&n.push(i);e=new ba(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.ua?this.la(e)&&(this.aa.next(e),t=!0):this.ha(e,this.onlineState)&&(this.Pa(e),t=!0),this.ca=e,t}onError(e){this.aa.error(e)}sa(e){this.onlineState=e;let t=!1;return this.ca&&!this.ua&&this.ha(this.ca,e)&&(this.Pa(this.ca),t=!0),t}ha(e,t){if(!e.fromCache||!this.ra())return!0;const n=t!=="Offline";return(!this.options.Ta||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}la(e){if(e.docChanges.length>0)return!0;const t=this.ca&&this.ca.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}Pa(e){e=ba.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.ua=!0,this.aa.next(e)}ra(){return this.options.source!==bp.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SE{constructor(e){this.key=e}}class CE{constructor(e){this.key=e}}class aN{constructor(e,t){this.query=e,this.fa=t,this.ga=null,this.hasCachedResults=!1,this.current=!1,this.pa=$e(),this.mutatedKeys=$e(),this.ya=v0(e),this.wa=new ya(this.ya)}get ba(){return this.fa}Sa(e,t){const n=t?t.Da:new g_,i=t?t.wa:this.wa;let a=t?t.mutatedKeys:this.mutatedKeys,u=i,c=!1;const d=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,p=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((g,_)=>{const E=i.get(g),C=uu(this.query,_)?_:null,A=!!E&&this.mutatedKeys.has(E.key),P=!!C&&(C.hasLocalMutations||this.mutatedKeys.has(C.key)&&C.hasCommittedMutations);let D=!1;E&&C?E.data.isEqual(C.data)?A!==P&&(n.track({type:3,doc:C}),D=!0):this.va(E,C)||(n.track({type:2,doc:C}),D=!0,(d&&this.ya(C,d)>0||p&&this.ya(C,p)<0)&&(c=!0)):!E&&C?(n.track({type:0,doc:C}),D=!0):E&&!C&&(n.track({type:1,doc:E}),D=!0,(d||p)&&(c=!0)),D&&(C?(u=u.add(C),a=P?a.add(g):a.delete(g)):(u=u.delete(g),a=a.delete(g)))}),this.query.limit!==null)for(;u.size>this.query.limit;){const g=this.query.limitType==="F"?u.last():u.first();u=u.delete(g.key),a=a.delete(g.key),n.track({type:1,doc:g})}return{wa:u,Da:n,ls:c,mutatedKeys:a}}va(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,i){const a=this.wa;this.wa=e.wa,this.mutatedKeys=e.mutatedKeys;const u=e.Da.X_();u.sort((g,_)=>function(C,A){const P=D=>{switch(D){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ae()}};return P(C)-P(A)}(g.type,_.type)||this.ya(g.doc,_.doc)),this.Ca(n),i=i!=null&&i;const c=t&&!i?this.Fa():[],d=this.pa.size===0&&this.current&&!i?1:0,p=d!==this.ga;return this.ga=d,u.length!==0||p?{snapshot:new ba(this.query,e.wa,a,u,e.mutatedKeys,d===0,p,!1,!!n&&n.resumeToken.approximateByteSize()>0),Ma:c}:{Ma:c}}sa(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({wa:this.wa,Da:new g_,mutatedKeys:this.mutatedKeys,ls:!1},!1)):{Ma:[]}}xa(e){return!this.fa.has(e)&&!!this.wa.has(e)&&!this.wa.get(e).hasLocalMutations}Ca(e){e&&(e.addedDocuments.forEach(t=>this.fa=this.fa.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.fa=this.fa.delete(t)),this.current=e.current)}Fa(){if(!this.current)return[];const e=this.pa;this.pa=$e(),this.wa.forEach(n=>{this.xa(n.key)&&(this.pa=this.pa.add(n.key))});const t=[];return e.forEach(n=>{this.pa.has(n)||t.push(new CE(n))}),this.pa.forEach(n=>{e.has(n)||t.push(new SE(n))}),t}Oa(e){this.fa=e.gs,this.pa=$e();const t=this.Sa(e.documents);return this.applyChanges(t,!0)}Na(){return ba.fromInitialDocuments(this.query,this.wa,this.mutatedKeys,this.ga===0,this.hasCachedResults)}}const ja="SyncEngine";class lN{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class uN{constructor(e){this.key=e,this.Ba=!1}}class cN{constructor(e,t,n,i,a,u){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=i,this.currentUser=a,this.maxConcurrentLimboResolutions=u,this.La={},this.ka=new xs(c=>g0(c),Gh),this.qa=new Map,this.Qa=new Set,this.$a=new yt(_e.comparator),this.Ka=new Map,this.Ua=new um,this.Wa={},this.Ga=new Map,this.za=po.Un(),this.onlineState="Unknown",this.ja=void 0}get isPrimaryClient(){return this.ja===!0}}async function hN(r,e,t=!0){const n=ed(r);let i;const a=n.ka.get(e);return a?(n.sharedClientState.addLocalQueryTarget(a.targetId),i=a.view.Na()):i=await AE(n,e,t,!0),i}async function dN(r,e){const t=ed(r);await AE(t,e,!0,!1)}async function AE(r,e,t,n){const i=await Sh(r.localStore,Qn(e)),a=i.targetId,u=r.sharedClientState.addLocalQueryTarget(a,t);let c;return n&&(c=await wm(r,e,a,u==="current",i.resumeToken)),r.isPrimaryClient&&t&&Jh(r.remoteStore,i),c}async function wm(r,e,t,n,i){r.Ha=(_,E,C)=>async function(P,D,B,W){let $=D.view.Sa(B);$.ls&&($=await Np(P.localStore,D.query,!1).then(({documents:N})=>D.view.Sa(N,$)));const X=W&&W.targetChanges.get(D.targetId),F=W&&W.targetMismatches.get(D.targetId)!=null,U=D.view.applyChanges($,P.isPrimaryClient,X,F);return Dp(P,D.targetId,U.Ma),U.snapshot}(r,_,E,C);const a=await Np(r.localStore,e,!0),u=new aN(e,a.gs),c=u.Sa(a.documents),d=du.createSynthesizedTargetChangeForCurrentChange(t,n&&r.onlineState!=="Offline",i),p=u.applyChanges(c,r.isPrimaryClient,d);Dp(r,t,p.Ma);const g=new lN(e,t,u);return r.ka.set(e,g),r.qa.has(t)?r.qa.get(t).push(e):r.qa.set(t,[e]),p.snapshot}async function fN(r,e,t){const n=Ne(r),i=n.ka.get(e),a=n.qa.get(i.targetId);if(a.length>1)return n.qa.set(i.targetId,a.filter(u=>!Gh(u,e))),void n.ka.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(i.targetId),n.sharedClientState.isActiveQueryTarget(i.targetId)||await Pa(n.localStore,i.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(i.targetId),t&&ka(n.remoteStore,i.targetId),Da(n,i.targetId)}).catch(vi)):(Da(n,i.targetId),await Pa(n.localStore,i.targetId,!0))}async function pN(r,e){const t=Ne(r),n=t.ka.get(e),i=t.qa.get(n.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(n.targetId),ka(t.remoteStore,n.targetId))}async function xE(r,e){const t=Ne(r);try{const n=await Px(t.localStore,e);e.targetChanges.forEach((i,a)=>{const u=t.Ka.get(a);u&&(ke(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?u.Ba=!0:i.modifiedDocuments.size>0?ke(u.Ba):i.removedDocuments.size>0&&(ke(u.Ba),u.Ba=!1))}),await _o(t,n,e)}catch(n){await vi(n)}}function __(r,e,t){const n=Ne(r);if(n.isPrimaryClient&&t===0||!n.isPrimaryClient&&t===1){const i=[];n.ka.forEach((a,u)=>{const c=u.view.sa(e);c.snapshot&&i.push(c.snapshot)}),function(u,c){const d=Ne(u);d.onlineState=c;let p=!1;d.queries.forEach((g,_)=>{for(const E of _.ta)E.sa(c)&&(p=!0)}),p&&_m(d)}(n.eventManager,e),i.length&&n.La.p_(i),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function mN(r,e,t){const n=Ne(r);n.sharedClientState.updateQueryState(e,"rejected",t);const i=n.Ka.get(e),a=i&&i.key;if(a){let u=new yt(_e.comparator);u=u.insert(a,At.newNoDocument(a,De.min()));const c=$e().add(a),d=new hu(De.min(),new Map,new yt(Le),u,c);await xE(n,d),n.$a=n.$a.remove(a),n.Ka.delete(e),Im(n)}else await Pa(n.localStore,e,!1).then(()=>Da(n,e,t)).catch(vi)}async function gN(r,e){const t=Ne(r),n=e.batch.batchId;try{const i=await Rx(t.localStore,e);Tm(t,n,null),Em(t,n),t.sharedClientState.updateMutationState(n,"acknowledged"),await _o(t,i)}catch(i){await vi(i)}}async function yN(r,e,t){const n=Ne(r);try{const i=await function(u,c){const d=Ne(u);return d.persistence.runTransaction("Reject batch","readwrite-primary",p=>{let g;return d.mutationQueue.lookupMutationBatch(p,c).next(_=>(ke(_!==null),g=_.keys(),d.mutationQueue.removeMutationBatch(p,_))).next(()=>d.mutationQueue.performConsistencyCheck(p)).next(()=>d.documentOverlayCache.removeOverlaysForBatchId(p,g,c)).next(()=>d.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(p,g)).next(()=>d.localDocuments.getDocuments(p,g))})}(n.localStore,e);Tm(n,e,t),Em(n,e),n.sharedClientState.updateMutationState(e,"rejected",t),await _o(n,i)}catch(i){await vi(i)}}function Em(r,e){(r.Ga.get(e)||[]).forEach(t=>{t.resolve()}),r.Ga.delete(e)}function Tm(r,e,t){const n=Ne(r);let i=n.Wa[n.currentUser.toKey()];if(i){const a=i.get(e);a&&(t?a.reject(t):a.resolve(),i=i.remove(e)),n.Wa[n.currentUser.toKey()]=i}}function Da(r,e,t=null){r.sharedClientState.removeLocalQueryTarget(e);for(const n of r.qa.get(e))r.ka.delete(n),t&&r.La.Ja(n,t);r.qa.delete(e),r.isPrimaryClient&&r.Ua.Sr(e).forEach(n=>{r.Ua.containsKey(n)||NE(r,n)})}function NE(r,e){r.Qa.delete(e.path.canonicalString());const t=r.$a.get(e);t!==null&&(ka(r.remoteStore,t),r.$a=r.$a.remove(e),r.Ka.delete(t),Im(r))}function Dp(r,e,t){for(const n of t)n instanceof SE?(r.Ua.addReference(n.key,e),vN(r,n)):n instanceof CE?(le(ja,"Document no longer in limbo: "+n.key),r.Ua.removeReference(n.key,e),r.Ua.containsKey(n.key)||NE(r,n.key)):Ae()}function vN(r,e){const t=e.key,n=t.path.canonicalString();r.$a.get(t)||r.Qa.has(n)||(le(ja,"New document in limbo: "+t),r.Qa.add(n),Im(r))}function Im(r){for(;r.Qa.size>0&&r.$a.size<r.maxConcurrentLimboResolutions;){const e=r.Qa.values().next().value;r.Qa.delete(e);const t=new _e(lt.fromString(e)),n=r.za.next();r.Ka.set(n,new uN(t)),r.$a=r.$a.insert(t,n),Jh(r.remoteStore,new Es(Qn(Wh(t.path)),n,"TargetPurposeLimboResolution",Vn.ae))}}async function _o(r,e,t){const n=Ne(r),i=[],a=[],u=[];n.ka.isEmpty()||(n.ka.forEach((c,d)=>{u.push(n.Ha(d,e,t).then(p=>{var g;if((p||t)&&n.isPrimaryClient){const _=p?!p.fromCache:(g=t==null?void 0:t.targetChanges.get(d.targetId))===null||g===void 0?void 0:g.current;n.sharedClientState.updateQueryState(d.targetId,_?"current":"not-current")}if(p){i.push(p);const _=dm.Yi(d.targetId,p);a.push(_)}}))}),await Promise.all(u),n.La.p_(i),await async function(d,p){const g=Ne(d);try{await g.persistence.runTransaction("notifyLocalViewChanges","readwrite",_=>q.forEach(p,E=>q.forEach(E.Hi,C=>g.persistence.referenceDelegate.addReference(_,E.targetId,C)).next(()=>q.forEach(E.Ji,C=>g.persistence.referenceDelegate.removeReference(_,E.targetId,C)))))}catch(_){if(!_i(_))throw _;le(fm,"Failed to update sequence numbers: "+_)}for(const _ of p){const E=_.targetId;if(!_.fromCache){const C=g.Ts.get(E),A=C.snapshotVersion,P=C.withLastLimboFreeSnapshotVersion(A);g.Ts=g.Ts.insert(E,P)}}}(n.localStore,a))}async function _N(r,e){const t=Ne(r);if(!t.currentUser.isEqual(e)){le(ja,"User change. New user:",e.toKey());const n=await iE(t.localStore,e);t.currentUser=e,function(a,u){a.Ga.forEach(c=>{c.forEach(d=>{d.reject(new Ce(ie.CANCELLED,u))})}),a.Ga.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await _o(t,n.Rs)}}function wN(r,e){const t=Ne(r),n=t.Ka.get(e);if(n&&n.Ba)return $e().add(n.key);{let i=$e();const a=t.qa.get(e);if(!a)return i;for(const u of a){const c=t.ka.get(u);i=i.unionWith(c.view.ba)}return i}}async function EN(r,e){const t=Ne(r),n=await Np(t.localStore,e.query,!0),i=e.view.Oa(n);return t.isPrimaryClient&&Dp(t,e.targetId,i.Ma),i}async function TN(r,e){const t=Ne(r);return lE(t.localStore,e).then(n=>_o(t,n))}async function IN(r,e,t,n){const i=Ne(r),a=await function(c,d){const p=Ne(c),g=Ne(p.mutationQueue);return p.persistence.runTransaction("Lookup mutation documents","readonly",_=>g.Ln(_,d).next(E=>E?p.localDocuments.getDocuments(_,E):q.resolve(null)))}(i.localStore,e);a!==null?(t==="pending"?await pu(i.remoteStore):t==="acknowledged"||t==="rejected"?(Tm(i,e,n||null),Em(i,e),function(c,d){Ne(Ne(c).mutationQueue).qn(d)}(i.localStore,e)):Ae(),await _o(i,a)):le(ja,"Cannot apply mutation batch with id: "+e)}async function SN(r,e){const t=Ne(r);if(ed(t),PE(t),e===!0&&t.ja!==!0){const n=t.sharedClientState.getAllActiveQueryTargets(),i=await w_(t,n.toArray());t.ja=!0,await kp(t.remoteStore,!0);for(const a of i)Jh(t.remoteStore,a)}else if(e===!1&&t.ja!==!1){const n=[];let i=Promise.resolve();t.qa.forEach((a,u)=>{t.sharedClientState.isLocalQueryTarget(u)?n.push(u):i=i.then(()=>(Da(t,u),Pa(t.localStore,u,!0))),ka(t.remoteStore,u)}),await i,await w_(t,n),function(u){const c=Ne(u);c.Ka.forEach((d,p)=>{ka(c.remoteStore,p)}),c.Ua.Dr(),c.Ka=new Map,c.$a=new yt(_e.comparator)}(t),t.ja=!1,await kp(t.remoteStore,!1)}}async function w_(r,e,t){const n=Ne(r),i=[],a=[];for(const u of e){let c;const d=n.qa.get(u);if(d&&d.length!==0){c=await Sh(n.localStore,Qn(d[0]));for(const p of d){const g=n.ka.get(p),_=await EN(n,g);_.snapshot&&a.push(_.snapshot)}}else{const p=await aE(n.localStore,u);c=await Sh(n.localStore,p),await wm(n,RE(p),u,!1,c.resumeToken)}i.push(c)}return n.La.p_(a),i}function RE(r){return m0(r.path,r.collectionGroup,r.orderBy,r.filters,r.limit,"F",r.startAt,r.endAt)}function CN(r){return function(t){return Ne(Ne(t).persistence).zi()}(Ne(r).localStore)}async function AN(r,e,t,n){const i=Ne(r);if(i.ja)return void le(ja,"Ignoring unexpected query state notification.");const a=i.qa.get(e);if(a&&a.length>0)switch(t){case"current":case"not-current":{const u=await lE(i.localStore,y0(a[0])),c=hu.createSynthesizedRemoteEventForCurrentChange(e,t==="current",Dt.EMPTY_BYTE_STRING);await _o(i,u,c);break}case"rejected":await Pa(i.localStore,e,!0),Da(i,e,n);break;default:Ae()}}async function xN(r,e,t){const n=ed(r);if(n.ja){for(const i of e){if(n.qa.has(i)&&n.sharedClientState.isActiveQueryTarget(i)){le(ja,"Adding an already active target "+i);continue}const a=await aE(n.localStore,i),u=await Sh(n.localStore,a);await wm(n,RE(a),u.targetId,!1,u.resumeToken),Jh(n.remoteStore,u)}for(const i of t)n.qa.has(i)&&await Pa(n.localStore,i,!1).then(()=>{ka(n.remoteStore,i),Da(n,i)}).catch(vi)}}function ed(r){const e=Ne(r);return e.remoteStore.remoteSyncer.applyRemoteEvent=xE.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=wN.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=mN.bind(null,e),e.La.p_=sN.bind(null,e.eventManager),e.La.Ja=iN.bind(null,e.eventManager),e}function PE(r){const e=Ne(r);return e.remoteStore.remoteSyncer.applySuccessfulWrite=gN.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=yN.bind(null,e),e}class tu{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=mE(e.databaseInfo.databaseId),this.sharedClientState=this.Za(e),this.persistence=this.Xa(e),await this.persistence.start(),this.localStore=this.eu(e),this.gcScheduler=this.tu(e,this.localStore),this.indexBackfillerScheduler=this.nu(e,this.localStore)}tu(e,t){return null}nu(e,t){return null}eu(e){return sE(this.persistence,new rE,e.initialUser,this.serializer)}Xa(e){return new cm(Yh.ri,this.serializer)}Za(e){return new fE}async terminate(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}tu.provider={build:()=>new tu};class NN extends tu{constructor(e){super(),this.cacheSizeBytes=e}tu(e,t){ke(this.persistence.referenceDelegate instanceof Ih);const n=this.persistence.referenceDelegate.garbageCollector;return new Y0(n,e.asyncQueue,t)}Xa(e){const t=this.cacheSizeBytes!==void 0?hn.withCacheSize(this.cacheSizeBytes):hn.DEFAULT;return new cm(n=>Ih.ri(n,t),this.serializer)}}class kE extends tu{constructor(e,t,n){super(),this.ru=e,this.cacheSizeBytes=t,this.forceOwnership=n,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.ru.initialize(this,e),await PE(this.ru.syncEngine),await pu(this.ru.remoteStore),await this.persistence.Ci(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}eu(e){return sE(this.persistence,new rE,e.initialUser,this.serializer)}tu(e,t){const n=this.persistence.referenceDelegate.garbageCollector;return new Y0(n,e.asyncQueue,t)}nu(e,t){const n=new PC(t,this.persistence);return new RC(e.asyncQueue,n)}Xa(e){const t=nE(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),n=this.cacheSizeBytes!==void 0?hn.withCacheSize(this.cacheSizeBytes):hn.DEFAULT;return new hm(this.synchronizeTabs,t,e.clientId,n,e.asyncQueue,pE(),th(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Za(e){return new fE}}class RN extends kE{constructor(e,t){super(e,t,!1),this.ru=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const t=this.ru.syncEngine;this.sharedClientState instanceof Yf&&(this.sharedClientState.syncEngine={uo:IN.bind(null,t),co:AN.bind(null,t),lo:xN.bind(null,t),zi:CN.bind(null,t),ao:TN.bind(null,t)},await this.sharedClientState.start()),await this.persistence.Ci(async n=>{await SN(this.ru.syncEngine,n),this.gcScheduler&&(n&&!this.gcScheduler.started?this.gcScheduler.start():n||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(n&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():n||this.indexBackfillerScheduler.stop())})}Za(e){const t=pE();if(!Yf.D(t))throw new Ce(ie.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const n=nE(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Yf(t,e.asyncQueue,n,e.clientId,e.initialUser)}}class nu{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>__(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=_N.bind(null,this.syncEngine),await kp(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new tN}()}createDatastore(e){const t=mE(e.databaseInfo.databaseId),n=function(a){return new Fx(a)}(e.databaseInfo);return function(a,u,c,d){return new zx(a,u,c,d)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return function(n,i,a,u,c){return new $x(n,i,a,u,c)}(this.localStore,this.datastore,e.asyncQueue,t=>__(this.syncEngine,t,0),function(){return f_.D()?new f_:new Dx}())}createSyncEngine(e,t){return function(i,a,u,c,d,p,g){const _=new cN(i,a,u,c,d,p);return g&&(_.ja=!0),_}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(i){const a=Ne(i);le(mo,"RemoteStore shutting down."),a.W_.add(5),await fu(a),a.z_.shutdown(),a.j_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()}}nu.provider={build:()=>new nu};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PN{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.iu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.iu(this.observer.error,e):kt("Uncaught Error in snapshot listener:",e.toString()))}su(){this.muted=!0}iu(e,t){setTimeout(()=>{this.muted||e(t)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yi="FirestoreClient";class kN{constructor(e,t,n,i,a){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=i,this.user=cn.UNAUTHENTICATED,this.clientId=Ow.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=a,this.authCredentials.start(n,async u=>{le(yi,"Received user=",u.uid),await this.authCredentialListener(u),this.user=u}),this.appCheckCredentials.start(n,u=>(le(yi,"Received new app check token=",u),this.appCheckCredentialListener(u,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new di;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=IE(t,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function Jf(r,e){r.asyncQueue.verifyOperationInProgress(),le(yi,"Initializing OfflineComponentProvider");const t=r.configuration;await e.initialize(t);let n=t.initialUser;r.setCredentialChangeListener(async i=>{n.isEqual(i)||(await iE(e.localStore,i),n=i)}),e.persistence.setDatabaseDeletedListener(()=>r.terminate()),r._offlineComponents=e}async function E_(r,e){r.asyncQueue.verifyOperationInProgress();const t=await bN(r);le(yi,"Initializing OnlineComponentProvider"),await e.initialize(t,r.configuration),r.setCredentialChangeListener(n=>m_(e.remoteStore,n)),r.setAppCheckTokenChangeListener((n,i)=>m_(e.remoteStore,i)),r._onlineComponents=e}async function bN(r){if(!r._offlineComponents)if(r._uninitializedComponentsProvider){le(yi,"Using user provided OfflineComponentProvider");try{await Jf(r,r._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!function(i){return i.name==="FirebaseError"?i.code===ie.FAILED_PRECONDITION||i.code===ie.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(t))throw t;$l("Error using user provided cache. Falling back to memory cache: "+t),await Jf(r,new tu)}}else le(yi,"Using default OfflineComponentProvider"),await Jf(r,new NN(void 0));return r._offlineComponents}async function DN(r){return r._onlineComponents||(r._uninitializedComponentsProvider?(le(yi,"Using user provided OnlineComponentProvider"),await E_(r,r._uninitializedComponentsProvider._online)):(le(yi,"Using default OnlineComponentProvider"),await E_(r,new nu))),r._onlineComponents}async function VN(r){const e=await DN(r),t=e.eventManager;return t.onListen=hN.bind(null,e.syncEngine),t.onUnlisten=fN.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=dN.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=pN.bind(null,e.syncEngine),t}function MN(r,e,t={}){const n=new di;return r.asyncQueue.enqueueAndForget(async()=>function(a,u,c,d,p){const g=new PN({next:E=>{g.su(),u.enqueueAndForget(()=>rN(a,_));const C=E.docs.has(c);!C&&E.fromCache?p.reject(new Ce(ie.UNAVAILABLE,"Failed to get document because the client is offline.")):C&&E.fromCache&&d&&d.source==="server"?p.reject(new Ce(ie.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):p.resolve(E)},error:E=>p.reject(E)}),_=new oN(Wh(c.path),g,{includeMetadataChanges:!0,Ta:!0});return nN(a,_)}(await VN(r),r.asyncQueue,e,t,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bE(r){const e={};return r.timeoutSeconds!==void 0&&(e.timeoutSeconds=r.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T_=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ON(r,e,t){if(!t)throw new Ce(ie.INVALID_ARGUMENT,`Function ${r}() cannot be called with an empty ${e}.`)}function FN(r,e,t,n){if(e===!0&&n===!0)throw new Ce(ie.INVALID_ARGUMENT,`${r} and ${t} cannot be used together.`)}function I_(r){if(!_e.isDocumentKey(r))throw new Ce(ie.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${r} has ${r.length}.`)}function LN(r){if(r===void 0)return"undefined";if(r===null)return"null";if(typeof r=="string")return r.length>20&&(r=`${r.substring(0,20)}...`),JSON.stringify(r);if(typeof r=="number"||typeof r=="boolean")return""+r;if(typeof r=="object"){if(r instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(r);return e?`a custom ${e} object`:"an object"}}return typeof r=="function"?"a function":Ae()}function S_(r,e){if("_delegate"in r&&(r=r._delegate),!(r instanceof e)){if(e.name===r.constructor.name)throw new Ce(ie.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=LN(r);throw new Ce(ie.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jN="firestore.googleapis.com",C_=!0;class A_{constructor(e){var t,n;if(e.host===void 0){if(e.ssl!==void 0)throw new Ce(ie.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=jN,this.ssl=C_}else this.host=e.host,this.ssl=(t=e.ssl)!==null&&t!==void 0?t:C_;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=G0;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<X0)throw new Ce(ie.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}FN("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=bE((n=e.experimentalLongPollingOptions)!==null&&n!==void 0?n:{}),function(a){if(a.timeoutSeconds!==void 0){if(isNaN(a.timeoutSeconds))throw new Ce(ie.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (must not be NaN)`);if(a.timeoutSeconds<5)throw new Ce(ie.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (minimum allowed value is 5)`);if(a.timeoutSeconds>30)throw new Ce(ie.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,i){return n.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class DE{constructor(e,t,n,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new A_({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Ce(ie.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Ce(ie.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new A_(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new wC;switch(n.type){case"firstParty":return new IC(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new Ce(ie.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const n=T_.get(t);n&&(le("ComponentProvider","Removing Datastore"),T_.delete(t),n.terminate())}(this),Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sm{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Sm(this.firestore,e,this._query)}}class Ts{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new ru(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Ts(this.firestore,e,this._key)}}class ru extends Sm{constructor(e,t,n){super(e,t,Wh(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Ts(this.firestore,null,new _e(e))}withConverter(e){return new ru(this.firestore,e,this._path)}}function BN(r,e,...t){if(r=ww(r),arguments.length===1&&(e=Ow.newId()),ON("doc","path",e),r instanceof DE){const n=lt.fromString(e,...t);return I_(n),new Ts(r,null,new _e(n))}{if(!(r instanceof Ts||r instanceof ru))throw new Ce(ie.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=r._path.child(lt.fromString(e,...t));return I_(n),new Ts(r.firestore,r instanceof ru?r.converter:null,new _e(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const x_="AsyncQueue";class N_{constructor(e=Promise.resolve()){this.Vu=[],this.mu=!1,this.fu=[],this.gu=null,this.pu=!1,this.yu=!1,this.wu=[],this.a_=new gE(this,"async_queue_retry"),this.bu=()=>{const n=th();n&&le(x_,"Visibility state changed to "+n.visibilityState),this.a_.t_()},this.Su=e;const t=th();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.bu)}get isShuttingDown(){return this.mu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Du(),this.vu(e)}enterRestrictedMode(e){if(!this.mu){this.mu=!0,this.yu=e||!1;const t=th();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.bu)}}enqueue(e){if(this.Du(),this.mu)return new Promise(()=>{});const t=new di;return this.vu(()=>this.mu&&this.yu?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Vu.push(e),this.Cu()))}async Cu(){if(this.Vu.length!==0){try{await this.Vu[0](),this.Vu.shift(),this.a_.reset()}catch(e){if(!_i(e))throw e;le(x_,"Operation failed with retryable error: "+e)}this.Vu.length>0&&this.a_.Xo(()=>this.Cu())}}vu(e){const t=this.Su.then(()=>(this.pu=!0,e().catch(n=>{this.gu=n,this.pu=!1;const i=function(u){let c=u.message||"";return u.stack&&(c=u.stack.includes(u.message)?u.stack:u.message+`
`+u.stack),c}(n);throw kt("INTERNAL UNHANDLED ERROR: ",i),n}).then(n=>(this.pu=!1,n))));return this.Su=t,t}enqueueAfterDelay(e,t,n){this.Du(),this.wu.indexOf(e)>-1&&(t=0);const i=vm.createAndSchedule(this,e,t,n,a=>this.Fu(a));return this.fu.push(i),i}Du(){this.gu&&Ae()}verifyOperationInProgress(){}async Mu(){let e;do e=this.Su,await e;while(e!==this.Su)}xu(e){for(const t of this.fu)if(t.timerId===e)return!0;return!1}Ou(e){return this.Mu().then(()=>{this.fu.sort((t,n)=>t.targetTimeMs-n.targetTimeMs);for(const t of this.fu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Mu()})}Nu(e){this.wu.push(e)}Fu(e){const t=this.fu.indexOf(e);this.fu.splice(t,1)}}class VE extends DE{constructor(e,t,n,i){super(e,t,n,i),this.type="firestore",this._queue=new N_,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new N_(e),this._firestoreClient=void 0,await e}}}function zN(r,e,t){t||(t=fh);const n=Sw(r,"firestore");if(n.isInitialized(t)){const i=n.getImmediate({identifier:t}),a=n.getOptions(t);if(ih(a,e))return i;throw new Ce(ie.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if(e.cacheSizeBytes!==void 0&&e.localCache!==void 0)throw new Ce(ie.INVALID_ARGUMENT,"cache and cacheSizeBytes cannot be specified at the same time as cacheSizeBytes willbe deprecated. Instead, specify the cache size in the cache object");if(e.cacheSizeBytes!==void 0&&e.cacheSizeBytes!==-1&&e.cacheSizeBytes<X0)throw new Ce(ie.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return n.initialize({options:e,instanceIdentifier:t})}function UN(r){if(r._terminated)throw new Ce(ie.FAILED_PRECONDITION,"The client has already been terminated.");return r._firestoreClient||$N(r),r._firestoreClient}function $N(r){var e,t,n;const i=r._freezeSettings(),a=function(c,d,p,g){return new oA(c,d,p,g.host,g.ssl,g.experimentalForceLongPolling,g.experimentalAutoDetectLongPolling,bE(g.experimentalLongPollingOptions),g.useFetchStreams)}(r._databaseId,((e=r._app)===null||e===void 0?void 0:e.options.appId)||"",r._persistenceKey,i);r._componentsProvider||!((t=i.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((n=i.localCache)===null||n===void 0)&&n._onlineComponentProvider)&&(r._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),r._firestoreClient=new kN(r._authCredentials,r._appCheckCredentials,r._queue,a,r._componentsProvider&&function(c){const d=c==null?void 0:c._online.build();return{_offline:c==null?void 0:c._offline.build(d),_online:d}}(r._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nh{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Nh(Dt.fromBase64String(e))}catch(t){throw new Ce(ie.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Nh(Dt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ME{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Ce(ie.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new bt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qN{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Ce(ie.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Ce(ie.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Le(this._lat,e._lat)||Le(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WN{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,i){if(n.length!==i.length)return!1;for(let a=0;a<n.length;++a)if(n[a]!==i[a])return!1;return!0}(this._values,e._values)}}const GN=new RegExp("[~\\*/\\[\\]]");function KN(r,e,t){if(e.search(GN)>=0)throw R_(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,r);try{return new ME(...e.split("."))._internalPath}catch{throw R_(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,r)}}function R_(r,e,t,n,i){let a=`Function ${e}() called with invalid data`;a+=". ";let u="";return new Ce(ie.INVALID_ARGUMENT,a+r+u)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OE{constructor(e,t,n,i,a){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=i,this._converter=a}get id(){return this._key.path.lastSegment()}get ref(){return new Ts(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new HN(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(FE("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class HN extends OE{data(){return super.data()}}function FE(r,e){return typeof e=="string"?KN(r,e):e instanceof ME?e._internalPath:e._delegate._internalPath}class QN{convertValue(e,t="none"){switch(pi(e)){case 0:return null;case 1:return e.booleanValue;case 2:return wt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(As(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Ae()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const n={};return au(e,(i,a)=>{n[i]=this.convertValue(a,t)}),n}convertVectorValue(e){var t,n,i;const a=(i=(n=(t=e.fields)===null||t===void 0?void 0:t[Xl].arrayValue)===null||n===void 0?void 0:n.values)===null||i===void 0?void 0:i.map(u=>wt(u.doubleValue));return new WN(a)}convertGeoPoint(e){return new qN(wt(e.latitude),wt(e.longitude))}convertArray(e,t){return(e.values||[]).map(n=>this.convertValue(n,t))}convertServerTimestamp(e,t){switch(t){case"previous":const n=Uh(e);return n==null?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(Ql(e));default:return null}}convertTimestamp(e){const t=Cs(e);return new Xt(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=lt.fromString(e);ke(B0(n));const i=new uo(n.get(1),n.get(3)),a=new _e(n.popFirst(5));return i.isEqual(t)||kt(`Document ${a} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XN{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class LE extends OE{constructor(e,t,n,i,a,u){super(e,t,n,i,u),this._firestore=e,this._firestoreImpl=e,this.metadata=a}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new YN(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const n=this._document.data.field(FE("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}class YN extends LE{data(e={}){return super.data(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZN(r){r=S_(r,Ts);const e=S_(r.firestore,VE);return MN(UN(e),r._key).then(t=>eR(e,r,t))}class JN extends QN{constructor(e){super(),this.firestore=e}convertBytes(e){return new Nh(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Ts(this.firestore,null,t)}}function eR(r,e,t){const n=t.docs.get(e._key),i=new JN(r);return new LE(r,i,e._key,n,new XN(t.hasPendingWrites,t.fromCache),e.converter)}class tR{constructor(e){let t;this.kind="persistent",e!=null&&e.tabManager?(e.tabManager._initialize(e),t=e.tabManager):(t=iR(),t._initialize(e)),this._onlineComponentProvider=t._onlineComponentProvider,this._offlineComponentProvider=t._offlineComponentProvider}toJSON(){return{kind:this.kind}}}function nR(r){return new tR(r)}class rR{constructor(e){this.forceOwnership=e,this.kind="persistentSingleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=nu.provider,this._offlineComponentProvider={build:t=>new kE(t,e==null?void 0:e.cacheSizeBytes,this.forceOwnership)}}}class sR{constructor(){this.kind="PersistentMultipleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=nu.provider,this._offlineComponentProvider={build:t=>new RN(t,e==null?void 0:e.cacheSizeBytes)}}}function iR(r){return new rR(void 0)}function oR(){return new sR}(function(e,t=!0){(function(i){Oa=i})(Aw),zl(new va("firestore",(n,{instanceIdentifier:i,options:a})=>{const u=n.getProvider("app").getImmediate(),c=new VE(new EC(n.getProvider("auth-internal")),new SC(u,n.getProvider("app-check-internal")),function(p,g){if(!Object.prototype.hasOwnProperty.apply(p.options,["projectId"]))throw new Ce(ie.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new uo(p.options.projectId,g)}(u,i),u);return a=Object.assign({useFetchStreams:t},a),c._setSettings(a),c},"PUBLIC").setMultipleInstances(!0)),ci(dv,fv,e),ci(dv,fv,"esm2017")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jE="firebasestorage.googleapis.com",aR="storageBucket",lR=2*60*1e3,uR=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ts extends yo{constructor(e,t,n=0){super(ep(e),`Firebase Storage: ${t} (${ep(e)})`),this.status_=n,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,ts.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return ep(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Jr;(function(r){r.UNKNOWN="unknown",r.OBJECT_NOT_FOUND="object-not-found",r.BUCKET_NOT_FOUND="bucket-not-found",r.PROJECT_NOT_FOUND="project-not-found",r.QUOTA_EXCEEDED="quota-exceeded",r.UNAUTHENTICATED="unauthenticated",r.UNAUTHORIZED="unauthorized",r.UNAUTHORIZED_APP="unauthorized-app",r.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",r.INVALID_CHECKSUM="invalid-checksum",r.CANCELED="canceled",r.INVALID_EVENT_NAME="invalid-event-name",r.INVALID_URL="invalid-url",r.INVALID_DEFAULT_BUCKET="invalid-default-bucket",r.NO_DEFAULT_BUCKET="no-default-bucket",r.CANNOT_SLICE_BLOB="cannot-slice-blob",r.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",r.NO_DOWNLOAD_URL="no-download-url",r.INVALID_ARGUMENT="invalid-argument",r.INVALID_ARGUMENT_COUNT="invalid-argument-count",r.APP_DELETED="app-deleted",r.INVALID_ROOT_OPERATION="invalid-root-operation",r.INVALID_FORMAT="invalid-format",r.INTERNAL_ERROR="internal-error",r.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Jr||(Jr={}));function ep(r){return"storage/"+r}function cR(){const r="An unknown error occurred, please check the error payload for server response.";return new ts(Jr.UNKNOWN,r)}function hR(){return new ts(Jr.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function dR(){return new ts(Jr.CANCELED,"User canceled the upload/download.")}function fR(r){return new ts(Jr.INVALID_URL,"Invalid URL '"+r+"'.")}function pR(r){return new ts(Jr.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+r+"'.")}function P_(r){return new ts(Jr.INVALID_ARGUMENT,r)}function BE(){return new ts(Jr.APP_DELETED,"The Firebase app was deleted.")}function mR(r){return new ts(Jr.INVALID_ROOT_OPERATION,"The operation '"+r+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class br{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let n;try{n=br.makeFromUrl(e,t)}catch{return new br(e,"")}if(n.path==="")return n;throw pR(e)}static makeFromUrl(e,t){let n=null;const i="([A-Za-z0-9.\\-_]+)";function a(X){X.path.charAt(X.path.length-1)==="/"&&(X.path_=X.path_.slice(0,-1))}const u="(/(.*))?$",c=new RegExp("^gs://"+i+u,"i"),d={bucket:1,path:3};function p(X){X.path_=decodeURIComponent(X.path)}const g="v[A-Za-z0-9_]+",_=t.replace(/[.]/g,"\\."),E="(/([^?#]*).*)?$",C=new RegExp(`^https?://${_}/${g}/b/${i}/o${E}`,"i"),A={bucket:1,path:3},P=t===jE?"(?:storage.googleapis.com|storage.cloud.google.com)":t,D="([^?#]*)",B=new RegExp(`^https?://${P}/${i}/${D}`,"i"),$=[{regex:c,indices:d,postModify:a},{regex:C,indices:A,postModify:p},{regex:B,indices:{bucket:1,path:2},postModify:p}];for(let X=0;X<$.length;X++){const F=$[X],U=F.regex.exec(e);if(U){const N=U[F.indices.bucket];let I=U[F.indices.path];I||(I=""),n=new br(N,I),F.postModify(n);break}}if(n==null)throw fR(e);return n}}class gR{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yR(r,e,t){let n=1,i=null,a=null,u=!1,c=0;function d(){return c===2}let p=!1;function g(...D){p||(p=!0,e.apply(null,D))}function _(D){i=setTimeout(()=>{i=null,r(C,d())},D)}function E(){a&&clearTimeout(a)}function C(D,...B){if(p){E();return}if(D){E(),g.call(null,D,...B);return}if(d()||u){E(),g.call(null,D,...B);return}n<64&&(n*=2);let $;c===1?(c=2,$=0):$=(n+Math.random())*1e3,_($)}let A=!1;function P(D){A||(A=!0,E(),!p&&(i!==null?(D||(c=2),clearTimeout(i),_(0)):D||(c=1)))}return _(0),a=setTimeout(()=>{u=!0,P(!0)},t),P}function vR(r){r(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _R(r){return r!==void 0}function k_(r,e,t,n){if(n<e)throw P_(`Invalid value for '${r}'. Expected ${e} or greater.`);if(n>t)throw P_(`Invalid value for '${r}'. Expected ${t} or less.`)}function wR(r){const e=encodeURIComponent;let t="?";for(const n in r)if(r.hasOwnProperty(n)){const i=e(n)+"="+e(r[n]);t=t+i+"&"}return t=t.slice(0,-1),t}var Rh;(function(r){r[r.NO_ERROR=0]="NO_ERROR",r[r.NETWORK_ERROR=1]="NETWORK_ERROR",r[r.ABORT=2]="ABORT"})(Rh||(Rh={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ER(r,e){const t=r>=500&&r<600,i=[408,429].indexOf(r)!==-1,a=e.indexOf(r)!==-1;return t||i||a}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TR{constructor(e,t,n,i,a,u,c,d,p,g,_,E=!0){this.url_=e,this.method_=t,this.headers_=n,this.body_=i,this.successCodes_=a,this.additionalRetryCodes_=u,this.callback_=c,this.errorCallback_=d,this.timeout_=p,this.progressCallback_=g,this.connectionFactory_=_,this.retry=E,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((C,A)=>{this.resolve_=C,this.reject_=A,this.start_()})}start_(){const e=(n,i)=>{if(i){n(!1,new Wc(!1,null,!0));return}const a=this.connectionFactory_();this.pendingConnection_=a;const u=c=>{const d=c.loaded,p=c.lengthComputable?c.total:-1;this.progressCallback_!==null&&this.progressCallback_(d,p)};this.progressCallback_!==null&&a.addUploadProgressListener(u),a.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&a.removeUploadProgressListener(u),this.pendingConnection_=null;const c=a.getErrorCode()===Rh.NO_ERROR,d=a.getStatus();if(!c||ER(d,this.additionalRetryCodes_)&&this.retry){const g=a.getErrorCode()===Rh.ABORT;n(!1,new Wc(!1,null,g));return}const p=this.successCodes_.indexOf(d)!==-1;n(!0,new Wc(p,a))})},t=(n,i)=>{const a=this.resolve_,u=this.reject_,c=i.connection;if(i.wasSuccessCode)try{const d=this.callback_(c,c.getResponse());_R(d)?a(d):a()}catch(d){u(d)}else if(c!==null){const d=cR();d.serverResponse=c.getErrorText(),this.errorCallback_?u(this.errorCallback_(c,d)):u(d)}else if(i.canceled){const d=this.appDelete_?BE():dR();u(d)}else{const d=hR();u(d)}};this.canceled_?t(!1,new Wc(!1,null,!0)):this.backoffId_=yR(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&vR(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Wc{constructor(e,t,n){this.wasSuccessCode=e,this.connection=t,this.canceled=!!n}}function IR(r,e){e!==null&&e.length>0&&(r.Authorization="Firebase "+e)}function SR(r,e){r["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function CR(r,e){e&&(r["X-Firebase-GMPID"]=e)}function AR(r,e){e!==null&&(r["X-Firebase-AppCheck"]=e)}function xR(r,e,t,n,i,a,u=!0){const c=wR(r.urlParams),d=r.url+c,p=Object.assign({},r.headers);return CR(p,e),IR(p,t),SR(p,a),AR(p,n),new TR(d,r.method,p,r.body,r.successCodes,r.additionalRetryCodes,r.handler,r.errorHandler,r.timeout,r.progressCallback,i,u)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NR(r){if(r.length===0)return null;const e=r.lastIndexOf("/");return e===-1?"":r.slice(0,e)}function RR(r){const e=r.lastIndexOf("/",r.length-2);return e===-1?r:r.slice(e+1)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ph{constructor(e,t){this._service=e,t instanceof br?this._location=t:this._location=br.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new Ph(e,t)}get root(){const e=new br(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return RR(this._location.path)}get storage(){return this._service}get parent(){const e=NR(this._location.path);if(e===null)return null;const t=new br(this._location.bucket,e);return new Ph(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw mR(e)}}function b_(r,e){const t=e==null?void 0:e[aR];return t==null?null:br.makeFromBucketSpec(t,r)}function PR(r,e,t,n={}){r.host=`${e}:${t}`,r._protocol="http";const{mockUserToken:i}=n;i&&(r._overrideAuthToken=typeof i=="string"?i:n1(i,r.app.options.projectId))}class kR{constructor(e,t,n,i,a){this.app=e,this._authProvider=t,this._appCheckProvider=n,this._url=i,this._firebaseVersion=a,this._bucket=null,this._host=jE,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=lR,this._maxUploadRetryTime=uR,this._requests=new Set,i!=null?this._bucket=br.makeFromBucketSpec(i,this._host):this._bucket=b_(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=br.makeFromBucketSpec(this._url,e):this._bucket=b_(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){k_("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){k_("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(Cw(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Ph(this,e)}_makeRequest(e,t,n,i,a=!0){if(this._deleted)return new gR(BE());{const u=xR(e,this._appId,n,i,t,this._firebaseVersion,a);return this._requests.add(u),u.getPromise().then(()=>this._requests.delete(u),()=>this._requests.delete(u)),u}}async makeRequestWithTokens(e,t){const[n,i]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,n,i).getPromise()}}const D_="@firebase/storage",V_="0.13.7";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zE="storage";function bR(r=oC(),e){r=ww(r);const n=Sw(r,zE).getImmediate({identifier:e}),i=e1("storage");return i&&DR(n,...i),n}function DR(r,e,t,n={}){PR(r,e,t,n)}function VR(r,{instanceIdentifier:e}){const t=r.getProvider("app").getImmediate(),n=r.getProvider("auth-internal"),i=r.getProvider("app-check-internal");return new kR(t,n,i,e,Aw)}function MR(){zl(new va(zE,VR,"PUBLIC").setMultipleInstances(!0)),ci(D_,V_,""),ci(D_,V_,"esm2017")}MR();const OR={apiKey:"AIzaSyAlv8DyWdhTjJjZYPqkghZUyEupG5g8SFk",authDomain:"groove-slider.firebaseapp.com",projectId:"groove-slider",storageBucket:"groove-slider.appspot.com",messagingSenderId:"87433841566",appId:"1:87433841566:web:da11fb420a121cc700248f",measurementId:"G-X0QJM954YF"},UE=xw(OR),tp=zN(UE,{localCache:nR({tabManager:oR()})});bR(UE);function FR(r,e){return new Promise((t,n)=>{try{const i=LR();i.onmessage=a=>{a.data.type==="complete"?(t(a.data.file),i.terminate()):a.data.type==="error"&&(n(new Error(a.data.error)),i.terminate())},i.onerror=a=>{n(a),i.terminate()},i.postMessage({data:r,config:e})}catch(i){n(i)}})}function LR(){const r=`
    self.onmessage = async (event) => {
      const { data, config } = event.data;
      
      try {
        // Basic export processing
        const exportedFile = await processExport(data, config);
        
        self.postMessage({ 
          type: 'complete', 
          file: exportedFile 
        });
      } catch (error) {
        self.postMessage({ 
          type: 'error', 
          error: error.message 
        });
      }
    };
    
    async function processExport(data, config) {
      console.log('Processing export', data, config);
      return data; // Temporary return
    }
  `,e=new Blob([r],{type:"application/javascript"});return new Worker(URL.createObjectURL(e))}const jR=({value:r,onChange:e})=>{var u;const[t,n]=he.useState(!1),i=[{value:"720x1280",label:"720p"},{value:"1080x1920",label:"1080p"},{value:"1440x2560",label:"2K"}],a=c=>{e(c),n(!1)};return T.jsxs("div",{className:"custom-resolution-dropdown",children:[T.jsxs("div",{className:"dropdown-header",onClick:()=>n(!t),children:[((u=i.find(c=>c.value===r))==null?void 0:u.label)||r,t?T.jsx(eS,{size:16}):T.jsx(XI,{size:16})]}),t&&T.jsx("div",{className:"dropdown-list",children:i.map(c=>T.jsx("div",{className:"dropdown-item",onClick:()=>a(c.value),children:c.label},c.value))})]})},BR=({isOpen:r,progress:e,message:t,onClose:n,onExport:i,isExporting:a,storyData:u})=>{const[c,d]=he.useState("1080x1920"),[p,g]=he.useState(!1),[_,E]=he.useState(30),[C,A]=he.useState(null),P=async()=>{const D={resolution:c,isExportLoopEnabled:p,exportLoopDuration:_};try{A(null);const W=await FR({storyData:u,resolution:c,isExportLoopEnabled:p,exportLoopDuration:_},D);i(W)}catch(B){console.error("Export failed",B),A(B.message||"Export failed. Please try again.")}};return r?T.jsx("div",{className:"modal-overlay",children:T.jsxs("div",{className:"modal-content export-modal",children:[T.jsx("button",{className:"modal-close",onClick:n,children:T.jsx(ao,{size:20})}),a?T.jsxs("div",{className:"loading-container",children:[T.jsx("h3",{children:"Exporting Video"}),T.jsx("p",{children:t}),T.jsxs("div",{className:"progress-container",children:[T.jsx("div",{className:"progress-bar",children:T.jsx("div",{className:"progress-fill",style:{width:`${e}%`}})}),T.jsxs("span",{className:"progress-text",children:[Math.round(e),"%"]})]})]}):T.jsxs(T.Fragment,{children:[T.jsx("h3",{className:"modal-title",children:"Export Settings"}),T.jsxs("div",{className:"resolution-selector",children:[T.jsx("label",{children:"Resolution:"}),T.jsx(jR,{value:c,onChange:d})]}),T.jsxs("div",{className:"export-loop-settings",children:[T.jsx("div",{className:"loop-toggle",children:T.jsxs("label",{children:[T.jsx("span",{children:"Export as Loop"}),T.jsx("input",{type:"checkbox",checked:p,onChange:()=>g(!p)})]})}),p&&T.jsxs("div",{className:"input-container",children:[T.jsx("label",{children:"Loop Duration (seconds):"}),T.jsx("input",{type:"number",min:"5",max:"300",value:_,onChange:D=>E(Number(D.target.value)),className:"loop-duration-input"})]})]}),C&&T.jsx("div",{className:"export-error-message",children:C}),T.jsxs("div",{className:"export-actions",children:[T.jsxs("button",{className:"action-button share",onClick:()=>{},children:[T.jsx(OS,{className:"button-icon"}),"Share"]}),T.jsxs("button",{className:"action-button download",onClick:P,children:[T.jsx(cw,{className:"button-icon"}),"Export"]})]})]})]})}):null},zR=({isOpen:r,onClose:e,onSave:t})=>{const[n,i]=he.useState(""),[a,u]=he.useState(!1),[c,d]=he.useState(null);if(!r)return null;const p=async g=>{if(g.preventDefault(),!n.trim()){d("Please enter a session name");return}try{u(!0),d(null),await t(n),i(""),e()}catch(_){console.error("Error saving session:",_),d("Failed to save session: "+_.message)}finally{u(!1)}};return T.jsx("div",{className:"modal-overlay",children:T.jsxs("div",{className:"modal-content save-session-modal",children:[T.jsx("button",{className:"modal-close",onClick:e,children:T.jsx(ao,{size:20})}),T.jsx("h3",{className:"modal-title",children:"Save Session"}),T.jsxs("form",{onSubmit:p,children:[T.jsxs("div",{className:"form-group",children:[T.jsx("label",{htmlFor:"session-name",children:"Session Name:"}),T.jsx("input",{type:"text",id:"session-name",value:n,onChange:g=>i(g.target.value),placeholder:"Enter a name for your session",autoFocus:!0,maxLength:50,className:"session-name-input"})]}),c&&T.jsx("div",{className:"save-error",children:c}),T.jsxs("div",{className:"modal-actions",children:[T.jsx("button",{type:"button",className:"cancel-button",onClick:e,disabled:a,children:"Cancel"}),T.jsx("button",{type:"submit",className:"save-button",disabled:a,children:a?T.jsxs(T.Fragment,{children:[T.jsx("div",{className:"spinner small"}),"Saving..."]}):T.jsxs(T.Fragment,{children:[T.jsx(fw,{size:16}),"Save Session"]})})]})]})]})})},M_={name:"GrooveGalleryDB",version:1},td=()=>new Promise((r,e)=>{const t=indexedDB.open(M_.name,M_.version);t.onupgradeneeded=n=>{const i=n.target.result;if(!i.objectStoreNames.contains("sessions")){const a=i.createObjectStore("sessions",{keyPath:"id",autoIncrement:!0});a.createIndex("name","name",{unique:!1}),a.createIndex("createdAt","createdAt",{unique:!1})}i.objectStoreNames.contains("images")||i.createObjectStore("images",{keyPath:"id",autoIncrement:!0}).createIndex("sessionId","sessionId",{unique:!1}),i.objectStoreNames.contains("music")||i.createObjectStore("music",{keyPath:"id",autoIncrement:!0}).createIndex("sessionId","sessionId",{unique:!1})},t.onsuccess=n=>{const i=n.target.result;r(i)},t.onerror=n=>{console.error("IndexedDB error:",n.target.error),e(n.target.error)}}),UR=async r=>{try{const e=[];for(const d of r.stories)try{const g=await(await fetch(d.url)).blob();e.push({type:d.type,blob:g})}catch(p){console.error("Error processing image:",p)}let t=null;if(r.musicUrl)try{t=await(await fetch(r.musicUrl)).blob()}catch(d){console.error("Error processing music:",d)}const i=(await td()).transaction(["sessions","images","music"],"readwrite"),a=i.objectStore("sessions"),u={name:r.name,createdAt:new Date,bpm:r.bpm,musicStartPoint:r.musicStartPoint,imageFitMode:r.imageFitMode,duration:r.duration,isLoopingEnabled:r.isLoopingEnabled,currentIndex:r.currentIndex},c=a.add(u);return new Promise((d,p)=>{c.onsuccess=async g=>{const _=g.target.result,E=i.objectStore("images");for(const C of e)E.add({sessionId:_,type:C.type,blob:C.blob});t&&i.objectStore("music").add({sessionId:_,blob:t}),i.oncomplete=()=>{console.log(`Session saved with ID: ${_}`),d(_)},i.onerror=C=>{console.error("Transaction error:",C.target.error),p(C.target.error)}},c.onerror=g=>{console.error("Error adding session:",g.target.error),p(g.target.error)}})}catch(e){throw console.error("saveSession error:",e),e}},$R=async r=>{try{const e=await td(),t=await new Promise((c,d)=>{const _=e.transaction("sessions","readonly").objectStore("sessions").get(r);_.onsuccess=E=>{c(E.target.result)},_.onerror=E=>{d(E.target.error)}});if(!t)throw new Error(`Session with ID ${r} not found`);const i=(await new Promise((c,d)=>{const E=e.transaction("images","readonly").objectStore("images").index("sessionId").getAll(r);E.onsuccess=C=>{c(C.target.result)},E.onerror=C=>{d(C.target.error)}})).map(c=>({type:c.type,url:URL.createObjectURL(c.blob)})),a=await new Promise((c,d)=>{const E=e.transaction("music","readonly").objectStore("music").index("sessionId").get(r);E.onsuccess=C=>{c(C.target.result)},E.onerror=C=>{d(C.target.error)}});let u=null;return a&&a.blob&&(u=URL.createObjectURL(a.blob)),{...t,stories:i,musicUrl:u}}catch(e){throw console.error("loadSession error:",e),e}},qR=async()=>{try{const r=await td();return new Promise((e,t)=>{const a=r.transaction("sessions","readonly").objectStore("sessions").getAll();a.onsuccess=u=>{e(u.target.result)},a.onerror=u=>{t(u.target.error)}})}catch(r){throw console.error("getAllSessions error:",r),r}},WR=async r=>{try{const t=(await td()).transaction(["sessions","images","music"],"readwrite");t.objectStore("sessions").delete(r);const u=t.objectStore("images").index("sessionId").openCursor(IDBKeyRange.only(r));u.onsuccess=g=>{const _=g.target.result;_&&(_.delete(),_.continue())};const p=t.objectStore("music").index("sessionId").openCursor(IDBKeyRange.only(r));return p.onsuccess=g=>{const _=g.target.result;_&&(_.delete(),_.continue())},new Promise((g,_)=>{t.oncomplete=()=>{console.log(`Session ${r} deleted successfully`),g()},t.onerror=E=>{console.error("Error deleting session:",E.target.error),_(E.target.error)}})}catch(e){throw console.error("deleteSession error:",e),e}},GR=({onLoadSession:r,visible:e})=>{const[t,n]=he.useState([]),[i,a]=he.useState(!0),[u,c]=he.useState(null);he.useEffect(()=>{e&&d()},[e]);const d=async()=>{try{a(!0);const E=(await qR()).filter(C=>!C.name.startsWith("auto_save_"));E.sort((C,A)=>new Date(A.createdAt)-new Date(C.createdAt)),n(E),c(null)}catch(_){console.error("Error loading sessions:",_),c("Failed to load saved sessions")}finally{a(!1)}},p=async(_,E)=>{if(_.stopPropagation(),window.confirm("Are you sure you want to delete this session?"))try{await WR(E),n(t.filter(C=>C.id!==E))}catch(C){console.error("Error deleting session:",C),alert("Failed to delete session")}},g=_=>new Date(_).toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});return e?T.jsxs("div",{className:"sessions-list",children:[T.jsx("h3",{className:"sessions-title",children:"Saved Sessions"}),i&&T.jsx("div",{className:"sessions-loading",children:"Loading saved sessions..."}),u&&T.jsx("div",{className:"sessions-error",children:u}),!i&&t.length===0&&T.jsxs("div",{className:"sessions-empty",children:[T.jsx("p",{children:"No saved sessions yet"}),T.jsx("p",{className:"sessions-hint",children:"Create a slideshow and click Save to add one"})]}),!i&&t.length>0&&T.jsx("ul",{className:"sessions-items",children:t.map(_=>T.jsxs("li",{className:"session-item",onClick:()=>r(_.id),children:[T.jsxs("div",{className:"session-info",children:[T.jsx("div",{className:"session-name",children:_.name}),T.jsxs("div",{className:"session-date",children:[T.jsx(uw,{size:12}),T.jsx("span",{children:g(_.createdAt)})]}),T.jsxs("div",{className:"session-details",children:[T.jsxs("span",{children:[_.bpm," BPM"]}),T.jsxs("span",{children:[_.duration.toFixed(1),"s/slide"]})]})]}),T.jsxs("div",{className:"session-actions",children:[T.jsx("button",{className:"session-delete-btn",onClick:E=>p(E,_.id),title:"Delete session",children:T.jsx(US,{size:16})}),T.jsx(si,{size:16,className:"session-arrow"})]})]},_.id))})]}):null},mu=()=>new Promise((r,e)=>{const t=indexedDB.open("AudioVisualizerDB",3);t.onerror=n=>e("IndexedDB error: "+n.target.errorCode),t.onupgradeneeded=n=>{const i=n.target.result;i.objectStoreNames.contains("audioPositions")||i.createObjectStore("audioPositions",{keyPath:"audioUrl"}),i.objectStoreNames.contains("visualizerStates")||i.createObjectStore("visualizerStates",{keyPath:"audioUrl"}),i.objectStoreNames.contains("audioBuffers")||i.createObjectStore("audioBuffers",{keyPath:"audioUrl"})},t.onsuccess=n=>r(n.target.result)}),O_=async(r,e)=>{try{const i=(await mu()).transaction(["audioPositions"],"readwrite").objectStore("audioPositions");return new Promise((a,u)=>{const c=i.put({audioUrl:r,...e,timestamp:Date.now()});c.onsuccess=()=>a(!0),c.onerror=()=>u(!1)})}catch(t){return console.error("Error storing audio positions:",t),!1}},F_=async(r,e)=>{try{console.log(`Attempting to store audio buffer for: ${r}`);const t=await mu(),n=new(window.AudioContext||window.webkitAudioContext),i=e.getChannelData(0),a={audioUrl:r,channels:e.numberOfChannels,sampleRate:e.sampleRate,length:e.length,duration:e.duration,channelData:i.buffer,timestamp:Date.now()},c=t.transaction(["audioBuffers"],"readwrite").objectStore("audioBuffers");return new Promise((d,p)=>{const g=c.put(a);g.onsuccess=()=>{console.log(`Successfully stored audio buffer for: ${r}`),d(!0)},g.onerror=_=>{console.error(`Failed to store audio buffer for: ${r}`,_),p(!1)}})}catch(t){return console.error("Error storing audio buffer:",t),!1}},KR=async r=>{try{console.log(`Attempting to retrieve audio buffer for: ${r}`);const n=(await mu()).transaction(["audioBuffers"],"readonly").objectStore("audioBuffers");return new Promise((i,a)=>{const u=n.get(r);u.onsuccess=c=>{const d=c.target.result;if(d){const g=new(window.AudioContext||window.webkitAudioContext)().createBuffer(d.channels,d.length,d.sampleRate);for(let _=0;_<d.channels;_++)g.getChannelData(_).set(new Float32Array(d.channelData));console.log(`Retrieved audio buffer for ${r}`),i({buffer:g})}else i(null)},u.onerror=c=>{console.error(`Error retrieving audio buffer for: ${r}`,c),a(null)}})}catch(e){return console.error("Error retrieving audio buffer:",e),null}},L_=async(r,e)=>{try{const i=(await mu()).transaction(["visualizerStates"],"readwrite").objectStore("visualizerStates");return new Promise((a,u)=>{const c=i.put({audioUrl:r,...e,timestamp:Date.now()});c.onsuccess=()=>a(!0),c.onerror=()=>u(!1)})}catch(t){return console.error("Error storing visualizer state:",t),!1}},HR=async r=>{try{const n=(await mu()).transaction(["visualizerStates"],"readonly").objectStore("visualizerStates");return new Promise((i,a)=>{const u=n.get(r);u.onsuccess=c=>{i(c.target.result||null)},u.onerror=()=>a(null)})}catch(e){return console.error("Error retrieving visualizer state:",e),null}},QR=({audioUrl:r,onStartPointChange:e,audioRef:t,musicStartPoint:n=0})=>{const i=he.useRef(null),a=he.useRef(null),[u,c]=he.useState(null),[d,p]=he.useState(!0),[g,_]=he.useState(0),[E,C]=he.useState(800),[A,P]=he.useState(0),[D,B]=he.useState(1),[W,$]=he.useState(0),[X,F]=he.useState(!1),U=he.useRef(null),N=he.useRef(null),I=he.useRef(!1);he.useEffect(()=>{if(!r||U.current===r)return;U.current=r,p(!0),(async()=>{try{const[ee,ye]=await Promise.all([HR(r),KR(r)]),te=new(window.AudioContext||window.webkitAudioContext);let ve;if(ye)ve=ye.buffer,console.log("Using cached audio buffer");else{const Be=await(await fetch(r)).arrayBuffer();ve=await te.decodeAudioData(Be),await F_(r,ve)}c(ve),_(ve.duration),ee&&(ee.zoomLevel&&B(ee.zoomLevel),ee.waveformOffset!==void 0&&$(ee.waveformOffset),e&&ee.startPoint!==void 0&&Math.abs(ee.startPoint-n)>.001&&e(ee.startPoint)),p(!1)}catch(ee){console.error("Error loading audio:",ee),p(!1)}})()},[r,e,n]),he.useEffect(()=>{if(!r||!u)return;const Q=setTimeout(()=>{Promise.all([L_(r,{zoomLevel:D,waveformOffset:W,startPoint:n}),F_(r,u),O_(r,{startPoint:n})]).catch(ee=>{console.error("Auto-save failed:",ee)})},5e3);return()=>clearTimeout(Q)},[r,u,D,W,n]),he.useEffect(()=>{const Q=t==null?void 0:t.current;if(!Q)return;const ee=()=>{const te=Q.currentTime;if(P(te),I.current=!Q.paused,X&&I.current){const ve=g/D,Oe=W,Be=Oe+ve,it=ve*.2;if(te>Be-it){const Lt=Math.max(0,Math.min(g-ve,te-ve*.8));$(Lt)}else if(te<Oe+it){const Lt=Math.max(0,Math.min(g-ve,te-ve*.2));$(Lt)}}},ye=()=>{I.current&&Q&&ee(),N.current=requestAnimationFrame(ye)};return ye(),Q.addEventListener("timeupdate",ee),Q.addEventListener("play",()=>{I.current=!0}),Q.addEventListener("pause",()=>{I.current=!1}),Q.addEventListener("seeking",ee),()=>{Q.removeEventListener("timeupdate",ee),Q.removeEventListener("play",()=>{I.current=!0}),Q.removeEventListener("pause",()=>{I.current=!1}),Q.removeEventListener("seeking",ee),N.current&&cancelAnimationFrame(N.current)}},[t,X,D,W,g]),he.useEffect(()=>{if(!u||g===0||!r)return;if(D>1){const ee=g/D,ye=Math.max(0,Math.min(g-ee,n-ee/2));$(ye)}const Q=setTimeout(()=>{O_(r,{startPoint:n}).catch(ee=>console.error("Error saving to IndexedDB:",ee))},1e3);return()=>clearTimeout(Q)},[n,D,u,g,r]);const R=(Q,ee=!0)=>{if(isNaN(Q))return"00:00.000";const ye=Math.floor(Q/60),te=Math.floor(Q%60);if(ee){const ve=Math.floor(Q%1*1e3);return`${ye.toString().padStart(2,"0")}:${te.toString().padStart(2,"0")}.${ve.toString().padStart(3,"0")}`}else return`${ye.toString().padStart(2,"0")}:${te.toString().padStart(2,"0")}`},b=he.useCallback(()=>{if(!u||!i.current)return;const Q=i.current,ee=Q.getContext("2d"),ye=Q.width,te=Q.height;ee.clearRect(0,0,ye,te),ee.fillStyle="#222",ee.fillRect(0,0,ye,te);const ve=u.getChannelData(0),Oe=g/D,Be=Math.max(0,Math.min(g-Oe,W)),it=Be+Oe,Lt=ve.length,qe=Math.floor(Be/g*Lt),Mr=Math.floor(it/g*Lt)-qe,dr=1,rs=0,On=Math.floor(ye/(dr+rs)),Fn=Math.floor(Mr/On);ee.fillStyle="#FFFFFF";for(let Ye=0;Ye<On;Ye++){const In=Ye*(dr+rs),mn=qe+Math.floor(Ye/On*Mr);let dt=0;for(let Ln=0;Ln<Fn;Ln++){const jn=mn+Ln;if(jn<ve.length){const fr=Math.abs(ve[jn]);fr>dt&&(dt=fr)}}const ft=Math.min(2,dt*.9)*(te/2),Sn=In,ss=te/2-ft,Yn=ft*2;ee.fillRect(Sn,ss,dr,Yn)}ee.strokeStyle="rgba(100, 100, 100, 0.3)",ee.lineWidth=1,ee.beginPath(),ee.moveTo(0,te/2),ee.lineTo(ye,te/2),ee.stroke(),ee.beginPath(),ee.moveTo(0,te/4),ee.lineTo(ye,te/4),ee.moveTo(0,3*te/4),ee.lineTo(ye,3*te/4),ee.stroke(),ee.fillStyle="#777",ee.font="10px Arial";let ut=1;D>=32?ut=.05:D>=16?ut=.1:D>=8?ut=.25:D>=4?ut=.5:D>=2&&(ut=1);for(let Ye=Math.ceil(Be/ut)*ut;Ye<=it;Ye+=ut){const In=(Ye-Be)/Oe*ye;ee.fillStyle="rgba(100, 100, 100, 0.5)",ee.fillRect(In,0,1,te),(ut>=1||ut>=.5&&Ye*2%2===0||ut>=.25&&Ye*4%4===0||ut>=.1&&Ye*10%10===0||ut>=.05&&Ye*20%20===0)&&(ee.fillStyle="#AAA",ee.textAlign="center",ee.fillText(R(Ye,!1),In,te-5))}if(A>=Be&&A<=it){const Ye=(A-Be)/Oe*ye;ee.fillStyle="rgba(255, 0, 0, 0.8)",ee.fillRect(Ye-1,0,2,te),ee.beginPath(),ee.moveTo(Ye,0),ee.lineTo(Ye-4,-4),ee.lineTo(Ye+4,-4),ee.closePath(),ee.fill()}if(n>=Be&&n<=it){const Ye=(n-Be)/Oe*ye;ee.fillStyle="rgba(255, 215, 0, 0.8)",ee.fillRect(Ye-1,0,2,te),ee.beginPath(),ee.moveTo(Ye,0),ee.lineTo(Ye-6,-6),ee.lineTo(Ye+6,-6),ee.closePath(),ee.fill()}const Or=3;ee.fillStyle="rgba(100, 100, 255, 0.5)",ee.fillRect(0,te-Or,ye*(Oe/g),Or)},[u,A,D,W,g,n,E]);he.useEffect(()=>{if(u&&!d){const Q=requestAnimationFrame(b);return()=>cancelAnimationFrame(Q)}},[u,A,D,W,g,n,d,b]);const V=Q=>{if(Q.preventDefault(),Q.stopPropagation(),!u||!i.current||fe)return;const ee=i.current,ye=ee.getBoundingClientRect(),ve=(Q.type.includes("touch")?Q.touches?Q.touches[0].clientX:Q.changedTouches[0].clientX:Q.clientX)-ye.left,Oe=ve/ee.width,Be=Math.max(0,Math.min(g,g*Oe));r&&L_(r,{zoomLevel:D,waveformOffset:W,startPoint:n}).catch(it=>console.error("Save on click failed:",it)),t!=null&&t.current&&(t.current.currentTime=Be),P(Be),console.log({eventType:Q.type,clickX:ve,canvasWidth:ee.width,totalDuration:g,clickRatio:Oe,clickTime:Be})},M=()=>{B(Q=>{if(Q>=64)return Q;const ee=Math.min(64,Q*2);if(u){const ye=g/Q,te=W+ye/2,ve=g/ee,Oe=Math.max(0,Math.min(g-ve,te-ve/2));$(Oe)}return ee})},k=()=>{B(Q=>{if(Q<=1)return 1;const ee=Math.max(1,Q/2);if(ee===1)$(0);else if(u){const ye=g/Q,te=W+ye/2,ve=g/ee,Oe=Math.max(0,Math.min(g-ve,te-ve/2));$(Oe)}return ee})},me=()=>{if(!u)return;const Q=g/D,ee=Math.max(0,Math.min(g-Q,n-Q/2));$(ee)},ce=Q=>{if(!u)return;Q.preventDefault();const ee=g/D,ye=Math.max(0,g-ee),te=.05*ee;Q.deltaY>0?$(ve=>Math.min(ye,ve+te)):$(ve=>Math.max(0,ve-te))},[fe,oe]=he.useState(!1),[ne,se]=he.useState(0),re=Q=>{u&&(Q.preventDefault(),oe(!0),se(Q.clientX),Q.currentTarget.style.cursor="grabbing")},L=Q=>{if(!fe||!u)return;const ee=Q.clientX-ne,ye=g/D,te=E/ye,ve=ee/te,Oe=Math.max(0,g-ye);$(Be=>Math.max(0,Math.min(Oe,Be-ve))),se(Q.clientX)},Z=Q=>{oe(!1),Q.currentTarget.style.cursor="grab"},Ee=()=>{if(!(t!=null&&t.current)||!e)return;const Q=t.current.currentTime,ee=Math.round(Q*1e3)/1e3;e(ee)},be=Q=>{if(!u||!e)return;const ee=Q*.001,ye=Math.max(0,Math.min(g,n+ee)),te=Math.round(ye*1e3)/1e3;if(e(te),D>1){const ve=g/D,Oe=W,Be=Oe+ve;if(ye<Oe||ye>Be){const it=Math.max(0,Math.min(g-ve,ye-ve/2));$(it)}}};return T.jsx("div",{className:"waveform-container",ref:a,children:d?T.jsx("div",{className:"waveform-loading",children:"Loading waveform..."}):T.jsxs(T.Fragment,{children:[T.jsxs("div",{className:"waveform-canvas-container",style:{position:"relative",cursor:fe?"grabbing":"grab"},onWheel:ce,onMouseDown:re,onMouseMove:L,onMouseUp:Z,onMouseLeave:Z,onClick:V,onTouchStart:Q=>{if(!u)return;Q.preventDefault();const ee=Q.touches[0];oe(!0),se(ee.clientX),Q.currentTarget.style.cursor="grabbing"},onTouchMove:Q=>{if(!fe||!u)return;Q.preventDefault();const ee=Q.touches[0],ye=ee.clientX-ne,te=g/D,ve=E/te,Oe=ye/ve,Be=Math.max(0,g-te);$(it=>Math.max(0,Math.min(Be,it-Oe))),se(ee.clientX)},onTouchEnd:Q=>{fe||V(Q),oe(!1),Q.currentTarget.style.cursor="grab"},onTouchCancel:Q=>{oe(!1),Q.currentTarget.style.cursor="grab"},children:[T.jsx("canvas",{ref:i,width:800,height:80,className:"waveform-canvas"}),T.jsx("button",{onClick:me,style:{position:"absolute",top:"5px",left:"30px",background:"rgba(255, 215, 0, 0.5)",color:"white",border:"none",borderRadius:"3px",padding:"2px 6px",fontSize:"10px",cursor:"pointer"},title:"Focus view on start point",children:"Find Start"}),T.jsxs("div",{style:{position:"absolute",top:"5px",left:"5px",background:"rgba(0, 0, 0, 0.5)",color:"white",borderRadius:"3px",padding:"2px 5px",fontSize:"10px"},children:[D,"x"]})]}),T.jsxs("div",{className:"waveform-timestamps",style:{display:"flex",justifyContent:"space-between",padding:"5px 0",fontSize:"12px",fontFamily:"monospace"},children:[T.jsxs("span",{className:"start-point",style:{color:"white",fontSize:"14px",border:"solid 2px orange",borderRadius:"3px",padding:"2px 5px",cursor:"pointer",WebkitUserSelect:"none",MozUserSelect:"none",msUserSelect:"none",userSelect:"none",WebkitTouchCallout:"none"},onClick:me,title:"Click to focus on start point",children:["Start: ",R(n)]}),T.jsxs("span",{className:"duration",style:{color:"white",fontSize:"14px",border:"solid 2px white",borderRadius:"3px",padding:"2px 5px",WebkitUserSelect:"none",MozUserSelect:"none",msUserSelect:"none",userSelect:"none",WebkitTouchCallout:"none"},children:["Total: ",R(g)]})]}),T.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"5px 0",margin:"5px 0"},children:T.jsxs("div",{style:{display:"flex",gap:"5px"},children:[T.jsx("button",{onClick:k,disabled:D<=1,style:{background:D>=64?"#555":"#222",color:"white",border:"solid 2px white",borderRadius:"3px",padding:"3px 8px",fontSize:"16px",fontFamily:"Arial, sans-serif",cursor:D>=64?"not-allowed":"pointer",WebkitUserSelect:"none",MozUserSelect:"none",msUserSelect:"none",userSelect:"none",WebkitTouchCallout:"none"},children:T.jsx(AS,{})}),T.jsx("button",{onClick:M,disabled:D>=64,style:{background:D>=64?"#555":"#222",color:"white",border:"solid 2px white",borderRadius:"3px",padding:"3px 8px",fontSize:"16px",fontFamily:"Arial, sans-serif",cursor:D>=64?"not-allowed":"pointer",WebkitUserSelect:"none",MozUserSelect:"none",msUserSelect:"none",userSelect:"none",WebkitTouchCallout:"none"},children:T.jsx(kS,{})})]})}),T.jsxs("div",{className:"navigation-controls",style:{display:"flex",justifyContent:"center",gap:"8px",padding:"10px 0"},children:[T.jsx("button",{onClick:()=>be(-5),style:{background:"#DAA520",border:"none",borderRadius:"4px",padding:"6px 12px",color:"black",cursor:"pointer",fontSize:"16px",WebkitUserSelect:"none",MozUserSelect:"none",msUserSelect:"none",userSelect:"none",WebkitTouchCallout:"none"},children:"-5 ms"}),T.jsx("button",{onClick:()=>be(-1),style:{background:"#DAA520",border:"none",borderRadius:"4px",padding:"6px 12px",color:"black",cursor:"pointer",fontSize:"16px",WebkitUserSelect:"none",MozUserSelect:"none",msUserSelect:"none",userSelect:"none",WebkitTouchCallout:"none"},children:"-1 ms"}),T.jsx("button",{onClick:()=>be(1),style:{background:"#DAA520",border:"none",borderRadius:"4px",padding:"6px 12px",color:"black",cursor:"pointer",fontSize:"16px",WebkitUserSelect:"none",MozUserSelect:"none",msUserSelect:"none",userSelect:"none",WebkitTouchCallout:"none"},children:"+1 ms"}),T.jsx("button",{onClick:()=>be(5),style:{background:"#DAA520",border:"none",borderRadius:"4px",padding:"6px 12px",color:"black",cursor:"pointer",fontSize:"16px",WebkitUserSelect:"none",MozUserSelect:"none",msUserSelect:"none",userSelect:"none",WebkitTouchCallout:"none"},children:"+5 ms"})]}),T.jsx("button",{className:"set-start-point-button",onClick:Ee,style:{background:"#FFD700",border:"none",borderRadius:"4px",padding:"10px",margin:"5px 0",color:"#333",fontSeize:"16px",fontWeight:"bold",cursor:"pointer",width:"100%",WebkitUserSelect:"none",MozUserSelect:"none",msUserSelect:"none",userSelect:"none",WebkitTouchCallout:"none"},children:"Set Start Point"})]})})},XR=r=>(e,t)=>(r.set(e,t),t),j_=Number.MAX_SAFE_INTEGER===void 0?9007199254740991:Number.MAX_SAFE_INTEGER,$E=536870912,B_=$E*2,YR=(r,e)=>t=>{const n=e.get(t);let i=n===void 0?t.size:n<B_?n+1:0;if(!t.has(i))return r(t,i);if(t.size<$E){for(;t.has(i);)i=Math.floor(Math.random()*B_);return r(t,i)}if(t.size>j_)throw new Error("Congratulations, you created a collection of unique numbers which uses all available integers!");for(;t.has(i);)i=Math.floor(Math.random()*j_);return r(t,i)},qE=new WeakMap,ZR=XR(qE),JR=YR(ZR,qE),eP=r=>typeof r.start=="function",z_=new WeakMap,tP=r=>({...r,connect:({call:e})=>async()=>{const{port1:t,port2:n}=new MessageChannel,i=await e("connect",{port:t},[t]);return z_.set(n,i),n},disconnect:({call:e})=>async t=>{const n=z_.get(t);if(n===void 0)throw new Error("The given port is not connected.");await e("disconnect",{portId:n})},isSupported:({call:e})=>()=>e("isSupported")}),np=new WeakMap,nP=r=>{if(np.has(r))return np.get(r);const e=new Map;return np.set(r,e),e},rP=r=>{const e=tP(r);return t=>{const n=nP(t);t.addEventListener("message",({data:c})=>{const{id:d}=c;if(d!==null&&n.has(d)){const{reject:p,resolve:g}=n.get(d);n.delete(d),c.error===void 0?g(c.result):p(new Error(c.error.message))}}),eP(t)&&t.start();const i=(c,d=null,p=[])=>new Promise((g,_)=>{const E=JR(n);n.set(E,{reject:_,resolve:g}),d===null?t.postMessage({id:E,method:c},p):t.postMessage({id:E,method:c,params:d},p)}),a=(c,d,p=[])=>{t.postMessage({id:null,method:c,params:d},p)};let u={};for(const[c,d]of Object.entries(e))u={...u,[c]:d({call:i,notify:a})};return{...u}}},U_=(r,e,t)=>({endTime:e,insertTime:t,type:"exponentialRampToValue",value:r}),$_=(r,e,t)=>({endTime:e,insertTime:t,type:"linearRampToValue",value:r}),Vp=(r,e)=>({startTime:e,type:"setValue",value:r}),WE=(r,e,t)=>({duration:t,startTime:e,type:"setValueCurve",values:r}),GE=(r,e,{startTime:t,target:n,timeConstant:i})=>n+(e-n)*Math.exp((t-r)/i),ga=r=>r.type==="exponentialRampToValue",kh=r=>r.type==="linearRampToValue",ii=r=>ga(r)||kh(r),Cm=r=>r.type==="setValue",_s=r=>r.type==="setValueCurve",bh=(r,e,t,n)=>{const i=r[e];return i===void 0?n:ii(i)||Cm(i)?i.value:_s(i)?i.values[i.values.length-1]:GE(t,bh(r,e-1,i.startTime,n),i)},q_=(r,e,t,n,i)=>t===void 0?[n.insertTime,i]:ii(t)?[t.endTime,t.value]:Cm(t)?[t.startTime,t.value]:_s(t)?[t.startTime+t.duration,t.values[t.values.length-1]]:[t.startTime,bh(r,e-1,t.startTime,i)],Mp=r=>r.type==="cancelAndHold",Op=r=>r.type==="cancelScheduledValues",ri=r=>Mp(r)||Op(r)?r.cancelTime:ga(r)||kh(r)?r.endTime:r.startTime,W_=(r,e,t,{endTime:n,value:i})=>t===i?i:0<t&&0<i||t<0&&i<0?t*(i/t)**((r-e)/(n-e)):0,G_=(r,e,t,{endTime:n,value:i})=>t+(r-e)/(n-e)*(i-t),sP=(r,e)=>{const t=Math.floor(e),n=Math.ceil(e);return t===n?r[t]:(1-(e-t))*r[t]+(1-(n-e))*r[n]},iP=(r,{duration:e,startTime:t,values:n})=>{const i=(r-t)/e*(n.length-1);return sP(n,i)},Gc=r=>r.type==="setTarget";class oP{constructor(e){this._automationEvents=[],this._currenTime=0,this._defaultValue=e}[Symbol.iterator](){return this._automationEvents[Symbol.iterator]()}add(e){const t=ri(e);if(Mp(e)||Op(e)){const n=this._automationEvents.findIndex(a=>Op(e)&&_s(a)?a.startTime+a.duration>=t:ri(a)>=t),i=this._automationEvents[n];if(n!==-1&&(this._automationEvents=this._automationEvents.slice(0,n)),Mp(e)){const a=this._automationEvents[this._automationEvents.length-1];if(i!==void 0&&ii(i)){if(a!==void 0&&Gc(a))throw new Error("The internal list is malformed.");const u=a===void 0?i.insertTime:_s(a)?a.startTime+a.duration:ri(a),c=a===void 0?this._defaultValue:_s(a)?a.values[a.values.length-1]:a.value,d=ga(i)?W_(t,u,c,i):G_(t,u,c,i),p=ga(i)?U_(d,t,this._currenTime):$_(d,t,this._currenTime);this._automationEvents.push(p)}if(a!==void 0&&Gc(a)&&this._automationEvents.push(Vp(this.getValue(t),t)),a!==void 0&&_s(a)&&a.startTime+a.duration>t){const u=t-a.startTime,c=(a.values.length-1)/a.duration,d=Math.max(2,1+Math.ceil(u*c)),p=u/(d-1)*c,g=a.values.slice(0,d);if(p<1)for(let _=1;_<d;_+=1){const E=p*_%1;g[_]=a.values[_-1]*(1-E)+a.values[_]*E}this._automationEvents[this._automationEvents.length-1]=WE(g,a.startTime,u)}}}else{const n=this._automationEvents.findIndex(u=>ri(u)>t),i=n===-1?this._automationEvents[this._automationEvents.length-1]:this._automationEvents[n-1];if(i!==void 0&&_s(i)&&ri(i)+i.duration>t)return!1;const a=ga(e)?U_(e.value,e.endTime,this._currenTime):kh(e)?$_(e.value,t,this._currenTime):e;if(n===-1)this._automationEvents.push(a);else{if(_s(e)&&t+e.duration>ri(this._automationEvents[n]))return!1;this._automationEvents.splice(n,0,a)}}return!0}flush(e){const t=this._automationEvents.findIndex(n=>ri(n)>e);if(t>1){const n=this._automationEvents.slice(t-1),i=n[0];Gc(i)&&n.unshift(Vp(bh(this._automationEvents,t-2,i.startTime,this._defaultValue),i.startTime)),this._automationEvents=n}}getValue(e){if(this._automationEvents.length===0)return this._defaultValue;const t=this._automationEvents.findIndex(u=>ri(u)>e),n=this._automationEvents[t],i=(t===-1?this._automationEvents.length:t)-1,a=this._automationEvents[i];if(a!==void 0&&Gc(a)&&(n===void 0||!ii(n)||n.insertTime>e))return GE(e,bh(this._automationEvents,i-1,a.startTime,this._defaultValue),a);if(a!==void 0&&Cm(a)&&(n===void 0||!ii(n)))return a.value;if(a!==void 0&&_s(a)&&(n===void 0||!ii(n)||a.startTime+a.duration>e))return e<a.startTime+a.duration?iP(e,a):a.values[a.values.length-1];if(a!==void 0&&ii(a)&&(n===void 0||!ii(n)))return a.value;if(n!==void 0&&ga(n)){const[u,c]=q_(this._automationEvents,i,a,n,this._defaultValue);return W_(e,u,c,n)}if(n!==void 0&&kh(n)){const[u,c]=q_(this._automationEvents,i,a,n,this._defaultValue);return G_(e,u,c,n)}return this._defaultValue}}const aP=r=>({cancelTime:r,type:"cancelAndHold"}),lP=r=>({cancelTime:r,type:"cancelScheduledValues"}),uP=(r,e)=>({endTime:e,type:"exponentialRampToValue",value:r}),cP=(r,e)=>({endTime:e,type:"linearRampToValue",value:r}),hP=(r,e,t)=>({startTime:e,target:r,timeConstant:t,type:"setTarget"}),dP=()=>new DOMException("","AbortError"),fP=r=>(e,t,[n,i,a],u)=>{r(e[i],[t,n,a],c=>c[0]===t&&c[1]===n,u)},pP=r=>(e,t,n)=>{const i=[];for(let a=0;a<n.numberOfInputs;a+=1)i.push(new Set);r.set(e,{activeInputs:i,outputs:new Set,passiveInputs:new WeakMap,renderer:t})},mP=r=>(e,t)=>{r.set(e,{activeInputs:new Set,passiveInputs:new WeakMap,renderer:t})},Va=new WeakSet,KE=new WeakMap,HE=new WeakMap,QE=new WeakMap,XE=new WeakMap,YE=new WeakMap,ZE=new WeakMap,Fp=new WeakMap,K_=new WeakMap,JE={construct(){return JE}},gP=r=>{try{const e=new Proxy(r,JE);new e}catch{return!1}return!0},H_=/^import(?:(?:[\s]+[\w]+|(?:[\s]+[\w]+[\s]*,)?[\s]*\{[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?(?:[\s]*,[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?)*[\s]*}|(?:[\s]+[\w]+[\s]*,)?[\s]*\*[\s]+as[\s]+[\w]+)[\s]+from)?(?:[\s]*)("([^"\\]|\\.)+"|'([^'\\]|\\.)+')(?:[\s]*);?/,Q_=(r,e)=>{const t=[];let n=r.replace(/^[\s]+/,""),i=n.match(H_);for(;i!==null;){const a=i[1].slice(1,-1),u=i[0].replace(/([\s]+)?;?$/,"").replace(a,new URL(a,e).toString());t.push(u),n=n.slice(i[0].length).replace(/^[\s]+/,""),i=n.match(H_)}return[t.join(";"),n]},X_=r=>{if(r!==void 0&&!Array.isArray(r))throw new TypeError("The parameterDescriptors property of given value for processorCtor is not an array.")},Y_=r=>{if(!gP(r))throw new TypeError("The given value for processorCtor should be a constructor.");if(r.prototype===null||typeof r.prototype!="object")throw new TypeError("The given value for processorCtor should have a prototype.")},yP=(r,e,t,n,i,a,u,c,d,p,g,_,E)=>{let C=0;return(A,P,D={credentials:"omit"})=>{const B=g.get(A);if(B!==void 0&&B.has(P))return Promise.resolve();const W=p.get(A);if(W!==void 0){const F=W.get(P);if(F!==void 0)return F}const $=a(A),X=$.audioWorklet===void 0?i(P).then(([F,U])=>{const[N,I]=Q_(F,U),R=`${N};((a,b)=>{(a[b]=a[b]||[]).push((AudioWorkletProcessor,global,registerProcessor,sampleRate,self,window)=>{${I}
})})(window,'_AWGS')`;return t(R)}).then(()=>{const F=E._AWGS.pop();if(F===void 0)throw new SyntaxError;n($.currentTime,$.sampleRate,()=>F(class{},void 0,(U,N)=>{if(U.trim()==="")throw e();const I=K_.get($);if(I!==void 0){if(I.has(U))throw e();Y_(N),X_(N.parameterDescriptors),I.set(U,N)}else Y_(N),X_(N.parameterDescriptors),K_.set($,new Map([[U,N]]))},$.sampleRate,void 0,void 0))}):Promise.all([i(P),Promise.resolve(r(_,_))]).then(([[F,U],N])=>{const I=C+1;C=I;const[R,b]=Q_(F,U),me=`${R};((AudioWorkletProcessor,registerProcessor)=>{${b}
})(${N?"AudioWorkletProcessor":"class extends AudioWorkletProcessor {__b=new WeakSet();constructor(){super();(p=>p.postMessage=(q=>(m,t)=>q.call(p,m,t?t.filter(u=>!this.__b.has(u)):t))(p.postMessage))(this.port)}}"},(n,p)=>registerProcessor(n,class extends p{${N?"":"__c = (a) => a.forEach(e=>this.__b.add(e.buffer));"}process(i,o,p){${N?"":"i.forEach(this.__c);o.forEach(this.__c);this.__c(Object.values(p));"}return super.process(i.map(j=>j.some(k=>k.length===0)?[]:j),o,p)}}));registerProcessor('__sac${I}',class extends AudioWorkletProcessor{process(){return !1}})`,ce=new Blob([me],{type:"application/javascript; charset=utf-8"}),fe=URL.createObjectURL(ce);return $.audioWorklet.addModule(fe,D).then(()=>{if(c($))return $;const oe=u($);return oe.audioWorklet.addModule(fe,D).then(()=>oe)}).then(oe=>{if(d===null)throw new SyntaxError;try{new d(oe,`__sac${I}`)}catch{throw new SyntaxError}}).finally(()=>URL.revokeObjectURL(fe))});return W===void 0?p.set(A,new Map([[P,X]])):W.set(P,X),X.then(()=>{const F=g.get(A);F===void 0?g.set(A,new Set([P])):F.add(P)}).finally(()=>{const F=p.get(A);F!==void 0&&F.delete(P)}),X}},wi=(r,e)=>{const t=r.get(e);if(t===void 0)throw new Error("A value with the given key could not be found.");return t},nd=(r,e)=>{const t=Array.from(r).filter(e);if(t.length>1)throw Error("More than one element was found.");if(t.length===0)throw Error("No element was found.");const[n]=t;return r.delete(n),n},eT=(r,e,t,n)=>{const i=wi(r,e),a=nd(i,u=>u[0]===t&&u[1]===n);return i.size===0&&r.delete(e),a},gu=r=>wi(ZE,r),Ma=r=>{if(Va.has(r))throw new Error("The AudioNode is already stored.");Va.add(r),gu(r).forEach(e=>e(!0))},tT=r=>"port"in r,yu=r=>{if(!Va.has(r))throw new Error("The AudioNode is not stored.");Va.delete(r),gu(r).forEach(e=>e(!1))},Lp=(r,e)=>{!tT(r)&&e.every(t=>t.size===0)&&yu(r)},vP=(r,e,t,n,i,a,u,c,d,p,g,_,E)=>{const C=new WeakMap;return(A,P,D,B,W)=>{const{activeInputs:$,passiveInputs:X}=a(P),{outputs:F}=a(A),U=c(A),N=I=>{const R=d(P),b=d(A);if(I){const V=eT(X,A,D,B);r($,A,V,!1),!W&&!_(A)&&t(b,R,D,B),E(P)&&Ma(P)}else{const V=n($,A,D,B);e(X,B,V,!1),!W&&!_(A)&&i(b,R,D,B);const M=u(P);if(M===0)g(P)&&Lp(P,$);else{const k=C.get(P);k!==void 0&&clearTimeout(k),C.set(P,setTimeout(()=>{g(P)&&Lp(P,$)},M*1e3))}}};return p(F,[P,D,B],I=>I[0]===P&&I[1]===D&&I[2]===B,!0)?(U.add(N),g(A)?r($,A,[D,B,N],!0):e(X,B,[A,D,N],!0),!0):!1}},_P=r=>(e,t,[n,i,a],u)=>{const c=e.get(n);c===void 0?e.set(n,new Set([[i,t,a]])):r(c,[i,t,a],d=>d[0]===i&&d[1]===t,u)},wP=r=>(e,t)=>{const n=r(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});t.connect(n).connect(e.destination);const i=()=>{t.removeEventListener("ended",i),t.disconnect(n),n.disconnect()};t.addEventListener("ended",i)},EP={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",fftSize:2048,maxDecibels:-30,minDecibels:-100,smoothingTimeConstant:.8},TP=(r,e,t,n,i,a)=>class extends r{constructor(c,d){const p=i(c),g={...EP,...d},_=n(p,g),E=a(p)?e():null;super(c,!1,_,E),this._nativeAnalyserNode=_}get fftSize(){return this._nativeAnalyserNode.fftSize}set fftSize(c){this._nativeAnalyserNode.fftSize=c}get frequencyBinCount(){return this._nativeAnalyserNode.frequencyBinCount}get maxDecibels(){return this._nativeAnalyserNode.maxDecibels}set maxDecibels(c){const d=this._nativeAnalyserNode.maxDecibels;if(this._nativeAnalyserNode.maxDecibels=c,!(c>this._nativeAnalyserNode.minDecibels))throw this._nativeAnalyserNode.maxDecibels=d,t()}get minDecibels(){return this._nativeAnalyserNode.minDecibels}set minDecibels(c){const d=this._nativeAnalyserNode.minDecibels;if(this._nativeAnalyserNode.minDecibels=c,!(this._nativeAnalyserNode.maxDecibels>c))throw this._nativeAnalyserNode.minDecibels=d,t()}get smoothingTimeConstant(){return this._nativeAnalyserNode.smoothingTimeConstant}set smoothingTimeConstant(c){this._nativeAnalyserNode.smoothingTimeConstant=c}getByteFrequencyData(c){this._nativeAnalyserNode.getByteFrequencyData(c)}getByteTimeDomainData(c){this._nativeAnalyserNode.getByteTimeDomainData(c)}getFloatFrequencyData(c){this._nativeAnalyserNode.getFloatFrequencyData(c)}getFloatTimeDomainData(c){this._nativeAnalyserNode.getFloatTimeDomainData(c)}},Tn=(r,e)=>r.context===e,IP=(r,e,t)=>()=>{const n=new WeakMap,i=async(a,u)=>{let c=e(a);if(!Tn(c,u)){const p={channelCount:c.channelCount,channelCountMode:c.channelCountMode,channelInterpretation:c.channelInterpretation,fftSize:c.fftSize,maxDecibels:c.maxDecibels,minDecibels:c.minDecibels,smoothingTimeConstant:c.smoothingTimeConstant};c=r(u,p)}return n.set(u,c),await t(a,u,c),c};return{render(a,u){const c=n.get(u);return c!==void 0?Promise.resolve(c):i(a,u)}}},Dh=r=>{try{r.copyToChannel(new Float32Array(1),0,-1)}catch{return!1}return!0},wo=()=>new DOMException("","IndexSizeError"),Am=r=>{r.getChannelData=(e=>t=>{try{return e.call(r,t)}catch(n){throw n.code===12?wo():n}})(r.getChannelData)},SP={numberOfChannels:1},CP=(r,e,t,n,i,a,u,c)=>{let d=null;return class nT{constructor(g){if(i===null)throw new Error("Missing the native OfflineAudioContext constructor.");const{length:_,numberOfChannels:E,sampleRate:C}={...SP,...g};d===null&&(d=new i(1,1,44100));const A=n!==null&&e(a,a)?new n({length:_,numberOfChannels:E,sampleRate:C}):d.createBuffer(E,_,C);if(A.numberOfChannels===0)throw t();return typeof A.copyFromChannel!="function"?(u(A),Am(A)):e(Dh,()=>Dh(A))||c(A),r.add(A),A}static[Symbol.hasInstance](g){return g!==null&&typeof g=="object"&&Object.getPrototypeOf(g)===nT.prototype||r.has(g)}}},ar=-34028234663852886e22,Dn=34028234663852886e22,Is=r=>Va.has(r),AP={buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1},xP=(r,e,t,n,i,a,u,c)=>class extends r{constructor(p,g){const _=a(p),E={...AP,...g},C=i(_,E),A=u(_),P=A?e():null;super(p,!1,C,P),this._audioBufferSourceNodeRenderer=P,this._isBufferNullified=!1,this._isBufferSet=E.buffer!==null,this._nativeAudioBufferSourceNode=C,this._onended=null,this._playbackRate=t(this,A,C.playbackRate,Dn,ar)}get buffer(){return this._isBufferNullified?null:this._nativeAudioBufferSourceNode.buffer}set buffer(p){if(this._nativeAudioBufferSourceNode.buffer=p,p!==null){if(this._isBufferSet)throw n();this._isBufferSet=!0}}get loop(){return this._nativeAudioBufferSourceNode.loop}set loop(p){this._nativeAudioBufferSourceNode.loop=p}get loopEnd(){return this._nativeAudioBufferSourceNode.loopEnd}set loopEnd(p){this._nativeAudioBufferSourceNode.loopEnd=p}get loopStart(){return this._nativeAudioBufferSourceNode.loopStart}set loopStart(p){this._nativeAudioBufferSourceNode.loopStart=p}get onended(){return this._onended}set onended(p){const g=typeof p=="function"?c(this,p):null;this._nativeAudioBufferSourceNode.onended=g;const _=this._nativeAudioBufferSourceNode.onended;this._onended=_!==null&&_===g?p:_}get playbackRate(){return this._playbackRate}start(p=0,g=0,_){if(this._nativeAudioBufferSourceNode.start(p,g,_),this._audioBufferSourceNodeRenderer!==null&&(this._audioBufferSourceNodeRenderer.start=_===void 0?[p,g]:[p,g,_]),this.context.state!=="closed"){Ma(this);const E=()=>{this._nativeAudioBufferSourceNode.removeEventListener("ended",E),Is(this)&&yu(this)};this._nativeAudioBufferSourceNode.addEventListener("ended",E)}}stop(p=0){this._nativeAudioBufferSourceNode.stop(p),this._audioBufferSourceNodeRenderer!==null&&(this._audioBufferSourceNodeRenderer.stop=p)}},NP=(r,e,t,n,i)=>()=>{const a=new WeakMap;let u=null,c=null;const d=async(p,g)=>{let _=t(p);const E=Tn(_,g);if(!E){const C={buffer:_.buffer,channelCount:_.channelCount,channelCountMode:_.channelCountMode,channelInterpretation:_.channelInterpretation,loop:_.loop,loopEnd:_.loopEnd,loopStart:_.loopStart,playbackRate:_.playbackRate.value};_=e(g,C),u!==null&&_.start(...u),c!==null&&_.stop(c)}return a.set(g,_),E?await r(g,p.playbackRate,_.playbackRate):await n(g,p.playbackRate,_.playbackRate),await i(p,g,_),_};return{set start(p){u=p},set stop(p){c=p},render(p,g){const _=a.get(g);return _!==void 0?Promise.resolve(_):d(p,g)}}},RP=r=>"playbackRate"in r,PP=r=>"frequency"in r&&"gain"in r,kP=r=>"offset"in r,bP=r=>!("frequency"in r)&&"gain"in r,DP=r=>"detune"in r&&"frequency"in r&&!("gain"in r),VP=r=>"pan"in r,Hn=r=>wi(KE,r),vu=r=>wi(QE,r),jp=(r,e)=>{const{activeInputs:t}=Hn(r);t.forEach(i=>i.forEach(([a])=>{e.includes(r)||jp(a,[...e,r])}));const n=RP(r)?[r.playbackRate]:tT(r)?Array.from(r.parameters.values()):PP(r)?[r.Q,r.detune,r.frequency,r.gain]:kP(r)?[r.offset]:bP(r)?[r.gain]:DP(r)?[r.detune,r.frequency]:VP(r)?[r.pan]:[];for(const i of n){const a=vu(i);a!==void 0&&a.activeInputs.forEach(([u])=>jp(u,e))}Is(r)&&yu(r)},MP=r=>{jp(r.destination,[])},OP=(r,e,t,n,i,a,u,c)=>class extends r{constructor(p,g){const _=a(p),E=u(_),C=i(_,g,E),A=E?e(c):null;super(p,!1,C,A),this._isNodeOfNativeOfflineAudioContext=E,this._nativeAudioDestinationNode=C}get channelCount(){return this._nativeAudioDestinationNode.channelCount}set channelCount(p){if(this._isNodeOfNativeOfflineAudioContext)throw n();if(p>this._nativeAudioDestinationNode.maxChannelCount)throw t();this._nativeAudioDestinationNode.channelCount=p}get channelCountMode(){return this._nativeAudioDestinationNode.channelCountMode}set channelCountMode(p){if(this._isNodeOfNativeOfflineAudioContext)throw n();this._nativeAudioDestinationNode.channelCountMode=p}get maxChannelCount(){return this._nativeAudioDestinationNode.maxChannelCount}},FP=r=>{const e=new WeakMap,t=async(n,i)=>{const a=i.destination;return e.set(i,a),await r(n,i,a),a};return{render(n,i){const a=e.get(i);return a!==void 0?Promise.resolve(a):t(n,i)}}},LP=(r,e,t,n,i,a,u,c)=>(d,p)=>{const g=p.listener,_=()=>{const F=new Float32Array(1),U=e(p,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:9}),N=u(p);let I=!1,R=[0,0,-1,0,1,0],b=[0,0,0];const V=()=>{if(I)return;I=!0;const ce=n(p,256,9,0);ce.onaudioprocess=({inputBuffer:fe})=>{const oe=[a(fe,F,0),a(fe,F,1),a(fe,F,2),a(fe,F,3),a(fe,F,4),a(fe,F,5)];oe.some((se,re)=>se!==R[re])&&(g.setOrientation(...oe),R=oe);const ne=[a(fe,F,6),a(fe,F,7),a(fe,F,8)];ne.some((se,re)=>se!==b[re])&&(g.setPosition(...ne),b=ne)},U.connect(ce)},M=ce=>fe=>{fe!==R[ce]&&(R[ce]=fe,g.setOrientation(...R))},k=ce=>fe=>{fe!==b[ce]&&(b[ce]=fe,g.setPosition(...b))},me=(ce,fe,oe)=>{const ne=t(p,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:fe});ne.connect(U,0,ce),ne.start(),Object.defineProperty(ne.offset,"defaultValue",{get(){return fe}});const se=r({context:d},N,ne.offset,Dn,ar);return c(se,"value",re=>()=>re.call(se),re=>L=>{try{re.call(se,L)}catch(Z){if(Z.code!==9)throw Z}V(),N&&oe(L)}),se.cancelAndHoldAtTime=(re=>N?()=>{throw i()}:(...L)=>{const Z=re.apply(se,L);return V(),Z})(se.cancelAndHoldAtTime),se.cancelScheduledValues=(re=>N?()=>{throw i()}:(...L)=>{const Z=re.apply(se,L);return V(),Z})(se.cancelScheduledValues),se.exponentialRampToValueAtTime=(re=>N?()=>{throw i()}:(...L)=>{const Z=re.apply(se,L);return V(),Z})(se.exponentialRampToValueAtTime),se.linearRampToValueAtTime=(re=>N?()=>{throw i()}:(...L)=>{const Z=re.apply(se,L);return V(),Z})(se.linearRampToValueAtTime),se.setTargetAtTime=(re=>N?()=>{throw i()}:(...L)=>{const Z=re.apply(se,L);return V(),Z})(se.setTargetAtTime),se.setValueAtTime=(re=>N?()=>{throw i()}:(...L)=>{const Z=re.apply(se,L);return V(),Z})(se.setValueAtTime),se.setValueCurveAtTime=(re=>N?()=>{throw i()}:(...L)=>{const Z=re.apply(se,L);return V(),Z})(se.setValueCurveAtTime),se};return{forwardX:me(0,0,M(0)),forwardY:me(1,0,M(1)),forwardZ:me(2,-1,M(2)),positionX:me(6,0,k(0)),positionY:me(7,0,k(1)),positionZ:me(8,0,k(2)),upX:me(3,0,M(3)),upY:me(4,1,M(4)),upZ:me(5,0,M(5))}},{forwardX:E,forwardY:C,forwardZ:A,positionX:P,positionY:D,positionZ:B,upX:W,upY:$,upZ:X}=g.forwardX===void 0?_():g;return{get forwardX(){return E},get forwardY(){return C},get forwardZ(){return A},get positionX(){return P},get positionY(){return D},get positionZ(){return B},get upX(){return W},get upY(){return $},get upZ(){return X}}},Vh=r=>"context"in r,_u=r=>Vh(r[0]),Eo=(r,e,t,n)=>{for(const i of r)if(t(i)){if(n)return!1;throw Error("The set contains at least one similar element.")}return r.add(e),!0},Z_=(r,e,[t,n],i)=>{Eo(r,[e,t,n],a=>a[0]===e&&a[1]===t,i)},J_=(r,[e,t,n],i)=>{const a=r.get(e);a===void 0?r.set(e,new Set([[t,n]])):Eo(a,[t,n],u=>u[0]===t,i)},Ba=r=>"inputs"in r,Mh=(r,e,t,n)=>{if(Ba(e)){const i=e.inputs[n];return r.connect(i,t,0),[i,t,0]}return r.connect(e,t,n),[e,t,n]},rT=(r,e,t)=>{for(const n of r)if(n[0]===e&&n[1]===t)return r.delete(n),n;return null},jP=(r,e,t)=>nd(r,n=>n[0]===e&&n[1]===t),sT=(r,e)=>{if(!gu(r).delete(e))throw new Error("Missing the expected event listener.")},iT=(r,e,t)=>{const n=wi(r,e),i=nd(n,a=>a[0]===t);return n.size===0&&r.delete(e),i},Oh=(r,e,t,n)=>{Ba(e)?r.disconnect(e.inputs[n],t,0):r.disconnect(e,t,n)},St=r=>wi(HE,r),su=r=>wi(XE,r),go=r=>Fp.has(r),nh=r=>!Va.has(r),ew=(r,e)=>new Promise(t=>{if(e!==null)t(!0);else{const n=r.createScriptProcessor(256,1,1),i=r.createGain(),a=r.createBuffer(1,2,44100),u=a.getChannelData(0);u[0]=1,u[1]=1;const c=r.createBufferSource();c.buffer=a,c.loop=!0,c.connect(n).connect(r.destination),c.connect(i),c.disconnect(i),n.onaudioprocess=d=>{const p=d.inputBuffer.getChannelData(0);Array.prototype.some.call(p,g=>g===1)?t(!0):t(!1),c.stop(),n.onaudioprocess=null,c.disconnect(n),n.disconnect(r.destination)},c.start()}}),rp=(r,e)=>{const t=new Map;for(const n of r)for(const i of n){const a=t.get(i);t.set(i,a===void 0?1:a+1)}t.forEach((n,i)=>e(i,n))},tw=r=>"context"in r,BP=r=>{const e=new Map;r.connect=(t=>(n,i=0,a=0)=>{const u=tw(n)?t(n,i,a):t(n,i),c=e.get(n);return c===void 0?e.set(n,[{input:a,output:i}]):c.every(d=>d.input!==a||d.output!==i)&&c.push({input:a,output:i}),u})(r.connect.bind(r)),r.disconnect=(t=>(n,i,a)=>{if(t.apply(r),n===void 0)e.clear();else if(typeof n=="number")for(const[u,c]of e){const d=c.filter(p=>p.output!==n);d.length===0?e.delete(u):e.set(u,d)}else if(e.has(n))if(i===void 0)e.delete(n);else{const u=e.get(n);if(u!==void 0){const c=u.filter(d=>d.output!==i&&(d.input!==a||a===void 0));c.length===0?e.delete(n):e.set(n,c)}}for(const[u,c]of e)c.forEach(d=>{tw(u)?r.connect(u,d.output,d.input):r.connect(u,d.output)})})(r.disconnect)},zP=(r,e,t,n)=>{const{activeInputs:i,passiveInputs:a}=vu(e),{outputs:u}=Hn(r),c=gu(r),d=p=>{const g=St(r),_=su(e);if(p){const E=iT(a,r,t);Z_(i,r,E,!1),!n&&!go(r)&&g.connect(_,t)}else{const E=jP(i,r,t);J_(a,E,!1),!n&&!go(r)&&g.disconnect(_,t)}};return Eo(u,[e,t],p=>p[0]===e&&p[1]===t,!0)?(c.add(d),Is(r)?Z_(i,r,[t,d],!0):J_(a,[r,t,d],!0),!0):!1},UP=(r,e,t,n)=>{const{activeInputs:i,passiveInputs:a}=Hn(e),u=rT(i[n],r,t);return u===null?[eT(a,r,t,n)[2],!1]:[u[2],!0]},$P=(r,e,t)=>{const{activeInputs:n,passiveInputs:i}=vu(e),a=rT(n,r,t);return a===null?[iT(i,r,t)[1],!1]:[a[2],!0]},xm=(r,e,t,n,i)=>{const[a,u]=UP(r,t,n,i);if(a!==null&&(sT(r,a),u&&!e&&!go(r)&&Oh(St(r),St(t),n,i)),Is(t)){const{activeInputs:c}=Hn(t);Lp(t,c)}},Nm=(r,e,t,n)=>{const[i,a]=$P(r,t,n);i!==null&&(sT(r,i),a&&!e&&!go(r)&&St(r).disconnect(su(t),n))},qP=(r,e)=>{const t=Hn(r),n=[];for(const i of t.outputs)_u(i)?xm(r,e,...i):Nm(r,e,...i),n.push(i[0]);return t.outputs.clear(),n},WP=(r,e,t)=>{const n=Hn(r),i=[];for(const a of n.outputs)a[1]===t&&(_u(a)?xm(r,e,...a):Nm(r,e,...a),i.push(a[0]),n.outputs.delete(a));return i},GP=(r,e,t,n,i)=>{const a=Hn(r);return Array.from(a.outputs).filter(u=>u[0]===t&&(n===void 0||u[1]===n)&&(i===void 0||u[2]===i)).map(u=>(_u(u)?xm(r,e,...u):Nm(r,e,...u),a.outputs.delete(u),u[0]))},KP=(r,e,t,n,i,a,u,c,d,p,g,_,E,C,A,P)=>class extends p{constructor(B,W,$,X){super($),this._context=B,this._nativeAudioNode=$;const F=g(B);_(F)&&t(ew,()=>ew(F,P))!==!0&&BP($),HE.set(this,$),ZE.set(this,new Set),B.state!=="closed"&&W&&Ma(this),r(this,X,$)}get channelCount(){return this._nativeAudioNode.channelCount}set channelCount(B){this._nativeAudioNode.channelCount=B}get channelCountMode(){return this._nativeAudioNode.channelCountMode}set channelCountMode(B){this._nativeAudioNode.channelCountMode=B}get channelInterpretation(){return this._nativeAudioNode.channelInterpretation}set channelInterpretation(B){this._nativeAudioNode.channelInterpretation=B}get context(){return this._context}get numberOfInputs(){return this._nativeAudioNode.numberOfInputs}get numberOfOutputs(){return this._nativeAudioNode.numberOfOutputs}connect(B,W=0,$=0){if(W<0||W>=this._nativeAudioNode.numberOfOutputs)throw i();const X=g(this._context),F=A(X);if(E(B)||C(B))throw a();if(Vh(B)){const I=St(B);try{const b=Mh(this._nativeAudioNode,I,W,$),V=nh(this);(F||V)&&this._nativeAudioNode.disconnect(...b),this.context.state!=="closed"&&!V&&nh(B)&&Ma(B)}catch(b){throw b.code===12?a():b}if(e(this,B,W,$,F)){const b=d([this],B);rp(b,n(F))}return B}const U=su(B);if(U.name==="playbackRate"&&U.maxValue===1024)throw u();try{this._nativeAudioNode.connect(U,W),(F||nh(this))&&this._nativeAudioNode.disconnect(U,W)}catch(I){throw I.code===12?a():I}if(zP(this,B,W,F)){const I=d([this],B);rp(I,n(F))}}disconnect(B,W,$){let X;const F=g(this._context),U=A(F);if(B===void 0)X=qP(this,U);else if(typeof B=="number"){if(B<0||B>=this.numberOfOutputs)throw i();X=WP(this,U,B)}else{if(W!==void 0&&(W<0||W>=this.numberOfOutputs)||Vh(B)&&$!==void 0&&($<0||$>=B.numberOfInputs))throw i();if(X=GP(this,U,B,W,$),X.length===0)throw a()}for(const N of X){const I=d([this],N);rp(I,c)}}},HP=(r,e,t,n,i,a,u,c,d,p,g,_,E)=>(C,A,P,D=null,B=null)=>{const W=P.value,$=new oP(W),X=A?n($):null,F={get defaultValue(){return W},get maxValue(){return D===null?P.maxValue:D},get minValue(){return B===null?P.minValue:B},get value(){return P.value},set value(U){P.value=U,F.setValueAtTime(U,C.context.currentTime)},cancelAndHoldAtTime(U){if(typeof P.cancelAndHoldAtTime=="function")X===null&&$.flush(C.context.currentTime),$.add(i(U)),P.cancelAndHoldAtTime(U);else{const N=Array.from($).pop();X===null&&$.flush(C.context.currentTime),$.add(i(U));const I=Array.from($).pop();P.cancelScheduledValues(U),N!==I&&I!==void 0&&(I.type==="exponentialRampToValue"?P.exponentialRampToValueAtTime(I.value,I.endTime):I.type==="linearRampToValue"?P.linearRampToValueAtTime(I.value,I.endTime):I.type==="setValue"?P.setValueAtTime(I.value,I.startTime):I.type==="setValueCurve"&&P.setValueCurveAtTime(I.values,I.startTime,I.duration))}return F},cancelScheduledValues(U){return X===null&&$.flush(C.context.currentTime),$.add(a(U)),P.cancelScheduledValues(U),F},exponentialRampToValueAtTime(U,N){if(U===0)throw new RangeError;if(!Number.isFinite(N)||N<0)throw new RangeError;const I=C.context.currentTime;return X===null&&$.flush(I),Array.from($).length===0&&($.add(p(W,I)),P.setValueAtTime(W,I)),$.add(u(U,N)),P.exponentialRampToValueAtTime(U,N),F},linearRampToValueAtTime(U,N){const I=C.context.currentTime;return X===null&&$.flush(I),Array.from($).length===0&&($.add(p(W,I)),P.setValueAtTime(W,I)),$.add(c(U,N)),P.linearRampToValueAtTime(U,N),F},setTargetAtTime(U,N,I){return X===null&&$.flush(C.context.currentTime),$.add(d(U,N,I)),P.setTargetAtTime(U,N,I),F},setValueAtTime(U,N){return X===null&&$.flush(C.context.currentTime),$.add(p(U,N)),P.setValueAtTime(U,N),F},setValueCurveAtTime(U,N,I){const R=U instanceof Float32Array?U:new Float32Array(U);if(_!==null&&_.name==="webkitAudioContext"){const b=N+I,V=C.context.sampleRate,M=Math.ceil(N*V),k=Math.floor(b*V),me=k-M,ce=new Float32Array(me);for(let oe=0;oe<me;oe+=1){const ne=(R.length-1)/I*((M+oe)/V-N),se=Math.floor(ne),re=Math.ceil(ne);ce[oe]=se===re?R[se]:(1-(ne-se))*R[se]+(1-(re-ne))*R[re]}X===null&&$.flush(C.context.currentTime),$.add(g(ce,N,I)),P.setValueCurveAtTime(ce,N,I);const fe=k/V;fe<b&&E(F,ce[ce.length-1],fe),E(F,R[R.length-1],b)}else X===null&&$.flush(C.context.currentTime),$.add(g(R,N,I)),P.setValueCurveAtTime(R,N,I);return F}};return t.set(F,P),e.set(F,C),r(F,X),F},QP=r=>({replay(e){for(const t of r)if(t.type==="exponentialRampToValue"){const{endTime:n,value:i}=t;e.exponentialRampToValueAtTime(i,n)}else if(t.type==="linearRampToValue"){const{endTime:n,value:i}=t;e.linearRampToValueAtTime(i,n)}else if(t.type==="setTarget"){const{startTime:n,target:i,timeConstant:a}=t;e.setTargetAtTime(i,n,a)}else if(t.type==="setValue"){const{startTime:n,value:i}=t;e.setValueAtTime(i,n)}else if(t.type==="setValueCurve"){const{duration:n,startTime:i,values:a}=t;e.setValueCurveAtTime(a,i,n)}else throw new Error("Can't apply an unknown automation.")}}),XP=(r,e,t,n,i,a,u,c,d,p,g,_,E,C,A,P,D,B,W,$)=>class extends A{constructor(F,U){super(F,U),this._nativeContext=F,this._audioWorklet=r===void 0?void 0:{addModule:(N,I)=>r(this,N,I)}}get audioWorklet(){return this._audioWorklet}createAnalyser(){return new e(this)}createBiquadFilter(){return new i(this)}createBuffer(F,U,N){return new t({length:U,numberOfChannels:F,sampleRate:N})}createBufferSource(){return new n(this)}createChannelMerger(F=6){return new a(this,{numberOfInputs:F})}createChannelSplitter(F=6){return new u(this,{numberOfOutputs:F})}createConstantSource(){return new c(this)}createConvolver(){return new d(this)}createDelay(F=1){return new g(this,{maxDelayTime:F})}createDynamicsCompressor(){return new _(this)}createGain(){return new E(this)}createIIRFilter(F,U){return new C(this,{feedback:U,feedforward:F})}createOscillator(){return new P(this)}createPanner(){return new D(this)}createPeriodicWave(F,U,N={disableNormalization:!1}){return new B(this,{...N,imag:U,real:F})}createStereoPanner(){return new W(this)}createWaveShaper(){return new $(this)}decodeAudioData(F,U,N){return p(this._nativeContext,F).then(I=>(typeof U=="function"&&U(I),I),I=>{throw typeof N=="function"&&N(I),I})}},YP={Q:1,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:350,gain:0,type:"lowpass"},ZP=(r,e,t,n,i,a,u,c)=>class extends r{constructor(p,g){const _=a(p),E={...YP,...g},C=i(_,E),A=u(_),P=A?t():null;super(p,!1,C,P),this._Q=e(this,A,C.Q,Dn,ar),this._detune=e(this,A,C.detune,1200*Math.log2(Dn),-1200*Math.log2(Dn)),this._frequency=e(this,A,C.frequency,p.sampleRate/2,0),this._gain=e(this,A,C.gain,40*Math.log10(Dn),ar),this._nativeBiquadFilterNode=C,c(this,1)}get detune(){return this._detune}get frequency(){return this._frequency}get gain(){return this._gain}get Q(){return this._Q}get type(){return this._nativeBiquadFilterNode.type}set type(p){this._nativeBiquadFilterNode.type=p}getFrequencyResponse(p,g,_){try{this._nativeBiquadFilterNode.getFrequencyResponse(p,g,_)}catch(E){throw E.code===11?n():E}if(p.length!==g.length||g.length!==_.length)throw n()}},JP=(r,e,t,n,i)=>()=>{const a=new WeakMap,u=async(c,d)=>{let p=t(c);const g=Tn(p,d);if(!g){const _={Q:p.Q.value,channelCount:p.channelCount,channelCountMode:p.channelCountMode,channelInterpretation:p.channelInterpretation,detune:p.detune.value,frequency:p.frequency.value,gain:p.gain.value,type:p.type};p=e(d,_)}return a.set(d,p),g?(await r(d,c.Q,p.Q),await r(d,c.detune,p.detune),await r(d,c.frequency,p.frequency),await r(d,c.gain,p.gain)):(await n(d,c.Q,p.Q),await n(d,c.detune,p.detune),await n(d,c.frequency,p.frequency),await n(d,c.gain,p.gain)),await i(c,d,p),p};return{render(c,d){const p=a.get(d);return p!==void 0?Promise.resolve(p):u(c,d)}}},ek=(r,e)=>(t,n)=>{const i=e.get(t);if(i!==void 0)return i;const a=r.get(t);if(a!==void 0)return a;try{const u=n();return u instanceof Promise?(r.set(t,u),u.catch(()=>!1).then(c=>(r.delete(t),e.set(t,c),c))):(e.set(t,u),u)}catch{return e.set(t,!1),!1}},tk={channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6},nk=(r,e,t,n,i)=>class extends r{constructor(u,c){const d=n(u),p={...tk,...c},g=t(d,p),_=i(d)?e():null;super(u,!1,g,_)}},rk=(r,e,t)=>()=>{const n=new WeakMap,i=async(a,u)=>{let c=e(a);if(!Tn(c,u)){const p={channelCount:c.channelCount,channelCountMode:c.channelCountMode,channelInterpretation:c.channelInterpretation,numberOfInputs:c.numberOfInputs};c=r(u,p)}return n.set(u,c),await t(a,u,c),c};return{render(a,u){const c=n.get(u);return c!==void 0?Promise.resolve(c):i(a,u)}}},sk={channelCount:6,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:6},ik=(r,e,t,n,i,a)=>class extends r{constructor(c,d){const p=n(c),g=a({...sk,...d}),_=t(p,g),E=i(p)?e():null;super(c,!1,_,E)}},ok=(r,e,t)=>()=>{const n=new WeakMap,i=async(a,u)=>{let c=e(a);if(!Tn(c,u)){const p={channelCount:c.channelCount,channelCountMode:c.channelCountMode,channelInterpretation:c.channelInterpretation,numberOfOutputs:c.numberOfOutputs};c=r(u,p)}return n.set(u,c),await t(a,u,c),c};return{render(a,u){const c=n.get(u);return c!==void 0?Promise.resolve(c):i(a,u)}}},ak=r=>(e,t,n)=>r(t,e,n),lk=r=>(e,t)=>{const n=r(e,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),i=e.createBuffer(1,2,44100);return n.buffer=i,n.loop=!0,n.connect(t),n.start(),()=>{n.stop(),n.disconnect(t)}},uk={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",offset:1},ck=(r,e,t,n,i,a,u)=>class extends r{constructor(d,p){const g=i(d),_={...uk,...p},E=n(g,_),C=a(g),A=C?t():null;super(d,!1,E,A),this._constantSourceNodeRenderer=A,this._nativeConstantSourceNode=E,this._offset=e(this,C,E.offset,Dn,ar),this._onended=null}get offset(){return this._offset}get onended(){return this._onended}set onended(d){const p=typeof d=="function"?u(this,d):null;this._nativeConstantSourceNode.onended=p;const g=this._nativeConstantSourceNode.onended;this._onended=g!==null&&g===p?d:g}start(d=0){if(this._nativeConstantSourceNode.start(d),this._constantSourceNodeRenderer!==null&&(this._constantSourceNodeRenderer.start=d),this.context.state!=="closed"){Ma(this);const p=()=>{this._nativeConstantSourceNode.removeEventListener("ended",p),Is(this)&&yu(this)};this._nativeConstantSourceNode.addEventListener("ended",p)}}stop(d=0){this._nativeConstantSourceNode.stop(d),this._constantSourceNodeRenderer!==null&&(this._constantSourceNodeRenderer.stop=d)}},hk=(r,e,t,n,i)=>()=>{const a=new WeakMap;let u=null,c=null;const d=async(p,g)=>{let _=t(p);const E=Tn(_,g);if(!E){const C={channelCount:_.channelCount,channelCountMode:_.channelCountMode,channelInterpretation:_.channelInterpretation,offset:_.offset.value};_=e(g,C),u!==null&&_.start(u),c!==null&&_.stop(c)}return a.set(g,_),E?await r(g,p.offset,_.offset):await n(g,p.offset,_.offset),await i(p,g,_),_};return{set start(p){u=p},set stop(p){c=p},render(p,g){const _=a.get(g);return _!==void 0?Promise.resolve(_):d(p,g)}}},dk=r=>e=>(r[0]=e,r[0]),fk={buffer:null,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",disableNormalization:!1},pk=(r,e,t,n,i,a)=>class extends r{constructor(c,d){const p=n(c),g={...fk,...d},_=t(p,g),C=i(p)?e():null;super(c,!1,_,C),this._isBufferNullified=!1,this._nativeConvolverNode=_,g.buffer!==null&&a(this,g.buffer.duration)}get buffer(){return this._isBufferNullified?null:this._nativeConvolverNode.buffer}set buffer(c){if(this._nativeConvolverNode.buffer=c,c===null&&this._nativeConvolverNode.buffer!==null){const d=this._nativeConvolverNode.context;this._nativeConvolverNode.buffer=d.createBuffer(1,1,d.sampleRate),this._isBufferNullified=!0,a(this,0)}else this._isBufferNullified=!1,a(this,this._nativeConvolverNode.buffer===null?0:this._nativeConvolverNode.buffer.duration)}get normalize(){return this._nativeConvolverNode.normalize}set normalize(c){this._nativeConvolverNode.normalize=c}},mk=(r,e,t)=>()=>{const n=new WeakMap,i=async(a,u)=>{let c=e(a);if(!Tn(c,u)){const p={buffer:c.buffer,channelCount:c.channelCount,channelCountMode:c.channelCountMode,channelInterpretation:c.channelInterpretation,disableNormalization:!c.normalize};c=r(u,p)}return n.set(u,c),Ba(c)?await t(a,u,c.inputs[0]):await t(a,u,c),c};return{render(a,u){const c=n.get(u);return c!==void 0?Promise.resolve(c):i(a,u)}}},gk=(r,e)=>(t,n,i)=>{if(e===null)throw new Error("Missing the native OfflineAudioContext constructor.");try{return new e(t,n,i)}catch(a){throw a.name==="SyntaxError"?r():a}},yk=()=>new DOMException("","DataCloneError"),nw=r=>{const{port1:e,port2:t}=new MessageChannel;return new Promise(n=>{const i=()=>{t.onmessage=null,e.close(),t.close(),n()};t.onmessage=()=>i();try{e.postMessage(r,[r])}catch{}finally{i()}})},vk=(r,e,t,n,i,a,u,c,d,p,g)=>(_,E)=>{const C=u(_)?_:a(_);if(i.has(E)){const A=t();return Promise.reject(A)}try{i.add(E)}catch{}return e(d,()=>d(C))?C.decodeAudioData(E).then(A=>(nw(E).catch(()=>{}),e(c,()=>c(A))||g(A),r.add(A),A)):new Promise((A,P)=>{const D=async()=>{try{await nw(E)}catch{}},B=W=>{P(W),D()};try{C.decodeAudioData(E,W=>{typeof W.copyFromChannel!="function"&&(p(W),Am(W)),r.add(W),D().then(()=>A(W))},W=>{B(W===null?n():W)})}catch(W){B(W)}})},_k=(r,e,t,n,i,a,u,c)=>(d,p)=>{const g=e.get(d);if(g===void 0)throw new Error("Missing the expected cycle count.");const _=a(d.context),E=c(_);if(g===p){if(e.delete(d),!E&&u(d)){const C=n(d),{outputs:A}=t(d);for(const P of A)if(_u(P)){const D=n(P[0]);r(C,D,P[1],P[2])}else{const D=i(P[0]);C.connect(D,P[1])}}}else e.set(d,g-p)},wk={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",delayTime:0,maxDelayTime:1},Ek=(r,e,t,n,i,a,u)=>class extends r{constructor(d,p){const g=i(d),_={...wk,...p},E=n(g,_),C=a(g),A=C?t(_.maxDelayTime):null;super(d,!1,E,A),this._delayTime=e(this,C,E.delayTime),u(this,_.maxDelayTime)}get delayTime(){return this._delayTime}},Tk=(r,e,t,n,i)=>a=>{const u=new WeakMap,c=async(d,p)=>{let g=t(d);const _=Tn(g,p);if(!_){const E={channelCount:g.channelCount,channelCountMode:g.channelCountMode,channelInterpretation:g.channelInterpretation,delayTime:g.delayTime.value,maxDelayTime:a};g=e(p,E)}return u.set(p,g),_?await r(p,d.delayTime,g.delayTime):await n(p,d.delayTime,g.delayTime),await i(d,p,g),g};return{render(d,p){const g=u.get(p);return g!==void 0?Promise.resolve(g):c(d,p)}}},Ik=r=>(e,t,n,i)=>r(e[i],a=>a[0]===t&&a[1]===n),Sk=r=>"delayTime"in r,Ck=(r,e,t)=>function n(i,a){const u=Vh(a)?a:t(r,a);if(Sk(u))return[];if(i[0]===u)return[i];if(i.includes(u))return[];const{outputs:c}=e(u);return Array.from(c).map(d=>n([...i,u],d[0])).reduce((d,p)=>d.concat(p),[])},Ak={attack:.003,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",knee:30,ratio:12,release:.25,threshold:-24},xk=(r,e,t,n,i,a,u,c)=>class extends r{constructor(p,g){const _=a(p),E={...Ak,...g},C=n(_,E),A=u(_),P=A?t():null;super(p,!1,C,P),this._attack=e(this,A,C.attack),this._knee=e(this,A,C.knee),this._nativeDynamicsCompressorNode=C,this._ratio=e(this,A,C.ratio),this._release=e(this,A,C.release),this._threshold=e(this,A,C.threshold),c(this,.006)}get attack(){return this._attack}get channelCount(){return this._nativeDynamicsCompressorNode.channelCount}set channelCount(p){const g=this._nativeDynamicsCompressorNode.channelCount;if(this._nativeDynamicsCompressorNode.channelCount=p,p>2)throw this._nativeDynamicsCompressorNode.channelCount=g,i()}get channelCountMode(){return this._nativeDynamicsCompressorNode.channelCountMode}set channelCountMode(p){const g=this._nativeDynamicsCompressorNode.channelCountMode;if(this._nativeDynamicsCompressorNode.channelCountMode=p,p==="max")throw this._nativeDynamicsCompressorNode.channelCountMode=g,i()}get knee(){return this._knee}get ratio(){return this._ratio}get reduction(){return typeof this._nativeDynamicsCompressorNode.reduction.value=="number"?this._nativeDynamicsCompressorNode.reduction.value:this._nativeDynamicsCompressorNode.reduction}get release(){return this._release}get threshold(){return this._threshold}},Nk=(r,e,t,n,i)=>()=>{const a=new WeakMap,u=async(c,d)=>{let p=t(c);const g=Tn(p,d);if(!g){const _={attack:p.attack.value,channelCount:p.channelCount,channelCountMode:p.channelCountMode,channelInterpretation:p.channelInterpretation,knee:p.knee.value,ratio:p.ratio.value,release:p.release.value,threshold:p.threshold.value};p=e(d,_)}return a.set(d,p),g?(await r(d,c.attack,p.attack),await r(d,c.knee,p.knee),await r(d,c.ratio,p.ratio),await r(d,c.release,p.release),await r(d,c.threshold,p.threshold)):(await n(d,c.attack,p.attack),await n(d,c.knee,p.knee),await n(d,c.ratio,p.ratio),await n(d,c.release,p.release),await n(d,c.threshold,p.threshold)),await i(c,d,p),p};return{render(c,d){const p=a.get(d);return p!==void 0?Promise.resolve(p):u(c,d)}}},Rk=()=>new DOMException("","EncodingError"),Pk=r=>e=>new Promise((t,n)=>{if(r===null){n(new SyntaxError);return}const i=r.document.head;if(i===null)n(new SyntaxError);else{const a=r.document.createElement("script"),u=new Blob([e],{type:"application/javascript"}),c=URL.createObjectURL(u),d=r.onerror,p=()=>{r.onerror=d,URL.revokeObjectURL(c)};r.onerror=(g,_,E,C,A)=>{if(_===c||_===r.location.href&&E===1&&C===1)return p(),n(A),!1;if(d!==null)return d(g,_,E,C,A)},a.onerror=()=>{p(),n(new SyntaxError)},a.onload=()=>{p(),t()},a.src=c,a.type="module",i.appendChild(a)}}),kk=r=>class{constructor(t){this._nativeEventTarget=t,this._listeners=new WeakMap}addEventListener(t,n,i){if(n!==null){let a=this._listeners.get(n);a===void 0&&(a=r(this,n),typeof n=="function"&&this._listeners.set(n,a)),this._nativeEventTarget.addEventListener(t,a,i)}}dispatchEvent(t){return this._nativeEventTarget.dispatchEvent(t)}removeEventListener(t,n,i){const a=n===null?void 0:this._listeners.get(n);this._nativeEventTarget.removeEventListener(t,a===void 0?null:a,i)}},bk=r=>(e,t,n)=>{Object.defineProperties(r,{currentFrame:{configurable:!0,get(){return Math.round(e*t)}},currentTime:{configurable:!0,get(){return e}}});try{return n()}finally{r!==null&&(delete r.currentFrame,delete r.currentTime)}},Dk=r=>async e=>{try{const t=await fetch(e);if(t.ok)return[await t.text(),t.url]}catch{}throw r()},Vk={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",gain:1},Mk=(r,e,t,n,i,a)=>class extends r{constructor(c,d){const p=i(c),g={...Vk,...d},_=n(p,g),E=a(p),C=E?t():null;super(c,!1,_,C),this._gain=e(this,E,_.gain,Dn,ar)}get gain(){return this._gain}},Ok=(r,e,t,n,i)=>()=>{const a=new WeakMap,u=async(c,d)=>{let p=t(c);const g=Tn(p,d);if(!g){const _={channelCount:p.channelCount,channelCountMode:p.channelCountMode,channelInterpretation:p.channelInterpretation,gain:p.gain.value};p=e(d,_)}return a.set(d,p),g?await r(d,c.gain,p.gain):await n(d,c.gain,p.gain),await i(c,d,p),p};return{render(c,d){const p=a.get(d);return p!==void 0?Promise.resolve(p):u(c,d)}}},Fk=r=>e=>{const t=r(e);if(t.renderer===null)throw new Error("Missing the renderer of the given AudioNode in the audio graph.");return t.renderer},Lk=r=>e=>{var t;return(t=r.get(e))!==null&&t!==void 0?t:0},jk=r=>e=>{const t=r(e);if(t.renderer===null)throw new Error("Missing the renderer of the given AudioParam in the audio graph.");return t.renderer},Mn=()=>new DOMException("","InvalidStateError"),Bk=r=>e=>{const t=r.get(e);if(t===void 0)throw Mn();return t},zk=(r,e)=>t=>{let n=r.get(t);if(n!==void 0)return n;if(e===null)throw new Error("Missing the native OfflineAudioContext constructor.");return n=new e(1,1,44100),r.set(t,n),n},Uk=r=>e=>{const t=r.get(e);if(t===void 0)throw new Error("The context has no set of AudioWorkletNodes.");return t},rd=()=>new DOMException("","InvalidAccessError"),$k=r=>{r.getFrequencyResponse=(e=>(t,n,i)=>{if(t.length!==n.length||n.length!==i.length)throw rd();return e.call(r,t,n,i)})(r.getFrequencyResponse)},qk={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers"},Wk=(r,e,t,n,i,a)=>class extends r{constructor(c,d){const p=n(c),g=i(p),_={...qk,...d},E=e(p,g?null:c.baseLatency,_),C=g?t(_.feedback,_.feedforward):null;super(c,!1,E,C),$k(E),this._nativeIIRFilterNode=E,a(this,1)}getFrequencyResponse(c,d,p){return this._nativeIIRFilterNode.getFrequencyResponse(c,d,p)}},oT=(r,e,t,n,i,a,u,c,d,p,g)=>{const _=p.length;let E=c;for(let C=0;C<_;C+=1){let A=t[0]*p[C];for(let P=1;P<i;P+=1){const D=E-P&d-1;A+=t[P]*a[D],A-=r[P]*u[D]}for(let P=i;P<n;P+=1)A+=t[P]*a[E-P&d-1];for(let P=i;P<e;P+=1)A-=r[P]*u[E-P&d-1];a[E]=p[C],u[E]=A,E=E+1&d-1,g[C]=A}return E},Gk=(r,e,t,n)=>{const i=t instanceof Float64Array?t:new Float64Array(t),a=n instanceof Float64Array?n:new Float64Array(n),u=i.length,c=a.length,d=Math.min(u,c);if(i[0]!==1){for(let A=0;A<u;A+=1)a[A]/=i[0];for(let A=1;A<c;A+=1)i[A]/=i[0]}const p=32,g=new Float32Array(p),_=new Float32Array(p),E=e.createBuffer(r.numberOfChannels,r.length,r.sampleRate),C=r.numberOfChannels;for(let A=0;A<C;A+=1){const P=r.getChannelData(A),D=E.getChannelData(A);g.fill(0),_.fill(0),oT(i,u,a,c,d,g,_,0,p,P,D)}return E},Kk=(r,e,t,n,i)=>(a,u)=>{const c=new WeakMap;let d=null;const p=async(g,_)=>{let E=null,C=e(g);const A=Tn(C,_);if(_.createIIRFilter===void 0?E=r(_,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}):A||(C=_.createIIRFilter(u,a)),c.set(_,E===null?C:E),E!==null){if(d===null){if(t===null)throw new Error("Missing the native OfflineAudioContext constructor.");const D=new t(g.context.destination.channelCount,g.context.length,_.sampleRate);d=(async()=>{await n(g,D,D.destination);const B=await i(D);return Gk(B,_,a,u)})()}const P=await d;return E.buffer=P,E.start(0),E}return await n(g,_,C),C};return{render(g,_){const E=c.get(_);return E!==void 0?Promise.resolve(E):p(g,_)}}},Hk=(r,e,t,n,i,a)=>u=>(c,d)=>{const p=r.get(c);if(p===void 0){if(!u&&a(c)){const g=n(c),{outputs:_}=t(c);for(const E of _)if(_u(E)){const C=n(E[0]);e(g,C,E[1],E[2])}else{const C=i(E[0]);g.disconnect(C,E[1])}}r.set(c,d)}else r.set(c,p+d)},Qk=r=>e=>r!==null&&e instanceof r,Xk=r=>e=>r!==null&&typeof r.AudioNode=="function"&&e instanceof r.AudioNode,Yk=r=>e=>r!==null&&typeof r.AudioParam=="function"&&e instanceof r.AudioParam,Zk=(r,e)=>t=>r(t)||e(t),Jk=r=>e=>r!==null&&e instanceof r,e2=r=>r!==null&&r.isSecureContext,t2=(r,e,t,n,i,a)=>class extends t{constructor(c,d){super(c),this._nativeContext=c,YE.set(this,c),n(c)&&i.set(c,new Set),this._destination=new r(this,d),this._listener=e(this,c),this._onstatechange=null}get currentTime(){return this._nativeContext.currentTime}get destination(){return this._destination}get listener(){return this._listener}get onstatechange(){return this._onstatechange}set onstatechange(c){const d=typeof c=="function"?a(this,c):null;this._nativeContext.onstatechange=d;const p=this._nativeContext.onstatechange;this._onstatechange=p!==null&&p===d?c:p}get sampleRate(){return this._nativeContext.sampleRate}get state(){return this._nativeContext.state}},iu=r=>{const e=new Uint32Array([1179011410,40,1163280727,544501094,16,131073,44100,176400,1048580,1635017060,4,0]);try{const t=r.decodeAudioData(e.buffer,()=>{});return t===void 0?!1:(t.catch(()=>{}),!0)}catch{}return!1},n2=(r,e)=>(t,n,i)=>{const a=new Set;return t.connect=(u=>(c,d=0,p=0)=>{const g=a.size===0;if(e(c))return u.call(t,c,d,p),r(a,[c,d,p],_=>_[0]===c&&_[1]===d&&_[2]===p,!0),g&&n(),c;u.call(t,c,d),r(a,[c,d],_=>_[0]===c&&_[1]===d,!0),g&&n()})(t.connect),t.disconnect=(u=>(c,d,p)=>{const g=a.size>0;if(c===void 0)u.apply(t),a.clear();else if(typeof c=="number"){u.call(t,c);for(const E of a)E[1]===c&&a.delete(E)}else{e(c)?u.call(t,c,d,p):u.call(t,c,d);for(const E of a)E[0]===c&&(d===void 0||E[1]===d)&&(p===void 0||E[2]===p)&&a.delete(E)}const _=a.size===0;g&&_&&i()})(t.disconnect),t},Et=(r,e,t)=>{const n=e[t];n!==void 0&&n!==r[t]&&(r[t]=n)},Yt=(r,e)=>{Et(r,e,"channelCount"),Et(r,e,"channelCountMode"),Et(r,e,"channelInterpretation")},rw=r=>typeof r.getFloatTimeDomainData=="function",r2=r=>{r.getFloatTimeDomainData=e=>{const t=new Uint8Array(e.length);r.getByteTimeDomainData(t);const n=Math.max(t.length,r.fftSize);for(let i=0;i<n;i+=1)e[i]=(t[i]-128)*.0078125;return e}},s2=(r,e)=>(t,n)=>{const i=t.createAnalyser();if(Yt(i,n),!(n.maxDecibels>n.minDecibels))throw e();return Et(i,n,"fftSize"),Et(i,n,"maxDecibels"),Et(i,n,"minDecibels"),Et(i,n,"smoothingTimeConstant"),r(rw,()=>rw(i))||r2(i),i},i2=r=>r===null?null:r.hasOwnProperty("AudioBuffer")?r.AudioBuffer:null,xt=(r,e,t)=>{const n=e[t];n!==void 0&&n!==r[t].value&&(r[t].value=n)},o2=r=>{r.start=(e=>{let t=!1;return(n=0,i=0,a)=>{if(t)throw Mn();e.call(r,n,i,a),t=!0}})(r.start)},Rm=r=>{r.start=(e=>(t=0,n=0,i)=>{if(typeof i=="number"&&i<0||n<0||t<0)throw new RangeError("The parameters can't be negative.");e.call(r,t,n,i)})(r.start)},Pm=r=>{r.stop=(e=>(t=0)=>{if(t<0)throw new RangeError("The parameter can't be negative.");e.call(r,t)})(r.stop)},a2=(r,e,t,n,i,a,u,c,d,p,g)=>(_,E)=>{const C=_.createBufferSource();return Yt(C,E),xt(C,E,"playbackRate"),Et(C,E,"buffer"),Et(C,E,"loop"),Et(C,E,"loopEnd"),Et(C,E,"loopStart"),e(t,()=>t(_))||o2(C),e(n,()=>n(_))||d(C),e(i,()=>i(_))||p(C,_),e(a,()=>a(_))||Rm(C),e(u,()=>u(_))||g(C,_),e(c,()=>c(_))||Pm(C),r(_,C),C},l2=r=>r===null?null:r.hasOwnProperty("AudioContext")?r.AudioContext:r.hasOwnProperty("webkitAudioContext")?r.webkitAudioContext:null,u2=(r,e)=>(t,n,i)=>{const a=t.destination;if(a.channelCount!==n)try{a.channelCount=n}catch{}i&&a.channelCountMode!=="explicit"&&(a.channelCountMode="explicit"),a.maxChannelCount===0&&Object.defineProperty(a,"maxChannelCount",{value:n});const u=r(t,{channelCount:n,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,gain:1});return e(u,"channelCount",c=>()=>c.call(u),c=>d=>{c.call(u,d);try{a.channelCount=d}catch(p){if(d>a.maxChannelCount)throw p}}),e(u,"channelCountMode",c=>()=>c.call(u),c=>d=>{c.call(u,d),a.channelCountMode=d}),e(u,"channelInterpretation",c=>()=>c.call(u),c=>d=>{c.call(u,d),a.channelInterpretation=d}),Object.defineProperty(u,"maxChannelCount",{get:()=>a.maxChannelCount}),u.connect(a),u},c2=r=>r===null?null:r.hasOwnProperty("AudioWorkletNode")?r.AudioWorkletNode:null,h2=(r,e)=>r===null?512:Math.max(512,Math.min(16384,Math.pow(2,Math.round(Math.log2(r*e))))),aT=(r,e)=>{const t=r.createBiquadFilter();return Yt(t,e),xt(t,e,"Q"),xt(t,e,"detune"),xt(t,e,"frequency"),xt(t,e,"gain"),Et(t,e,"type"),t},d2=(r,e)=>(t,n)=>{const i=t.createChannelMerger(n.numberOfInputs);return r!==null&&r.name==="webkitAudioContext"&&e(t,i),Yt(i,n),i},f2=r=>{const e=r.numberOfOutputs;Object.defineProperty(r,"channelCount",{get:()=>e,set:t=>{if(t!==e)throw Mn()}}),Object.defineProperty(r,"channelCountMode",{get:()=>"explicit",set:t=>{if(t!=="explicit")throw Mn()}}),Object.defineProperty(r,"channelInterpretation",{get:()=>"discrete",set:t=>{if(t!=="discrete")throw Mn()}})},km=(r,e)=>{const t=r.createChannelSplitter(e.numberOfOutputs);return Yt(t,e),f2(t),t},p2=(r,e,t,n,i)=>(a,u)=>{if(a.createConstantSource===void 0)return t(a,u);const c=a.createConstantSource();return Yt(c,u),xt(c,u,"offset"),e(n,()=>n(a))||Rm(c),e(i,()=>i(a))||Pm(c),r(a,c),c},za=(r,e)=>(r.connect=e.connect.bind(e),r.disconnect=e.disconnect.bind(e),r),m2=(r,e,t,n)=>(i,{offset:a,...u})=>{const c=i.createBuffer(1,2,44100),d=e(i,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),p=t(i,{...u,gain:a}),g=c.getChannelData(0);g[0]=1,g[1]=1,d.buffer=c,d.loop=!0;const _={get bufferSize(){},get channelCount(){return p.channelCount},set channelCount(A){p.channelCount=A},get channelCountMode(){return p.channelCountMode},set channelCountMode(A){p.channelCountMode=A},get channelInterpretation(){return p.channelInterpretation},set channelInterpretation(A){p.channelInterpretation=A},get context(){return p.context},get inputs(){return[]},get numberOfInputs(){return d.numberOfInputs},get numberOfOutputs(){return p.numberOfOutputs},get offset(){return p.gain},get onended(){return d.onended},set onended(A){d.onended=A},addEventListener(...A){return d.addEventListener(A[0],A[1],A[2])},dispatchEvent(...A){return d.dispatchEvent(A[0])},removeEventListener(...A){return d.removeEventListener(A[0],A[1],A[2])},start(A=0){d.start.call(d,A)},stop(A=0){d.stop.call(d,A)}},E=()=>d.connect(p),C=()=>d.disconnect(p);return r(i,d),n(za(_,p),E,C)},g2=(r,e)=>(t,n)=>{const i=t.createConvolver();if(Yt(i,n),n.disableNormalization===i.normalize&&(i.normalize=!n.disableNormalization),Et(i,n,"buffer"),n.channelCount>2||(e(i,"channelCount",a=>()=>a.call(i),a=>u=>{if(u>2)throw r();return a.call(i,u)}),n.channelCountMode==="max"))throw r();return e(i,"channelCountMode",a=>()=>a.call(i),a=>u=>{if(u==="max")throw r();return a.call(i,u)}),i},lT=(r,e)=>{const t=r.createDelay(e.maxDelayTime);return Yt(t,e),xt(t,e,"delayTime"),t},y2=r=>(e,t)=>{const n=e.createDynamicsCompressor();if(Yt(n,t),t.channelCount>2||t.channelCountMode==="max")throw r();return xt(n,t,"attack"),xt(n,t,"knee"),xt(n,t,"ratio"),xt(n,t,"release"),xt(n,t,"threshold"),n},Dr=(r,e)=>{const t=r.createGain();return Yt(t,e),xt(t,e,"gain"),t},v2=r=>(e,t,n)=>{if(e.createIIRFilter===void 0)return r(e,t,n);const i=e.createIIRFilter(n.feedforward,n.feedback);return Yt(i,n),i};function _2(r,e){const t=e[0]*e[0]+e[1]*e[1];return[(r[0]*e[0]+r[1]*e[1])/t,(r[1]*e[0]-r[0]*e[1])/t]}function w2(r,e){return[r[0]*e[0]-r[1]*e[1],r[0]*e[1]+r[1]*e[0]]}function sw(r,e){let t=[0,0];for(let n=r.length-1;n>=0;n-=1)t=w2(t,e),t[0]+=r[n];return t}const E2=(r,e,t,n)=>(i,a,{channelCount:u,channelCountMode:c,channelInterpretation:d,feedback:p,feedforward:g})=>{const _=h2(a,i.sampleRate),E=p instanceof Float64Array?p:new Float64Array(p),C=g instanceof Float64Array?g:new Float64Array(g),A=E.length,P=C.length,D=Math.min(A,P);if(A===0||A>20)throw n();if(E[0]===0)throw e();if(P===0||P>20)throw n();if(C[0]===0)throw e();if(E[0]!==1){for(let I=0;I<P;I+=1)C[I]/=E[0];for(let I=1;I<A;I+=1)E[I]/=E[0]}const B=t(i,_,u,u);B.channelCount=u,B.channelCountMode=c,B.channelInterpretation=d;const W=32,$=[],X=[],F=[];for(let I=0;I<u;I+=1){$.push(0);const R=new Float32Array(W),b=new Float32Array(W);R.fill(0),b.fill(0),X.push(R),F.push(b)}B.onaudioprocess=I=>{const R=I.inputBuffer,b=I.outputBuffer,V=R.numberOfChannels;for(let M=0;M<V;M+=1){const k=R.getChannelData(M),me=b.getChannelData(M);$[M]=oT(E,A,C,P,D,X[M],F[M],$[M],W,k,me)}};const U=i.sampleRate/2;return za({get bufferSize(){return _},get channelCount(){return B.channelCount},set channelCount(I){B.channelCount=I},get channelCountMode(){return B.channelCountMode},set channelCountMode(I){B.channelCountMode=I},get channelInterpretation(){return B.channelInterpretation},set channelInterpretation(I){B.channelInterpretation=I},get context(){return B.context},get inputs(){return[B]},get numberOfInputs(){return B.numberOfInputs},get numberOfOutputs(){return B.numberOfOutputs},addEventListener(...I){return B.addEventListener(I[0],I[1],I[2])},dispatchEvent(...I){return B.dispatchEvent(I[0])},getFrequencyResponse(I,R,b){if(I.length!==R.length||R.length!==b.length)throw r();const V=I.length;for(let M=0;M<V;M+=1){const k=-Math.PI*(I[M]/U),me=[Math.cos(k),Math.sin(k)],ce=sw(C,me),fe=sw(E,me),oe=_2(ce,fe);R[M]=Math.sqrt(oe[0]*oe[0]+oe[1]*oe[1]),b[M]=Math.atan2(oe[1],oe[0])}},removeEventListener(...I){return B.removeEventListener(I[0],I[1],I[2])}},B)},T2=r=>r===null?null:r.hasOwnProperty("OfflineAudioContext")?r.OfflineAudioContext:r.hasOwnProperty("webkitOfflineAudioContext")?r.webkitOfflineAudioContext:null,I2=(r,e,t,n,i,a)=>(u,c)=>{const d=u.createOscillator();return Yt(d,c),xt(d,c,"detune"),xt(d,c,"frequency"),c.periodicWave!==void 0?d.setPeriodicWave(c.periodicWave):Et(d,c,"type"),e(t,()=>t(u))||Rm(d),e(n,()=>n(u))||a(d,u),e(i,()=>i(u))||Pm(d),r(u,d),d},S2=r=>(e,t)=>{const n=e.createPanner();return n.orientationX===void 0?r(e,t):(Yt(n,t),xt(n,t,"orientationX"),xt(n,t,"orientationY"),xt(n,t,"orientationZ"),xt(n,t,"positionX"),xt(n,t,"positionY"),xt(n,t,"positionZ"),Et(n,t,"coneInnerAngle"),Et(n,t,"coneOuterAngle"),Et(n,t,"coneOuterGain"),Et(n,t,"distanceModel"),Et(n,t,"maxDistance"),Et(n,t,"panningModel"),Et(n,t,"refDistance"),Et(n,t,"rolloffFactor"),n)},C2=(r,e,t,n,i,a,u,c,d,p)=>(g,{coneInnerAngle:_,coneOuterAngle:E,coneOuterGain:C,distanceModel:A,maxDistance:P,orientationX:D,orientationY:B,orientationZ:W,panningModel:$,positionX:X,positionY:F,positionZ:U,refDistance:N,rolloffFactor:I,...R})=>{const b=g.createPanner();if(R.channelCount>2||R.channelCountMode==="max")throw u();Yt(b,R);const V={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},M=t(g,{...V,channelInterpretation:"speakers",numberOfInputs:6}),k=n(g,{...R,gain:1}),me=n(g,{...V,gain:1}),ce=n(g,{...V,gain:0}),fe=n(g,{...V,gain:0}),oe=n(g,{...V,gain:0}),ne=n(g,{...V,gain:0}),se=n(g,{...V,gain:0}),re=i(g,256,6,1),L=a(g,{...V,curve:new Float32Array([1,1]),oversample:"none"});let Z=[D,B,W],Ee=[X,F,U];const be=new Float32Array(1);re.onaudioprocess=({inputBuffer:te})=>{const ve=[d(te,be,0),d(te,be,1),d(te,be,2)];ve.some((Be,it)=>Be!==Z[it])&&(b.setOrientation(...ve),Z=ve);const Oe=[d(te,be,3),d(te,be,4),d(te,be,5)];Oe.some((Be,it)=>Be!==Ee[it])&&(b.setPosition(...Oe),Ee=Oe)},Object.defineProperty(ce.gain,"defaultValue",{get:()=>0}),Object.defineProperty(fe.gain,"defaultValue",{get:()=>0}),Object.defineProperty(oe.gain,"defaultValue",{get:()=>0}),Object.defineProperty(ne.gain,"defaultValue",{get:()=>0}),Object.defineProperty(se.gain,"defaultValue",{get:()=>0});const Q={get bufferSize(){},get channelCount(){return b.channelCount},set channelCount(te){if(te>2)throw u();k.channelCount=te,b.channelCount=te},get channelCountMode(){return b.channelCountMode},set channelCountMode(te){if(te==="max")throw u();k.channelCountMode=te,b.channelCountMode=te},get channelInterpretation(){return b.channelInterpretation},set channelInterpretation(te){k.channelInterpretation=te,b.channelInterpretation=te},get coneInnerAngle(){return b.coneInnerAngle},set coneInnerAngle(te){b.coneInnerAngle=te},get coneOuterAngle(){return b.coneOuterAngle},set coneOuterAngle(te){b.coneOuterAngle=te},get coneOuterGain(){return b.coneOuterGain},set coneOuterGain(te){if(te<0||te>1)throw e();b.coneOuterGain=te},get context(){return b.context},get distanceModel(){return b.distanceModel},set distanceModel(te){b.distanceModel=te},get inputs(){return[k]},get maxDistance(){return b.maxDistance},set maxDistance(te){if(te<0)throw new RangeError;b.maxDistance=te},get numberOfInputs(){return b.numberOfInputs},get numberOfOutputs(){return b.numberOfOutputs},get orientationX(){return me.gain},get orientationY(){return ce.gain},get orientationZ(){return fe.gain},get panningModel(){return b.panningModel},set panningModel(te){b.panningModel=te},get positionX(){return oe.gain},get positionY(){return ne.gain},get positionZ(){return se.gain},get refDistance(){return b.refDistance},set refDistance(te){if(te<0)throw new RangeError;b.refDistance=te},get rolloffFactor(){return b.rolloffFactor},set rolloffFactor(te){if(te<0)throw new RangeError;b.rolloffFactor=te},addEventListener(...te){return k.addEventListener(te[0],te[1],te[2])},dispatchEvent(...te){return k.dispatchEvent(te[0])},removeEventListener(...te){return k.removeEventListener(te[0],te[1],te[2])}};_!==Q.coneInnerAngle&&(Q.coneInnerAngle=_),E!==Q.coneOuterAngle&&(Q.coneOuterAngle=E),C!==Q.coneOuterGain&&(Q.coneOuterGain=C),A!==Q.distanceModel&&(Q.distanceModel=A),P!==Q.maxDistance&&(Q.maxDistance=P),D!==Q.orientationX.value&&(Q.orientationX.value=D),B!==Q.orientationY.value&&(Q.orientationY.value=B),W!==Q.orientationZ.value&&(Q.orientationZ.value=W),$!==Q.panningModel&&(Q.panningModel=$),X!==Q.positionX.value&&(Q.positionX.value=X),F!==Q.positionY.value&&(Q.positionY.value=F),U!==Q.positionZ.value&&(Q.positionZ.value=U),N!==Q.refDistance&&(Q.refDistance=N),I!==Q.rolloffFactor&&(Q.rolloffFactor=I),(Z[0]!==1||Z[1]!==0||Z[2]!==0)&&b.setOrientation(...Z),(Ee[0]!==0||Ee[1]!==0||Ee[2]!==0)&&b.setPosition(...Ee);const ee=()=>{k.connect(b),r(k,L,0,0),L.connect(me).connect(M,0,0),L.connect(ce).connect(M,0,1),L.connect(fe).connect(M,0,2),L.connect(oe).connect(M,0,3),L.connect(ne).connect(M,0,4),L.connect(se).connect(M,0,5),M.connect(re).connect(g.destination)},ye=()=>{k.disconnect(b),c(k,L,0,0),L.disconnect(me),me.disconnect(M),L.disconnect(ce),ce.disconnect(M),L.disconnect(fe),fe.disconnect(M),L.disconnect(oe),oe.disconnect(M),L.disconnect(ne),ne.disconnect(M),L.disconnect(se),se.disconnect(M),M.disconnect(re),re.disconnect(g.destination)};return p(za(Q,b),ee,ye)},A2=r=>(e,{disableNormalization:t,imag:n,real:i})=>{const a=n instanceof Float32Array?n:new Float32Array(n),u=i instanceof Float32Array?i:new Float32Array(i),c=e.createPeriodicWave(u,a,{disableNormalization:t});if(Array.from(n).length<2)throw r();return c},sd=(r,e,t,n)=>r.createScriptProcessor(e,t,n),x2=(r,e)=>(t,n)=>{const i=n.channelCountMode;if(i==="clamped-max")throw e();if(t.createStereoPanner===void 0)return r(t,n);const a=t.createStereoPanner();return Yt(a,n),xt(a,n,"pan"),Object.defineProperty(a,"channelCountMode",{get:()=>i,set:u=>{if(u!==i)throw e()}}),a},N2=(r,e,t,n,i,a)=>{const c=new Float32Array([1,1]),d=Math.PI/2,p={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},g={...p,oversample:"none"},_=(A,P,D,B)=>{const W=new Float32Array(16385),$=new Float32Array(16385);for(let R=0;R<16385;R+=1){const b=R/16384*d;W[R]=Math.cos(b),$[R]=Math.sin(b)}const X=t(A,{...p,gain:0}),F=n(A,{...g,curve:W}),U=n(A,{...g,curve:c}),N=t(A,{...p,gain:0}),I=n(A,{...g,curve:$});return{connectGraph(){P.connect(X),P.connect(U.inputs===void 0?U:U.inputs[0]),P.connect(N),U.connect(D),D.connect(F.inputs===void 0?F:F.inputs[0]),D.connect(I.inputs===void 0?I:I.inputs[0]),F.connect(X.gain),I.connect(N.gain),X.connect(B,0,0),N.connect(B,0,1)},disconnectGraph(){P.disconnect(X),P.disconnect(U.inputs===void 0?U:U.inputs[0]),P.disconnect(N),U.disconnect(D),D.disconnect(F.inputs===void 0?F:F.inputs[0]),D.disconnect(I.inputs===void 0?I:I.inputs[0]),F.disconnect(X.gain),I.disconnect(N.gain),X.disconnect(B,0,0),N.disconnect(B,0,1)}}},E=(A,P,D,B)=>{const W=new Float32Array(16385),$=new Float32Array(16385),X=new Float32Array(16385),F=new Float32Array(16385),U=Math.floor(16385/2);for(let oe=0;oe<16385;oe+=1)if(oe>U){const ne=(oe-U)/(16384-U)*d;W[oe]=Math.cos(ne),$[oe]=Math.sin(ne),X[oe]=0,F[oe]=1}else{const ne=oe/(16384-U)*d;W[oe]=1,$[oe]=0,X[oe]=Math.cos(ne),F[oe]=Math.sin(ne)}const N=e(A,{channelCount:2,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:2}),I=t(A,{...p,gain:0}),R=n(A,{...g,curve:W}),b=t(A,{...p,gain:0}),V=n(A,{...g,curve:$}),M=n(A,{...g,curve:c}),k=t(A,{...p,gain:0}),me=n(A,{...g,curve:X}),ce=t(A,{...p,gain:0}),fe=n(A,{...g,curve:F});return{connectGraph(){P.connect(N),P.connect(M.inputs===void 0?M:M.inputs[0]),N.connect(I,0),N.connect(b,0),N.connect(k,1),N.connect(ce,1),M.connect(D),D.connect(R.inputs===void 0?R:R.inputs[0]),D.connect(V.inputs===void 0?V:V.inputs[0]),D.connect(me.inputs===void 0?me:me.inputs[0]),D.connect(fe.inputs===void 0?fe:fe.inputs[0]),R.connect(I.gain),V.connect(b.gain),me.connect(k.gain),fe.connect(ce.gain),I.connect(B,0,0),k.connect(B,0,0),b.connect(B,0,1),ce.connect(B,0,1)},disconnectGraph(){P.disconnect(N),P.disconnect(M.inputs===void 0?M:M.inputs[0]),N.disconnect(I,0),N.disconnect(b,0),N.disconnect(k,1),N.disconnect(ce,1),M.disconnect(D),D.disconnect(R.inputs===void 0?R:R.inputs[0]),D.disconnect(V.inputs===void 0?V:V.inputs[0]),D.disconnect(me.inputs===void 0?me:me.inputs[0]),D.disconnect(fe.inputs===void 0?fe:fe.inputs[0]),R.disconnect(I.gain),V.disconnect(b.gain),me.disconnect(k.gain),fe.disconnect(ce.gain),I.disconnect(B,0,0),k.disconnect(B,0,0),b.disconnect(B,0,1),ce.disconnect(B,0,1)}}},C=(A,P,D,B,W)=>{if(P===1)return _(A,D,B,W);if(P===2)return E(A,D,B,W);throw i()};return(A,{channelCount:P,channelCountMode:D,pan:B,...W})=>{if(D==="max")throw i();const $=r(A,{...W,channelCount:1,channelCountMode:D,numberOfInputs:2}),X=t(A,{...W,channelCount:P,channelCountMode:D,gain:1}),F=t(A,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:B});let{connectGraph:U,disconnectGraph:N}=C(A,P,X,F,$);Object.defineProperty(F.gain,"defaultValue",{get:()=>0}),Object.defineProperty(F.gain,"maxValue",{get:()=>1}),Object.defineProperty(F.gain,"minValue",{get:()=>-1});const I={get bufferSize(){},get channelCount(){return X.channelCount},set channelCount(M){X.channelCount!==M&&(R&&N(),{connectGraph:U,disconnectGraph:N}=C(A,M,X,F,$),R&&U()),X.channelCount=M},get channelCountMode(){return X.channelCountMode},set channelCountMode(M){if(M==="clamped-max"||M==="max")throw i();X.channelCountMode=M},get channelInterpretation(){return X.channelInterpretation},set channelInterpretation(M){X.channelInterpretation=M},get context(){return X.context},get inputs(){return[X]},get numberOfInputs(){return X.numberOfInputs},get numberOfOutputs(){return X.numberOfOutputs},get pan(){return F.gain},addEventListener(...M){return X.addEventListener(M[0],M[1],M[2])},dispatchEvent(...M){return X.dispatchEvent(M[0])},removeEventListener(...M){return X.removeEventListener(M[0],M[1],M[2])}};let R=!1;const b=()=>{U(),R=!0},V=()=>{N(),R=!1};return a(za(I,$),b,V)}},R2=(r,e,t,n,i,a,u)=>(c,d)=>{const p=c.createWaveShaper();if(a!==null&&a.name==="webkitAudioContext"&&c.createGain().gain.automationRate===void 0)return t(c,d);Yt(p,d);const g=d.curve===null||d.curve instanceof Float32Array?d.curve:new Float32Array(d.curve);if(g!==null&&g.length<2)throw e();Et(p,{curve:g},"curve"),Et(p,d,"oversample");let _=null,E=!1;return u(p,"curve",P=>()=>P.call(p),P=>D=>(P.call(p,D),E&&(n(D)&&_===null?_=r(c,p):!n(D)&&_!==null&&(_(),_=null)),D)),i(p,()=>{E=!0,n(p.curve)&&(_=r(c,p))},()=>{E=!1,_!==null&&(_(),_=null)})},P2=(r,e,t,n,i)=>(a,{curve:u,oversample:c,...d})=>{const p=a.createWaveShaper(),g=a.createWaveShaper();Yt(p,d),Yt(g,d);const _=t(a,{...d,gain:1}),E=t(a,{...d,gain:-1}),C=t(a,{...d,gain:1}),A=t(a,{...d,gain:-1});let P=null,D=!1,B=null;const W={get bufferSize(){},get channelCount(){return p.channelCount},set channelCount(F){_.channelCount=F,E.channelCount=F,p.channelCount=F,C.channelCount=F,g.channelCount=F,A.channelCount=F},get channelCountMode(){return p.channelCountMode},set channelCountMode(F){_.channelCountMode=F,E.channelCountMode=F,p.channelCountMode=F,C.channelCountMode=F,g.channelCountMode=F,A.channelCountMode=F},get channelInterpretation(){return p.channelInterpretation},set channelInterpretation(F){_.channelInterpretation=F,E.channelInterpretation=F,p.channelInterpretation=F,C.channelInterpretation=F,g.channelInterpretation=F,A.channelInterpretation=F},get context(){return p.context},get curve(){return B},set curve(F){if(F!==null&&F.length<2)throw e();if(F===null)p.curve=F,g.curve=F;else{const U=F.length,N=new Float32Array(U+2-U%2),I=new Float32Array(U+2-U%2);N[0]=F[0],I[0]=-F[U-1];const R=Math.ceil((U+1)/2),b=(U+1)/2-1;for(let V=1;V<R;V+=1){const M=V/R*b,k=Math.floor(M),me=Math.ceil(M);N[V]=k===me?F[k]:(1-(M-k))*F[k]+(1-(me-M))*F[me],I[V]=k===me?-F[U-1-k]:-((1-(M-k))*F[U-1-k])-(1-(me-M))*F[U-1-me]}N[R]=U%2===1?F[R-1]:(F[R-2]+F[R-1])/2,p.curve=N,g.curve=I}B=F,D&&(n(B)&&P===null?P=r(a,_):P!==null&&(P(),P=null))},get inputs(){return[_]},get numberOfInputs(){return p.numberOfInputs},get numberOfOutputs(){return p.numberOfOutputs},get oversample(){return p.oversample},set oversample(F){p.oversample=F,g.oversample=F},addEventListener(...F){return _.addEventListener(F[0],F[1],F[2])},dispatchEvent(...F){return _.dispatchEvent(F[0])},removeEventListener(...F){return _.removeEventListener(F[0],F[1],F[2])}};u!==null&&(W.curve=u instanceof Float32Array?u:new Float32Array(u)),c!==W.oversample&&(W.oversample=c);const $=()=>{_.connect(p).connect(C),_.connect(E).connect(g).connect(A).connect(C),D=!0,n(B)&&(P=r(a,_))},X=()=>{_.disconnect(p),p.disconnect(C),_.disconnect(E),E.disconnect(g),g.disconnect(A),A.disconnect(C),D=!1,P!==null&&(P(),P=null)};return i(za(W,C),$,X)},cr=()=>new DOMException("","NotSupportedError"),k2={numberOfChannels:1},b2=(r,e,t,n,i)=>class extends r{constructor(u,c,d){let p;if(typeof u=="number"&&c!==void 0&&d!==void 0)p={length:c,numberOfChannels:u,sampleRate:d};else if(typeof u=="object")p=u;else throw new Error("The given parameters are not valid.");const{length:g,numberOfChannels:_,sampleRate:E}={...k2,...p},C=n(_,g,E);e(iu,()=>iu(C))||C.addEventListener("statechange",(()=>{let A=0;const P=D=>{this._state==="running"&&(A>0?(C.removeEventListener("statechange",P),D.stopImmediatePropagation(),this._waitForThePromiseToSettle(D)):A+=1)};return P})()),super(C,_),this._length=g,this._nativeOfflineAudioContext=C,this._state=null}get length(){return this._nativeOfflineAudioContext.length===void 0?this._length:this._nativeOfflineAudioContext.length}get state(){return this._state===null?this._nativeOfflineAudioContext.state:this._state}startRendering(){return this._state==="running"?Promise.reject(t()):(this._state="running",i(this.destination,this._nativeOfflineAudioContext).finally(()=>{this._state=null,MP(this)}))}_waitForThePromiseToSettle(u){this._state===null?this._nativeOfflineAudioContext.dispatchEvent(u):setTimeout(()=>this._waitForThePromiseToSettle(u))}},D2={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:440,periodicWave:void 0,type:"sine"},V2=(r,e,t,n,i,a,u)=>class extends r{constructor(d,p){const g=i(d),_={...D2,...p},E=t(g,_),C=a(g),A=C?n():null,P=d.sampleRate/2;super(d,!1,E,A),this._detune=e(this,C,E.detune,153600,-153600),this._frequency=e(this,C,E.frequency,P,-P),this._nativeOscillatorNode=E,this._onended=null,this._oscillatorNodeRenderer=A,this._oscillatorNodeRenderer!==null&&_.periodicWave!==void 0&&(this._oscillatorNodeRenderer.periodicWave=_.periodicWave)}get detune(){return this._detune}get frequency(){return this._frequency}get onended(){return this._onended}set onended(d){const p=typeof d=="function"?u(this,d):null;this._nativeOscillatorNode.onended=p;const g=this._nativeOscillatorNode.onended;this._onended=g!==null&&g===p?d:g}get type(){return this._nativeOscillatorNode.type}set type(d){this._nativeOscillatorNode.type=d,this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.periodicWave=null)}setPeriodicWave(d){this._nativeOscillatorNode.setPeriodicWave(d),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.periodicWave=d)}start(d=0){if(this._nativeOscillatorNode.start(d),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.start=d),this.context.state!=="closed"){Ma(this);const p=()=>{this._nativeOscillatorNode.removeEventListener("ended",p),Is(this)&&yu(this)};this._nativeOscillatorNode.addEventListener("ended",p)}}stop(d=0){this._nativeOscillatorNode.stop(d),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.stop=d)}},M2=(r,e,t,n,i)=>()=>{const a=new WeakMap;let u=null,c=null,d=null;const p=async(g,_)=>{let E=t(g);const C=Tn(E,_);if(!C){const A={channelCount:E.channelCount,channelCountMode:E.channelCountMode,channelInterpretation:E.channelInterpretation,detune:E.detune.value,frequency:E.frequency.value,periodicWave:u===null?void 0:u,type:E.type};E=e(_,A),c!==null&&E.start(c),d!==null&&E.stop(d)}return a.set(_,E),C?(await r(_,g.detune,E.detune),await r(_,g.frequency,E.frequency)):(await n(_,g.detune,E.detune),await n(_,g.frequency,E.frequency)),await i(g,_,E),E};return{set periodicWave(g){u=g},set start(g){c=g},set stop(g){d=g},render(g,_){const E=a.get(_);return E!==void 0?Promise.resolve(E):p(g,_)}}},O2={channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,orientationX:1,orientationY:0,orientationZ:0,panningModel:"equalpower",positionX:0,positionY:0,positionZ:0,refDistance:1,rolloffFactor:1},F2=(r,e,t,n,i,a,u)=>class extends r{constructor(d,p){const g=i(d),_={...O2,...p},E=t(g,_),C=a(g),A=C?n():null;super(d,!1,E,A),this._nativePannerNode=E,this._orientationX=e(this,C,E.orientationX,Dn,ar),this._orientationY=e(this,C,E.orientationY,Dn,ar),this._orientationZ=e(this,C,E.orientationZ,Dn,ar),this._positionX=e(this,C,E.positionX,Dn,ar),this._positionY=e(this,C,E.positionY,Dn,ar),this._positionZ=e(this,C,E.positionZ,Dn,ar),u(this,1)}get coneInnerAngle(){return this._nativePannerNode.coneInnerAngle}set coneInnerAngle(d){this._nativePannerNode.coneInnerAngle=d}get coneOuterAngle(){return this._nativePannerNode.coneOuterAngle}set coneOuterAngle(d){this._nativePannerNode.coneOuterAngle=d}get coneOuterGain(){return this._nativePannerNode.coneOuterGain}set coneOuterGain(d){this._nativePannerNode.coneOuterGain=d}get distanceModel(){return this._nativePannerNode.distanceModel}set distanceModel(d){this._nativePannerNode.distanceModel=d}get maxDistance(){return this._nativePannerNode.maxDistance}set maxDistance(d){this._nativePannerNode.maxDistance=d}get orientationX(){return this._orientationX}get orientationY(){return this._orientationY}get orientationZ(){return this._orientationZ}get panningModel(){return this._nativePannerNode.panningModel}set panningModel(d){this._nativePannerNode.panningModel=d}get positionX(){return this._positionX}get positionY(){return this._positionY}get positionZ(){return this._positionZ}get refDistance(){return this._nativePannerNode.refDistance}set refDistance(d){this._nativePannerNode.refDistance=d}get rolloffFactor(){return this._nativePannerNode.rolloffFactor}set rolloffFactor(d){this._nativePannerNode.rolloffFactor=d}},L2=(r,e,t,n,i,a,u,c,d,p)=>()=>{const g=new WeakMap;let _=null;const E=async(C,A)=>{let P=null,D=a(C);const B={channelCount:D.channelCount,channelCountMode:D.channelCountMode,channelInterpretation:D.channelInterpretation},W={...B,coneInnerAngle:D.coneInnerAngle,coneOuterAngle:D.coneOuterAngle,coneOuterGain:D.coneOuterGain,distanceModel:D.distanceModel,maxDistance:D.maxDistance,panningModel:D.panningModel,refDistance:D.refDistance,rolloffFactor:D.rolloffFactor},$=Tn(D,A);if("bufferSize"in D)P=n(A,{...B,gain:1});else if(!$){const X={...W,orientationX:D.orientationX.value,orientationY:D.orientationY.value,orientationZ:D.orientationZ.value,positionX:D.positionX.value,positionY:D.positionY.value,positionZ:D.positionZ.value};D=i(A,X)}if(g.set(A,P===null?D:P),P!==null){if(_===null){if(u===null)throw new Error("Missing the native OfflineAudioContext constructor.");const V=new u(6,C.context.length,A.sampleRate),M=e(V,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6});M.connect(V.destination),_=(async()=>{const k=await Promise.all([C.orientationX,C.orientationY,C.orientationZ,C.positionX,C.positionY,C.positionZ].map(async(me,ce)=>{const fe=t(V,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:ce===0?1:0});return await c(V,me,fe.offset),fe}));for(let me=0;me<6;me+=1)k[me].connect(M,0,me),k[me].start(0);return p(V)})()}const X=await _,F=n(A,{...B,gain:1});await d(C,A,F);const U=[];for(let V=0;V<X.numberOfChannels;V+=1)U.push(X.getChannelData(V));let N=[U[0][0],U[1][0],U[2][0]],I=[U[3][0],U[4][0],U[5][0]],R=n(A,{...B,gain:1}),b=i(A,{...W,orientationX:N[0],orientationY:N[1],orientationZ:N[2],positionX:I[0],positionY:I[1],positionZ:I[2]});F.connect(R).connect(b.inputs[0]),b.connect(P);for(let V=128;V<X.length;V+=128){const M=[U[0][V],U[1][V],U[2][V]],k=[U[3][V],U[4][V],U[5][V]];if(M.some((me,ce)=>me!==N[ce])||k.some((me,ce)=>me!==I[ce])){N=M,I=k;const me=V/A.sampleRate;R.gain.setValueAtTime(0,me),R=n(A,{...B,gain:0}),b=i(A,{...W,orientationX:N[0],orientationY:N[1],orientationZ:N[2],positionX:I[0],positionY:I[1],positionZ:I[2]}),R.gain.setValueAtTime(1,me),F.connect(R).connect(b.inputs[0]),b.connect(P)}}return P}return $?(await r(A,C.orientationX,D.orientationX),await r(A,C.orientationY,D.orientationY),await r(A,C.orientationZ,D.orientationZ),await r(A,C.positionX,D.positionX),await r(A,C.positionY,D.positionY),await r(A,C.positionZ,D.positionZ)):(await c(A,C.orientationX,D.orientationX),await c(A,C.orientationY,D.orientationY),await c(A,C.orientationZ,D.orientationZ),await c(A,C.positionX,D.positionX),await c(A,C.positionY,D.positionY),await c(A,C.positionZ,D.positionZ)),Ba(D)?await d(C,A,D.inputs[0]):await d(C,A,D),D};return{render(C,A){const P=g.get(A);return P!==void 0?Promise.resolve(P):E(C,A)}}},j2={disableNormalization:!1},B2=(r,e,t,n)=>class uT{constructor(a,u){const c=e(a),d=n({...j2,...u}),p=r(c,d);return t.add(p),p}static[Symbol.hasInstance](a){return a!==null&&typeof a=="object"&&Object.getPrototypeOf(a)===uT.prototype||t.has(a)}},z2=(r,e)=>(t,n,i)=>(r(n).replay(i),e(n,t,i)),U2=(r,e,t)=>async(n,i,a)=>{const u=r(n);await Promise.all(u.activeInputs.map((c,d)=>Array.from(c).map(async([p,g])=>{const E=await e(p).render(p,i),C=n.context.destination;!t(p)&&(n!==C||!t(n))&&E.connect(a,g,d)})).reduce((c,d)=>[...c,...d],[]))},$2=(r,e,t)=>async(n,i,a)=>{const u=e(n);await Promise.all(Array.from(u.activeInputs).map(async([c,d])=>{const g=await r(c).render(c,i);t(c)||g.connect(a,d)}))},q2=(r,e,t,n)=>i=>r(iu,()=>iu(i))?Promise.resolve(r(n,n)).then(a=>{if(!a){const u=t(i,512,0,1);i.oncomplete=()=>{u.onaudioprocess=null,u.disconnect()},u.onaudioprocess=()=>i.currentTime,u.connect(i.destination)}return i.startRendering()}):new Promise(a=>{const u=e(i,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});i.oncomplete=c=>{u.disconnect(),a(c.renderedBuffer)},u.connect(i.destination),i.startRendering()}),W2=r=>(e,t)=>r.set(e,t),G2=(r,e,t,n,i,a,u,c)=>(d,p)=>t(d).render(d,p).then(()=>Promise.all(Array.from(n(p)).map(g=>t(g).render(g,p)))).then(()=>i(p)).then(g=>(typeof g.copyFromChannel!="function"?(u(g),Am(g)):e(a,()=>a(g))||c(g),r.add(g),g)),K2={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",pan:0},H2=(r,e,t,n,i,a)=>class extends r{constructor(c,d){const p=i(c),g={...K2,...d},_=t(p,g),E=a(p),C=E?n():null;super(c,!1,_,C),this._pan=e(this,E,_.pan)}get pan(){return this._pan}},Q2=(r,e,t,n,i)=>()=>{const a=new WeakMap,u=async(c,d)=>{let p=t(c);const g=Tn(p,d);if(!g){const _={channelCount:p.channelCount,channelCountMode:p.channelCountMode,channelInterpretation:p.channelInterpretation,pan:p.pan.value};p=e(d,_)}return a.set(d,p),g?await r(d,c.pan,p.pan):await n(d,c.pan,p.pan),Ba(p)?await i(c,d,p.inputs[0]):await i(c,d,p),p};return{render(c,d){const p=a.get(d);return p!==void 0?Promise.resolve(p):u(c,d)}}},X2=r=>()=>{if(r===null)return!1;try{new r({length:1,sampleRate:44100})}catch{return!1}return!0},Y2=(r,e)=>async()=>{if(r===null)return!0;if(e===null)return!1;const t=new Blob(['class A extends AudioWorkletProcessor{process(i){this.port.postMessage(i,[i[0][0].buffer])}}registerProcessor("a",A)'],{type:"application/javascript; charset=utf-8"}),n=new e(1,128,44100),i=URL.createObjectURL(t);let a=!1,u=!1;try{await n.audioWorklet.addModule(i);const c=new r(n,"a",{numberOfOutputs:0}),d=n.createOscillator();c.port.onmessage=()=>a=!0,c.onprocessorerror=()=>u=!0,d.connect(c),d.start(0),await n.startRendering(),await new Promise(p=>setTimeout(p))}catch{}finally{URL.revokeObjectURL(i)}return a&&!u},Z2=(r,e)=>()=>{if(e===null)return Promise.resolve(!1);const t=new e(1,1,44100),n=r(t,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return new Promise(i=>{t.oncomplete=()=>{n.disconnect(),i(t.currentTime!==0)},t.startRendering()})},J2={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",curve:null,oversample:"none"},eb=(r,e,t,n,i,a,u)=>class extends r{constructor(d,p){const g=i(d),_={...J2,...p},E=t(g,_),A=a(g)?n():null;super(d,!0,E,A),this._isCurveNullified=!1,this._nativeWaveShaperNode=E,u(this,1)}get curve(){return this._isCurveNullified?null:this._nativeWaveShaperNode.curve}set curve(d){if(d===null)this._isCurveNullified=!0,this._nativeWaveShaperNode.curve=new Float32Array([0,0]);else{if(d.length<2)throw e();this._isCurveNullified=!1,this._nativeWaveShaperNode.curve=d}}get oversample(){return this._nativeWaveShaperNode.oversample}set oversample(d){this._nativeWaveShaperNode.oversample=d}},tb=(r,e,t)=>()=>{const n=new WeakMap,i=async(a,u)=>{let c=e(a);if(!Tn(c,u)){const p={channelCount:c.channelCount,channelCountMode:c.channelCountMode,channelInterpretation:c.channelInterpretation,curve:c.curve,oversample:c.oversample};c=r(u,p)}return n.set(u,c),Ba(c)?await t(a,u,c.inputs[0]):await t(a,u,c),c};return{render(a,u){const c=n.get(u);return c!==void 0?Promise.resolve(c):i(a,u)}}},nb=()=>typeof window>"u"?null:window,rb=(r,e)=>t=>{t.copyFromChannel=(n,i,a=0)=>{const u=r(a),c=r(i);if(c>=t.numberOfChannels)throw e();const d=t.length,p=t.getChannelData(c),g=n.length;for(let _=u<0?-u:0;_+u<d&&_<g;_+=1)n[_]=p[_+u]},t.copyToChannel=(n,i,a=0)=>{const u=r(a),c=r(i);if(c>=t.numberOfChannels)throw e();const d=t.length,p=t.getChannelData(c),g=n.length;for(let _=u<0?-u:0;_+u<d&&_<g;_+=1)p[_+u]=n[_]}},sb=r=>e=>{e.copyFromChannel=(t=>(n,i,a=0)=>{const u=r(a),c=r(i);if(u<e.length)return t.call(e,n,c,u)})(e.copyFromChannel),e.copyToChannel=(t=>(n,i,a=0)=>{const u=r(a),c=r(i);if(u<e.length)return t.call(e,n,c,u)})(e.copyToChannel)},ib=r=>(e,t)=>{const n=t.createBuffer(1,1,44100);e.buffer===null&&(e.buffer=n),r(e,"buffer",i=>()=>{const a=i.call(e);return a===n?null:a},i=>a=>i.call(e,a===null?n:a))},ob=(r,e)=>(t,n)=>{n.channelCount=1,n.channelCountMode="explicit",Object.defineProperty(n,"channelCount",{get:()=>1,set:()=>{throw r()}}),Object.defineProperty(n,"channelCountMode",{get:()=>"explicit",set:()=>{throw r()}});const i=t.createBufferSource();e(n,()=>{const c=n.numberOfInputs;for(let d=0;d<c;d+=1)i.connect(n,0,d)},()=>i.disconnect(n))},cT=(r,e,t)=>r.copyFromChannel===void 0?r.getChannelData(t)[0]:(r.copyFromChannel(e,t),e[0]),hT=r=>{if(r===null)return!1;const e=r.length;return e%2!==0?r[Math.floor(e/2)]!==0:r[e/2-1]+r[e/2]!==0},wu=(r,e,t,n)=>{let i=r;for(;!i.hasOwnProperty(e);)i=Object.getPrototypeOf(i);const{get:a,set:u}=Object.getOwnPropertyDescriptor(i,e);Object.defineProperty(r,e,{get:t(a),set:n(u)})},ab=r=>({...r,channelCount:r.numberOfOutputs}),lb=r=>{const{imag:e,real:t}=r;return e===void 0?t===void 0?{...r,imag:[0,0],real:[0,0]}:{...r,imag:Array.from(t,()=>0),real:t}:t===void 0?{...r,imag:e,real:Array.from(e,()=>0)}:{...r,imag:e,real:t}},dT=(r,e,t)=>{try{r.setValueAtTime(e,t)}catch(n){if(n.code!==9)throw n;dT(r,e,t+1e-7)}},ub=r=>{const e=r.createBufferSource();e.start();try{e.start()}catch{return!0}return!1},cb=r=>{const e=r.createBufferSource(),t=r.createBuffer(1,1,44100);e.buffer=t;try{e.start(0,1)}catch{return!1}return!0},hb=r=>{const e=r.createBufferSource();e.start();try{e.stop()}catch{return!1}return!0},bm=r=>{const e=r.createOscillator();try{e.start(-1)}catch(t){return t instanceof RangeError}return!1},fT=r=>{const e=r.createBuffer(1,1,44100),t=r.createBufferSource();t.buffer=e,t.start(),t.stop();try{return t.stop(),!0}catch{return!1}},Dm=r=>{const e=r.createOscillator();try{e.stop(-1)}catch(t){return t instanceof RangeError}return!1},db=r=>{r.start=(e=>(t=0,n=0,i)=>{const a=r.buffer,u=a===null?n:Math.min(a.duration,n);a!==null&&u>a.duration-.5/r.context.sampleRate?e.call(r,t,0,0):e.call(r,t,u,i)})(r.start)},pT=(r,e)=>{const t=e.createGain();r.connect(t);const n=(i=>()=>{i.call(r,t),r.removeEventListener("ended",n)})(r.disconnect);r.addEventListener("ended",n),za(r,t),r.stop=(i=>{let a=!1;return(u=0)=>{if(a)try{i.call(r,u)}catch{t.gain.setValueAtTime(0,u)}else i.call(r,u),a=!0}})(r.stop)},Eu=(r,e)=>t=>{const n={value:r};return Object.defineProperties(t,{currentTarget:n,target:n}),typeof e=="function"?e.call(r,t):e.handleEvent.call(r,t)},fb=fP(Eo),pb=_P(Eo),mb=Ik(nd),mT=new WeakMap,gb=Lk(mT),Vr=ek(new Map,new WeakMap),es=nb(),gT=s2(Vr,wo),Vm=Fk(Hn),fn=U2(Hn,Vm,go),yb=IP(gT,St,fn),Vt=Bk(YE),Ei=T2(es),Nt=Jk(Ei),yT=new WeakMap,vT=kk(Eu),id=l2(es),_T=Qk(id),wT=Xk(es),vb=Yk(es),Bp=c2(es),pn=KP(pP(KE),vP(fb,pb,Mh,mb,Oh,Hn,gb,gu,St,Eo,Is,go,nh),Vr,Hk(Fp,Oh,Hn,St,su,Is),wo,rd,cr,_k(Mh,Fp,Hn,St,su,Vt,Is,Nt),Ck(yT,Hn,wi),vT,Vt,_T,wT,vb,Nt,Bp),_b=TP(pn,yb,wo,gT,Vt,Nt),Mm=new WeakSet,iw=i2(es),ET=dk(new Uint32Array(1)),Om=rb(ET,wo),Fm=sb(ET),wb=CP(Mm,Vr,cr,iw,Ei,X2(iw),Om,Fm),od=wP(Dr),TT=$2(Vm,vu,go),Ns=ak(TT),Tu=a2(od,Vr,ub,cb,hb,bm,fT,Dm,db,ib(wu),pT),Rs=z2(jk(vu),TT),Eb=NP(Ns,Tu,St,Rs,fn),ns=HP(mP(QE),yT,XE,QP,aP,lP,uP,cP,hP,Vp,WE,id,dT),Tb=xP(pn,Eb,ns,Mn,Tu,Vt,Nt,Eu),Ib=OP(pn,FP,wo,Mn,u2(Dr,wu),Vt,Nt,fn),Sb=JP(Ns,aT,St,Rs,fn),To=W2(mT),Cb=ZP(pn,ns,Sb,rd,aT,Vt,Nt,To),Ua=n2(Eo,wT),Ab=ob(Mn,Ua),$a=d2(id,Ab),xb=rk($a,St,fn),Nb=nk(pn,xb,$a,Vt,Nt),Rb=ok(km,St,fn),Pb=ik(pn,Rb,km,Vt,Nt,ab),kb=m2(od,Tu,Dr,Ua),ad=p2(od,Vr,kb,bm,Dm),bb=hk(Ns,ad,St,Rs,fn),Db=ck(pn,ns,bb,ad,Vt,Nt,Eu),IT=g2(cr,wu),Vb=mk(IT,St,fn),Mb=pk(pn,Vb,IT,Vt,Nt,To),Ob=Tk(Ns,lT,St,Rs,fn),Fb=Ek(pn,ns,Ob,lT,Vt,Nt,To),ST=y2(cr),Lb=Nk(Ns,ST,St,Rs,fn),jb=xk(pn,ns,Lb,ST,cr,Vt,Nt,To),Bb=Ok(Ns,Dr,St,Rs,fn),zb=Mk(pn,ns,Bb,Dr,Vt,Nt),Ub=E2(rd,Mn,sd,cr),Lm=q2(Vr,Dr,sd,Z2(Dr,Ei)),$b=Kk(Tu,St,Ei,fn,Lm),qb=v2(Ub),Wb=Wk(pn,qb,$b,Vt,Nt,To),Gb=LP(ns,$a,ad,sd,cr,cT,Nt,wu),CT=new WeakMap,Kb=t2(Ib,Gb,vT,Nt,CT,Eu),AT=I2(od,Vr,bm,fT,Dm,pT),Hb=M2(Ns,AT,St,Rs,fn),Qb=V2(pn,ns,AT,Hb,Vt,Nt,Eu),xT=lk(Tu),Xb=P2(xT,Mn,Dr,hT,Ua),ld=R2(xT,Mn,Xb,hT,Ua,id,wu),Yb=C2(Mh,Mn,$a,Dr,sd,ld,cr,Oh,cT,Ua),NT=S2(Yb),Zb=L2(Ns,$a,ad,Dr,NT,St,Ei,Rs,fn,Lm),Jb=F2(pn,ns,NT,Zb,Vt,Nt,To),eD=A2(wo),tD=B2(eD,Vt,new WeakSet,lb),nD=N2($a,km,Dr,ld,cr,Ua),RT=x2(nD,cr),rD=Q2(Ns,RT,St,Rs,fn),sD=H2(pn,ns,RT,rD,Vt,Nt),iD=tb(ld,St,fn),oD=eb(pn,Mn,ld,iD,Vt,Nt,To),aD=e2(es),lD=bk(es),uD=new WeakMap,cD=zk(uD,Ei),hD=aD?yP(Vr,cr,Pk(es),lD,Dk(dP),Vt,cD,Nt,Bp,new WeakMap,new WeakMap,Y2(Bp,Ei),es):void 0,dD=Zk(_T,Nt),fD=vk(Mm,Vr,yk,Rk,new WeakSet,Vt,dD,Dh,iu,Om,Fm),pD=XP(hD,_b,wb,Tb,Cb,Nb,Pb,Db,Mb,fD,Fb,jb,zb,Wb,Kb,Qb,Jb,tD,sD,oD),mD=Uk(CT),gD=gk(cr,Ei),yD=G2(Mm,Vr,Vm,mD,Lm,Dh,Om,Fm),vD=b2(pD,Vr,Mn,gD,yD),ow=(r,e,t)=>{const n=new vD(r.numberOfChannels,Math.round(t*r.sampleRate),r.sampleRate),i=n.createBiquadFilter(),a=n.createBufferSource();return i.frequency.value=240,i.type="lowpass",a.buffer=r,a.connect(i).connect(n.destination),a.start(0,e,t),n.startRendering().then(u=>{const c=u.getChannelData(0),d=u.sampleRate;return{channelData:c,sampleRate:d}})},_D=rP({analyze:({call:r})=>async(...e)=>{var t;const[n,i,a]=e,u=typeof i=="number"?i:0,c=typeof a=="number"?a:n.duration-u,{channelData:d,sampleRate:p}=await ow(n,u,c),g=typeof i=="object"?i:typeof a=="object"?a:(t=e[3])!==null&&t!==void 0?t:null;return r("analyze",{channelData:d,sampleRate:p,...g===null?g:{tempoSettings:g}},[d.buffer])},guess:({call:r})=>async(...e)=>{var t;const[n,i,a]=e,u=typeof i=="number"?i:0,c=typeof a=="number"?a:n.duration-u,{channelData:d,sampleRate:p}=await ow(n,u,c),g=typeof i=="object"?i:typeof a=="object"?a:(t=e[3])!==null&&t!==void 0?t:null;return r("guess",{channelData:d,sampleRate:p,...g===null?g:{tempoSettings:g}},[d.buffer])}}),wD=r=>{const e=new Worker(r);return _D(e)},ED=(r,e)=>{let t=null;return()=>{if(t!==null)return t;const n=new Blob([e],{type:"application/javascript; charset=utf-8"}),i=URL.createObjectURL(n);return t=r(i),setTimeout(()=>URL.revokeObjectURL(i)),t}},TD=`(()=>{var e={455:function(e,t){!function(e){"use strict";var t=function(e){return function(t){var r=e(t);return t.add(r),r}},r=function(e){return function(t,r){return e.set(t,r),r}},n=void 0===Number.MAX_SAFE_INTEGER?9007199254740991:Number.MAX_SAFE_INTEGER,o=536870912,s=2*o,a=function(e,t){return function(r){var a=t.get(r),i=void 0===a?r.size:a<s?a+1:0;if(!r.has(i))return e(r,i);if(r.size<o){for(;r.has(i);)i=Math.floor(Math.random()*s);return e(r,i)}if(r.size>n)throw new Error("Congratulations, you created a collection of unique numbers which uses all available integers!");for(;r.has(i);)i=Math.floor(Math.random()*n);return e(r,i)}},i=new WeakMap,c=r(i),u=a(c,i),l=t(u);e.addUniqueNumber=l,e.generateUniqueNumber=u}(t)}},t={};function r(n){var o=t[n];if(void 0!==o)return o.exports;var s=t[n]={exports:{}};return e[n].call(s.exports,s,s.exports,r),s.exports}(()=>{"use strict";const e=-32603,t=-32602,n=-32601,o=(e,t)=>Object.assign(new Error(e),{status:t}),s=t=>o('The handler of the method called "'.concat(t,'" returned an unexpected result.'),e),a=(t,r)=>async({data:{id:a,method:i,params:c}})=>{const u=r[i];try{if(void 0===u)throw(e=>o('The requested method called "'.concat(e,'" is not supported.'),n))(i);const r=void 0===c?u():u(c);if(void 0===r)throw(t=>o('The handler of the method called "'.concat(t,'" returned no required result.'),e))(i);const l=r instanceof Promise?await r:r;if(null===a){if(void 0!==l.result)throw s(i)}else{if(void 0===l.result)throw s(i);const{result:e,transferables:r=[]}=l;t.postMessage({id:a,result:e},r)}}catch(e){const{message:r,status:n=-32603}=e;t.postMessage({error:{code:n,message:r},id:a})}};var i=r(455);const c=new Map,u=(e,r,n)=>({...r,connect:({port:t})=>{t.start();const n=e(t,r),o=(0,i.generateUniqueNumber)(c);return c.set(o,(()=>{n(),t.close(),c.delete(o)})),{result:o}},disconnect:({portId:e})=>{const r=c.get(e);if(void 0===r)throw(e=>o('The specified parameter called "portId" with the given value "'.concat(e,'" does not identify a port connected to this worker.'),t))(e);return r(),{result:null}},isSupported:async()=>{if(await new Promise((e=>{const t=new ArrayBuffer(0),{port1:r,port2:n}=new MessageChannel;r.onmessage=({data:t})=>e(null!==t),n.postMessage(t,[t])}))){const e=n();return{result:e instanceof Promise?await e:e}}return{result:!1}}}),l=(e,t,r=()=>!0)=>{const n=u(l,t,r),o=a(e,n);return e.addEventListener("message",o),()=>e.removeEventListener("message",o)},h=(e,t,r)=>{const n=e.length,o=[];let s=!1;for(let a=0;a<n;a+=1)e[a]>t?s=!0:s&&(s=!1,o.push(a-1),a+=r/4-1);return s&&o.push(n-1),o},d=(e,t,r)=>{const n=(e=>{let t=0;const r=e.length;for(let n=0;n<r;n+=1)e[n]>t&&(t=e[n]);return t})(e),o=.3*n;let s=[],a=n-.05*n;if(n>.25)for(;s.length<30&&a>=o;)s=h(e,a,t),a-=.05*n;const i=(e=>{const t=[];return e.forEach(((r,n)=>{const o=Math.min(e.length-n,10);for(let s=1;s<o;s+=1){const o=e[n+s]-r;t.some((e=>e.interval===o&&(e.peaks.push(r),!0)))||t.push({interval:o,peaks:[r]})}})),t})(s),c=((e,t,r={})=>{var n,o;const s=Math.max(0,null!==(n=r.maxTempo)&&void 0!==n?n:180),a=Math.max(0,null!==(o=r.minTempo)&&void 0!==o?o:90),i=[];return e.forEach((e=>{let r=60/(e.interval/t);for(;r<a;)r*=2;for(;r>s;)r/=2;if(r<a)return;let n=!1,o=e.peaks.length;i.forEach((t=>{if(t.tempo===r&&(t.score+=e.peaks.length,t.peaks=[...t.peaks,...e.peaks],n=!0),t.tempo>r-.5&&t.tempo<r+.5){const n=2*Math.abs(t.tempo-r);o+=(1-n)*t.peaks.length,t.score+=(1-n)*e.peaks.length}})),n||i.push({peaks:e.peaks,score:o,tempo:r})})),i})(i,t,r);return c.sort(((e,t)=>t.score-e.score)),c},p=(e,t,r)=>{const n=d(e,t,r);if(0===n.length)throw new Error("The given channelData does not contain any detectable beats.");return n[0].tempo},f=(e,t,r)=>{const n=d(e,t,r);if(0===n.length)throw new Error("The given channelData does not contain any detectable beats.");const{peaks:o,tempo:s}=n[0],a=Math.round(s),i=60/a;o.sort(((e,t)=>e-t));let c=o[0]/t;for(;c>i;)c-=i;return{bpm:a,offset:c,tempo:s}};l(self,{analyze:({channelData:e,sampleRate:t,tempoSettings:r})=>({result:p(e,t,r)}),guess:({channelData:e,sampleRate:t,tempoSettings:r})=>({result:f(e,t,r)})})})()})();`,ID=ED(wD,TD),SD=(...r)=>ID().analyze(...r),un=new VI({log:!0,corePath:"https://unpkg.com/@ffmpeg/core@0.12.4/dist/ffmpeg-core.js",wasmPath:"https://unpkg.com/@ffmpeg/core@0.12.4/dist/ffmpeg-core.wasm"}),aw=async()=>{try{console.log("Starting FFmpeg load..."),await un.load({corePath:"https://cdn.jsdelivr.net/npm/@ffmpeg/core@0.12.15/dist/ffmpeg-core.js",wasmPath:"https://cdn.jsdelivr.net/npm/@ffmpeg/core@0.12.15/dist/ffmpeg-core.wasm"}),console.log("FFmpeg loaded successfully")}catch(r){throw console.error("FFmpeg load error:",r),r instanceof Error&&console.error({message:r.message,name:r.name,stack:r.stack,cause:r.cause}),alert("Failed to load FFmpeg. Please check your internet connection."),r}},CD=({onCreateSlideshow:r,onLoadSession:e,onClose:t})=>{const[n,i]=he.useState(!0),[a,u]=he.useState(!1);return T.jsx("div",{className:"landing-wrapper",children:T.jsxs("div",{className:"landing-container",children:[T.jsxs("div",{className:"landing-header",children:[T.jsx("button",{className:"info-button",onClick:()=>u(!0),children:T.jsx("span",{style:{width:24,height:24,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"50%",border:"1px solid white",fontSize:"16px"},children:"i"})}),T.jsx("h1",{className:"app-title",children:"Groove Slider v1.1"}),T.jsx("button",{className:"close-landing-button",onClick:t,children:T.jsx(ao,{size:24})})]}),T.jsxs("div",{className:"retro-background",children:[T.jsx("div",{className:"wave-pattern top"}),T.jsx("div",{className:"wave-pattern bottom"}),T.jsxs("div",{className:"project-management",children:[T.jsx("button",{className:"create-button",onClick:r,children:"Create Slideshow"}),T.jsx("button",{className:"sessions-toggle-button",onClick:()=>i(!n),children:n?"Hide Saved Projects":"Show Saved Projects"}),n&&T.jsx("div",{className:"landing-sessions-container",children:T.jsx(GR,{visible:!0,onLoadSession:e})})]})]}),T.jsx("div",{className:"featured-section",children:T.jsxs("button",{className:"use-style-button",children:[T.jsx(Up,{size:18}),T.jsx("span",{children:"Follow Us "})]})}),a&&T.jsx(kD,{isOpen:a,onClose:()=>u(!1)})]})})},AD=({onUpload:r,onBPMChange:e,currentBPM:t,onStartPointChange:n,audioRef:i,musicUrl:a,musicStartPoint:u})=>{const[c,d]=he.useState(0),[p,g]=he.useState(!1),[_,E]=he.useState(1),[C,A]=he.useState(0),P=he.useRef(null),[D,B]=he.useState(""),[W,$]=he.useState(!1),[X,F]=he.useState(!1),[U,N]=he.useState(null),I=he.useRef(null),R=he.useRef(null);he.useEffect(()=>{if(!U){const ce=new(window.AudioContext||window.webkitAudioContext);N(ce)}return()=>{U&&U.close()}},[]);const b=async ce=>{try{console.log("Starting BPM detection..."),$(!0);const fe=new(window.AudioContext||window.webkitAudioContext),ne=await(await fetch(ce)).arrayBuffer();console.log("Audio data fetched, decoding...");const se=await fe.decodeAudioData(ne);console.log("Audio decoded, analyzing tempo...");const re=await SD(se);console.log(`Raw detected tempo: ${re}`);let L=re;re>140&&(L=re/2);const Z=Math.round(L);return console.log(`Final detected BPM: ${Z}`),Z}catch(fe){return console.error("BPM detection failed:",fe),120}finally{$(!1)}},V=()=>{if(!P.current)return;const ce=P.current.currentTime;if(d(ce),p&&R.current!==null){const fe=Math.abs(ce-R.current);fe>.005&&ce<R.current+.5?(console.log(`Correcting drift of ${fe.toFixed(6)}s`),P.current.currentTime=R.current,i.current&&(i.current.currentTime=R.current)):ce>R.current+.5&&(R.current=null)}};he.useEffect(()=>{if(P.current&&i.current){P.current.addEventListener("timeupdate",V);const ce=()=>{i.current.currentTime=P.current.currentTime};return P.current.addEventListener("timeupdate",ce),P.current.addEventListener("seeking",()=>{I.current&&clearInterval(I.current),I.current=setInterval(()=>{V()},10)}),P.current.addEventListener("seeked",()=>{I.current&&(clearInterval(I.current),I.current=null)}),P.current.addEventListener("loadedmetadata",()=>{A(P.current.duration)}),()=>{P.current&&(P.current.removeEventListener("timeupdate",V),P.current.removeEventListener("timeupdate",ce),P.current.removeEventListener("seeking",()=>{}),P.current.removeEventListener("seeked",()=>{})),I.current&&clearInterval(I.current)}}},[i,P,p]);const M=async()=>{if(P.current)if(p)P.current.pause(),g(!1);else try{const ce=P.current.currentTime;R.current=ce,P.current.currentTime=ce,U&&U.state==="suspended"&&await U.resume(),await P.current.play(),setTimeout(()=>{Math.abs(P.current.currentTime-ce)>.005&&(console.log(`Forced correction: ${P.current.currentTime} -> ${ce}`),P.current.currentTime=ce)},10),g(!0)}catch(ce){console.error("Playback error:",ce),R.current=null}},k=()=>{F(!0),p&&P.current&&P.current.pause()},me=()=>{F(!1),p&&P.current&&(R.current=P.current.currentTime,P.current.play().catch(ce=>console.error("Resume error:",ce)))};return T.jsx("div",{className:"music-panel",children:T.jsxs("div",{className:"music-controls",children:[T.jsxs("div",{className:"bpm-control",children:[W&&T.jsxs("div",{className:"bpm-analyzer",children:[T.jsx(vS,{className:"spinner",size:18}),T.jsx("span",{children:"Analyzing beat..."})]}),T.jsxs("div",{className:"manual-bpm",children:[T.jsxs("label",{children:[T.jsx("span",{children:"AUTO-BPM"}),T.jsx("span",{children:"DETECTION:"})]}),T.jsx("input",{type:"number",min:"60",max:"180",value:t,onChange:ce=>e(parseInt(ce.target.value)),className:"bpm-input"})]}),T.jsxs("label",{className:"upload-button",children:[T.jsx(Up,{className:"icon"}),T.jsx("span",{children:"Upload Music"}),T.jsx("input",{type:"file",accept:".mp3,.aac,.m4a,.wav,.mp4,.mov",onChange:async ce=>{const fe=ce.target.files[0];if(fe){const oe=URL.createObjectURL(fe);B(fe.name),$(!0);try{const ne=await b(oe);console.log(`Final detected BPM: ${ne}`),e(ne)}catch(ne){console.error("BPM detection failed:",ne),e(120)}finally{$(!1)}r(oe),n(0),P.current&&(P.current.src=oe,P.current.currentTime=0)}},className:"hidden-input"})]})]}),T.jsxs("div",{className:"music-player",children:[T.jsx("audio",{ref:P,src:a,onTimeUpdate:V,preload:"auto"}),a&&T.jsx("div",{className:"music-info",children:T.jsx("span",{children:D||"Track Title"})}),T.jsx("button",{className:"audio-control-button",onClick:M,children:p?T.jsx(hw,{size:32}):T.jsx(dw,{size:32})}),a&&T.jsx(QR,{audioUrl:a,audioRef:i,onStartPointChange:ce=>{const fe=Math.round(ce*1e3)/1e3;R.current=fe,n(fe),P.current&&(P.current.currentTime=fe)},musicStartPoint:u}),T.jsx("div",{className:"audio-progress",children:T.jsx("input",{type:"range",min:"0",max:C||100,step:"0.001",value:c,onMouseDown:k,onMouseUp:me,onTouchStart:k,onTouchEnd:me,onChange:ce=>{const fe=parseFloat(ce.target.value);P.current&&(P.current.currentTime=fe,R.current=fe,X&&n(fe),d(fe))},className:"progress-slider",style:{background:`linear-gradient(to right, #4682B4 ${c/C*100}%, #e5e5e5 ${c/C*100}%)`}})})]})]})})},xD=({currentIndex:r,totalSlides:e,onProgressClick:t})=>(console.log("Rendering ProgressBar",{currentIndex:r,totalSlides:e,bars:[...Array(e)].map((n,i)=>({index:i,isActive:i===r}))}),T.jsx("div",{className:"progress-container",children:[...Array(e)].map((n,i)=>T.jsx("div",{className:`progress-bar ${i===r?"active":""}`,style:{backgroundColor:i===r?"white":"rgba(255,255,255,0.3)"},onClick:()=>t(i)},i))})),ND=({onPrevious:r,onNext:e,isFirstSlide:t,isLastSlide:n})=>T.jsxs(T.Fragment,{children:[T.jsx("button",{onClick:r,className:"nav-button prev",disabled:t,children:T.jsx(Qi,{})}),T.jsx("button",{onClick:e,className:"nav-button next",disabled:n,children:T.jsx(si,{})})]}),RD=({onFileUpload:r})=>T.jsx("div",{className:"empty-state",children:T.jsxs("label",{htmlFor:"file-upload",className:"file-upload-label",children:[T.jsx(nS,{size:48}),T.jsx("span",{children:"Add Images"}),T.jsx("input",{type:"file",id:"file-upload",accept:"image/*",multiple:!0,onChange:r,className:"hidden-input"})]})}),PD=({isOpen:r,progress:e,message:t})=>r?T.jsx("div",{className:"modal-overlay",children:T.jsx("div",{className:"modal-content export-progress",children:T.jsxs("div",{className:"loading-container",children:[T.jsx("h3",{className:"progress-title",children:t}),T.jsx("div",{className:"progress-bar-container",children:T.jsx("div",{className:"progress-bar-fill",style:{width:`${e||0}%`,transition:"width 0.3s ease-in-out"}})}),T.jsxs("div",{className:"progress-percentage",children:[Math.round(e||0),"%"]})]})})}):null,kD=({isOpen:r,onClose:e})=>{const[t,n]=he.useState(null),[i,a]=he.useState(""),[u,c]=he.useState(!0);he.useEffect(()=>{r&&(async()=>{try{if(console.group("🔍 License Fetch Debugging"),console.log("Firestore DB:",tp),console.log("Modal Open:",r),!tp){console.error("❌ Firestore DB not initialized");return}const E=BN(tp,"content","license");console.log("📄 Document Reference:",E);try{const C=await ZN(E);if(console.log("📋 Document Exists:",C.exists()),C.exists()){const A=C.data();console.log("📝 License Data:",A),A&&A.text?(console.log("✅ License Text Found"),a(A.text)):(console.warn("❗ No text field in license document"),a("No license text found."))}else console.warn("❌ No such document in Firestore"),a("License document does not exist.")}catch(C){if(console.error("❌ Snapshot Error:",C),C.code==="unavailable"){console.log("🌐 Offline mode: Attempting to use cached data");const A=await getDocFromCache(E);if(A.exists()){const P=A.data();a(P.text||"Cached license text")}else a("License unavailable offline")}else a(`Error loading license: ${C.message}`)}}catch(E){console.error("❌ Detailed Firebase Error:",E),a(`Error loading license: ${E.message}`)}finally{console.groupEnd(),c(!1)}})()},[r]);const d=_=>{n(_)},p=()=>{n(null)},g=()=>{switch(t){case"credits":return T.jsxs("div",{className:"section-content",children:[T.jsxs("header",{className:"section-header",children:[T.jsx("button",{className:"back-button",onClick:p,children:T.jsx(Qi,{size:24})}),T.jsx("h2",{children:"Credits"})]}),T.jsx("div",{className:"section-body",children:T.jsxs("div",{className:"credits-content",children:[T.jsxs("div",{className:"developer-profile",children:[T.jsx("div",{className:"developer-avatar",children:T.jsx(HI,{size:64})}),T.jsx("h3",{children:"Ben Hayes"}),T.jsx("p",{className:"developer-title",children:"Creator & Developer"})]}),T.jsxs("div",{className:"company-info",children:[T.jsx("h4",{children:"Hayzer Apps"}),T.jsx("p",{children:"Groove Slider was designed, developed, and maintained by Ben Hayes as the sole developer."})]}),T.jsxs("div",{className:"developer-note",children:[T.jsx("p",{children:"From concept to implementation, every aspect of this app was crafted to provide an elegant way to create musical slideshows of your favorite moments."}),T.jsx("p",{children:"I hope you enjoy using Groove Slider as much as I enjoyed creating it."})]}),T.jsxs("div",{className:"contact-section",children:[T.jsx("h4",{children:"Connect"}),T.jsx("p",{children:"Have feedback or suggestions? I'd love to hear from you!"}),T.jsx("p",{children:"Email: contact@hayzerapps.com"})]})]})})]});case"feedback":return T.jsxs("div",{className:"section-content",children:[T.jsxs("header",{className:"section-header",children:[T.jsx("button",{className:"back-button",onClick:p,children:T.jsx(Qi,{size:24})}),T.jsx("h2",{children:"Feedback"})]}),T.jsx("div",{className:"section-body",children:T.jsxs("div",{className:"feedback-form",children:[T.jsx("p",{children:"We'd love to hear your thoughts on Groove Slider!"}),T.jsx("textarea",{placeholder:"Share your feedback here...",className:"feedback-textarea",rows:6}),T.jsx("button",{className:"submit-button",children:"Submit Feedback"})]})})]});case"restore":return T.jsxs("div",{className:"section-content",children:[T.jsxs("header",{className:"section-header",children:[T.jsx("button",{className:"back-button",onClick:p,children:T.jsx(Qi,{size:24})}),T.jsx("h2",{children:"Restore Purchase"})]}),T.jsxs("div",{className:"section-body",children:[T.jsx("p",{children:"Tap the button below to restore your previous purchases."}),T.jsx("button",{className:"restore-button",children:"Restore Purchases"})]})]});case"unsubscribe":return T.jsxs("div",{className:"section-content",children:[T.jsxs("header",{className:"section-header",children:[T.jsx("button",{className:"back-button",onClick:p,children:T.jsx(Qi,{size:24})}),T.jsx("h2",{children:"How to Unsubscribe"})]}),T.jsx("div",{className:"section-body",children:T.jsxs("div",{className:"unsubscribe-info",children:[T.jsx("p",{children:"For information on how to manage or cancel your subscription, please visit Google's official support page:"}),T.jsx("button",{className:"external-link-button",onClick:()=>window.open("https://support.google.com/googleplay/answer/7018481?hl=en&co=GENIE.Platform%3DAndroid","_blank"),children:"Google Play Subscription Help"})]})})]});case"privacy":return T.jsxs("div",{className:"section-content",children:[T.jsxs("header",{className:"section-header",children:[T.jsx("button",{className:"back-button",onClick:p,children:T.jsx(Qi,{size:24})}),T.jsx("h2",{children:"Privacy Policy"})]}),T.jsx("div",{className:"section-body",children:T.jsxs("div",{className:"privacy-content",children:[T.jsx("h3",{children:"Privacy Policy for Groove Slider"}),T.jsx("p",{children:"Last Updated: March 2, 2025"}),T.jsx("h4",{children:"Introduction"}),T.jsx("p",{children:"Welcome to Groove Slider. We respect your privacy and are committed to protecting your personal data. This privacy policy will inform you about how we handle your data when you use our application and tell you about your privacy rights."}),T.jsx("h4",{children:"What Data We Collect"}),T.jsx("p",{children:"Groove Slider requires access to the following on your device:"}),T.jsxs("ul",{children:[T.jsx("li",{children:"Image files (photos, pictures) that you select to include in your slideshows"}),T.jsx("li",{children:"Audio files (music, sounds) that you select to add to your slideshows"})]}),T.jsx("h4",{children:"How We Use Your Data"}),T.jsx("p",{children:"We use your data for the following purposes:"}),T.jsxs("ul",{children:[T.jsx("li",{children:"To create slideshows with your selected images"}),T.jsx("li",{children:"To add your selected music to your slideshows"}),T.jsx("li",{children:"To export these slideshows as MP4 video files to your device"})]}),T.jsx("h4",{children:"Data Processing"}),T.jsx("p",{children:"All data processing happens locally on your device. Your images and music:"}),T.jsxs("ul",{children:[T.jsx("li",{children:"Are not uploaded to our servers"}),T.jsx("li",{children:"Are not shared with third parties"}),T.jsx("li",{children:"Are only accessed when you explicitly grant permission"}),T.jsx("li",{children:"Are only used for the purpose of creating and exporting your slideshows"})]}),T.jsx("h4",{children:"Storage"}),T.jsx("p",{children:"The app stores:"}),T.jsxs("ul",{children:[T.jsx("li",{children:"Temporary copies of your selected images and music while processing"}),T.jsx("li",{children:"Your slideshow settings and preferences"}),T.jsx("li",{children:"Completed MP4 video files that are saved to your device storage"})]}),T.jsx("h4",{children:"Third-Party Services"}),T.jsx("p",{children:"Our app does not integrate with third-party analytics or advertising services."}),T.jsx("h4",{children:"Your Rights"}),T.jsx("p",{children:"You have the right to:"}),T.jsxs("ul",{children:[T.jsx("li",{children:"Delete your saved slideshows and preferences by uninstalling the app"}),T.jsx("li",{children:"Control what files you share with the app through your device permissions"})]}),T.jsx("h4",{children:"Children's Privacy"}),T.jsx("p",{children:"Our service is not directed to anyone under the age of 13. We do not knowingly collect personal information from children."}),T.jsx("h4",{children:"Changes to This Privacy Policy"}),T.jsx("p",{children:'We may update our Privacy Policy from time to time. We will notify you of any changes by posting the new Privacy Policy on this page and updating the "Last Updated" date.'}),T.jsx("h4",{children:"Contact Us"}),T.jsx("p",{children:"If you have any questions about this Privacy Policy, please contact us at: contact@grooveslider.app"})]})})]});case"license":return T.jsxs("div",{className:"section-content",children:[T.jsxs("header",{className:"section-header",children:[T.jsx("button",{className:"back-button",onClick:p,children:T.jsx(Qi,{size:24})}),T.jsx("h2",{children:"License Agreement"})]}),T.jsx("div",{className:"section-body",children:T.jsx("div",{className:"license-content",children:u?T.jsx("p",{children:"Loading license..."}):T.jsxs(T.Fragment,{children:[T.jsx("h3",{children:"End User License Agreement"}),T.jsx("p",{children:"Last Updated: March 2, 2025"}),T.jsx("div",{className:"license-text",children:i||"No license text available."})]})})})]});default:return null}};return T.jsx("div",{className:"modal-overlay",children:T.jsx("div",{className:"info-modal",children:t?g():T.jsxs(T.Fragment,{children:[T.jsxs("header",{className:"info-header",children:[T.jsx("h2",{children:"Settings"}),T.jsx("button",{className:"close-button",onClick:e,children:T.jsx(ao,{size:24})})]}),T.jsxs("div",{className:"info-content",children:[T.jsxs("div",{className:"pro-banner",children:[T.jsxs("div",{className:"pro-text",children:[T.jsxs("h3",{children:["Groove Slider ",T.jsx("span",{className:"pro-badge",children:"Pro"})]}),T.jsx("p",{children:"Unlock All Features"})]}),T.jsx("div",{className:"pro-image",children:T.jsx("div",{style:{width:80,height:80,background:"rgba(255,255,255,0.2)",borderRadius:"8px"}})})]}),T.jsxs("div",{className:"info-item-group",children:[T.jsxs("div",{className:"info-item",onClick:()=>d("credits"),children:[T.jsx(pS,{className:"info-icon"}),T.jsxs("div",{className:"info-text",children:[T.jsx("h4",{children:"Credits"}),T.jsx("p",{children:"About"})]}),T.jsx(si,{})]}),T.jsxs("div",{className:"info-item",onClick:()=>d("feedback"),children:[T.jsx(TS,{className:"info-icon"}),T.jsx("div",{className:"info-text",children:T.jsx("h4",{children:"Feedback"})}),T.jsx(si,{})]}),T.jsxs("div",{className:"info-item",onClick:()=>d("restore"),children:[T.jsx(LS,{className:"info-icon"}),T.jsx("div",{className:"info-text",children:T.jsx("h4",{children:"Restore Purchase"})}),T.jsx(si,{})]})]}),T.jsxs("div",{className:"info-item-group",children:[T.jsxs("div",{className:"info-item",onClick:()=>d("unsubscribe"),children:[T.jsx(sS,{className:"info-icon"}),T.jsx("div",{className:"info-text",children:T.jsx("h4",{children:"How to unsubscribe"})}),T.jsx(si,{})]}),T.jsxs("div",{className:"info-item",onClick:()=>d("privacy"),children:[T.jsx(wS,{className:"info-icon"}),T.jsx("div",{className:"info-text",children:T.jsx("h4",{children:"Privacy Policy"})}),T.jsx(si,{})]}),T.jsxs("div",{className:"info-item",onClick:()=>d("license"),children:[T.jsx(cS,{className:"info-icon"}),T.jsx("div",{className:"info-text",children:T.jsx("h4",{children:"License"})}),T.jsx(si,{})]}),T.jsxs("div",{className:"info-item",children:[T.jsx(dS,{className:"info-icon"}),T.jsxs("div",{className:"info-text",children:[T.jsx("h4",{children:"Version"}),T.jsx("p",{children:"Version 0.9.0 (Beta)"})]})]})]})]})]})})})},bD=({isVisible:r,onClose:e})=>r?T.jsx("div",{className:"share-notification",children:T.jsxs("div",{className:"share-content",children:[T.jsx("h3",{children:"Export Complete! 🎉"}),T.jsx("p",{children:"Share your creation:"}),T.jsxs("div",{className:"share-buttons",children:[T.jsx("button",{onClick:()=>window.open("https://instagram.com","_blank"),className:"share-button instagram",children:"Share to Instagram"}),T.jsx("button",{onClick:()=>window.open("https://tiktok.com","_blank"),className:"share-button tiktok",children:"Share to TikTok"})]}),T.jsx("button",{onClick:e,className:"close-notification",children:T.jsx(ao,{size:20})})]})}):null,PT=({stories:r,onClose:e,onReorder:t,onDelete:n})=>{const[i,a]=he.useState(r.map((D,B)=>B+1)),[u,c]=he.useState(null),[d,p]=he.useState(null),[g,_]=he.useState(!1),E=D=>{c(u===D?null:D)},C=(D,B)=>{u===B&&(_(!0),D.currentTarget.style.cursor="grabbing")},A=(D,B)=>{D.preventDefault(),g&&u!==null&&u!==B&&p(B)},P=D=>{if(u!==null&&u!==D){const B=[...r],[W]=B.splice(u,1);B.splice(D,0,W);const $=B.map((X,F)=>F+1);a($),t(B),c(null),p(null),_(!1)}};return T.jsxs("div",{className:"edit-panel",children:[T.jsxs("div",{className:"edit-panel-header",children:[T.jsx("h3",{children:"Re-order by Tap, Drag, Drop"}),T.jsx("button",{className:"edit-panel-close",onClick:e,children:T.jsx(ao,{size:20})})]}),T.jsx("div",{className:"thumbnails-container",children:r.map((D,B)=>T.jsx("div",{className:`thumbnail ${u===B?"selected":""}
${d===B?"drag-over":""}`,onClick:()=>E(B),onMouseDown:W=>C(W,B),onTouchStart:W=>C(W,B),onDragOver:W=>A(W,B),onMouseOver:W=>g&&A(W,B),onTouchMove:W=>{const $=W.touches[0],F=document.elementFromPoint($.clientX,$.clientY).closest(".thumbnail");if(F){const U=Array.from(F.parentNode.children).indexOf(F);A(W,U)}},onMouseUp:()=>P(B),onTouchEnd:()=>d!==null&&P(d),draggable:u===B,children:T.jsxs("div",{className:"thumbnail-content",children:[T.jsx("button",{className:"delete-button",onClick:W=>{W.stopPropagation(),n(B)},children:T.jsx(ao,{size:16})}),T.jsxs("div",{className:"image-thumbnail",children:[T.jsx("img",{src:D.url,alt:`Slide ${B+1}`}),u===B&&T.jsx("div",{className:"selection-dot"})]})]})},B))})]})},DD=({onFileUpload:r,onSaveSession:e,onExportSession:t,onPlayPause:n,isPlaying:i,duration:a,onDurationChange:u,onEdit:c,onMusicUpload:d,onBPMChange:p,musicUrl:g,bpm:_,onStartPointChange:E,musicStartPoint:C,audioRef:A,isLoopingEnabled:P,setIsLoopingEnabled:D,showEditPanel:B,setShowEditPanel:W,stories:$,setStories:X,handleDelete:F,handleReorder:U})=>{const[N,I]=he.useState(!1),[R,b]=he.useState(!1),[V,M]=he.useState(1);he.useEffect(()=>{const ne=[.125,.25,.5,1,2,4,8,16].find(se=>Math.abs(a*_/(4*60)-se)<.01);ne&&M(ne)},[a,_]);const k=(oe,ne)=>oe*4*60/ne,me=()=>{I(!N),R&&b(!1),B&&W(!1)},ce=()=>{b(!R),N&&I(!1),B&&W(!1)},fe=()=>{W(!B),N&&I(!1),R&&b(!1)};return T.jsxs("div",{className:"bottom-menu w-full flex flex-col items-stretch",children:[N&&T.jsx("div",{className:"duration-panel",children:T.jsxs("div",{className:"duration-controls",children:[T.jsx("h3",{children:"Bar-Based Slide Transitions"}),T.jsx("div",{className:"bar-options",children:[{value:.125,label:"⅛ Bar"},{value:.25,label:"¼ Bar"},{value:.5,label:"½ Bar"},{value:1,label:"1 Bar"},{value:2,label:"2 Bars"},{value:4,label:"4 Bars"},{value:8,label:"8 Bars"},{value:16,label:"16 Bars"}].map(oe=>T.jsx("button",{className:`bar-option ${V===oe.value?"selected":""}`,onClick:()=>{const ne=k(oe.value,_);M(oe.value),u(ne)},children:oe.label},oe.value))}),T.jsxs("div",{className:"duration-info",children:[T.jsx("span",{children:"Slide Change Speed:"}),T.jsxs("span",{className:"time-info",children:[a.toFixed(2),"s /",_," BPM"]})]})]})}),R&&T.jsx(AD,{audioRef:A,onUpload:d,onBPMChange:p,currentBPM:_,onStartPointChange:E,musicStartPoint:C,musicUrl:g}),B&&T.jsx(PT,{stories:$,onClose:()=>W(!1),onReorder:oe=>{X(oe),U(oe)},onDelete:F}),T.jsxs("div",{className:"bottom-menu-buttons",children:[T.jsxs("button",{className:`bottom-menu-button ${P?"active":""}`,onClick:()=>D(!P),"data-loop":"true",children:[T.jsx(DS,{className:"bottom-menu-icon"}),T.jsx("span",{className:"bottom-menu-text",children:"Loop"})]}),T.jsxs("button",{className:`bottom-menu-button ${N?"active":""}`,onClick:me,children:[T.jsx(uw,{className:"bottom-menu-icon"}),T.jsx("span",{className:"bottom-menu-text",children:"Speed"})]}),T.jsxs("button",{className:`bottom-menu-button ${R?"active":""}`,onClick:ce,children:[T.jsx(Up,{className:"bottom-menu-icon"}),T.jsx("span",{className:"bottom-menu-text",children:"Music"})]}),T.jsxs("button",{className:`bottom-menu-button ${i?"active":""}`,onClick:n,children:[i?T.jsx(hw,{className:"bottom-menu-icon"}):T.jsx(dw,{className:"bottom-menu-icon"}),T.jsx("span",{className:"bottom-menu-text",children:i?"Pause":"Play"})]}),T.jsxs("div",{className:"bottom-menu-right-group",children:[T.jsxs("button",{className:`bottom-menu-button ${B?"active":""}`,onClick:fe,children:[T.jsx(BS,{className:"bottom-menu-icon"}),T.jsx("span",{className:"bottom-menu-text",children:"Edit"})]}),T.jsxs("label",{className:"bottom-menu-button",children:[T.jsx(gS,{className:"bottom-menu-icon"}),T.jsx("span",{className:"bottom-menu-text",children:"Add"}),T.jsx("input",{type:"file",id:"file-upload-bottom",accept:"image/*",multiple:!0,onChange:r,className:"hidden-input"})]}),T.jsxs("button",{className:"bottom-menu-button",onClick:e,children:[T.jsx(fw,{className:"bottom-menu-icon"}),T.jsx("span",{className:"bottom-menu-text",children:"Save"})]}),T.jsxs("button",{className:"bottom-menu-button",onClick:t,children:[T.jsx(cw,{className:"bottom-menu-icon"}),T.jsx("span",{className:"bottom-menu-text",children:"Export"})]})]})]})]})},VD=()=>{const[r,e]=he.useState(!0),[t,n]=he.useState(0),[i,a]=he.useState([]),[u,c]=he.useState(!1),[d,p]=he.useState(2),[g,_]=he.useState(!1),[E,C]=he.useState(!1),[A,P]=he.useState(!1),[D,B]=he.useState(null),[W,$]=he.useState(!1),[X,F]=he.useState(!1),[U,N]=he.useState(!1),[I,R]=he.useState("cover"),[b,V]=he.useState(!1),[M,k]=he.useState(!1),[me,ce]=he.useState(null),[fe,oe]=he.useState(""),[ne,se]=he.useState(!1),[re,L]=he.useState(null),[Z,Ee]=he.useState(120),[be,Q]=he.useState(0),[ee,ye]=he.useState(!0),[te,ve]=he.useState({}),[Oe,Be]=he.useState(null),[it,Lt]=he.useState(null),qe=he.useRef(null),hr=he.useRef(null),Mr=()=>{i.length>0?window.confirm("Start a new project? Any unsaved changes will be lost.")&&(dr(),e(!1)):e(!1)},dr=()=>{a([]),n(0),L(null),qe.current&&(qe.current.pause(),qe.current.src=""),c(!1),Ee(120),Q(0),p(2),ye(!1)},rs=Te=>new Promise((Re,je)=>{const Ue=new Image;Ue.onload=()=>Re(Te),Ue.onerror=je,Ue.src=Te});he.useEffect(()=>{const Te=async()=>{const Re=[t-1,t,t+1].filter(je=>je>=0&&je<i.length);for(const je of Re)if(!te[i[je].url])try{await rs(i[je].url),ve(Ue=>({...Ue,[i[je].url]:!0}))}catch(Ue){console.error("Failed to preload image:",Ue)}};i.length>0&&Te()},[t,i]),he.useEffect(()=>{aw().catch(console.error)},[]);const On=async Te=>{const Re=Array.from(Te.target.files).filter(nt=>nt.type.startsWith("image/"));if(Re.length===0){alert("Please select image files only.");return}const je=await Promise.all(Re.map(async nt=>{const $t=await Fn(nt);return{type:"image",url:URL.createObjectURL(nt),originalName:nt.name,base64Data:$t,dateAdded:new Date().toISOString()}})),Ue=[...i,...je];if(a(Ue),Te.target.value="",je.length>0)try{await Ps("auto_save_"+Date.now(),!0),console.log(`Auto-save completed with ${Ue.length} total images`)}catch(nt){console.error("Auto-save failed:",nt)}},Fn=Te=>new Promise(Re=>{const je=new FileReader;je.onloadend=()=>Re(je.result),je.readAsDataURL(Te)}),ut=Te=>{const Re=Te.split(";base64,"),je=Re[0].split(":")[1],Ue=window.atob(Re[1]),nt=Ue.length,$t=new Uint8Array(nt);for(let Rt=0;Rt<nt;++Rt)$t[Rt]=Ue.charCodeAt(Rt);return new Blob([$t],{type:je})},Or=Te=>{L(Te),Q(0),qe.current&&(qe.current.src=Te,qe.current.currentTime=0)},Ye=Te=>{Ee(Te);const Ue=([.125,.25,.5,1,2,4,8,16].find(nt=>Math.abs(d*Te/(4*60)-nt)<.01)||1)*4*60/Te;p(Ue)},In=()=>{hr.current=setInterval(()=>{n(Te=>!ee&&Te>=i.length-1?(mn(),c(!1),qe.current&&qe.current.pause(),Te):(Te+1)%i.length)},d*1e3)},mn=()=>{hr.current&&clearInterval(hr.current)},dt=async()=>{if(u)mn(),qe.current&&qe.current.pause(),c(!1);else{if(t===i.length-1&&n(0),In(),qe.current&&re){const Te=be;qe.current.currentTime=Te;try{await qe.current.play(),setTimeout(()=>{Math.abs(qe.current.currentTime-Te)>.01&&(console.log("Correcting audio timing drift on play"),qe.current.currentTime=Te)},10)}catch(Re){console.log("Play error:",Re)}}c(!0)}};he.useEffect(()=>()=>mn(),[]),he.useEffect(()=>{u&&(mn(),In())},[d]);const ft=()=>{t<i.length-1&&n(t+1)},Sn=()=>{t>0&&n(t-1)},ss=Te=>Be(Te.touches[0].clientX),Yn=Te=>Lt(Te.touches[0].clientX),Ln=()=>{if(!Oe||!it)return;const Te=Oe-it,Re=Te>50,je=Te<-50;Re&&t<i.length-1&&ft(),je&&t>0&&Sn(),Be(null),Lt(null)},jn=Te=>{u&&(mn(),c(!1),qe.current&&qe.current.pause()),n(0),a(Te)},fr=Te=>{const Re=i.filter((je,Ue)=>Ue!==Te);a(Re),t>=Te&&n(Math.max(0,t-1))},Ti=(Te,Re,je)=>je!=="cover"?`scale=${Te}:${Re}:force_original_aspect_ratio=1,pad=${Te}:${Re}:(ow-iw)/2:(oh-ih)/2:black`:`scale=iw*max(${Te}/iw\\,${Re}/ih):ih*max(${Te}/iw\\,${Re}/ih),crop=${Te}:${Re}`,Ii=async Te=>{try{u&&(mn(),qe.current&&qe.current.pause(),c(!1));const Re=await $R(Te);a(Re.stories),Ee(Re.bpm),p(Re.duration),ye(Re.isLoopingEnabled),n(Re.currentIndex),R(Re.imageFitMode||"cover"),Re.musicUrl&&(L(Re.musicUrl),Q(Re.musicStartPoint),qe.current&&(qe.current.src=Re.musicUrl,qe.current.currentTime=Re.musicStartPoint)),r&&e(!1),alert("Session loaded successfully!")}catch(Re){console.error("Error loading session:",Re),alert("Failed to load session: "+Re.message)}},Si=async Te=>{const Re={...Te},{resolution:je="1080x1920",isExportLoopEnabled:Ue=!1,exportLoopDuration:nt=0}=Re;try{let $t,Rt="untitled.mp4";if("showSaveFilePicker"in window)$t=await window.showSaveFilePicker({suggestedName:Rt,types:[{description:"MP4 Video",accept:{"video/mp4":[".mp4"]}}]});else{const Ze=document.createElement("a");Ze.download=Rt,$t={createWritable:async()=>({write:async et=>{const qt=URL.createObjectURL(new Blob([et],{type:"video/mp4"}));Ze.href=qt,Ze.click(),URL.revokeObjectURL(qt)},close:async()=>{}})}}k(!0),se(!0),oe("Preparing to export video..."),ce(0),un.loaded||await aw();let pr=[];const Fr=[],[Ci,mr]=je.split("x").map(Number),Ai=i.length*d,pt=Ue&&nt>0?Math.ceil(nt/Ai):1;for(let Ze=0;Ze<pt;Ze++)for(let et=0;et<i.length;et++){const qt=i[et];oe(`Processing image ${et+1}/${i.length} (Loop ${Ze+1}/${pt})`);let gr;try{if(qt.base64Data){const is=ut(qt.base64Data);gr=new Uint8Array(await is.arrayBuffer())}else gr=await Wy(qt.url)}catch(is){throw console.error(`Error fetching image ${et+1}:`,is),new Error(`Failed to process image ${et+1}. Please check if all images are valid.`)}const Lr=`input_${Ze}_${et}.png`,gn=`processed_${Ze}_${et}.mp4`;await un.writeFile(Lr,gr),pr.push(Lr),await un.exec(["-loop","1","-i",Lr,"-c:v","libx264","-t",`${d}`,"-pix_fmt","yuv420p","-vf",Ti(Ci,mr,I),"-r","30","-preset","ultrafast",gn]),pr.push(gn),Fr.push({name:gn}),ce((Ze*i.length+et+1)/(pt*i.length)*75)}if(await un.writeFile("list.txt",Fr.map(Ze=>`file '${Ze.name}'`).join(`
`)),pr.push("list.txt"),oe("Creating final video..."),ce(85),await un.exec(["-f","concat","-safe","0","-i","list.txt","-c:v","copy","temp_output.mp4"]),pr.push("temp_output.mp4"),re){oe("Adding background music...");try{let Ze;try{if(Ze=await Wy(re),console.log("Music data fetched, size:",Ze.byteLength),!Ze||Ze.byteLength<1e3)throw new Error("Music file appears to be invalid or too small")}catch(et){throw console.error("Music fetch error:",et),new Error("Could not access music file")}await un.writeFile("background.mp3",Ze),await un.exec(["-i","temp_output.mp4","-ss",String(be),"-i","background.mp3","-shortest","-map","0:v","-map","1:a","-c:v","copy","-c:a","aac","-b:a","192k","final_output.mp4"]);try{await un.deleteFile("background.mp3"),await un.deleteFile("temp_output.mp4")}catch(et){console.warn("Non-critical cleanup error:",et)}}catch(Ze){console.error("Music processing failed:",Ze),oe("Music processing failed, creating video without audio..."),await un.exec(["-i","temp_output.mp4","-c","copy","final_output.mp4"])}}else await un.exec(["-i","temp_output.mp4","-c","copy","final_output.mp4"]);oe("Preparing download..."),ce(95);try{const Ze=await un.readFile("final_output.mp4");ce(100);const et=await $t.createWritable();await et.write(new Blob([Ze.buffer],{type:"video/mp4"})),await et.close(),se(!1),k(!1),V(!0);try{for(const qt of pr)await un.deleteFile(qt);await un.deleteFile("final_output.mp4")}catch(qt){console.warn("Final cleanup error (non-critical):",qt)}}catch(Ze){throw console.error("Final output error:",Ze),new Error(`Failed to save video: ${Ze.message}`)}}catch($t){console.error("Export error:",$t),se(!1),k(!1),alert(`Export failed: ${$t.message}`);try{for(const Rt of tempFiles||[])await un.deleteFile(Rt).catch(()=>{})}catch{}}},Ps=async(Te,Re=!1)=>{try{console.log("Saving session to IndexedDB:",{sessionName:Te,storiesCount:i.length,hasBase64Data:i.map(Ue=>!!Ue.base64Data),firstImagePreview:i.length>0?i[0].base64Data?i[0].base64Data.substring(0,50)+"...":"Missing base64 data":"No images"}),Re||(se(!0),oe("Saving session..."),ce(10));const je={name:Te,stories:i,musicUrl:re,bpm:Z,musicStartPoint:be,imageFitMode:I,duration:d,isLoopingEnabled:ee,currentIndex:t};Re||ce(40),await UR(je),console.log(`Session "${Te}" saved successfully!`,{timestamp:new Date().toISOString(),imageCount:i.length}),Re||(ce(100),oe("Session saved successfully!"),setTimeout(()=>{se(!1),Te.startsWith("auto_save_")||alert("Session saved successfully!")},1e3))}catch(je){console.error("Error saving session to database:",je,{sessionName:Te,storiesCount:i.length}),Re||(se(!1),alert(`Failed to save session: ${je.message}`))}};return T.jsx(T.Fragment,{children:r?T.jsx(CD,{onCreateSlideshow:Mr,onLoadSession:Ii,onClose:()=>e(!1)}):T.jsx("div",{className:"app-container",children:T.jsx("div",{className:"app-content",children:T.jsxs("div",{className:"slider-container",children:[T.jsxs("div",{className:"title-bar",children:[T.jsx("h1",{className:"slider-title",children:"Groove Slider"}),T.jsx("button",{onClick:()=>e(!0),className:"projects-button",children:"back"})]}),T.jsx("audio",{ref:qe,src:re,loop:!0}),i.length===0?T.jsx(RD,{onFileUpload:On}):T.jsxs("div",{className:"story-container",onTouchStart:ss,onTouchMove:Yn,onTouchEnd:Ln,children:[T.jsx("div",{className:"story-slide",children:T.jsx("div",{className:"media-wrapper",children:T.jsxs("div",{className:"image-container",style:{position:"relative",width:"100%",height:"100%"},children:[T.jsx("button",{className:"image-fit-toggle",onClick:Te=>{Te.preventDefault(),console.log("Image fit button clicked"),R(Re=>{const je=Re==="cover"?"contain":"cover";return console.log("New image fit mode:",je),je})},children:I==="cover"?T.jsx(SS,{}):T.jsx(lS,{})}),i[t]&&i[t].url?T.jsx("img",{src:i[t].url,alt:`Slide ${t+1}`,className:"media-content",style:{objectFit:I,width:"100%",height:"100%",display:"block"},loading:"eager",onError:Te=>{console.log("Image failed to load, attempting recovery");const Re=i[t];if(Re&&Re.base64Data){const je=ut(Re.base64Data),Ue=URL.createObjectURL(je),nt=[...i];nt[t]={...Re,url:Ue},a(nt),Te.target.src=Ue}}}):T.jsx("div",{className:"empty-image-placeholder",style:{backgroundColor:"#f5f5f5",width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",color:"#333"},children:"Select an image to display"})]})})}),T.jsx(ND,{onPrevious:Sn,onNext:ft,isFirstSlide:t===0,isLastSlide:t===i.length-1}),T.jsx(xD,{currentIndex:t,totalSlides:i.length,onProgressClick:Te=>{console.log("Current Index:",t),console.log("Clicked Index:",Te),console.log("Total Stories:",i.length),n(Te)}})]}),T.jsx(DD,{audioRef:qe,onFileUpload:On,onSaveSession:()=>$(!0),onExportSession:()=>P(!0),onPlayPause:dt,isPlaying:u,duration:d,onDurationChange:p,onEdit:()=>C(!E),onMusicUpload:Or,onBPMChange:Ye,musicUrl:re,bpm:Z,onStartPointChange:Q,musicStartPoint:be,onMusicPanelToggle:()=>setShowMusicPanel(!showMusicPanel),isLoopingEnabled:ee,setIsLoopingEnabled:ye,showEditPanel:E,setShowEditPanel:C,stories:i,setStories:a,handleDelete:fr,handleReorder:jn}),E&&T.jsx(PT,{stories:i,onClose:()=>C(!E),onReorder:jn,onDelete:fr}),T.jsx(BR,{isOpen:A,progress:me,message:fe,onClose:()=>P(!1),onExport:Si,isExporting:M}),T.jsx(zR,{isOpen:W,onClose:()=>$(!1),onSave:Ps}),T.jsx(PD,{isOpen:ne,progress:me,message:fe}),T.jsx(bD,{isVisible:b,onClose:()=>V(!1)})]})})})})};function MD({installPrompt:r,onInstallClick:e}){return T.jsxs("div",{className:"app-container",children:[r&&T.jsx("button",{onClick:e,style:{position:"fixed",top:"10px",right:"10px",zIndex:1e3,padding:"10px",backgroundColor:"#007bff",color:"white",border:"none",borderRadius:"5px",cursor:"pointer"},children:"Install App"}),T.jsx(VD,{})]})}function OD(){const[r,e]=he.useState(null);he.useEffect(()=>{"serviceWorker"in navigator&&window.addEventListener("load",async()=>{try{console.log("Attempting to register service worker"),console.log("Current origin:",window.location.origin),console.log("Current pathname:",window.location.pathname);const a=await navigator.serviceWorker.register("/groove-slider-img/sw.js",{scope:"/groove-slider-img/",type:"classic"});console.log("Service Worker registered successfully:",a),console.log("Registration scope:",a.scope)}catch(a){console.error("Service Worker registration failed:",a),console.error("Full error:",JSON.stringify(a,Object.getOwnPropertyNames(a)))}});const n=a=>{a.preventDefault(),e(a)},i=a=>{console.log("App was successfully installed")};return window.addEventListener("beforeinstallprompt",n),window.addEventListener("appinstalled",i),()=>{window.removeEventListener("beforeinstallprompt",n),window.removeEventListener("appinstalled",i)}},[]);const t=async()=>{if(r){r.prompt();const{outcome:n}=await r.userChoice;console.log(n==="accepted"?"User accepted the install prompt":"User dismissed the install prompt"),e(null)}};return T.jsx(he.StrictMode,{children:T.jsx(MD,{installPrompt:r,onInstallClick:t})})}$I.createRoot(document.getElementById("root")).render(T.jsx(OD,{}));
