var m=Object.defineProperty;var A=e=>{throw TypeError(e)};var N=(e,t,r)=>t in e?m(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var n=(e,t,r)=>N(e,typeof t!="symbol"?t+"":t,r),_=(e,t,r)=>t.has(e)||A("Cannot "+r);var s=(e,t,r)=>(_(e,t,"read from private field"),r?r.call(e):t.get(e)),f=(e,t,r)=>t.has(e)?A("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,r),O=(e,t,r,i)=>(_(e,t,"write to private field"),i?i.call(e,r):t.set(e,r),r);var a;(function(e){e.LOAD="LOAD",e.EXEC="EXEC",e.FFPROBE="FFPROBE",e.WRITE_FILE="WRITE_FILE",e.READ_FILE="READ_FILE",e.DELETE_FILE="DELETE_FILE",e.RENAME="RENAME",e.CREATE_DIR="CREATE_DIR",e.LIST_DIR="LIST_DIR",e.DELETE_DIR="DELETE_DIR",e.ERROR="ERROR",e.DOWNLOAD="DOWNLOAD",e.PROGRESS="PROGRESS",e.LOG="LOG",e.MOUNT="MOUNT",e.UNMOUNT="UNMOUNT"})(a||(a={}));const U=(()=>{let e=0;return()=>e++})(),S=new Error("ffmpeg is not loaded, call `await ffmpeg.load()` first"),b=new Error("called FFmpeg.terminate()");var R,h,d,c,l,L,o;class T{constructor(){f(this,R,null);f(this,h,{});f(this,d,{});f(this,c,[]);f(this,l,[]);n(this,"loaded",!1);f(this,L,()=>{s(this,R)&&(s(this,R).onmessage=({data:{id:t,type:r,data:i}})=>{switch(r){case a.LOAD:this.loaded=!0,s(this,h)[t](i);break;case a.MOUNT:case a.UNMOUNT:case a.EXEC:case a.FFPROBE:case a.WRITE_FILE:case a.READ_FILE:case a.DELETE_FILE:case a.RENAME:case a.CREATE_DIR:case a.LIST_DIR:case a.DELETE_DIR:s(this,h)[t](i);break;case a.LOG:s(this,c).forEach(E=>E(i));break;case a.PROGRESS:s(this,l).forEach(E=>E(i));break;case a.ERROR:s(this,d)[t](i);break}delete s(this,h)[t],delete s(this,d)[t]})});f(this,o,({type:t,data:r},i=[],E)=>s(this,R)?new Promise((u,D)=>{const I=U();s(this,R)&&s(this,R).postMessage({id:I,type:t,data:r},i),s(this,h)[I]=u,s(this,d)[I]=D,E==null||E.addEventListener("abort",()=>{D(new DOMException(`Message # ${I} was aborted`,"AbortError"))},{once:!0})}):Promise.reject(S));n(this,"load",({classWorkerURL:t,...r}={},{signal:i}={})=>(s(this,R)||(O(this,R,t?new Worker(new URL(t,import.meta.url),{type:"module"}):new Worker(new URL("/groove-slider-img/assets/worker-BAOIWoxA.js",import.meta.url),{type:"module"})),s(this,L).call(this)),s(this,o).call(this,{type:a.LOAD,data:r},void 0,i)));n(this,"exec",(t,r=-1,{signal:i}={})=>s(this,o).call(this,{type:a.EXEC,data:{args:t,timeout:r}},void 0,i));n(this,"ffprobe",(t,r=-1,{signal:i}={})=>s(this,o).call(this,{type:a.FFPROBE,data:{args:t,timeout:r}},void 0,i));n(this,"terminate",()=>{const t=Object.keys(s(this,d));for(const r of t)s(this,d)[r](b),delete s(this,d)[r],delete s(this,h)[r];s(this,R)&&(s(this,R).terminate(),O(this,R,null),this.loaded=!1)});n(this,"writeFile",(t,r,{signal:i}={})=>{const E=[];return r instanceof Uint8Array&&E.push(r.buffer),s(this,o).call(this,{type:a.WRITE_FILE,data:{path:t,data:r}},E,i)});n(this,"mount",(t,r,i)=>{const E=[];return s(this,o).call(this,{type:a.MOUNT,data:{fsType:t,options:r,mountPoint:i}},E)});n(this,"unmount",t=>{const r=[];return s(this,o).call(this,{type:a.UNMOUNT,data:{mountPoint:t}},r)});n(this,"readFile",(t,r="binary",{signal:i}={})=>s(this,o).call(this,{type:a.READ_FILE,data:{path:t,encoding:r}},void 0,i));n(this,"deleteFile",(t,{signal:r}={})=>s(this,o).call(this,{type:a.DELETE_FILE,data:{path:t}},void 0,r));n(this,"rename",(t,r,{signal:i}={})=>s(this,o).call(this,{type:a.RENAME,data:{oldPath:t,newPath:r}},void 0,i));n(this,"createDir",(t,{signal:r}={})=>s(this,o).call(this,{type:a.CREATE_DIR,data:{path:t}},void 0,r));n(this,"listDir",(t,{signal:r}={})=>s(this,o).call(this,{type:a.LIST_DIR,data:{path:t}},void 0,r));n(this,"deleteDir",(t,{signal:r}={})=>s(this,o).call(this,{type:a.DELETE_DIR,data:{path:t}},void 0,r))}on(t,r){t==="log"?s(this,c).push(r):t==="progress"&&s(this,l).push(r)}off(t,r){t==="log"?O(this,c,s(this,c).filter(i=>i!==r)):t==="progress"&&O(this,l,s(this,l).filter(i=>i!==r))}}R=new WeakMap,h=new WeakMap,d=new WeakMap,c=new WeakMap,l=new WeakMap,L=new WeakMap,o=new WeakMap;var w;(function(e){e.MEMFS="MEMFS",e.NODEFS="NODEFS",e.NODERAWFS="NODERAWFS",e.IDBFS="IDBFS",e.WORKERFS="WORKERFS",e.PROXYFS="PROXYFS"})(w||(w={}));const p=e=>new Promise((t,r)=>{const i=new FileReader;i.onload=()=>{const{result:E}=i;E instanceof ArrayBuffer?t(new Uint8Array(E)):t(new Uint8Array)},i.onerror=E=>{var u,D;r(Error(`File could not be read! Code=${((D=(u=E==null?void 0:E.target)==null?void 0:u.error)==null?void 0:D.code)||-1}`))},i.readAsArrayBuffer(e)}),C=async e=>{let t;if(typeof e=="string")/data:_data\/([a-zA-Z]*);base64,([^"]*)/.test(e)?t=atob(e.split(",")[1]).split("").map(r=>r.charCodeAt(0)):t=await(await fetch(e)).arrayBuffer();else if(e instanceof URL)t=await(await fetch(e)).arrayBuffer();else if(e instanceof File||e instanceof Blob)t=await p(e);else return new Uint8Array;return new Uint8Array(t)};export{T as F,C as f};
