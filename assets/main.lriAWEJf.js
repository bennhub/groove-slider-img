import{F as VI,f as Gy}from"./ffmpeg.C6phY-E3.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const u of a.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&n(u)}).observe(document,{childList:!0,subtree:!0});function t(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(i){if(i.ep)return;i.ep=!0;const a=t(i);fetch(i.href,a)}})();var Of={exports:{}},Cl={},Ff={exports:{}},Ue={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ky;function MI(){if(Ky)return Ue;Ky=1;var r=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),u=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),p=Symbol.for("react.memo"),g=Symbol.for("react.lazy"),_=Symbol.iterator;function E(F){return F===null||typeof F!="object"?null:(F=_&&F[_]||F["@@iterator"],typeof F=="function"?F:null)}var C={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},A=Object.assign,P={};function M(F,Z,Ee){this.props=F,this.context=Z,this.refs=P,this.updater=Ee||C}M.prototype.isReactComponent={},M.prototype.setState=function(F,Z){if(typeof F!="object"&&typeof F!="function"&&F!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,F,Z,"setState")},M.prototype.forceUpdate=function(F){this.updater.enqueueForceUpdate(this,F,"forceUpdate")};function U(){}U.prototype=M.prototype;function W(F,Z,Ee){this.props=F,this.context=Z,this.refs=P,this.updater=Ee||C}var z=W.prototype=new U;z.constructor=W,A(z,M.prototype),z.isPureReactComponent=!0;var X=Array.isArray,j=Object.prototype.hasOwnProperty,$={current:null},x={key:!0,ref:!0,__self:!0,__source:!0};function I(F,Z,Ee){var Ve,me={},Be=null,te=null;if(Z!=null)for(Ve in Z.ref!==void 0&&(te=Z.ref),Z.key!==void 0&&(Be=""+Z.key),Z)j.call(Z,Ve)&&!x.hasOwnProperty(Ve)&&(me[Ve]=Z[Ve]);var q=arguments.length-2;if(q===1)me.children=Ee;else if(1<q){for(var ge=Array(q),Te=0;Te<q;Te++)ge[Te]=arguments[Te+2];me.children=ge}if(F&&F.defaultProps)for(Ve in q=F.defaultProps,q)me[Ve]===void 0&&(me[Ve]=q[Ve]);return{$$typeof:r,type:F,key:Be,ref:te,props:me,_owner:$.current}}function R(F,Z){return{$$typeof:r,type:F.type,key:Z,ref:F.ref,props:F.props,_owner:F._owner}}function b(F){return typeof F=="object"&&F!==null&&F.$$typeof===r}function D(F){var Z={"=":"=0",":":"=2"};return"$"+F.replace(/[=:]/g,function(Ee){return Z[Ee]})}var V=/\/+/g;function k(F,Z){return typeof F=="object"&&F!==null&&F.key!=null?D(""+F.key):Z.toString(36)}function ue(F,Z,Ee,Ve,me){var Be=typeof F;(Be==="undefined"||Be==="boolean")&&(F=null);var te=!1;if(F===null)te=!0;else switch(Be){case"string":case"number":te=!0;break;case"object":switch(F.$$typeof){case r:case e:te=!0}}if(te)return te=F,me=me(te),F=Ve===""?"."+k(te,0):Ve,X(me)?(Ee="",F!=null&&(Ee=F.replace(V,"$&/")+"/"),ue(me,Z,Ee,"",function(Te){return Te})):me!=null&&(b(me)&&(me=R(me,Ee+(!me.key||te&&te.key===me.key?"":(""+me.key).replace(V,"$&/")+"/")+F)),Z.push(me)),1;if(te=0,Ve=Ve===""?".":Ve+":",X(F))for(var q=0;q<F.length;q++){Be=F[q];var ge=Ve+k(Be,q);te+=ue(Be,Z,Ee,ge,me)}else if(ge=E(F),typeof ge=="function")for(F=ge.call(F),q=0;!(Be=F.next()).done;)Be=Be.value,ge=Ve+k(Be,q++),te+=ue(Be,Z,Ee,ge,me);else if(Be==="object")throw Z=String(F),Error("Objects are not valid as a React child (found: "+(Z==="[object Object]"?"object with keys {"+Object.keys(F).join(", ")+"}":Z)+"). If you meant to render a collection of children, use an array instead.");return te}function ve(F,Z,Ee){if(F==null)return F;var Ve=[],me=0;return ue(F,Ve,"","",function(Be){return Z.call(Ee,Be,me++)}),Ve}function pe(F){if(F._status===-1){var Z=F._result;Z=Z(),Z.then(function(Ee){(F._status===0||F._status===-1)&&(F._status=1,F._result=Ee)},function(Ee){(F._status===0||F._status===-1)&&(F._status=2,F._result=Ee)}),F._status===-1&&(F._status=0,F._result=Z)}if(F._status===1)return F._result.default;throw F._result}var de={current:null},ee={transition:null},ne={ReactCurrentDispatcher:de,ReactCurrentBatchConfig:ee,ReactCurrentOwner:$};function re(){throw Error("act(...) is not supported in production builds of React.")}return Ue.Children={map:ve,forEach:function(F,Z,Ee){ve(F,function(){Z.apply(this,arguments)},Ee)},count:function(F){var Z=0;return ve(F,function(){Z++}),Z},toArray:function(F){return ve(F,function(Z){return Z})||[]},only:function(F){if(!b(F))throw Error("React.Children.only expected to receive a single React element child.");return F}},Ue.Component=M,Ue.Fragment=t,Ue.Profiler=i,Ue.PureComponent=W,Ue.StrictMode=n,Ue.Suspense=d,Ue.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ne,Ue.act=re,Ue.cloneElement=function(F,Z,Ee){if(F==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+F+".");var Ve=A({},F.props),me=F.key,Be=F.ref,te=F._owner;if(Z!=null){if(Z.ref!==void 0&&(Be=Z.ref,te=$.current),Z.key!==void 0&&(me=""+Z.key),F.type&&F.type.defaultProps)var q=F.type.defaultProps;for(ge in Z)j.call(Z,ge)&&!x.hasOwnProperty(ge)&&(Ve[ge]=Z[ge]===void 0&&q!==void 0?q[ge]:Z[ge])}var ge=arguments.length-2;if(ge===1)Ve.children=Ee;else if(1<ge){q=Array(ge);for(var Te=0;Te<ge;Te++)q[Te]=arguments[Te+2];Ve.children=q}return{$$typeof:r,type:F.type,key:me,ref:Be,props:Ve,_owner:te}},Ue.createContext=function(F){return F={$$typeof:u,_currentValue:F,_currentValue2:F,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},F.Provider={$$typeof:a,_context:F},F.Consumer=F},Ue.createElement=I,Ue.createFactory=function(F){var Z=I.bind(null,F);return Z.type=F,Z},Ue.createRef=function(){return{current:null}},Ue.forwardRef=function(F){return{$$typeof:c,render:F}},Ue.isValidElement=b,Ue.lazy=function(F){return{$$typeof:g,_payload:{_status:-1,_result:F},_init:pe}},Ue.memo=function(F,Z){return{$$typeof:p,type:F,compare:Z===void 0?null:Z}},Ue.startTransition=function(F){var Z=ee.transition;ee.transition={};try{F()}finally{ee.transition=Z}},Ue.unstable_act=re,Ue.useCallback=function(F,Z){return de.current.useCallback(F,Z)},Ue.useContext=function(F){return de.current.useContext(F)},Ue.useDebugValue=function(){},Ue.useDeferredValue=function(F){return de.current.useDeferredValue(F)},Ue.useEffect=function(F,Z){return de.current.useEffect(F,Z)},Ue.useId=function(){return de.current.useId()},Ue.useImperativeHandle=function(F,Z,Ee){return de.current.useImperativeHandle(F,Z,Ee)},Ue.useInsertionEffect=function(F,Z){return de.current.useInsertionEffect(F,Z)},Ue.useLayoutEffect=function(F,Z){return de.current.useLayoutEffect(F,Z)},Ue.useMemo=function(F,Z){return de.current.useMemo(F,Z)},Ue.useReducer=function(F,Z,Ee){return de.current.useReducer(F,Z,Ee)},Ue.useRef=function(F){return de.current.useRef(F)},Ue.useState=function(F){return de.current.useState(F)},Ue.useSyncExternalStore=function(F,Z,Ee){return de.current.useSyncExternalStore(F,Z,Ee)},Ue.useTransition=function(){return de.current.useTransition()},Ue.version="18.3.1",Ue}var Hy;function Up(){return Hy||(Hy=1,Ff.exports=MI()),Ff.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Qy;function OI(){if(Qy)return Cl;Qy=1;var r=Up(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,i=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,a={key:!0,ref:!0,__self:!0,__source:!0};function u(c,d,p){var g,_={},E=null,C=null;p!==void 0&&(E=""+p),d.key!==void 0&&(E=""+d.key),d.ref!==void 0&&(C=d.ref);for(g in d)n.call(d,g)&&!a.hasOwnProperty(g)&&(_[g]=d[g]);if(c&&c.defaultProps)for(g in d=c.defaultProps,d)_[g]===void 0&&(_[g]=d[g]);return{$$typeof:e,type:c,key:E,ref:C,props:_,_owner:i.current}}return Cl.Fragment=t,Cl.jsx=u,Cl.jsxs=u,Cl}var Xy;function FI(){return Xy||(Xy=1,Of.exports=OI()),Of.exports}var T=FI(),le=Up(),Lc={},Lf={exports:{}},bn={},jf={exports:{}},Bf={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Yy;function LI(){return Yy||(Yy=1,function(r){function e(ee,ne){var re=ee.length;ee.push(ne);e:for(;0<re;){var F=re-1>>>1,Z=ee[F];if(0<i(Z,ne))ee[F]=ne,ee[re]=Z,re=F;else break e}}function t(ee){return ee.length===0?null:ee[0]}function n(ee){if(ee.length===0)return null;var ne=ee[0],re=ee.pop();if(re!==ne){ee[0]=re;e:for(var F=0,Z=ee.length,Ee=Z>>>1;F<Ee;){var Ve=2*(F+1)-1,me=ee[Ve],Be=Ve+1,te=ee[Be];if(0>i(me,re))Be<Z&&0>i(te,me)?(ee[F]=te,ee[Be]=re,F=Be):(ee[F]=me,ee[Ve]=re,F=Ve);else if(Be<Z&&0>i(te,re))ee[F]=te,ee[Be]=re,F=Be;else break e}}return ne}function i(ee,ne){var re=ee.sortIndex-ne.sortIndex;return re!==0?re:ee.id-ne.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;r.unstable_now=function(){return a.now()}}else{var u=Date,c=u.now();r.unstable_now=function(){return u.now()-c}}var d=[],p=[],g=1,_=null,E=3,C=!1,A=!1,P=!1,M=typeof setTimeout=="function"?setTimeout:null,U=typeof clearTimeout=="function"?clearTimeout:null,W=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function z(ee){for(var ne=t(p);ne!==null;){if(ne.callback===null)n(p);else if(ne.startTime<=ee)n(p),ne.sortIndex=ne.expirationTime,e(d,ne);else break;ne=t(p)}}function X(ee){if(P=!1,z(ee),!A)if(t(d)!==null)A=!0,pe(j);else{var ne=t(p);ne!==null&&de(X,ne.startTime-ee)}}function j(ee,ne){A=!1,P&&(P=!1,U(I),I=-1),C=!0;var re=E;try{for(z(ne),_=t(d);_!==null&&(!(_.expirationTime>ne)||ee&&!D());){var F=_.callback;if(typeof F=="function"){_.callback=null,E=_.priorityLevel;var Z=F(_.expirationTime<=ne);ne=r.unstable_now(),typeof Z=="function"?_.callback=Z:_===t(d)&&n(d),z(ne)}else n(d);_=t(d)}if(_!==null)var Ee=!0;else{var Ve=t(p);Ve!==null&&de(X,Ve.startTime-ne),Ee=!1}return Ee}finally{_=null,E=re,C=!1}}var $=!1,x=null,I=-1,R=5,b=-1;function D(){return!(r.unstable_now()-b<R)}function V(){if(x!==null){var ee=r.unstable_now();b=ee;var ne=!0;try{ne=x(!0,ee)}finally{ne?k():($=!1,x=null)}}else $=!1}var k;if(typeof W=="function")k=function(){W(V)};else if(typeof MessageChannel<"u"){var ue=new MessageChannel,ve=ue.port2;ue.port1.onmessage=V,k=function(){ve.postMessage(null)}}else k=function(){M(V,0)};function pe(ee){x=ee,$||($=!0,k())}function de(ee,ne){I=M(function(){ee(r.unstable_now())},ne)}r.unstable_IdlePriority=5,r.unstable_ImmediatePriority=1,r.unstable_LowPriority=4,r.unstable_NormalPriority=3,r.unstable_Profiling=null,r.unstable_UserBlockingPriority=2,r.unstable_cancelCallback=function(ee){ee.callback=null},r.unstable_continueExecution=function(){A||C||(A=!0,pe(j))},r.unstable_forceFrameRate=function(ee){0>ee||125<ee?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):R=0<ee?Math.floor(1e3/ee):5},r.unstable_getCurrentPriorityLevel=function(){return E},r.unstable_getFirstCallbackNode=function(){return t(d)},r.unstable_next=function(ee){switch(E){case 1:case 2:case 3:var ne=3;break;default:ne=E}var re=E;E=ne;try{return ee()}finally{E=re}},r.unstable_pauseExecution=function(){},r.unstable_requestPaint=function(){},r.unstable_runWithPriority=function(ee,ne){switch(ee){case 1:case 2:case 3:case 4:case 5:break;default:ee=3}var re=E;E=ee;try{return ne()}finally{E=re}},r.unstable_scheduleCallback=function(ee,ne,re){var F=r.unstable_now();switch(typeof re=="object"&&re!==null?(re=re.delay,re=typeof re=="number"&&0<re?F+re:F):re=F,ee){case 1:var Z=-1;break;case 2:Z=250;break;case 5:Z=1073741823;break;case 4:Z=1e4;break;default:Z=5e3}return Z=re+Z,ee={id:g++,callback:ne,priorityLevel:ee,startTime:re,expirationTime:Z,sortIndex:-1},re>F?(ee.sortIndex=re,e(p,ee),t(d)===null&&ee===t(p)&&(P?(U(I),I=-1):P=!0,de(X,re-F))):(ee.sortIndex=Z,e(d,ee),A||C||(A=!0,pe(j))),ee},r.unstable_shouldYield=D,r.unstable_wrapCallback=function(ee){var ne=E;return function(){var re=E;E=ne;try{return ee.apply(this,arguments)}finally{E=re}}}}(Bf)),Bf}var Zy;function jI(){return Zy||(Zy=1,jf.exports=LI()),jf.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Jy;function BI(){if(Jy)return bn;Jy=1;var r=Up(),e=jI();function t(s){for(var o="https://reactjs.org/docs/error-decoder.html?invariant="+s,l=1;l<arguments.length;l++)o+="&args[]="+encodeURIComponent(arguments[l]);return"Minified React error #"+s+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var n=new Set,i={};function a(s,o){u(s,o),u(s+"Capture",o)}function u(s,o){for(i[s]=o,s=0;s<o.length;s++)n.add(o[s])}var c=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),d=Object.prototype.hasOwnProperty,p=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,g={},_={};function E(s){return d.call(_,s)?!0:d.call(g,s)?!1:p.test(s)?_[s]=!0:(g[s]=!0,!1)}function C(s,o,l,f){if(l!==null&&l.type===0)return!1;switch(typeof o){case"function":case"symbol":return!0;case"boolean":return f?!1:l!==null?!l.acceptsBooleans:(s=s.toLowerCase().slice(0,5),s!=="data-"&&s!=="aria-");default:return!1}}function A(s,o,l,f){if(o===null||typeof o>"u"||C(s,o,l,f))return!0;if(f)return!1;if(l!==null)switch(l.type){case 3:return!o;case 4:return o===!1;case 5:return isNaN(o);case 6:return isNaN(o)||1>o}return!1}function P(s,o,l,f,m,v,S){this.acceptsBooleans=o===2||o===3||o===4,this.attributeName=f,this.attributeNamespace=m,this.mustUseProperty=l,this.propertyName=s,this.type=o,this.sanitizeURL=v,this.removeEmptyString=S}var M={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(s){M[s]=new P(s,0,!1,s,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(s){var o=s[0];M[o]=new P(o,1,!1,s[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(s){M[s]=new P(s,2,!1,s.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(s){M[s]=new P(s,2,!1,s,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(s){M[s]=new P(s,3,!1,s.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(s){M[s]=new P(s,3,!0,s,null,!1,!1)}),["capture","download"].forEach(function(s){M[s]=new P(s,4,!1,s,null,!1,!1)}),["cols","rows","size","span"].forEach(function(s){M[s]=new P(s,6,!1,s,null,!1,!1)}),["rowSpan","start"].forEach(function(s){M[s]=new P(s,5,!1,s.toLowerCase(),null,!1,!1)});var U=/[\-:]([a-z])/g;function W(s){return s[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(s){var o=s.replace(U,W);M[o]=new P(o,1,!1,s,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(s){var o=s.replace(U,W);M[o]=new P(o,1,!1,s,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(s){var o=s.replace(U,W);M[o]=new P(o,1,!1,s,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(s){M[s]=new P(s,1,!1,s.toLowerCase(),null,!1,!1)}),M.xlinkHref=new P("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(s){M[s]=new P(s,1,!1,s.toLowerCase(),null,!0,!0)});function z(s,o,l,f){var m=M.hasOwnProperty(o)?M[o]:null;(m!==null?m.type!==0:f||!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(A(o,l,m,f)&&(l=null),f||m===null?E(o)&&(l===null?s.removeAttribute(o):s.setAttribute(o,""+l)):m.mustUseProperty?s[m.propertyName]=l===null?m.type===3?!1:"":l:(o=m.attributeName,f=m.attributeNamespace,l===null?s.removeAttribute(o):(m=m.type,l=m===3||m===4&&l===!0?"":""+l,f?s.setAttributeNS(f,o,l):s.setAttribute(o,l))))}var X=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,j=Symbol.for("react.element"),$=Symbol.for("react.portal"),x=Symbol.for("react.fragment"),I=Symbol.for("react.strict_mode"),R=Symbol.for("react.profiler"),b=Symbol.for("react.provider"),D=Symbol.for("react.context"),V=Symbol.for("react.forward_ref"),k=Symbol.for("react.suspense"),ue=Symbol.for("react.suspense_list"),ve=Symbol.for("react.memo"),pe=Symbol.for("react.lazy"),de=Symbol.for("react.offscreen"),ee=Symbol.iterator;function ne(s){return s===null||typeof s!="object"?null:(s=ee&&s[ee]||s["@@iterator"],typeof s=="function"?s:null)}var re=Object.assign,F;function Z(s){if(F===void 0)try{throw Error()}catch(l){var o=l.stack.trim().match(/\n( *(at )?)/);F=o&&o[1]||""}return`
`+F+s}var Ee=!1;function Ve(s,o){if(!s||Ee)return"";Ee=!0;var l=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(o)if(o=function(){throw Error()},Object.defineProperty(o.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(o,[])}catch(Y){var f=Y}Reflect.construct(s,[],o)}else{try{o.call()}catch(Y){f=Y}s.call(o.prototype)}else{try{throw Error()}catch(Y){f=Y}s()}}catch(Y){if(Y&&f&&typeof Y.stack=="string"){for(var m=Y.stack.split(`
`),v=f.stack.split(`
`),S=m.length-1,O=v.length-1;1<=S&&0<=O&&m[S]!==v[O];)O--;for(;1<=S&&0<=O;S--,O--)if(m[S]!==v[O]){if(S!==1||O!==1)do if(S--,O--,0>O||m[S]!==v[O]){var L=`
`+m[S].replace(" at new "," at ");return s.displayName&&L.includes("<anonymous>")&&(L=L.replace("<anonymous>",s.displayName)),L}while(1<=S&&0<=O);break}}}finally{Ee=!1,Error.prepareStackTrace=l}return(s=s?s.displayName||s.name:"")?Z(s):""}function me(s){switch(s.tag){case 5:return Z(s.type);case 16:return Z("Lazy");case 13:return Z("Suspense");case 19:return Z("SuspenseList");case 0:case 2:case 15:return s=Ve(s.type,!1),s;case 11:return s=Ve(s.type.render,!1),s;case 1:return s=Ve(s.type,!0),s;default:return""}}function Be(s){if(s==null)return null;if(typeof s=="function")return s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case x:return"Fragment";case $:return"Portal";case R:return"Profiler";case I:return"StrictMode";case k:return"Suspense";case ue:return"SuspenseList"}if(typeof s=="object")switch(s.$$typeof){case D:return(s.displayName||"Context")+".Consumer";case b:return(s._context.displayName||"Context")+".Provider";case V:var o=s.render;return s=s.displayName,s||(s=o.displayName||o.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case ve:return o=s.displayName||null,o!==null?o:Be(s.type)||"Memo";case pe:o=s._payload,s=s._init;try{return Be(s(o))}catch{}}return null}function te(s){var o=s.type;switch(s.tag){case 24:return"Cache";case 9:return(o.displayName||"Context")+".Consumer";case 10:return(o._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return s=o.render,s=s.displayName||s.name||"",o.displayName||(s!==""?"ForwardRef("+s+")":"ForwardRef");case 7:return"Fragment";case 5:return o;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Be(o);case 8:return o===I?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof o=="function")return o.displayName||o.name||null;if(typeof o=="string")return o}return null}function q(s){switch(typeof s){case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function ge(s){var o=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function Te(s){var o=ge(s)?"checked":"value",l=Object.getOwnPropertyDescriptor(s.constructor.prototype,o),f=""+s[o];if(!s.hasOwnProperty(o)&&typeof l<"u"&&typeof l.get=="function"&&typeof l.set=="function"){var m=l.get,v=l.set;return Object.defineProperty(s,o,{configurable:!0,get:function(){return m.call(this)},set:function(S){f=""+S,v.call(this,S)}}),Object.defineProperty(s,o,{enumerable:l.enumerable}),{getValue:function(){return f},setValue:function(S){f=""+S},stopTracking:function(){s._valueTracker=null,delete s[o]}}}}function be(s){s._valueTracker||(s._valueTracker=Te(s))}function $e(s){if(!s)return!1;var o=s._valueTracker;if(!o)return!0;var l=o.getValue(),f="";return s&&(f=ge(s)?s.checked?"true":"false":s.value),s=f,s!==l?(o.setValue(s),!0):!1}function et(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}function Le(s,o){var l=o.checked;return re({},o,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:l??s._wrapperState.initialChecked})}function Pt(s,o){var l=o.defaultValue==null?"":o.defaultValue,f=o.checked!=null?o.checked:o.defaultChecked;l=q(o.value!=null?o.value:l),s._wrapperState={initialChecked:f,initialValue:l,controlled:o.type==="checkbox"||o.type==="radio"?o.checked!=null:o.value!=null}}function On(s,o){o=o.checked,o!=null&&z(s,"checked",o,!1)}function Yn(s,o){On(s,o);var l=q(o.value),f=o.type;if(l!=null)f==="number"?(l===0&&s.value===""||s.value!=l)&&(s.value=""+l):s.value!==""+l&&(s.value=""+l);else if(f==="submit"||f==="reset"){s.removeAttribute("value");return}o.hasOwnProperty("value")?Zn(s,o.type,l):o.hasOwnProperty("defaultValue")&&Zn(s,o.type,q(o.defaultValue)),o.checked==null&&o.defaultChecked!=null&&(s.defaultChecked=!!o.defaultChecked)}function fr(s,o,l){if(o.hasOwnProperty("value")||o.hasOwnProperty("defaultValue")){var f=o.type;if(!(f!=="submit"&&f!=="reset"||o.value!==void 0&&o.value!==null))return;o=""+s._wrapperState.initialValue,l||o===s.value||(s.value=o),s.defaultValue=o}l=s.name,l!==""&&(s.name=""),s.defaultChecked=!!s._wrapperState.initialChecked,l!==""&&(s.name=l)}function Zn(s,o,l){(o!=="number"||et(s.ownerDocument)!==s)&&(l==null?s.defaultValue=""+s._wrapperState.initialValue:s.defaultValue!==""+l&&(s.defaultValue=""+l))}var mn=Array.isArray;function gn(s,o,l,f){if(s=s.options,o){o={};for(var m=0;m<l.length;m++)o["$"+l[m]]=!0;for(l=0;l<s.length;l++)m=o.hasOwnProperty("$"+s[l].value),s[l].selected!==m&&(s[l].selected=m),m&&f&&(s[l].defaultSelected=!0)}else{for(l=""+q(l),o=null,m=0;m<s.length;m++){if(s[m].value===l){s[m].selected=!0,f&&(s[m].defaultSelected=!0);return}o!==null||s[m].disabled||(o=s[m])}o!==null&&(o.selected=!0)}}function Lr(s,o){if(o.dangerouslySetInnerHTML!=null)throw Error(t(91));return re({},o,{value:void 0,defaultValue:void 0,children:""+s._wrapperState.initialValue})}function pr(s,o){var l=o.value;if(l==null){if(l=o.children,o=o.defaultValue,l!=null){if(o!=null)throw Error(t(92));if(mn(l)){if(1<l.length)throw Error(t(93));l=l[0]}o=l}o==null&&(o=""),l=o}s._wrapperState={initialValue:q(l)}}function wt(s,o){var l=q(o.value),f=q(o.defaultValue);l!=null&&(l=""+l,l!==s.value&&(s.value=l),o.defaultValue==null&&s.defaultValue!==l&&(s.defaultValue=l)),f!=null&&(s.defaultValue=""+f)}function Fn(s){var o=s.textContent;o===s._wrapperState.initialValue&&o!==""&&o!==null&&(s.value=o)}function st(s){switch(s){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ht(s,o){return s==null||s==="http://www.w3.org/1999/xhtml"?st(o):s==="http://www.w3.org/2000/svg"&&o==="foreignObject"?"http://www.w3.org/1999/xhtml":s}var yn,jr=function(s){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(o,l,f,m){MSApp.execUnsafeLocalFunction(function(){return s(o,l,f,m)})}:s}(function(s,o){if(s.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in s)s.innerHTML=o;else{for(yn=yn||document.createElement("div"),yn.innerHTML="<svg>"+o.valueOf().toString()+"</svg>",o=yn.firstChild;s.firstChild;)s.removeChild(s.firstChild);for(;o.firstChild;)s.appendChild(o.firstChild)}});function Jn(s,o){if(o){var l=s.firstChild;if(l&&l===s.lastChild&&l.nodeType===3){l.nodeValue=o;return}}s.textContent=o}var mr={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Ln=["Webkit","ms","Moz","O"];Object.keys(mr).forEach(function(s){Ln.forEach(function(o){o=o+s.charAt(0).toUpperCase()+s.substring(1),mr[o]=mr[s]})});function gr(s,o,l){return o==null||typeof o=="boolean"||o===""?"":l||typeof o!="number"||o===0||mr.hasOwnProperty(s)&&mr[s]?(""+o).trim():o+"px"}function yr(s,o){s=s.style;for(var l in o)if(o.hasOwnProperty(l)){var f=l.indexOf("--")===0,m=gr(l,o[l],f);l==="float"&&(l="cssFloat"),f?s.setProperty(l,m):s[l]=m}}var Ii=re({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Si(s,o){if(o){if(Ii[s]&&(o.children!=null||o.dangerouslySetInnerHTML!=null))throw Error(t(137,s));if(o.dangerouslySetInnerHTML!=null){if(o.children!=null)throw Error(t(60));if(typeof o.dangerouslySetInnerHTML!="object"||!("__html"in o.dangerouslySetInnerHTML))throw Error(t(61))}if(o.style!=null&&typeof o.style!="object")throw Error(t(62))}}function Ci(s,o){if(s.indexOf("-")===-1)return typeof o.is=="string";switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var vr=null;function _e(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var xe=null,Fe=null,Ge=null;function dt(s){if(s=cl(s)){if(typeof xe!="function")throw Error(t(280));var o=s.stateNode;o&&(o=Ju(o),xe(s.stateNode,s.type,o))}}function Ct(s){Fe?Ge?Ge.push(s):Ge=[s]:Fe=s}function nn(){if(Fe){var s=Fe,o=Ge;if(Ge=Fe=null,dt(s),o)for(s=0;s<o.length;s++)dt(o[s])}}function jn(s,o){return s(o)}function ks(){}var _r=!1;function Ai(s,o,l){if(_r)return s(o,l);_r=!0;try{return jn(s,o,l)}finally{_r=!1,(Fe!==null||Ge!==null)&&(ks(),nn())}}function Et(s,o){var l=s.stateNode;if(l===null)return null;var f=Ju(l);if(f===null)return null;l=f[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(f=!f.disabled)||(s=s.type,f=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!f;break e;default:s=!1}if(s)return null;if(l&&typeof l!="function")throw Error(t(231,o,typeof l));return l}var Br=!1;if(c)try{var We={};Object.defineProperty(We,"passive",{get:function(){Br=!0}}),window.addEventListener("test",We,We),window.removeEventListener("test",We,We)}catch{Br=!1}function lt(s,o,l,f,m,v,S,O,L){var Y=Array.prototype.slice.call(arguments,3);try{o.apply(l,Y)}catch(ae){this.onError(ae)}}var $t=!1,zr=null,vn=!1,os=null,xi={onError:function(s){$t=!0,zr=s}};function So(s,o,l,f,m,v,S,O,L){$t=!1,zr=null,lt.apply(xi,arguments)}function Su(s,o,l,f,m,v,S,O,L){if(So.apply(this,arguments),$t){if($t){var Y=zr;$t=!1,zr=null}else throw Error(t(198));vn||(vn=!0,os=Y)}}function wr(s){var o=s,l=s;if(s.alternate)for(;o.return;)o=o.return;else{s=o;do o=s,o.flags&4098&&(l=o.return),s=o.return;while(s)}return o.tag===3?l:null}function Ni(s){if(s.tag===13){var o=s.memoizedState;if(o===null&&(s=s.alternate,s!==null&&(o=s.memoizedState)),o!==null)return o.dehydrated}return null}function Er(s){if(wr(s)!==s)throw Error(t(188))}function Cu(s){var o=s.alternate;if(!o){if(o=wr(s),o===null)throw Error(t(188));return o!==s?null:s}for(var l=s,f=o;;){var m=l.return;if(m===null)break;var v=m.alternate;if(v===null){if(f=m.return,f!==null){l=f;continue}break}if(m.child===v.child){for(v=m.child;v;){if(v===l)return Er(m),s;if(v===f)return Er(m),o;v=v.sibling}throw Error(t(188))}if(l.return!==f.return)l=m,f=v;else{for(var S=!1,O=m.child;O;){if(O===l){S=!0,l=m,f=v;break}if(O===f){S=!0,f=m,l=v;break}O=O.sibling}if(!S){for(O=v.child;O;){if(O===l){S=!0,l=v,f=m;break}if(O===f){S=!0,f=v,l=m;break}O=O.sibling}if(!S)throw Error(t(189))}}if(l.alternate!==f)throw Error(t(190))}if(l.tag!==3)throw Error(t(188));return l.stateNode.current===l?s:o}function qa(s){return s=Cu(s),s!==null?Co(s):null}function Co(s){if(s.tag===5||s.tag===6)return s;for(s=s.child;s!==null;){var o=Co(s);if(o!==null)return o;s=s.sibling}return null}var Ao=e.unstable_scheduleCallback,Ga=e.unstable_cancelCallback,Au=e.unstable_shouldYield,cd=e.unstable_requestPaint,ut=e.unstable_now,xu=e.unstable_getCurrentPriorityLevel,Ri=e.unstable_ImmediatePriority,bs=e.unstable_UserBlockingPriority,er=e.unstable_NormalPriority,Ka=e.unstable_LowPriority,Nu=e.unstable_IdlePriority,Pi=null,Bn=null;function Ru(s){if(Bn&&typeof Bn.onCommitFiberRoot=="function")try{Bn.onCommitFiberRoot(Pi,s,void 0,(s.current.flags&128)===128)}catch{}}var _n=Math.clz32?Math.clz32:ku,Ha=Math.log,Pu=Math.LN2;function ku(s){return s>>>=0,s===0?32:31-(Ha(s)/Pu|0)|0}var xo=64,No=4194304;function Ds(s){switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return s&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return s}}function ki(s,o){var l=s.pendingLanes;if(l===0)return 0;var f=0,m=s.suspendedLanes,v=s.pingedLanes,S=l&268435455;if(S!==0){var O=S&~m;O!==0?f=Ds(O):(v&=S,v!==0&&(f=Ds(v)))}else S=l&~m,S!==0?f=Ds(S):v!==0&&(f=Ds(v));if(f===0)return 0;if(o!==0&&o!==f&&!(o&m)&&(m=f&-f,v=o&-o,m>=v||m===16&&(v&4194240)!==0))return o;if(f&4&&(f|=l&16),o=s.entangledLanes,o!==0)for(s=s.entanglements,o&=f;0<o;)l=31-_n(o),m=1<<l,f|=s[l],o&=~m;return f}function hd(s,o){switch(s){case 1:case 2:case 4:return o+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function as(s,o){for(var l=s.suspendedLanes,f=s.pingedLanes,m=s.expirationTimes,v=s.pendingLanes;0<v;){var S=31-_n(v),O=1<<S,L=m[S];L===-1?(!(O&l)||O&f)&&(m[S]=hd(O,o)):L<=o&&(s.expiredLanes|=O),v&=~O}}function zn(s){return s=s.pendingLanes&-1073741825,s!==0?s:s&1073741824?1073741824:0}function bi(){var s=xo;return xo<<=1,!(xo&4194240)&&(xo=64),s}function Vs(s){for(var o=[],l=0;31>l;l++)o.push(s);return o}function Ms(s,o,l){s.pendingLanes|=o,o!==536870912&&(s.suspendedLanes=0,s.pingedLanes=0),s=s.eventTimes,o=31-_n(o),s[o]=l}function ot(s,o){var l=s.pendingLanes&~o;s.pendingLanes=o,s.suspendedLanes=0,s.pingedLanes=0,s.expiredLanes&=o,s.mutableReadLanes&=o,s.entangledLanes&=o,o=s.entanglements;var f=s.eventTimes;for(s=s.expirationTimes;0<l;){var m=31-_n(l),v=1<<m;o[m]=0,f[m]=-1,s[m]=-1,l&=~v}}function Os(s,o){var l=s.entangledLanes|=o;for(s=s.entanglements;l;){var f=31-_n(l),m=1<<f;m&o|s[f]&o&&(s[f]|=o),l&=~m}}var Ke=0;function Fs(s){return s&=-s,1<s?4<s?s&268435455?16:536870912:4:1}var bu,Ro,Du,Vu,Mu,Qa=!1,Ur=[],Yt=null,Tr=null,Ir=null,Ls=new Map,tr=new Map,$r=[],dd="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Ou(s,o){switch(s){case"focusin":case"focusout":Yt=null;break;case"dragenter":case"dragleave":Tr=null;break;case"mouseover":case"mouseout":Ir=null;break;case"pointerover":case"pointerout":Ls.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":tr.delete(o.pointerId)}}function Cn(s,o,l,f,m,v){return s===null||s.nativeEvent!==v?(s={blockedOn:o,domEventName:l,eventSystemFlags:f,nativeEvent:v,targetContainers:[m]},o!==null&&(o=cl(o),o!==null&&Ro(o)),s):(s.eventSystemFlags|=f,o=s.targetContainers,m!==null&&o.indexOf(m)===-1&&o.push(m),s)}function fd(s,o,l,f,m){switch(o){case"focusin":return Yt=Cn(Yt,s,o,l,f,m),!0;case"dragenter":return Tr=Cn(Tr,s,o,l,f,m),!0;case"mouseover":return Ir=Cn(Ir,s,o,l,f,m),!0;case"pointerover":var v=m.pointerId;return Ls.set(v,Cn(Ls.get(v)||null,s,o,l,f,m)),!0;case"gotpointercapture":return v=m.pointerId,tr.set(v,Cn(tr.get(v)||null,s,o,l,f,m)),!0}return!1}function Fu(s){var o=Fi(s.target);if(o!==null){var l=wr(o);if(l!==null){if(o=l.tag,o===13){if(o=Ni(l),o!==null){s.blockedOn=o,Mu(s.priority,function(){Du(l)});return}}else if(o===3&&l.stateNode.current.memoizedState.isDehydrated){s.blockedOn=l.tag===3?l.stateNode.containerInfo:null;return}}}s.blockedOn=null}function ls(s){if(s.blockedOn!==null)return!1;for(var o=s.targetContainers;0<o.length;){var l=Po(s.domEventName,s.eventSystemFlags,o[0],s.nativeEvent);if(l===null){l=s.nativeEvent;var f=new l.constructor(l.type,l);vr=f,l.target.dispatchEvent(f),vr=null}else return o=cl(l),o!==null&&Ro(o),s.blockedOn=l,!1;o.shift()}return!0}function Di(s,o,l){ls(s)&&l.delete(o)}function Lu(){Qa=!1,Yt!==null&&ls(Yt)&&(Yt=null),Tr!==null&&ls(Tr)&&(Tr=null),Ir!==null&&ls(Ir)&&(Ir=null),Ls.forEach(Di),tr.forEach(Di)}function Sr(s,o){s.blockedOn===o&&(s.blockedOn=null,Qa||(Qa=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,Lu)))}function Cr(s){function o(m){return Sr(m,s)}if(0<Ur.length){Sr(Ur[0],s);for(var l=1;l<Ur.length;l++){var f=Ur[l];f.blockedOn===s&&(f.blockedOn=null)}}for(Yt!==null&&Sr(Yt,s),Tr!==null&&Sr(Tr,s),Ir!==null&&Sr(Ir,s),Ls.forEach(o),tr.forEach(o),l=0;l<$r.length;l++)f=$r[l],f.blockedOn===s&&(f.blockedOn=null);for(;0<$r.length&&(l=$r[0],l.blockedOn===null);)Fu(l),l.blockedOn===null&&$r.shift()}var us=X.ReactCurrentBatchConfig,js=!0;function gt(s,o,l,f){var m=Ke,v=us.transition;us.transition=null;try{Ke=1,Xa(s,o,l,f)}finally{Ke=m,us.transition=v}}function pd(s,o,l,f){var m=Ke,v=us.transition;us.transition=null;try{Ke=4,Xa(s,o,l,f)}finally{Ke=m,us.transition=v}}function Xa(s,o,l,f){if(js){var m=Po(s,o,l,f);if(m===null)Cd(s,o,f,Vi,l),Ou(s,f);else if(fd(m,s,o,l,f))f.stopPropagation();else if(Ou(s,f),o&4&&-1<dd.indexOf(s)){for(;m!==null;){var v=cl(m);if(v!==null&&bu(v),v=Po(s,o,l,f),v===null&&Cd(s,o,f,Vi,l),v===m)break;m=v}m!==null&&f.stopPropagation()}else Cd(s,o,f,null,l)}}var Vi=null;function Po(s,o,l,f){if(Vi=null,s=_e(f),s=Fi(s),s!==null)if(o=wr(s),o===null)s=null;else if(l=o.tag,l===13){if(s=Ni(o),s!==null)return s;s=null}else if(l===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;s=null}else o!==s&&(s=null);return Vi=s,null}function Ya(s){switch(s){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(xu()){case Ri:return 1;case bs:return 4;case er:case Ka:return 16;case Nu:return 536870912;default:return 16}default:return 16}}var Un=null,ko=null,An=null;function Za(){if(An)return An;var s,o=ko,l=o.length,f,m="value"in Un?Un.value:Un.textContent,v=m.length;for(s=0;s<l&&o[s]===m[s];s++);var S=l-s;for(f=1;f<=S&&o[l-f]===m[v-f];f++);return An=m.slice(s,1<f?1-f:void 0)}function bo(s){var o=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&o===13&&(s=13)):s=o,s===10&&(s=13),32<=s||s===13?s:0}function Wr(){return!0}function Ja(){return!1}function Zt(s){function o(l,f,m,v,S){this._reactName=l,this._targetInst=m,this.type=f,this.nativeEvent=v,this.target=S,this.currentTarget=null;for(var O in s)s.hasOwnProperty(O)&&(l=s[O],this[O]=l?l(v):v[O]);return this.isDefaultPrevented=(v.defaultPrevented!=null?v.defaultPrevented:v.returnValue===!1)?Wr:Ja,this.isPropagationStopped=Ja,this}return re(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var l=this.nativeEvent;l&&(l.preventDefault?l.preventDefault():typeof l.returnValue!="unknown"&&(l.returnValue=!1),this.isDefaultPrevented=Wr)},stopPropagation:function(){var l=this.nativeEvent;l&&(l.stopPropagation?l.stopPropagation():typeof l.cancelBubble!="unknown"&&(l.cancelBubble=!0),this.isPropagationStopped=Wr)},persist:function(){},isPersistent:Wr}),o}var Ar={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Do=Zt(Ar),qr=re({},Ar,{view:0,detail:0}),md=Zt(qr),Vo,cs,Bs,Mi=re({},qr,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Gr,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==Bs&&(Bs&&s.type==="mousemove"?(Vo=s.screenX-Bs.screenX,cs=s.screenY-Bs.screenY):cs=Vo=0,Bs=s),Vo)},movementY:function(s){return"movementY"in s?s.movementY:cs}}),Mo=Zt(Mi),el=re({},Mi,{dataTransfer:0}),ju=Zt(el),Oo=re({},qr,{relatedTarget:0}),Fo=Zt(Oo),Bu=re({},Ar,{animationName:0,elapsedTime:0,pseudoElement:0}),hs=Zt(Bu),zu=re({},Ar,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),Uu=Zt(zu),$u=re({},Ar,{data:0}),tl=Zt($u),Lo={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},wn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Wu={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function qu(s){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(s):(s=Wu[s])?!!o[s]:!1}function Gr(){return qu}var h=re({},qr,{key:function(s){if(s.key){var o=Lo[s.key]||s.key;if(o!=="Unidentified")return o}return s.type==="keypress"?(s=bo(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?wn[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Gr,charCode:function(s){return s.type==="keypress"?bo(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?bo(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),y=Zt(h),w=re({},Mi,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),N=Zt(w),K=re({},qr,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Gr}),J=Zt(K),fe=re({},Ar,{propertyName:0,elapsedTime:0,pseudoElement:0}),nt=Zt(fe),jt=re({},Mi,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),Qe=Zt(jt),Wt=[9,13,27,32],Ot=c&&"CompositionEvent"in window,nr=null;c&&"documentMode"in document&&(nr=document.documentMode);var $n=c&&"TextEvent"in window&&!nr,Oi=c&&(!Ot||nr&&8<nr&&11>=nr),jo=" ",Bm=!1;function zm(s,o){switch(s){case"keyup":return Wt.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Um(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var Bo=!1;function kT(s,o){switch(s){case"compositionend":return Um(o);case"keypress":return o.which!==32?null:(Bm=!0,jo);case"textInput":return s=o.data,s===jo&&Bm?null:s;default:return null}}function bT(s,o){if(Bo)return s==="compositionend"||!Ot&&zm(s,o)?(s=Za(),An=ko=Un=null,Bo=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return Oi&&o.locale!=="ko"?null:o.data;default:return null}}var DT={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function $m(s){var o=s&&s.nodeName&&s.nodeName.toLowerCase();return o==="input"?!!DT[s.type]:o==="textarea"}function Wm(s,o,l,f){Ct(f),o=Xu(o,"onChange"),0<o.length&&(l=new Do("onChange","change",null,l,f),s.push({event:l,listeners:o}))}var nl=null,rl=null;function VT(s){lg(s,0)}function Gu(s){var o=qo(s);if($e(o))return s}function MT(s,o){if(s==="change")return o}var qm=!1;if(c){var gd;if(c){var yd="oninput"in document;if(!yd){var Gm=document.createElement("div");Gm.setAttribute("oninput","return;"),yd=typeof Gm.oninput=="function"}gd=yd}else gd=!1;qm=gd&&(!document.documentMode||9<document.documentMode)}function Km(){nl&&(nl.detachEvent("onpropertychange",Hm),rl=nl=null)}function Hm(s){if(s.propertyName==="value"&&Gu(rl)){var o=[];Wm(o,rl,s,_e(s)),Ai(VT,o)}}function OT(s,o,l){s==="focusin"?(Km(),nl=o,rl=l,nl.attachEvent("onpropertychange",Hm)):s==="focusout"&&Km()}function FT(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return Gu(rl)}function LT(s,o){if(s==="click")return Gu(o)}function jT(s,o){if(s==="input"||s==="change")return Gu(o)}function BT(s,o){return s===o&&(s!==0||1/s===1/o)||s!==s&&o!==o}var xr=typeof Object.is=="function"?Object.is:BT;function sl(s,o){if(xr(s,o))return!0;if(typeof s!="object"||s===null||typeof o!="object"||o===null)return!1;var l=Object.keys(s),f=Object.keys(o);if(l.length!==f.length)return!1;for(f=0;f<l.length;f++){var m=l[f];if(!d.call(o,m)||!xr(s[m],o[m]))return!1}return!0}function Qm(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function Xm(s,o){var l=Qm(s);s=0;for(var f;l;){if(l.nodeType===3){if(f=s+l.textContent.length,s<=o&&f>=o)return{node:l,offset:o-s};s=f}e:{for(;l;){if(l.nextSibling){l=l.nextSibling;break e}l=l.parentNode}l=void 0}l=Qm(l)}}function Ym(s,o){return s&&o?s===o?!0:s&&s.nodeType===3?!1:o&&o.nodeType===3?Ym(s,o.parentNode):"contains"in s?s.contains(o):s.compareDocumentPosition?!!(s.compareDocumentPosition(o)&16):!1:!1}function Zm(){for(var s=window,o=et();o instanceof s.HTMLIFrameElement;){try{var l=typeof o.contentWindow.location.href=="string"}catch{l=!1}if(l)s=o.contentWindow;else break;o=et(s.document)}return o}function vd(s){var o=s&&s.nodeName&&s.nodeName.toLowerCase();return o&&(o==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||o==="textarea"||s.contentEditable==="true")}function zT(s){var o=Zm(),l=s.focusedElem,f=s.selectionRange;if(o!==l&&l&&l.ownerDocument&&Ym(l.ownerDocument.documentElement,l)){if(f!==null&&vd(l)){if(o=f.start,s=f.end,s===void 0&&(s=o),"selectionStart"in l)l.selectionStart=o,l.selectionEnd=Math.min(s,l.value.length);else if(s=(o=l.ownerDocument||document)&&o.defaultView||window,s.getSelection){s=s.getSelection();var m=l.textContent.length,v=Math.min(f.start,m);f=f.end===void 0?v:Math.min(f.end,m),!s.extend&&v>f&&(m=f,f=v,v=m),m=Xm(l,v);var S=Xm(l,f);m&&S&&(s.rangeCount!==1||s.anchorNode!==m.node||s.anchorOffset!==m.offset||s.focusNode!==S.node||s.focusOffset!==S.offset)&&(o=o.createRange(),o.setStart(m.node,m.offset),s.removeAllRanges(),v>f?(s.addRange(o),s.extend(S.node,S.offset)):(o.setEnd(S.node,S.offset),s.addRange(o)))}}for(o=[],s=l;s=s.parentNode;)s.nodeType===1&&o.push({element:s,left:s.scrollLeft,top:s.scrollTop});for(typeof l.focus=="function"&&l.focus(),l=0;l<o.length;l++)s=o[l],s.element.scrollLeft=s.left,s.element.scrollTop=s.top}}var UT=c&&"documentMode"in document&&11>=document.documentMode,zo=null,_d=null,il=null,wd=!1;function Jm(s,o,l){var f=l.window===l?l.document:l.nodeType===9?l:l.ownerDocument;wd||zo==null||zo!==et(f)||(f=zo,"selectionStart"in f&&vd(f)?f={start:f.selectionStart,end:f.selectionEnd}:(f=(f.ownerDocument&&f.ownerDocument.defaultView||window).getSelection(),f={anchorNode:f.anchorNode,anchorOffset:f.anchorOffset,focusNode:f.focusNode,focusOffset:f.focusOffset}),il&&sl(il,f)||(il=f,f=Xu(_d,"onSelect"),0<f.length&&(o=new Do("onSelect","select",null,o,l),s.push({event:o,listeners:f}),o.target=zo)))}function Ku(s,o){var l={};return l[s.toLowerCase()]=o.toLowerCase(),l["Webkit"+s]="webkit"+o,l["Moz"+s]="moz"+o,l}var Uo={animationend:Ku("Animation","AnimationEnd"),animationiteration:Ku("Animation","AnimationIteration"),animationstart:Ku("Animation","AnimationStart"),transitionend:Ku("Transition","TransitionEnd")},Ed={},eg={};c&&(eg=document.createElement("div").style,"AnimationEvent"in window||(delete Uo.animationend.animation,delete Uo.animationiteration.animation,delete Uo.animationstart.animation),"TransitionEvent"in window||delete Uo.transitionend.transition);function Hu(s){if(Ed[s])return Ed[s];if(!Uo[s])return s;var o=Uo[s],l;for(l in o)if(o.hasOwnProperty(l)&&l in eg)return Ed[s]=o[l];return s}var tg=Hu("animationend"),ng=Hu("animationiteration"),rg=Hu("animationstart"),sg=Hu("transitionend"),ig=new Map,og="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function zs(s,o){ig.set(s,o),a(o,[s])}for(var Td=0;Td<og.length;Td++){var Id=og[Td],$T=Id.toLowerCase(),WT=Id[0].toUpperCase()+Id.slice(1);zs($T,"on"+WT)}zs(tg,"onAnimationEnd"),zs(ng,"onAnimationIteration"),zs(rg,"onAnimationStart"),zs("dblclick","onDoubleClick"),zs("focusin","onFocus"),zs("focusout","onBlur"),zs(sg,"onTransitionEnd"),u("onMouseEnter",["mouseout","mouseover"]),u("onMouseLeave",["mouseout","mouseover"]),u("onPointerEnter",["pointerout","pointerover"]),u("onPointerLeave",["pointerout","pointerover"]),a("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),a("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),a("onBeforeInput",["compositionend","keypress","textInput","paste"]),a("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ol="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),qT=new Set("cancel close invalid load scroll toggle".split(" ").concat(ol));function ag(s,o,l){var f=s.type||"unknown-event";s.currentTarget=l,Su(f,o,void 0,s),s.currentTarget=null}function lg(s,o){o=(o&4)!==0;for(var l=0;l<s.length;l++){var f=s[l],m=f.event;f=f.listeners;e:{var v=void 0;if(o)for(var S=f.length-1;0<=S;S--){var O=f[S],L=O.instance,Y=O.currentTarget;if(O=O.listener,L!==v&&m.isPropagationStopped())break e;ag(m,O,Y),v=L}else for(S=0;S<f.length;S++){if(O=f[S],L=O.instance,Y=O.currentTarget,O=O.listener,L!==v&&m.isPropagationStopped())break e;ag(m,O,Y),v=L}}}if(vn)throw s=os,vn=!1,os=null,s}function ft(s,o){var l=o[kd];l===void 0&&(l=o[kd]=new Set);var f=s+"__bubble";l.has(f)||(ug(o,s,2,!1),l.add(f))}function Sd(s,o,l){var f=0;o&&(f|=4),ug(l,s,f,o)}var Qu="_reactListening"+Math.random().toString(36).slice(2);function al(s){if(!s[Qu]){s[Qu]=!0,n.forEach(function(l){l!=="selectionchange"&&(qT.has(l)||Sd(l,!1,s),Sd(l,!0,s))});var o=s.nodeType===9?s:s.ownerDocument;o===null||o[Qu]||(o[Qu]=!0,Sd("selectionchange",!1,o))}}function ug(s,o,l,f){switch(Ya(o)){case 1:var m=gt;break;case 4:m=pd;break;default:m=Xa}l=m.bind(null,o,l,s),m=void 0,!Br||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(m=!0),f?m!==void 0?s.addEventListener(o,l,{capture:!0,passive:m}):s.addEventListener(o,l,!0):m!==void 0?s.addEventListener(o,l,{passive:m}):s.addEventListener(o,l,!1)}function Cd(s,o,l,f,m){var v=f;if(!(o&1)&&!(o&2)&&f!==null)e:for(;;){if(f===null)return;var S=f.tag;if(S===3||S===4){var O=f.stateNode.containerInfo;if(O===m||O.nodeType===8&&O.parentNode===m)break;if(S===4)for(S=f.return;S!==null;){var L=S.tag;if((L===3||L===4)&&(L=S.stateNode.containerInfo,L===m||L.nodeType===8&&L.parentNode===m))return;S=S.return}for(;O!==null;){if(S=Fi(O),S===null)return;if(L=S.tag,L===5||L===6){f=v=S;continue e}O=O.parentNode}}f=f.return}Ai(function(){var Y=v,ae=_e(l),ce=[];e:{var ie=ig.get(s);if(ie!==void 0){var we=Do,Se=s;switch(s){case"keypress":if(bo(l)===0)break e;case"keydown":case"keyup":we=y;break;case"focusin":Se="focus",we=Fo;break;case"focusout":Se="blur",we=Fo;break;case"beforeblur":case"afterblur":we=Fo;break;case"click":if(l.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":we=Mo;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":we=ju;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":we=J;break;case tg:case ng:case rg:we=hs;break;case sg:we=nt;break;case"scroll":we=md;break;case"wheel":we=Qe;break;case"copy":case"cut":case"paste":we=Uu;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":we=N}var Ne=(o&4)!==0,kt=!Ne&&s==="scroll",H=Ne?ie!==null?ie+"Capture":null:ie;Ne=[];for(var B=Y,Q;B!==null;){Q=B;var he=Q.stateNode;if(Q.tag===5&&he!==null&&(Q=he,H!==null&&(he=Et(B,H),he!=null&&Ne.push(ll(B,he,Q)))),kt)break;B=B.return}0<Ne.length&&(ie=new we(ie,Se,null,l,ae),ce.push({event:ie,listeners:Ne}))}}if(!(o&7)){e:{if(ie=s==="mouseover"||s==="pointerover",we=s==="mouseout"||s==="pointerout",ie&&l!==vr&&(Se=l.relatedTarget||l.fromElement)&&(Fi(Se)||Se[ds]))break e;if((we||ie)&&(ie=ae.window===ae?ae:(ie=ae.ownerDocument)?ie.defaultView||ie.parentWindow:window,we?(Se=l.relatedTarget||l.toElement,we=Y,Se=Se?Fi(Se):null,Se!==null&&(kt=wr(Se),Se!==kt||Se.tag!==5&&Se.tag!==6)&&(Se=null)):(we=null,Se=Y),we!==Se)){if(Ne=Mo,he="onMouseLeave",H="onMouseEnter",B="mouse",(s==="pointerout"||s==="pointerover")&&(Ne=N,he="onPointerLeave",H="onPointerEnter",B="pointer"),kt=we==null?ie:qo(we),Q=Se==null?ie:qo(Se),ie=new Ne(he,B+"leave",we,l,ae),ie.target=kt,ie.relatedTarget=Q,he=null,Fi(ae)===Y&&(Ne=new Ne(H,B+"enter",Se,l,ae),Ne.target=Q,Ne.relatedTarget=kt,he=Ne),kt=he,we&&Se)t:{for(Ne=we,H=Se,B=0,Q=Ne;Q;Q=$o(Q))B++;for(Q=0,he=H;he;he=$o(he))Q++;for(;0<B-Q;)Ne=$o(Ne),B--;for(;0<Q-B;)H=$o(H),Q--;for(;B--;){if(Ne===H||H!==null&&Ne===H.alternate)break t;Ne=$o(Ne),H=$o(H)}Ne=null}else Ne=null;we!==null&&cg(ce,ie,we,Ne,!1),Se!==null&&kt!==null&&cg(ce,kt,Se,Ne,!0)}}e:{if(ie=Y?qo(Y):window,we=ie.nodeName&&ie.nodeName.toLowerCase(),we==="select"||we==="input"&&ie.type==="file")var Pe=MT;else if($m(ie))if(qm)Pe=jT;else{Pe=FT;var Me=OT}else(we=ie.nodeName)&&we.toLowerCase()==="input"&&(ie.type==="checkbox"||ie.type==="radio")&&(Pe=LT);if(Pe&&(Pe=Pe(s,Y))){Wm(ce,Pe,l,ae);break e}Me&&Me(s,ie,Y),s==="focusout"&&(Me=ie._wrapperState)&&Me.controlled&&ie.type==="number"&&Zn(ie,"number",ie.value)}switch(Me=Y?qo(Y):window,s){case"focusin":($m(Me)||Me.contentEditable==="true")&&(zo=Me,_d=Y,il=null);break;case"focusout":il=_d=zo=null;break;case"mousedown":wd=!0;break;case"contextmenu":case"mouseup":case"dragend":wd=!1,Jm(ce,l,ae);break;case"selectionchange":if(UT)break;case"keydown":case"keyup":Jm(ce,l,ae)}var Oe;if(Ot)e:{switch(s){case"compositionstart":var je="onCompositionStart";break e;case"compositionend":je="onCompositionEnd";break e;case"compositionupdate":je="onCompositionUpdate";break e}je=void 0}else Bo?zm(s,l)&&(je="onCompositionEnd"):s==="keydown"&&l.keyCode===229&&(je="onCompositionStart");je&&(Oi&&l.locale!=="ko"&&(Bo||je!=="onCompositionStart"?je==="onCompositionEnd"&&Bo&&(Oe=Za()):(Un=ae,ko="value"in Un?Un.value:Un.textContent,Bo=!0)),Me=Xu(Y,je),0<Me.length&&(je=new tl(je,s,null,l,ae),ce.push({event:je,listeners:Me}),Oe?je.data=Oe:(Oe=Um(l),Oe!==null&&(je.data=Oe)))),(Oe=$n?kT(s,l):bT(s,l))&&(Y=Xu(Y,"onBeforeInput"),0<Y.length&&(ae=new tl("onBeforeInput","beforeinput",null,l,ae),ce.push({event:ae,listeners:Y}),ae.data=Oe))}lg(ce,o)})}function ll(s,o,l){return{instance:s,listener:o,currentTarget:l}}function Xu(s,o){for(var l=o+"Capture",f=[];s!==null;){var m=s,v=m.stateNode;m.tag===5&&v!==null&&(m=v,v=Et(s,l),v!=null&&f.unshift(ll(s,v,m)),v=Et(s,o),v!=null&&f.push(ll(s,v,m))),s=s.return}return f}function $o(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5);return s||null}function cg(s,o,l,f,m){for(var v=o._reactName,S=[];l!==null&&l!==f;){var O=l,L=O.alternate,Y=O.stateNode;if(L!==null&&L===f)break;O.tag===5&&Y!==null&&(O=Y,m?(L=Et(l,v),L!=null&&S.unshift(ll(l,L,O))):m||(L=Et(l,v),L!=null&&S.push(ll(l,L,O)))),l=l.return}S.length!==0&&s.push({event:o,listeners:S})}var GT=/\r\n?/g,KT=/\u0000|\uFFFD/g;function hg(s){return(typeof s=="string"?s:""+s).replace(GT,`
`).replace(KT,"")}function Yu(s,o,l){if(o=hg(o),hg(s)!==o&&l)throw Error(t(425))}function Zu(){}var Ad=null,xd=null;function Nd(s,o){return s==="textarea"||s==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var Rd=typeof setTimeout=="function"?setTimeout:void 0,HT=typeof clearTimeout=="function"?clearTimeout:void 0,dg=typeof Promise=="function"?Promise:void 0,QT=typeof queueMicrotask=="function"?queueMicrotask:typeof dg<"u"?function(s){return dg.resolve(null).then(s).catch(XT)}:Rd;function XT(s){setTimeout(function(){throw s})}function Pd(s,o){var l=o,f=0;do{var m=l.nextSibling;if(s.removeChild(l),m&&m.nodeType===8)if(l=m.data,l==="/$"){if(f===0){s.removeChild(m),Cr(o);return}f--}else l!=="$"&&l!=="$?"&&l!=="$!"||f++;l=m}while(l);Cr(o)}function Us(s){for(;s!=null;s=s.nextSibling){var o=s.nodeType;if(o===1||o===3)break;if(o===8){if(o=s.data,o==="$"||o==="$!"||o==="$?")break;if(o==="/$")return null}}return s}function fg(s){s=s.previousSibling;for(var o=0;s;){if(s.nodeType===8){var l=s.data;if(l==="$"||l==="$!"||l==="$?"){if(o===0)return s;o--}else l==="/$"&&o++}s=s.previousSibling}return null}var Wo=Math.random().toString(36).slice(2),Kr="__reactFiber$"+Wo,ul="__reactProps$"+Wo,ds="__reactContainer$"+Wo,kd="__reactEvents$"+Wo,YT="__reactListeners$"+Wo,ZT="__reactHandles$"+Wo;function Fi(s){var o=s[Kr];if(o)return o;for(var l=s.parentNode;l;){if(o=l[ds]||l[Kr]){if(l=o.alternate,o.child!==null||l!==null&&l.child!==null)for(s=fg(s);s!==null;){if(l=s[Kr])return l;s=fg(s)}return o}s=l,l=s.parentNode}return null}function cl(s){return s=s[Kr]||s[ds],!s||s.tag!==5&&s.tag!==6&&s.tag!==13&&s.tag!==3?null:s}function qo(s){if(s.tag===5||s.tag===6)return s.stateNode;throw Error(t(33))}function Ju(s){return s[ul]||null}var bd=[],Go=-1;function $s(s){return{current:s}}function pt(s){0>Go||(s.current=bd[Go],bd[Go]=null,Go--)}function ct(s,o){Go++,bd[Go]=s.current,s.current=o}var Ws={},rn=$s(Ws),xn=$s(!1),Li=Ws;function Ko(s,o){var l=s.type.contextTypes;if(!l)return Ws;var f=s.stateNode;if(f&&f.__reactInternalMemoizedUnmaskedChildContext===o)return f.__reactInternalMemoizedMaskedChildContext;var m={},v;for(v in l)m[v]=o[v];return f&&(s=s.stateNode,s.__reactInternalMemoizedUnmaskedChildContext=o,s.__reactInternalMemoizedMaskedChildContext=m),m}function Nn(s){return s=s.childContextTypes,s!=null}function ec(){pt(xn),pt(rn)}function pg(s,o,l){if(rn.current!==Ws)throw Error(t(168));ct(rn,o),ct(xn,l)}function mg(s,o,l){var f=s.stateNode;if(o=o.childContextTypes,typeof f.getChildContext!="function")return l;f=f.getChildContext();for(var m in f)if(!(m in o))throw Error(t(108,te(s)||"Unknown",m));return re({},l,f)}function tc(s){return s=(s=s.stateNode)&&s.__reactInternalMemoizedMergedChildContext||Ws,Li=rn.current,ct(rn,s),ct(xn,xn.current),!0}function gg(s,o,l){var f=s.stateNode;if(!f)throw Error(t(169));l?(s=mg(s,o,Li),f.__reactInternalMemoizedMergedChildContext=s,pt(xn),pt(rn),ct(rn,s)):pt(xn),ct(xn,l)}var fs=null,nc=!1,Dd=!1;function yg(s){fs===null?fs=[s]:fs.push(s)}function JT(s){nc=!0,yg(s)}function qs(){if(!Dd&&fs!==null){Dd=!0;var s=0,o=Ke;try{var l=fs;for(Ke=1;s<l.length;s++){var f=l[s];do f=f(!0);while(f!==null)}fs=null,nc=!1}catch(m){throw fs!==null&&(fs=fs.slice(s+1)),Ao(Ri,qs),m}finally{Ke=o,Dd=!1}}return null}var Ho=[],Qo=0,rc=null,sc=0,rr=[],sr=0,ji=null,ps=1,ms="";function Bi(s,o){Ho[Qo++]=sc,Ho[Qo++]=rc,rc=s,sc=o}function vg(s,o,l){rr[sr++]=ps,rr[sr++]=ms,rr[sr++]=ji,ji=s;var f=ps;s=ms;var m=32-_n(f)-1;f&=~(1<<m),l+=1;var v=32-_n(o)+m;if(30<v){var S=m-m%5;v=(f&(1<<S)-1).toString(32),f>>=S,m-=S,ps=1<<32-_n(o)+m|l<<m|f,ms=v+s}else ps=1<<v|l<<m|f,ms=s}function Vd(s){s.return!==null&&(Bi(s,1),vg(s,1,0))}function Md(s){for(;s===rc;)rc=Ho[--Qo],Ho[Qo]=null,sc=Ho[--Qo],Ho[Qo]=null;for(;s===ji;)ji=rr[--sr],rr[sr]=null,ms=rr[--sr],rr[sr]=null,ps=rr[--sr],rr[sr]=null}var Wn=null,qn=null,yt=!1,Nr=null;function _g(s,o){var l=lr(5,null,null,0);l.elementType="DELETED",l.stateNode=o,l.return=s,o=s.deletions,o===null?(s.deletions=[l],s.flags|=16):o.push(l)}function wg(s,o){switch(s.tag){case 5:var l=s.type;return o=o.nodeType!==1||l.toLowerCase()!==o.nodeName.toLowerCase()?null:o,o!==null?(s.stateNode=o,Wn=s,qn=Us(o.firstChild),!0):!1;case 6:return o=s.pendingProps===""||o.nodeType!==3?null:o,o!==null?(s.stateNode=o,Wn=s,qn=null,!0):!1;case 13:return o=o.nodeType!==8?null:o,o!==null?(l=ji!==null?{id:ps,overflow:ms}:null,s.memoizedState={dehydrated:o,treeContext:l,retryLane:1073741824},l=lr(18,null,null,0),l.stateNode=o,l.return=s,s.child=l,Wn=s,qn=null,!0):!1;default:return!1}}function Od(s){return(s.mode&1)!==0&&(s.flags&128)===0}function Fd(s){if(yt){var o=qn;if(o){var l=o;if(!wg(s,o)){if(Od(s))throw Error(t(418));o=Us(l.nextSibling);var f=Wn;o&&wg(s,o)?_g(f,l):(s.flags=s.flags&-4097|2,yt=!1,Wn=s)}}else{if(Od(s))throw Error(t(418));s.flags=s.flags&-4097|2,yt=!1,Wn=s}}}function Eg(s){for(s=s.return;s!==null&&s.tag!==5&&s.tag!==3&&s.tag!==13;)s=s.return;Wn=s}function ic(s){if(s!==Wn)return!1;if(!yt)return Eg(s),yt=!0,!1;var o;if((o=s.tag!==3)&&!(o=s.tag!==5)&&(o=s.type,o=o!=="head"&&o!=="body"&&!Nd(s.type,s.memoizedProps)),o&&(o=qn)){if(Od(s))throw Tg(),Error(t(418));for(;o;)_g(s,o),o=Us(o.nextSibling)}if(Eg(s),s.tag===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(t(317));e:{for(s=s.nextSibling,o=0;s;){if(s.nodeType===8){var l=s.data;if(l==="/$"){if(o===0){qn=Us(s.nextSibling);break e}o--}else l!=="$"&&l!=="$!"&&l!=="$?"||o++}s=s.nextSibling}qn=null}}else qn=Wn?Us(s.stateNode.nextSibling):null;return!0}function Tg(){for(var s=qn;s;)s=Us(s.nextSibling)}function Xo(){qn=Wn=null,yt=!1}function Ld(s){Nr===null?Nr=[s]:Nr.push(s)}var eI=X.ReactCurrentBatchConfig;function hl(s,o,l){if(s=l.ref,s!==null&&typeof s!="function"&&typeof s!="object"){if(l._owner){if(l=l._owner,l){if(l.tag!==1)throw Error(t(309));var f=l.stateNode}if(!f)throw Error(t(147,s));var m=f,v=""+s;return o!==null&&o.ref!==null&&typeof o.ref=="function"&&o.ref._stringRef===v?o.ref:(o=function(S){var O=m.refs;S===null?delete O[v]:O[v]=S},o._stringRef=v,o)}if(typeof s!="string")throw Error(t(284));if(!l._owner)throw Error(t(290,s))}return s}function oc(s,o){throw s=Object.prototype.toString.call(o),Error(t(31,s==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":s))}function Ig(s){var o=s._init;return o(s._payload)}function Sg(s){function o(H,B){if(s){var Q=H.deletions;Q===null?(H.deletions=[B],H.flags|=16):Q.push(B)}}function l(H,B){if(!s)return null;for(;B!==null;)o(H,B),B=B.sibling;return null}function f(H,B){for(H=new Map;B!==null;)B.key!==null?H.set(B.key,B):H.set(B.index,B),B=B.sibling;return H}function m(H,B){return H=Js(H,B),H.index=0,H.sibling=null,H}function v(H,B,Q){return H.index=Q,s?(Q=H.alternate,Q!==null?(Q=Q.index,Q<B?(H.flags|=2,B):Q):(H.flags|=2,B)):(H.flags|=1048576,B)}function S(H){return s&&H.alternate===null&&(H.flags|=2),H}function O(H,B,Q,he){return B===null||B.tag!==6?(B=Pf(Q,H.mode,he),B.return=H,B):(B=m(B,Q),B.return=H,B)}function L(H,B,Q,he){var Pe=Q.type;return Pe===x?ae(H,B,Q.props.children,he,Q.key):B!==null&&(B.elementType===Pe||typeof Pe=="object"&&Pe!==null&&Pe.$$typeof===pe&&Ig(Pe)===B.type)?(he=m(B,Q.props),he.ref=hl(H,B,Q),he.return=H,he):(he=Pc(Q.type,Q.key,Q.props,null,H.mode,he),he.ref=hl(H,B,Q),he.return=H,he)}function Y(H,B,Q,he){return B===null||B.tag!==4||B.stateNode.containerInfo!==Q.containerInfo||B.stateNode.implementation!==Q.implementation?(B=kf(Q,H.mode,he),B.return=H,B):(B=m(B,Q.children||[]),B.return=H,B)}function ae(H,B,Q,he,Pe){return B===null||B.tag!==7?(B=Hi(Q,H.mode,he,Pe),B.return=H,B):(B=m(B,Q),B.return=H,B)}function ce(H,B,Q){if(typeof B=="string"&&B!==""||typeof B=="number")return B=Pf(""+B,H.mode,Q),B.return=H,B;if(typeof B=="object"&&B!==null){switch(B.$$typeof){case j:return Q=Pc(B.type,B.key,B.props,null,H.mode,Q),Q.ref=hl(H,null,B),Q.return=H,Q;case $:return B=kf(B,H.mode,Q),B.return=H,B;case pe:var he=B._init;return ce(H,he(B._payload),Q)}if(mn(B)||ne(B))return B=Hi(B,H.mode,Q,null),B.return=H,B;oc(H,B)}return null}function ie(H,B,Q,he){var Pe=B!==null?B.key:null;if(typeof Q=="string"&&Q!==""||typeof Q=="number")return Pe!==null?null:O(H,B,""+Q,he);if(typeof Q=="object"&&Q!==null){switch(Q.$$typeof){case j:return Q.key===Pe?L(H,B,Q,he):null;case $:return Q.key===Pe?Y(H,B,Q,he):null;case pe:return Pe=Q._init,ie(H,B,Pe(Q._payload),he)}if(mn(Q)||ne(Q))return Pe!==null?null:ae(H,B,Q,he,null);oc(H,Q)}return null}function we(H,B,Q,he,Pe){if(typeof he=="string"&&he!==""||typeof he=="number")return H=H.get(Q)||null,O(B,H,""+he,Pe);if(typeof he=="object"&&he!==null){switch(he.$$typeof){case j:return H=H.get(he.key===null?Q:he.key)||null,L(B,H,he,Pe);case $:return H=H.get(he.key===null?Q:he.key)||null,Y(B,H,he,Pe);case pe:var Me=he._init;return we(H,B,Q,Me(he._payload),Pe)}if(mn(he)||ne(he))return H=H.get(Q)||null,ae(B,H,he,Pe,null);oc(B,he)}return null}function Se(H,B,Q,he){for(var Pe=null,Me=null,Oe=B,je=B=0,Kt=null;Oe!==null&&je<Q.length;je++){Oe.index>je?(Kt=Oe,Oe=null):Kt=Oe.sibling;var Je=ie(H,Oe,Q[je],he);if(Je===null){Oe===null&&(Oe=Kt);break}s&&Oe&&Je.alternate===null&&o(H,Oe),B=v(Je,B,je),Me===null?Pe=Je:Me.sibling=Je,Me=Je,Oe=Kt}if(je===Q.length)return l(H,Oe),yt&&Bi(H,je),Pe;if(Oe===null){for(;je<Q.length;je++)Oe=ce(H,Q[je],he),Oe!==null&&(B=v(Oe,B,je),Me===null?Pe=Oe:Me.sibling=Oe,Me=Oe);return yt&&Bi(H,je),Pe}for(Oe=f(H,Oe);je<Q.length;je++)Kt=we(Oe,H,je,Q[je],he),Kt!==null&&(s&&Kt.alternate!==null&&Oe.delete(Kt.key===null?je:Kt.key),B=v(Kt,B,je),Me===null?Pe=Kt:Me.sibling=Kt,Me=Kt);return s&&Oe.forEach(function(ei){return o(H,ei)}),yt&&Bi(H,je),Pe}function Ne(H,B,Q,he){var Pe=ne(Q);if(typeof Pe!="function")throw Error(t(150));if(Q=Pe.call(Q),Q==null)throw Error(t(151));for(var Me=Pe=null,Oe=B,je=B=0,Kt=null,Je=Q.next();Oe!==null&&!Je.done;je++,Je=Q.next()){Oe.index>je?(Kt=Oe,Oe=null):Kt=Oe.sibling;var ei=ie(H,Oe,Je.value,he);if(ei===null){Oe===null&&(Oe=Kt);break}s&&Oe&&ei.alternate===null&&o(H,Oe),B=v(ei,B,je),Me===null?Pe=ei:Me.sibling=ei,Me=ei,Oe=Kt}if(Je.done)return l(H,Oe),yt&&Bi(H,je),Pe;if(Oe===null){for(;!Je.done;je++,Je=Q.next())Je=ce(H,Je.value,he),Je!==null&&(B=v(Je,B,je),Me===null?Pe=Je:Me.sibling=Je,Me=Je);return yt&&Bi(H,je),Pe}for(Oe=f(H,Oe);!Je.done;je++,Je=Q.next())Je=we(Oe,H,je,Je.value,he),Je!==null&&(s&&Je.alternate!==null&&Oe.delete(Je.key===null?je:Je.key),B=v(Je,B,je),Me===null?Pe=Je:Me.sibling=Je,Me=Je);return s&&Oe.forEach(function(DI){return o(H,DI)}),yt&&Bi(H,je),Pe}function kt(H,B,Q,he){if(typeof Q=="object"&&Q!==null&&Q.type===x&&Q.key===null&&(Q=Q.props.children),typeof Q=="object"&&Q!==null){switch(Q.$$typeof){case j:e:{for(var Pe=Q.key,Me=B;Me!==null;){if(Me.key===Pe){if(Pe=Q.type,Pe===x){if(Me.tag===7){l(H,Me.sibling),B=m(Me,Q.props.children),B.return=H,H=B;break e}}else if(Me.elementType===Pe||typeof Pe=="object"&&Pe!==null&&Pe.$$typeof===pe&&Ig(Pe)===Me.type){l(H,Me.sibling),B=m(Me,Q.props),B.ref=hl(H,Me,Q),B.return=H,H=B;break e}l(H,Me);break}else o(H,Me);Me=Me.sibling}Q.type===x?(B=Hi(Q.props.children,H.mode,he,Q.key),B.return=H,H=B):(he=Pc(Q.type,Q.key,Q.props,null,H.mode,he),he.ref=hl(H,B,Q),he.return=H,H=he)}return S(H);case $:e:{for(Me=Q.key;B!==null;){if(B.key===Me)if(B.tag===4&&B.stateNode.containerInfo===Q.containerInfo&&B.stateNode.implementation===Q.implementation){l(H,B.sibling),B=m(B,Q.children||[]),B.return=H,H=B;break e}else{l(H,B);break}else o(H,B);B=B.sibling}B=kf(Q,H.mode,he),B.return=H,H=B}return S(H);case pe:return Me=Q._init,kt(H,B,Me(Q._payload),he)}if(mn(Q))return Se(H,B,Q,he);if(ne(Q))return Ne(H,B,Q,he);oc(H,Q)}return typeof Q=="string"&&Q!==""||typeof Q=="number"?(Q=""+Q,B!==null&&B.tag===6?(l(H,B.sibling),B=m(B,Q),B.return=H,H=B):(l(H,B),B=Pf(Q,H.mode,he),B.return=H,H=B),S(H)):l(H,B)}return kt}var Yo=Sg(!0),Cg=Sg(!1),ac=$s(null),lc=null,Zo=null,jd=null;function Bd(){jd=Zo=lc=null}function zd(s){var o=ac.current;pt(ac),s._currentValue=o}function Ud(s,o,l){for(;s!==null;){var f=s.alternate;if((s.childLanes&o)!==o?(s.childLanes|=o,f!==null&&(f.childLanes|=o)):f!==null&&(f.childLanes&o)!==o&&(f.childLanes|=o),s===l)break;s=s.return}}function Jo(s,o){lc=s,jd=Zo=null,s=s.dependencies,s!==null&&s.firstContext!==null&&(s.lanes&o&&(Rn=!0),s.firstContext=null)}function ir(s){var o=s._currentValue;if(jd!==s)if(s={context:s,memoizedValue:o,next:null},Zo===null){if(lc===null)throw Error(t(308));Zo=s,lc.dependencies={lanes:0,firstContext:s}}else Zo=Zo.next=s;return o}var zi=null;function $d(s){zi===null?zi=[s]:zi.push(s)}function Ag(s,o,l,f){var m=o.interleaved;return m===null?(l.next=l,$d(o)):(l.next=m.next,m.next=l),o.interleaved=l,gs(s,f)}function gs(s,o){s.lanes|=o;var l=s.alternate;for(l!==null&&(l.lanes|=o),l=s,s=s.return;s!==null;)s.childLanes|=o,l=s.alternate,l!==null&&(l.childLanes|=o),l=s,s=s.return;return l.tag===3?l.stateNode:null}var Gs=!1;function Wd(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function xg(s,o){s=s.updateQueue,o.updateQueue===s&&(o.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,effects:s.effects})}function ys(s,o){return{eventTime:s,lane:o,tag:0,payload:null,callback:null,next:null}}function Ks(s,o,l){var f=s.updateQueue;if(f===null)return null;if(f=f.shared,Ze&2){var m=f.pending;return m===null?o.next=o:(o.next=m.next,m.next=o),f.pending=o,gs(s,l)}return m=f.interleaved,m===null?(o.next=o,$d(f)):(o.next=m.next,m.next=o),f.interleaved=o,gs(s,l)}function uc(s,o,l){if(o=o.updateQueue,o!==null&&(o=o.shared,(l&4194240)!==0)){var f=o.lanes;f&=s.pendingLanes,l|=f,o.lanes=l,Os(s,l)}}function Ng(s,o){var l=s.updateQueue,f=s.alternate;if(f!==null&&(f=f.updateQueue,l===f)){var m=null,v=null;if(l=l.firstBaseUpdate,l!==null){do{var S={eventTime:l.eventTime,lane:l.lane,tag:l.tag,payload:l.payload,callback:l.callback,next:null};v===null?m=v=S:v=v.next=S,l=l.next}while(l!==null);v===null?m=v=o:v=v.next=o}else m=v=o;l={baseState:f.baseState,firstBaseUpdate:m,lastBaseUpdate:v,shared:f.shared,effects:f.effects},s.updateQueue=l;return}s=l.lastBaseUpdate,s===null?l.firstBaseUpdate=o:s.next=o,l.lastBaseUpdate=o}function cc(s,o,l,f){var m=s.updateQueue;Gs=!1;var v=m.firstBaseUpdate,S=m.lastBaseUpdate,O=m.shared.pending;if(O!==null){m.shared.pending=null;var L=O,Y=L.next;L.next=null,S===null?v=Y:S.next=Y,S=L;var ae=s.alternate;ae!==null&&(ae=ae.updateQueue,O=ae.lastBaseUpdate,O!==S&&(O===null?ae.firstBaseUpdate=Y:O.next=Y,ae.lastBaseUpdate=L))}if(v!==null){var ce=m.baseState;S=0,ae=Y=L=null,O=v;do{var ie=O.lane,we=O.eventTime;if((f&ie)===ie){ae!==null&&(ae=ae.next={eventTime:we,lane:0,tag:O.tag,payload:O.payload,callback:O.callback,next:null});e:{var Se=s,Ne=O;switch(ie=o,we=l,Ne.tag){case 1:if(Se=Ne.payload,typeof Se=="function"){ce=Se.call(we,ce,ie);break e}ce=Se;break e;case 3:Se.flags=Se.flags&-65537|128;case 0:if(Se=Ne.payload,ie=typeof Se=="function"?Se.call(we,ce,ie):Se,ie==null)break e;ce=re({},ce,ie);break e;case 2:Gs=!0}}O.callback!==null&&O.lane!==0&&(s.flags|=64,ie=m.effects,ie===null?m.effects=[O]:ie.push(O))}else we={eventTime:we,lane:ie,tag:O.tag,payload:O.payload,callback:O.callback,next:null},ae===null?(Y=ae=we,L=ce):ae=ae.next=we,S|=ie;if(O=O.next,O===null){if(O=m.shared.pending,O===null)break;ie=O,O=ie.next,ie.next=null,m.lastBaseUpdate=ie,m.shared.pending=null}}while(!0);if(ae===null&&(L=ce),m.baseState=L,m.firstBaseUpdate=Y,m.lastBaseUpdate=ae,o=m.shared.interleaved,o!==null){m=o;do S|=m.lane,m=m.next;while(m!==o)}else v===null&&(m.shared.lanes=0);Wi|=S,s.lanes=S,s.memoizedState=ce}}function Rg(s,o,l){if(s=o.effects,o.effects=null,s!==null)for(o=0;o<s.length;o++){var f=s[o],m=f.callback;if(m!==null){if(f.callback=null,f=l,typeof m!="function")throw Error(t(191,m));m.call(f)}}}var dl={},Hr=$s(dl),fl=$s(dl),pl=$s(dl);function Ui(s){if(s===dl)throw Error(t(174));return s}function qd(s,o){switch(ct(pl,o),ct(fl,s),ct(Hr,dl),s=o.nodeType,s){case 9:case 11:o=(o=o.documentElement)?o.namespaceURI:ht(null,"");break;default:s=s===8?o.parentNode:o,o=s.namespaceURI||null,s=s.tagName,o=ht(o,s)}pt(Hr),ct(Hr,o)}function ea(){pt(Hr),pt(fl),pt(pl)}function Pg(s){Ui(pl.current);var o=Ui(Hr.current),l=ht(o,s.type);o!==l&&(ct(fl,s),ct(Hr,l))}function Gd(s){fl.current===s&&(pt(Hr),pt(fl))}var Tt=$s(0);function hc(s){for(var o=s;o!==null;){if(o.tag===13){var l=o.memoizedState;if(l!==null&&(l=l.dehydrated,l===null||l.data==="$?"||l.data==="$!"))return o}else if(o.tag===19&&o.memoizedProps.revealOrder!==void 0){if(o.flags&128)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===s)break;for(;o.sibling===null;){if(o.return===null||o.return===s)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}var Kd=[];function Hd(){for(var s=0;s<Kd.length;s++)Kd[s]._workInProgressVersionPrimary=null;Kd.length=0}var dc=X.ReactCurrentDispatcher,Qd=X.ReactCurrentBatchConfig,$i=0,It=null,Bt=null,qt=null,fc=!1,ml=!1,gl=0,tI=0;function sn(){throw Error(t(321))}function Xd(s,o){if(o===null)return!1;for(var l=0;l<o.length&&l<s.length;l++)if(!xr(s[l],o[l]))return!1;return!0}function Yd(s,o,l,f,m,v){if($i=v,It=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,dc.current=s===null||s.memoizedState===null?iI:oI,s=l(f,m),ml){v=0;do{if(ml=!1,gl=0,25<=v)throw Error(t(301));v+=1,qt=Bt=null,o.updateQueue=null,dc.current=aI,s=l(f,m)}while(ml)}if(dc.current=gc,o=Bt!==null&&Bt.next!==null,$i=0,qt=Bt=It=null,fc=!1,o)throw Error(t(300));return s}function Zd(){var s=gl!==0;return gl=0,s}function Qr(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return qt===null?It.memoizedState=qt=s:qt=qt.next=s,qt}function or(){if(Bt===null){var s=It.alternate;s=s!==null?s.memoizedState:null}else s=Bt.next;var o=qt===null?It.memoizedState:qt.next;if(o!==null)qt=o,Bt=s;else{if(s===null)throw Error(t(310));Bt=s,s={memoizedState:Bt.memoizedState,baseState:Bt.baseState,baseQueue:Bt.baseQueue,queue:Bt.queue,next:null},qt===null?It.memoizedState=qt=s:qt=qt.next=s}return qt}function yl(s,o){return typeof o=="function"?o(s):o}function Jd(s){var o=or(),l=o.queue;if(l===null)throw Error(t(311));l.lastRenderedReducer=s;var f=Bt,m=f.baseQueue,v=l.pending;if(v!==null){if(m!==null){var S=m.next;m.next=v.next,v.next=S}f.baseQueue=m=v,l.pending=null}if(m!==null){v=m.next,f=f.baseState;var O=S=null,L=null,Y=v;do{var ae=Y.lane;if(($i&ae)===ae)L!==null&&(L=L.next={lane:0,action:Y.action,hasEagerState:Y.hasEagerState,eagerState:Y.eagerState,next:null}),f=Y.hasEagerState?Y.eagerState:s(f,Y.action);else{var ce={lane:ae,action:Y.action,hasEagerState:Y.hasEagerState,eagerState:Y.eagerState,next:null};L===null?(O=L=ce,S=f):L=L.next=ce,It.lanes|=ae,Wi|=ae}Y=Y.next}while(Y!==null&&Y!==v);L===null?S=f:L.next=O,xr(f,o.memoizedState)||(Rn=!0),o.memoizedState=f,o.baseState=S,o.baseQueue=L,l.lastRenderedState=f}if(s=l.interleaved,s!==null){m=s;do v=m.lane,It.lanes|=v,Wi|=v,m=m.next;while(m!==s)}else m===null&&(l.lanes=0);return[o.memoizedState,l.dispatch]}function ef(s){var o=or(),l=o.queue;if(l===null)throw Error(t(311));l.lastRenderedReducer=s;var f=l.dispatch,m=l.pending,v=o.memoizedState;if(m!==null){l.pending=null;var S=m=m.next;do v=s(v,S.action),S=S.next;while(S!==m);xr(v,o.memoizedState)||(Rn=!0),o.memoizedState=v,o.baseQueue===null&&(o.baseState=v),l.lastRenderedState=v}return[v,f]}function kg(){}function bg(s,o){var l=It,f=or(),m=o(),v=!xr(f.memoizedState,m);if(v&&(f.memoizedState=m,Rn=!0),f=f.queue,tf(Mg.bind(null,l,f,s),[s]),f.getSnapshot!==o||v||qt!==null&&qt.memoizedState.tag&1){if(l.flags|=2048,vl(9,Vg.bind(null,l,f,m,o),void 0,null),Gt===null)throw Error(t(349));$i&30||Dg(l,o,m)}return m}function Dg(s,o,l){s.flags|=16384,s={getSnapshot:o,value:l},o=It.updateQueue,o===null?(o={lastEffect:null,stores:null},It.updateQueue=o,o.stores=[s]):(l=o.stores,l===null?o.stores=[s]:l.push(s))}function Vg(s,o,l,f){o.value=l,o.getSnapshot=f,Og(o)&&Fg(s)}function Mg(s,o,l){return l(function(){Og(o)&&Fg(s)})}function Og(s){var o=s.getSnapshot;s=s.value;try{var l=o();return!xr(s,l)}catch{return!0}}function Fg(s){var o=gs(s,1);o!==null&&br(o,s,1,-1)}function Lg(s){var o=Qr();return typeof s=="function"&&(s=s()),o.memoizedState=o.baseState=s,s={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:yl,lastRenderedState:s},o.queue=s,s=s.dispatch=sI.bind(null,It,s),[o.memoizedState,s]}function vl(s,o,l,f){return s={tag:s,create:o,destroy:l,deps:f,next:null},o=It.updateQueue,o===null?(o={lastEffect:null,stores:null},It.updateQueue=o,o.lastEffect=s.next=s):(l=o.lastEffect,l===null?o.lastEffect=s.next=s:(f=l.next,l.next=s,s.next=f,o.lastEffect=s)),s}function jg(){return or().memoizedState}function pc(s,o,l,f){var m=Qr();It.flags|=s,m.memoizedState=vl(1|o,l,void 0,f===void 0?null:f)}function mc(s,o,l,f){var m=or();f=f===void 0?null:f;var v=void 0;if(Bt!==null){var S=Bt.memoizedState;if(v=S.destroy,f!==null&&Xd(f,S.deps)){m.memoizedState=vl(o,l,v,f);return}}It.flags|=s,m.memoizedState=vl(1|o,l,v,f)}function Bg(s,o){return pc(8390656,8,s,o)}function tf(s,o){return mc(2048,8,s,o)}function zg(s,o){return mc(4,2,s,o)}function Ug(s,o){return mc(4,4,s,o)}function $g(s,o){if(typeof o=="function")return s=s(),o(s),function(){o(null)};if(o!=null)return s=s(),o.current=s,function(){o.current=null}}function Wg(s,o,l){return l=l!=null?l.concat([s]):null,mc(4,4,$g.bind(null,o,s),l)}function nf(){}function qg(s,o){var l=or();o=o===void 0?null:o;var f=l.memoizedState;return f!==null&&o!==null&&Xd(o,f[1])?f[0]:(l.memoizedState=[s,o],s)}function Gg(s,o){var l=or();o=o===void 0?null:o;var f=l.memoizedState;return f!==null&&o!==null&&Xd(o,f[1])?f[0]:(s=s(),l.memoizedState=[s,o],s)}function Kg(s,o,l){return $i&21?(xr(l,o)||(l=bi(),It.lanes|=l,Wi|=l,s.baseState=!0),o):(s.baseState&&(s.baseState=!1,Rn=!0),s.memoizedState=l)}function nI(s,o){var l=Ke;Ke=l!==0&&4>l?l:4,s(!0);var f=Qd.transition;Qd.transition={};try{s(!1),o()}finally{Ke=l,Qd.transition=f}}function Hg(){return or().memoizedState}function rI(s,o,l){var f=Ys(s);if(l={lane:f,action:l,hasEagerState:!1,eagerState:null,next:null},Qg(s))Xg(o,l);else if(l=Ag(s,o,l,f),l!==null){var m=Tn();br(l,s,f,m),Yg(l,o,f)}}function sI(s,o,l){var f=Ys(s),m={lane:f,action:l,hasEagerState:!1,eagerState:null,next:null};if(Qg(s))Xg(o,m);else{var v=s.alternate;if(s.lanes===0&&(v===null||v.lanes===0)&&(v=o.lastRenderedReducer,v!==null))try{var S=o.lastRenderedState,O=v(S,l);if(m.hasEagerState=!0,m.eagerState=O,xr(O,S)){var L=o.interleaved;L===null?(m.next=m,$d(o)):(m.next=L.next,L.next=m),o.interleaved=m;return}}catch{}finally{}l=Ag(s,o,m,f),l!==null&&(m=Tn(),br(l,s,f,m),Yg(l,o,f))}}function Qg(s){var o=s.alternate;return s===It||o!==null&&o===It}function Xg(s,o){ml=fc=!0;var l=s.pending;l===null?o.next=o:(o.next=l.next,l.next=o),s.pending=o}function Yg(s,o,l){if(l&4194240){var f=o.lanes;f&=s.pendingLanes,l|=f,o.lanes=l,Os(s,l)}}var gc={readContext:ir,useCallback:sn,useContext:sn,useEffect:sn,useImperativeHandle:sn,useInsertionEffect:sn,useLayoutEffect:sn,useMemo:sn,useReducer:sn,useRef:sn,useState:sn,useDebugValue:sn,useDeferredValue:sn,useTransition:sn,useMutableSource:sn,useSyncExternalStore:sn,useId:sn,unstable_isNewReconciler:!1},iI={readContext:ir,useCallback:function(s,o){return Qr().memoizedState=[s,o===void 0?null:o],s},useContext:ir,useEffect:Bg,useImperativeHandle:function(s,o,l){return l=l!=null?l.concat([s]):null,pc(4194308,4,$g.bind(null,o,s),l)},useLayoutEffect:function(s,o){return pc(4194308,4,s,o)},useInsertionEffect:function(s,o){return pc(4,2,s,o)},useMemo:function(s,o){var l=Qr();return o=o===void 0?null:o,s=s(),l.memoizedState=[s,o],s},useReducer:function(s,o,l){var f=Qr();return o=l!==void 0?l(o):o,f.memoizedState=f.baseState=o,s={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:o},f.queue=s,s=s.dispatch=rI.bind(null,It,s),[f.memoizedState,s]},useRef:function(s){var o=Qr();return s={current:s},o.memoizedState=s},useState:Lg,useDebugValue:nf,useDeferredValue:function(s){return Qr().memoizedState=s},useTransition:function(){var s=Lg(!1),o=s[0];return s=nI.bind(null,s[1]),Qr().memoizedState=s,[o,s]},useMutableSource:function(){},useSyncExternalStore:function(s,o,l){var f=It,m=Qr();if(yt){if(l===void 0)throw Error(t(407));l=l()}else{if(l=o(),Gt===null)throw Error(t(349));$i&30||Dg(f,o,l)}m.memoizedState=l;var v={value:l,getSnapshot:o};return m.queue=v,Bg(Mg.bind(null,f,v,s),[s]),f.flags|=2048,vl(9,Vg.bind(null,f,v,l,o),void 0,null),l},useId:function(){var s=Qr(),o=Gt.identifierPrefix;if(yt){var l=ms,f=ps;l=(f&~(1<<32-_n(f)-1)).toString(32)+l,o=":"+o+"R"+l,l=gl++,0<l&&(o+="H"+l.toString(32)),o+=":"}else l=tI++,o=":"+o+"r"+l.toString(32)+":";return s.memoizedState=o},unstable_isNewReconciler:!1},oI={readContext:ir,useCallback:qg,useContext:ir,useEffect:tf,useImperativeHandle:Wg,useInsertionEffect:zg,useLayoutEffect:Ug,useMemo:Gg,useReducer:Jd,useRef:jg,useState:function(){return Jd(yl)},useDebugValue:nf,useDeferredValue:function(s){var o=or();return Kg(o,Bt.memoizedState,s)},useTransition:function(){var s=Jd(yl)[0],o=or().memoizedState;return[s,o]},useMutableSource:kg,useSyncExternalStore:bg,useId:Hg,unstable_isNewReconciler:!1},aI={readContext:ir,useCallback:qg,useContext:ir,useEffect:tf,useImperativeHandle:Wg,useInsertionEffect:zg,useLayoutEffect:Ug,useMemo:Gg,useReducer:ef,useRef:jg,useState:function(){return ef(yl)},useDebugValue:nf,useDeferredValue:function(s){var o=or();return Bt===null?o.memoizedState=s:Kg(o,Bt.memoizedState,s)},useTransition:function(){var s=ef(yl)[0],o=or().memoizedState;return[s,o]},useMutableSource:kg,useSyncExternalStore:bg,useId:Hg,unstable_isNewReconciler:!1};function Rr(s,o){if(s&&s.defaultProps){o=re({},o),s=s.defaultProps;for(var l in s)o[l]===void 0&&(o[l]=s[l]);return o}return o}function rf(s,o,l,f){o=s.memoizedState,l=l(f,o),l=l==null?o:re({},o,l),s.memoizedState=l,s.lanes===0&&(s.updateQueue.baseState=l)}var yc={isMounted:function(s){return(s=s._reactInternals)?wr(s)===s:!1},enqueueSetState:function(s,o,l){s=s._reactInternals;var f=Tn(),m=Ys(s),v=ys(f,m);v.payload=o,l!=null&&(v.callback=l),o=Ks(s,v,m),o!==null&&(br(o,s,m,f),uc(o,s,m))},enqueueReplaceState:function(s,o,l){s=s._reactInternals;var f=Tn(),m=Ys(s),v=ys(f,m);v.tag=1,v.payload=o,l!=null&&(v.callback=l),o=Ks(s,v,m),o!==null&&(br(o,s,m,f),uc(o,s,m))},enqueueForceUpdate:function(s,o){s=s._reactInternals;var l=Tn(),f=Ys(s),m=ys(l,f);m.tag=2,o!=null&&(m.callback=o),o=Ks(s,m,f),o!==null&&(br(o,s,f,l),uc(o,s,f))}};function Zg(s,o,l,f,m,v,S){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(f,v,S):o.prototype&&o.prototype.isPureReactComponent?!sl(l,f)||!sl(m,v):!0}function Jg(s,o,l){var f=!1,m=Ws,v=o.contextType;return typeof v=="object"&&v!==null?v=ir(v):(m=Nn(o)?Li:rn.current,f=o.contextTypes,v=(f=f!=null)?Ko(s,m):Ws),o=new o(l,v),s.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,o.updater=yc,s.stateNode=o,o._reactInternals=s,f&&(s=s.stateNode,s.__reactInternalMemoizedUnmaskedChildContext=m,s.__reactInternalMemoizedMaskedChildContext=v),o}function ey(s,o,l,f){s=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(l,f),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(l,f),o.state!==s&&yc.enqueueReplaceState(o,o.state,null)}function sf(s,o,l,f){var m=s.stateNode;m.props=l,m.state=s.memoizedState,m.refs={},Wd(s);var v=o.contextType;typeof v=="object"&&v!==null?m.context=ir(v):(v=Nn(o)?Li:rn.current,m.context=Ko(s,v)),m.state=s.memoizedState,v=o.getDerivedStateFromProps,typeof v=="function"&&(rf(s,o,v,l),m.state=s.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof m.getSnapshotBeforeUpdate=="function"||typeof m.UNSAFE_componentWillMount!="function"&&typeof m.componentWillMount!="function"||(o=m.state,typeof m.componentWillMount=="function"&&m.componentWillMount(),typeof m.UNSAFE_componentWillMount=="function"&&m.UNSAFE_componentWillMount(),o!==m.state&&yc.enqueueReplaceState(m,m.state,null),cc(s,l,m,f),m.state=s.memoizedState),typeof m.componentDidMount=="function"&&(s.flags|=4194308)}function ta(s,o){try{var l="",f=o;do l+=me(f),f=f.return;while(f);var m=l}catch(v){m=`
Error generating stack: `+v.message+`
`+v.stack}return{value:s,source:o,stack:m,digest:null}}function of(s,o,l){return{value:s,source:null,stack:l??null,digest:o??null}}function af(s,o){try{console.error(o.value)}catch(l){setTimeout(function(){throw l})}}var lI=typeof WeakMap=="function"?WeakMap:Map;function ty(s,o,l){l=ys(-1,l),l.tag=3,l.payload={element:null};var f=o.value;return l.callback=function(){Sc||(Sc=!0,Tf=f),af(s,o)},l}function ny(s,o,l){l=ys(-1,l),l.tag=3;var f=s.type.getDerivedStateFromError;if(typeof f=="function"){var m=o.value;l.payload=function(){return f(m)},l.callback=function(){af(s,o)}}var v=s.stateNode;return v!==null&&typeof v.componentDidCatch=="function"&&(l.callback=function(){af(s,o),typeof f!="function"&&(Qs===null?Qs=new Set([this]):Qs.add(this));var S=o.stack;this.componentDidCatch(o.value,{componentStack:S!==null?S:""})}),l}function ry(s,o,l){var f=s.pingCache;if(f===null){f=s.pingCache=new lI;var m=new Set;f.set(o,m)}else m=f.get(o),m===void 0&&(m=new Set,f.set(o,m));m.has(l)||(m.add(l),s=TI.bind(null,s,o,l),o.then(s,s))}function sy(s){do{var o;if((o=s.tag===13)&&(o=s.memoizedState,o=o!==null?o.dehydrated!==null:!0),o)return s;s=s.return}while(s!==null);return null}function iy(s,o,l,f,m){return s.mode&1?(s.flags|=65536,s.lanes=m,s):(s===o?s.flags|=65536:(s.flags|=128,l.flags|=131072,l.flags&=-52805,l.tag===1&&(l.alternate===null?l.tag=17:(o=ys(-1,1),o.tag=2,Ks(l,o,1))),l.lanes|=1),s)}var uI=X.ReactCurrentOwner,Rn=!1;function En(s,o,l,f){o.child=s===null?Cg(o,null,l,f):Yo(o,s.child,l,f)}function oy(s,o,l,f,m){l=l.render;var v=o.ref;return Jo(o,m),f=Yd(s,o,l,f,v,m),l=Zd(),s!==null&&!Rn?(o.updateQueue=s.updateQueue,o.flags&=-2053,s.lanes&=~m,vs(s,o,m)):(yt&&l&&Vd(o),o.flags|=1,En(s,o,f,m),o.child)}function ay(s,o,l,f,m){if(s===null){var v=l.type;return typeof v=="function"&&!Rf(v)&&v.defaultProps===void 0&&l.compare===null&&l.defaultProps===void 0?(o.tag=15,o.type=v,ly(s,o,v,f,m)):(s=Pc(l.type,null,f,o,o.mode,m),s.ref=o.ref,s.return=o,o.child=s)}if(v=s.child,!(s.lanes&m)){var S=v.memoizedProps;if(l=l.compare,l=l!==null?l:sl,l(S,f)&&s.ref===o.ref)return vs(s,o,m)}return o.flags|=1,s=Js(v,f),s.ref=o.ref,s.return=o,o.child=s}function ly(s,o,l,f,m){if(s!==null){var v=s.memoizedProps;if(sl(v,f)&&s.ref===o.ref)if(Rn=!1,o.pendingProps=f=v,(s.lanes&m)!==0)s.flags&131072&&(Rn=!0);else return o.lanes=s.lanes,vs(s,o,m)}return lf(s,o,l,f,m)}function uy(s,o,l){var f=o.pendingProps,m=f.children,v=s!==null?s.memoizedState:null;if(f.mode==="hidden")if(!(o.mode&1))o.memoizedState={baseLanes:0,cachePool:null,transitions:null},ct(ra,Gn),Gn|=l;else{if(!(l&1073741824))return s=v!==null?v.baseLanes|l:l,o.lanes=o.childLanes=1073741824,o.memoizedState={baseLanes:s,cachePool:null,transitions:null},o.updateQueue=null,ct(ra,Gn),Gn|=s,null;o.memoizedState={baseLanes:0,cachePool:null,transitions:null},f=v!==null?v.baseLanes:l,ct(ra,Gn),Gn|=f}else v!==null?(f=v.baseLanes|l,o.memoizedState=null):f=l,ct(ra,Gn),Gn|=f;return En(s,o,m,l),o.child}function cy(s,o){var l=o.ref;(s===null&&l!==null||s!==null&&s.ref!==l)&&(o.flags|=512,o.flags|=2097152)}function lf(s,o,l,f,m){var v=Nn(l)?Li:rn.current;return v=Ko(o,v),Jo(o,m),l=Yd(s,o,l,f,v,m),f=Zd(),s!==null&&!Rn?(o.updateQueue=s.updateQueue,o.flags&=-2053,s.lanes&=~m,vs(s,o,m)):(yt&&f&&Vd(o),o.flags|=1,En(s,o,l,m),o.child)}function hy(s,o,l,f,m){if(Nn(l)){var v=!0;tc(o)}else v=!1;if(Jo(o,m),o.stateNode===null)_c(s,o),Jg(o,l,f),sf(o,l,f,m),f=!0;else if(s===null){var S=o.stateNode,O=o.memoizedProps;S.props=O;var L=S.context,Y=l.contextType;typeof Y=="object"&&Y!==null?Y=ir(Y):(Y=Nn(l)?Li:rn.current,Y=Ko(o,Y));var ae=l.getDerivedStateFromProps,ce=typeof ae=="function"||typeof S.getSnapshotBeforeUpdate=="function";ce||typeof S.UNSAFE_componentWillReceiveProps!="function"&&typeof S.componentWillReceiveProps!="function"||(O!==f||L!==Y)&&ey(o,S,f,Y),Gs=!1;var ie=o.memoizedState;S.state=ie,cc(o,f,S,m),L=o.memoizedState,O!==f||ie!==L||xn.current||Gs?(typeof ae=="function"&&(rf(o,l,ae,f),L=o.memoizedState),(O=Gs||Zg(o,l,O,f,ie,L,Y))?(ce||typeof S.UNSAFE_componentWillMount!="function"&&typeof S.componentWillMount!="function"||(typeof S.componentWillMount=="function"&&S.componentWillMount(),typeof S.UNSAFE_componentWillMount=="function"&&S.UNSAFE_componentWillMount()),typeof S.componentDidMount=="function"&&(o.flags|=4194308)):(typeof S.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=f,o.memoizedState=L),S.props=f,S.state=L,S.context=Y,f=O):(typeof S.componentDidMount=="function"&&(o.flags|=4194308),f=!1)}else{S=o.stateNode,xg(s,o),O=o.memoizedProps,Y=o.type===o.elementType?O:Rr(o.type,O),S.props=Y,ce=o.pendingProps,ie=S.context,L=l.contextType,typeof L=="object"&&L!==null?L=ir(L):(L=Nn(l)?Li:rn.current,L=Ko(o,L));var we=l.getDerivedStateFromProps;(ae=typeof we=="function"||typeof S.getSnapshotBeforeUpdate=="function")||typeof S.UNSAFE_componentWillReceiveProps!="function"&&typeof S.componentWillReceiveProps!="function"||(O!==ce||ie!==L)&&ey(o,S,f,L),Gs=!1,ie=o.memoizedState,S.state=ie,cc(o,f,S,m);var Se=o.memoizedState;O!==ce||ie!==Se||xn.current||Gs?(typeof we=="function"&&(rf(o,l,we,f),Se=o.memoizedState),(Y=Gs||Zg(o,l,Y,f,ie,Se,L)||!1)?(ae||typeof S.UNSAFE_componentWillUpdate!="function"&&typeof S.componentWillUpdate!="function"||(typeof S.componentWillUpdate=="function"&&S.componentWillUpdate(f,Se,L),typeof S.UNSAFE_componentWillUpdate=="function"&&S.UNSAFE_componentWillUpdate(f,Se,L)),typeof S.componentDidUpdate=="function"&&(o.flags|=4),typeof S.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof S.componentDidUpdate!="function"||O===s.memoizedProps&&ie===s.memoizedState||(o.flags|=4),typeof S.getSnapshotBeforeUpdate!="function"||O===s.memoizedProps&&ie===s.memoizedState||(o.flags|=1024),o.memoizedProps=f,o.memoizedState=Se),S.props=f,S.state=Se,S.context=L,f=Y):(typeof S.componentDidUpdate!="function"||O===s.memoizedProps&&ie===s.memoizedState||(o.flags|=4),typeof S.getSnapshotBeforeUpdate!="function"||O===s.memoizedProps&&ie===s.memoizedState||(o.flags|=1024),f=!1)}return uf(s,o,l,f,v,m)}function uf(s,o,l,f,m,v){cy(s,o);var S=(o.flags&128)!==0;if(!f&&!S)return m&&gg(o,l,!1),vs(s,o,v);f=o.stateNode,uI.current=o;var O=S&&typeof l.getDerivedStateFromError!="function"?null:f.render();return o.flags|=1,s!==null&&S?(o.child=Yo(o,s.child,null,v),o.child=Yo(o,null,O,v)):En(s,o,O,v),o.memoizedState=f.state,m&&gg(o,l,!0),o.child}function dy(s){var o=s.stateNode;o.pendingContext?pg(s,o.pendingContext,o.pendingContext!==o.context):o.context&&pg(s,o.context,!1),qd(s,o.containerInfo)}function fy(s,o,l,f,m){return Xo(),Ld(m),o.flags|=256,En(s,o,l,f),o.child}var cf={dehydrated:null,treeContext:null,retryLane:0};function hf(s){return{baseLanes:s,cachePool:null,transitions:null}}function py(s,o,l){var f=o.pendingProps,m=Tt.current,v=!1,S=(o.flags&128)!==0,O;if((O=S)||(O=s!==null&&s.memoizedState===null?!1:(m&2)!==0),O?(v=!0,o.flags&=-129):(s===null||s.memoizedState!==null)&&(m|=1),ct(Tt,m&1),s===null)return Fd(o),s=o.memoizedState,s!==null&&(s=s.dehydrated,s!==null)?(o.mode&1?s.data==="$!"?o.lanes=8:o.lanes=1073741824:o.lanes=1,null):(S=f.children,s=f.fallback,v?(f=o.mode,v=o.child,S={mode:"hidden",children:S},!(f&1)&&v!==null?(v.childLanes=0,v.pendingProps=S):v=kc(S,f,0,null),s=Hi(s,f,l,null),v.return=o,s.return=o,v.sibling=s,o.child=v,o.child.memoizedState=hf(l),o.memoizedState=cf,s):df(o,S));if(m=s.memoizedState,m!==null&&(O=m.dehydrated,O!==null))return cI(s,o,S,f,O,m,l);if(v){v=f.fallback,S=o.mode,m=s.child,O=m.sibling;var L={mode:"hidden",children:f.children};return!(S&1)&&o.child!==m?(f=o.child,f.childLanes=0,f.pendingProps=L,o.deletions=null):(f=Js(m,L),f.subtreeFlags=m.subtreeFlags&14680064),O!==null?v=Js(O,v):(v=Hi(v,S,l,null),v.flags|=2),v.return=o,f.return=o,f.sibling=v,o.child=f,f=v,v=o.child,S=s.child.memoizedState,S=S===null?hf(l):{baseLanes:S.baseLanes|l,cachePool:null,transitions:S.transitions},v.memoizedState=S,v.childLanes=s.childLanes&~l,o.memoizedState=cf,f}return v=s.child,s=v.sibling,f=Js(v,{mode:"visible",children:f.children}),!(o.mode&1)&&(f.lanes=l),f.return=o,f.sibling=null,s!==null&&(l=o.deletions,l===null?(o.deletions=[s],o.flags|=16):l.push(s)),o.child=f,o.memoizedState=null,f}function df(s,o){return o=kc({mode:"visible",children:o},s.mode,0,null),o.return=s,s.child=o}function vc(s,o,l,f){return f!==null&&Ld(f),Yo(o,s.child,null,l),s=df(o,o.pendingProps.children),s.flags|=2,o.memoizedState=null,s}function cI(s,o,l,f,m,v,S){if(l)return o.flags&256?(o.flags&=-257,f=of(Error(t(422))),vc(s,o,S,f)):o.memoizedState!==null?(o.child=s.child,o.flags|=128,null):(v=f.fallback,m=o.mode,f=kc({mode:"visible",children:f.children},m,0,null),v=Hi(v,m,S,null),v.flags|=2,f.return=o,v.return=o,f.sibling=v,o.child=f,o.mode&1&&Yo(o,s.child,null,S),o.child.memoizedState=hf(S),o.memoizedState=cf,v);if(!(o.mode&1))return vc(s,o,S,null);if(m.data==="$!"){if(f=m.nextSibling&&m.nextSibling.dataset,f)var O=f.dgst;return f=O,v=Error(t(419)),f=of(v,f,void 0),vc(s,o,S,f)}if(O=(S&s.childLanes)!==0,Rn||O){if(f=Gt,f!==null){switch(S&-S){case 4:m=2;break;case 16:m=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:m=32;break;case 536870912:m=268435456;break;default:m=0}m=m&(f.suspendedLanes|S)?0:m,m!==0&&m!==v.retryLane&&(v.retryLane=m,gs(s,m),br(f,s,m,-1))}return Nf(),f=of(Error(t(421))),vc(s,o,S,f)}return m.data==="$?"?(o.flags|=128,o.child=s.child,o=II.bind(null,s),m._reactRetry=o,null):(s=v.treeContext,qn=Us(m.nextSibling),Wn=o,yt=!0,Nr=null,s!==null&&(rr[sr++]=ps,rr[sr++]=ms,rr[sr++]=ji,ps=s.id,ms=s.overflow,ji=o),o=df(o,f.children),o.flags|=4096,o)}function my(s,o,l){s.lanes|=o;var f=s.alternate;f!==null&&(f.lanes|=o),Ud(s.return,o,l)}function ff(s,o,l,f,m){var v=s.memoizedState;v===null?s.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:f,tail:l,tailMode:m}:(v.isBackwards=o,v.rendering=null,v.renderingStartTime=0,v.last=f,v.tail=l,v.tailMode=m)}function gy(s,o,l){var f=o.pendingProps,m=f.revealOrder,v=f.tail;if(En(s,o,f.children,l),f=Tt.current,f&2)f=f&1|2,o.flags|=128;else{if(s!==null&&s.flags&128)e:for(s=o.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&my(s,l,o);else if(s.tag===19)my(s,l,o);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===o)break e;for(;s.sibling===null;){if(s.return===null||s.return===o)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}f&=1}if(ct(Tt,f),!(o.mode&1))o.memoizedState=null;else switch(m){case"forwards":for(l=o.child,m=null;l!==null;)s=l.alternate,s!==null&&hc(s)===null&&(m=l),l=l.sibling;l=m,l===null?(m=o.child,o.child=null):(m=l.sibling,l.sibling=null),ff(o,!1,m,l,v);break;case"backwards":for(l=null,m=o.child,o.child=null;m!==null;){if(s=m.alternate,s!==null&&hc(s)===null){o.child=m;break}s=m.sibling,m.sibling=l,l=m,m=s}ff(o,!0,l,null,v);break;case"together":ff(o,!1,null,null,void 0);break;default:o.memoizedState=null}return o.child}function _c(s,o){!(o.mode&1)&&s!==null&&(s.alternate=null,o.alternate=null,o.flags|=2)}function vs(s,o,l){if(s!==null&&(o.dependencies=s.dependencies),Wi|=o.lanes,!(l&o.childLanes))return null;if(s!==null&&o.child!==s.child)throw Error(t(153));if(o.child!==null){for(s=o.child,l=Js(s,s.pendingProps),o.child=l,l.return=o;s.sibling!==null;)s=s.sibling,l=l.sibling=Js(s,s.pendingProps),l.return=o;l.sibling=null}return o.child}function hI(s,o,l){switch(o.tag){case 3:dy(o),Xo();break;case 5:Pg(o);break;case 1:Nn(o.type)&&tc(o);break;case 4:qd(o,o.stateNode.containerInfo);break;case 10:var f=o.type._context,m=o.memoizedProps.value;ct(ac,f._currentValue),f._currentValue=m;break;case 13:if(f=o.memoizedState,f!==null)return f.dehydrated!==null?(ct(Tt,Tt.current&1),o.flags|=128,null):l&o.child.childLanes?py(s,o,l):(ct(Tt,Tt.current&1),s=vs(s,o,l),s!==null?s.sibling:null);ct(Tt,Tt.current&1);break;case 19:if(f=(l&o.childLanes)!==0,s.flags&128){if(f)return gy(s,o,l);o.flags|=128}if(m=o.memoizedState,m!==null&&(m.rendering=null,m.tail=null,m.lastEffect=null),ct(Tt,Tt.current),f)break;return null;case 22:case 23:return o.lanes=0,uy(s,o,l)}return vs(s,o,l)}var yy,pf,vy,_y;yy=function(s,o){for(var l=o.child;l!==null;){if(l.tag===5||l.tag===6)s.appendChild(l.stateNode);else if(l.tag!==4&&l.child!==null){l.child.return=l,l=l.child;continue}if(l===o)break;for(;l.sibling===null;){if(l.return===null||l.return===o)return;l=l.return}l.sibling.return=l.return,l=l.sibling}},pf=function(){},vy=function(s,o,l,f){var m=s.memoizedProps;if(m!==f){s=o.stateNode,Ui(Hr.current);var v=null;switch(l){case"input":m=Le(s,m),f=Le(s,f),v=[];break;case"select":m=re({},m,{value:void 0}),f=re({},f,{value:void 0}),v=[];break;case"textarea":m=Lr(s,m),f=Lr(s,f),v=[];break;default:typeof m.onClick!="function"&&typeof f.onClick=="function"&&(s.onclick=Zu)}Si(l,f);var S;l=null;for(Y in m)if(!f.hasOwnProperty(Y)&&m.hasOwnProperty(Y)&&m[Y]!=null)if(Y==="style"){var O=m[Y];for(S in O)O.hasOwnProperty(S)&&(l||(l={}),l[S]="")}else Y!=="dangerouslySetInnerHTML"&&Y!=="children"&&Y!=="suppressContentEditableWarning"&&Y!=="suppressHydrationWarning"&&Y!=="autoFocus"&&(i.hasOwnProperty(Y)?v||(v=[]):(v=v||[]).push(Y,null));for(Y in f){var L=f[Y];if(O=m!=null?m[Y]:void 0,f.hasOwnProperty(Y)&&L!==O&&(L!=null||O!=null))if(Y==="style")if(O){for(S in O)!O.hasOwnProperty(S)||L&&L.hasOwnProperty(S)||(l||(l={}),l[S]="");for(S in L)L.hasOwnProperty(S)&&O[S]!==L[S]&&(l||(l={}),l[S]=L[S])}else l||(v||(v=[]),v.push(Y,l)),l=L;else Y==="dangerouslySetInnerHTML"?(L=L?L.__html:void 0,O=O?O.__html:void 0,L!=null&&O!==L&&(v=v||[]).push(Y,L)):Y==="children"?typeof L!="string"&&typeof L!="number"||(v=v||[]).push(Y,""+L):Y!=="suppressContentEditableWarning"&&Y!=="suppressHydrationWarning"&&(i.hasOwnProperty(Y)?(L!=null&&Y==="onScroll"&&ft("scroll",s),v||O===L||(v=[])):(v=v||[]).push(Y,L))}l&&(v=v||[]).push("style",l);var Y=v;(o.updateQueue=Y)&&(o.flags|=4)}},_y=function(s,o,l,f){l!==f&&(o.flags|=4)};function _l(s,o){if(!yt)switch(s.tailMode){case"hidden":o=s.tail;for(var l=null;o!==null;)o.alternate!==null&&(l=o),o=o.sibling;l===null?s.tail=null:l.sibling=null;break;case"collapsed":l=s.tail;for(var f=null;l!==null;)l.alternate!==null&&(f=l),l=l.sibling;f===null?o||s.tail===null?s.tail=null:s.tail.sibling=null:f.sibling=null}}function on(s){var o=s.alternate!==null&&s.alternate.child===s.child,l=0,f=0;if(o)for(var m=s.child;m!==null;)l|=m.lanes|m.childLanes,f|=m.subtreeFlags&14680064,f|=m.flags&14680064,m.return=s,m=m.sibling;else for(m=s.child;m!==null;)l|=m.lanes|m.childLanes,f|=m.subtreeFlags,f|=m.flags,m.return=s,m=m.sibling;return s.subtreeFlags|=f,s.childLanes=l,o}function dI(s,o,l){var f=o.pendingProps;switch(Md(o),o.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return on(o),null;case 1:return Nn(o.type)&&ec(),on(o),null;case 3:return f=o.stateNode,ea(),pt(xn),pt(rn),Hd(),f.pendingContext&&(f.context=f.pendingContext,f.pendingContext=null),(s===null||s.child===null)&&(ic(o)?o.flags|=4:s===null||s.memoizedState.isDehydrated&&!(o.flags&256)||(o.flags|=1024,Nr!==null&&(Cf(Nr),Nr=null))),pf(s,o),on(o),null;case 5:Gd(o);var m=Ui(pl.current);if(l=o.type,s!==null&&o.stateNode!=null)vy(s,o,l,f,m),s.ref!==o.ref&&(o.flags|=512,o.flags|=2097152);else{if(!f){if(o.stateNode===null)throw Error(t(166));return on(o),null}if(s=Ui(Hr.current),ic(o)){f=o.stateNode,l=o.type;var v=o.memoizedProps;switch(f[Kr]=o,f[ul]=v,s=(o.mode&1)!==0,l){case"dialog":ft("cancel",f),ft("close",f);break;case"iframe":case"object":case"embed":ft("load",f);break;case"video":case"audio":for(m=0;m<ol.length;m++)ft(ol[m],f);break;case"source":ft("error",f);break;case"img":case"image":case"link":ft("error",f),ft("load",f);break;case"details":ft("toggle",f);break;case"input":Pt(f,v),ft("invalid",f);break;case"select":f._wrapperState={wasMultiple:!!v.multiple},ft("invalid",f);break;case"textarea":pr(f,v),ft("invalid",f)}Si(l,v),m=null;for(var S in v)if(v.hasOwnProperty(S)){var O=v[S];S==="children"?typeof O=="string"?f.textContent!==O&&(v.suppressHydrationWarning!==!0&&Yu(f.textContent,O,s),m=["children",O]):typeof O=="number"&&f.textContent!==""+O&&(v.suppressHydrationWarning!==!0&&Yu(f.textContent,O,s),m=["children",""+O]):i.hasOwnProperty(S)&&O!=null&&S==="onScroll"&&ft("scroll",f)}switch(l){case"input":be(f),fr(f,v,!0);break;case"textarea":be(f),Fn(f);break;case"select":case"option":break;default:typeof v.onClick=="function"&&(f.onclick=Zu)}f=m,o.updateQueue=f,f!==null&&(o.flags|=4)}else{S=m.nodeType===9?m:m.ownerDocument,s==="http://www.w3.org/1999/xhtml"&&(s=st(l)),s==="http://www.w3.org/1999/xhtml"?l==="script"?(s=S.createElement("div"),s.innerHTML="<script><\/script>",s=s.removeChild(s.firstChild)):typeof f.is=="string"?s=S.createElement(l,{is:f.is}):(s=S.createElement(l),l==="select"&&(S=s,f.multiple?S.multiple=!0:f.size&&(S.size=f.size))):s=S.createElementNS(s,l),s[Kr]=o,s[ul]=f,yy(s,o,!1,!1),o.stateNode=s;e:{switch(S=Ci(l,f),l){case"dialog":ft("cancel",s),ft("close",s),m=f;break;case"iframe":case"object":case"embed":ft("load",s),m=f;break;case"video":case"audio":for(m=0;m<ol.length;m++)ft(ol[m],s);m=f;break;case"source":ft("error",s),m=f;break;case"img":case"image":case"link":ft("error",s),ft("load",s),m=f;break;case"details":ft("toggle",s),m=f;break;case"input":Pt(s,f),m=Le(s,f),ft("invalid",s);break;case"option":m=f;break;case"select":s._wrapperState={wasMultiple:!!f.multiple},m=re({},f,{value:void 0}),ft("invalid",s);break;case"textarea":pr(s,f),m=Lr(s,f),ft("invalid",s);break;default:m=f}Si(l,m),O=m;for(v in O)if(O.hasOwnProperty(v)){var L=O[v];v==="style"?yr(s,L):v==="dangerouslySetInnerHTML"?(L=L?L.__html:void 0,L!=null&&jr(s,L)):v==="children"?typeof L=="string"?(l!=="textarea"||L!=="")&&Jn(s,L):typeof L=="number"&&Jn(s,""+L):v!=="suppressContentEditableWarning"&&v!=="suppressHydrationWarning"&&v!=="autoFocus"&&(i.hasOwnProperty(v)?L!=null&&v==="onScroll"&&ft("scroll",s):L!=null&&z(s,v,L,S))}switch(l){case"input":be(s),fr(s,f,!1);break;case"textarea":be(s),Fn(s);break;case"option":f.value!=null&&s.setAttribute("value",""+q(f.value));break;case"select":s.multiple=!!f.multiple,v=f.value,v!=null?gn(s,!!f.multiple,v,!1):f.defaultValue!=null&&gn(s,!!f.multiple,f.defaultValue,!0);break;default:typeof m.onClick=="function"&&(s.onclick=Zu)}switch(l){case"button":case"input":case"select":case"textarea":f=!!f.autoFocus;break e;case"img":f=!0;break e;default:f=!1}}f&&(o.flags|=4)}o.ref!==null&&(o.flags|=512,o.flags|=2097152)}return on(o),null;case 6:if(s&&o.stateNode!=null)_y(s,o,s.memoizedProps,f);else{if(typeof f!="string"&&o.stateNode===null)throw Error(t(166));if(l=Ui(pl.current),Ui(Hr.current),ic(o)){if(f=o.stateNode,l=o.memoizedProps,f[Kr]=o,(v=f.nodeValue!==l)&&(s=Wn,s!==null))switch(s.tag){case 3:Yu(f.nodeValue,l,(s.mode&1)!==0);break;case 5:s.memoizedProps.suppressHydrationWarning!==!0&&Yu(f.nodeValue,l,(s.mode&1)!==0)}v&&(o.flags|=4)}else f=(l.nodeType===9?l:l.ownerDocument).createTextNode(f),f[Kr]=o,o.stateNode=f}return on(o),null;case 13:if(pt(Tt),f=o.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(yt&&qn!==null&&o.mode&1&&!(o.flags&128))Tg(),Xo(),o.flags|=98560,v=!1;else if(v=ic(o),f!==null&&f.dehydrated!==null){if(s===null){if(!v)throw Error(t(318));if(v=o.memoizedState,v=v!==null?v.dehydrated:null,!v)throw Error(t(317));v[Kr]=o}else Xo(),!(o.flags&128)&&(o.memoizedState=null),o.flags|=4;on(o),v=!1}else Nr!==null&&(Cf(Nr),Nr=null),v=!0;if(!v)return o.flags&65536?o:null}return o.flags&128?(o.lanes=l,o):(f=f!==null,f!==(s!==null&&s.memoizedState!==null)&&f&&(o.child.flags|=8192,o.mode&1&&(s===null||Tt.current&1?zt===0&&(zt=3):Nf())),o.updateQueue!==null&&(o.flags|=4),on(o),null);case 4:return ea(),pf(s,o),s===null&&al(o.stateNode.containerInfo),on(o),null;case 10:return zd(o.type._context),on(o),null;case 17:return Nn(o.type)&&ec(),on(o),null;case 19:if(pt(Tt),v=o.memoizedState,v===null)return on(o),null;if(f=(o.flags&128)!==0,S=v.rendering,S===null)if(f)_l(v,!1);else{if(zt!==0||s!==null&&s.flags&128)for(s=o.child;s!==null;){if(S=hc(s),S!==null){for(o.flags|=128,_l(v,!1),f=S.updateQueue,f!==null&&(o.updateQueue=f,o.flags|=4),o.subtreeFlags=0,f=l,l=o.child;l!==null;)v=l,s=f,v.flags&=14680066,S=v.alternate,S===null?(v.childLanes=0,v.lanes=s,v.child=null,v.subtreeFlags=0,v.memoizedProps=null,v.memoizedState=null,v.updateQueue=null,v.dependencies=null,v.stateNode=null):(v.childLanes=S.childLanes,v.lanes=S.lanes,v.child=S.child,v.subtreeFlags=0,v.deletions=null,v.memoizedProps=S.memoizedProps,v.memoizedState=S.memoizedState,v.updateQueue=S.updateQueue,v.type=S.type,s=S.dependencies,v.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),l=l.sibling;return ct(Tt,Tt.current&1|2),o.child}s=s.sibling}v.tail!==null&&ut()>sa&&(o.flags|=128,f=!0,_l(v,!1),o.lanes=4194304)}else{if(!f)if(s=hc(S),s!==null){if(o.flags|=128,f=!0,l=s.updateQueue,l!==null&&(o.updateQueue=l,o.flags|=4),_l(v,!0),v.tail===null&&v.tailMode==="hidden"&&!S.alternate&&!yt)return on(o),null}else 2*ut()-v.renderingStartTime>sa&&l!==1073741824&&(o.flags|=128,f=!0,_l(v,!1),o.lanes=4194304);v.isBackwards?(S.sibling=o.child,o.child=S):(l=v.last,l!==null?l.sibling=S:o.child=S,v.last=S)}return v.tail!==null?(o=v.tail,v.rendering=o,v.tail=o.sibling,v.renderingStartTime=ut(),o.sibling=null,l=Tt.current,ct(Tt,f?l&1|2:l&1),o):(on(o),null);case 22:case 23:return xf(),f=o.memoizedState!==null,s!==null&&s.memoizedState!==null!==f&&(o.flags|=8192),f&&o.mode&1?Gn&1073741824&&(on(o),o.subtreeFlags&6&&(o.flags|=8192)):on(o),null;case 24:return null;case 25:return null}throw Error(t(156,o.tag))}function fI(s,o){switch(Md(o),o.tag){case 1:return Nn(o.type)&&ec(),s=o.flags,s&65536?(o.flags=s&-65537|128,o):null;case 3:return ea(),pt(xn),pt(rn),Hd(),s=o.flags,s&65536&&!(s&128)?(o.flags=s&-65537|128,o):null;case 5:return Gd(o),null;case 13:if(pt(Tt),s=o.memoizedState,s!==null&&s.dehydrated!==null){if(o.alternate===null)throw Error(t(340));Xo()}return s=o.flags,s&65536?(o.flags=s&-65537|128,o):null;case 19:return pt(Tt),null;case 4:return ea(),null;case 10:return zd(o.type._context),null;case 22:case 23:return xf(),null;case 24:return null;default:return null}}var wc=!1,an=!1,pI=typeof WeakSet=="function"?WeakSet:Set,Ie=null;function na(s,o){var l=s.ref;if(l!==null)if(typeof l=="function")try{l(null)}catch(f){At(s,o,f)}else l.current=null}function mf(s,o,l){try{l()}catch(f){At(s,o,f)}}var wy=!1;function mI(s,o){if(Ad=js,s=Zm(),vd(s)){if("selectionStart"in s)var l={start:s.selectionStart,end:s.selectionEnd};else e:{l=(l=s.ownerDocument)&&l.defaultView||window;var f=l.getSelection&&l.getSelection();if(f&&f.rangeCount!==0){l=f.anchorNode;var m=f.anchorOffset,v=f.focusNode;f=f.focusOffset;try{l.nodeType,v.nodeType}catch{l=null;break e}var S=0,O=-1,L=-1,Y=0,ae=0,ce=s,ie=null;t:for(;;){for(var we;ce!==l||m!==0&&ce.nodeType!==3||(O=S+m),ce!==v||f!==0&&ce.nodeType!==3||(L=S+f),ce.nodeType===3&&(S+=ce.nodeValue.length),(we=ce.firstChild)!==null;)ie=ce,ce=we;for(;;){if(ce===s)break t;if(ie===l&&++Y===m&&(O=S),ie===v&&++ae===f&&(L=S),(we=ce.nextSibling)!==null)break;ce=ie,ie=ce.parentNode}ce=we}l=O===-1||L===-1?null:{start:O,end:L}}else l=null}l=l||{start:0,end:0}}else l=null;for(xd={focusedElem:s,selectionRange:l},js=!1,Ie=o;Ie!==null;)if(o=Ie,s=o.child,(o.subtreeFlags&1028)!==0&&s!==null)s.return=o,Ie=s;else for(;Ie!==null;){o=Ie;try{var Se=o.alternate;if(o.flags&1024)switch(o.tag){case 0:case 11:case 15:break;case 1:if(Se!==null){var Ne=Se.memoizedProps,kt=Se.memoizedState,H=o.stateNode,B=H.getSnapshotBeforeUpdate(o.elementType===o.type?Ne:Rr(o.type,Ne),kt);H.__reactInternalSnapshotBeforeUpdate=B}break;case 3:var Q=o.stateNode.containerInfo;Q.nodeType===1?Q.textContent="":Q.nodeType===9&&Q.documentElement&&Q.removeChild(Q.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(he){At(o,o.return,he)}if(s=o.sibling,s!==null){s.return=o.return,Ie=s;break}Ie=o.return}return Se=wy,wy=!1,Se}function wl(s,o,l){var f=o.updateQueue;if(f=f!==null?f.lastEffect:null,f!==null){var m=f=f.next;do{if((m.tag&s)===s){var v=m.destroy;m.destroy=void 0,v!==void 0&&mf(o,l,v)}m=m.next}while(m!==f)}}function Ec(s,o){if(o=o.updateQueue,o=o!==null?o.lastEffect:null,o!==null){var l=o=o.next;do{if((l.tag&s)===s){var f=l.create;l.destroy=f()}l=l.next}while(l!==o)}}function gf(s){var o=s.ref;if(o!==null){var l=s.stateNode;switch(s.tag){case 5:s=l;break;default:s=l}typeof o=="function"?o(s):o.current=s}}function Ey(s){var o=s.alternate;o!==null&&(s.alternate=null,Ey(o)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(o=s.stateNode,o!==null&&(delete o[Kr],delete o[ul],delete o[kd],delete o[YT],delete o[ZT])),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}function Ty(s){return s.tag===5||s.tag===3||s.tag===4}function Iy(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||Ty(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function yf(s,o,l){var f=s.tag;if(f===5||f===6)s=s.stateNode,o?l.nodeType===8?l.parentNode.insertBefore(s,o):l.insertBefore(s,o):(l.nodeType===8?(o=l.parentNode,o.insertBefore(s,l)):(o=l,o.appendChild(s)),l=l._reactRootContainer,l!=null||o.onclick!==null||(o.onclick=Zu));else if(f!==4&&(s=s.child,s!==null))for(yf(s,o,l),s=s.sibling;s!==null;)yf(s,o,l),s=s.sibling}function vf(s,o,l){var f=s.tag;if(f===5||f===6)s=s.stateNode,o?l.insertBefore(s,o):l.appendChild(s);else if(f!==4&&(s=s.child,s!==null))for(vf(s,o,l),s=s.sibling;s!==null;)vf(s,o,l),s=s.sibling}var Jt=null,Pr=!1;function Hs(s,o,l){for(l=l.child;l!==null;)Sy(s,o,l),l=l.sibling}function Sy(s,o,l){if(Bn&&typeof Bn.onCommitFiberUnmount=="function")try{Bn.onCommitFiberUnmount(Pi,l)}catch{}switch(l.tag){case 5:an||na(l,o);case 6:var f=Jt,m=Pr;Jt=null,Hs(s,o,l),Jt=f,Pr=m,Jt!==null&&(Pr?(s=Jt,l=l.stateNode,s.nodeType===8?s.parentNode.removeChild(l):s.removeChild(l)):Jt.removeChild(l.stateNode));break;case 18:Jt!==null&&(Pr?(s=Jt,l=l.stateNode,s.nodeType===8?Pd(s.parentNode,l):s.nodeType===1&&Pd(s,l),Cr(s)):Pd(Jt,l.stateNode));break;case 4:f=Jt,m=Pr,Jt=l.stateNode.containerInfo,Pr=!0,Hs(s,o,l),Jt=f,Pr=m;break;case 0:case 11:case 14:case 15:if(!an&&(f=l.updateQueue,f!==null&&(f=f.lastEffect,f!==null))){m=f=f.next;do{var v=m,S=v.destroy;v=v.tag,S!==void 0&&(v&2||v&4)&&mf(l,o,S),m=m.next}while(m!==f)}Hs(s,o,l);break;case 1:if(!an&&(na(l,o),f=l.stateNode,typeof f.componentWillUnmount=="function"))try{f.props=l.memoizedProps,f.state=l.memoizedState,f.componentWillUnmount()}catch(O){At(l,o,O)}Hs(s,o,l);break;case 21:Hs(s,o,l);break;case 22:l.mode&1?(an=(f=an)||l.memoizedState!==null,Hs(s,o,l),an=f):Hs(s,o,l);break;default:Hs(s,o,l)}}function Cy(s){var o=s.updateQueue;if(o!==null){s.updateQueue=null;var l=s.stateNode;l===null&&(l=s.stateNode=new pI),o.forEach(function(f){var m=SI.bind(null,s,f);l.has(f)||(l.add(f),f.then(m,m))})}}function kr(s,o){var l=o.deletions;if(l!==null)for(var f=0;f<l.length;f++){var m=l[f];try{var v=s,S=o,O=S;e:for(;O!==null;){switch(O.tag){case 5:Jt=O.stateNode,Pr=!1;break e;case 3:Jt=O.stateNode.containerInfo,Pr=!0;break e;case 4:Jt=O.stateNode.containerInfo,Pr=!0;break e}O=O.return}if(Jt===null)throw Error(t(160));Sy(v,S,m),Jt=null,Pr=!1;var L=m.alternate;L!==null&&(L.return=null),m.return=null}catch(Y){At(m,o,Y)}}if(o.subtreeFlags&12854)for(o=o.child;o!==null;)Ay(o,s),o=o.sibling}function Ay(s,o){var l=s.alternate,f=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:if(kr(o,s),Xr(s),f&4){try{wl(3,s,s.return),Ec(3,s)}catch(Ne){At(s,s.return,Ne)}try{wl(5,s,s.return)}catch(Ne){At(s,s.return,Ne)}}break;case 1:kr(o,s),Xr(s),f&512&&l!==null&&na(l,l.return);break;case 5:if(kr(o,s),Xr(s),f&512&&l!==null&&na(l,l.return),s.flags&32){var m=s.stateNode;try{Jn(m,"")}catch(Ne){At(s,s.return,Ne)}}if(f&4&&(m=s.stateNode,m!=null)){var v=s.memoizedProps,S=l!==null?l.memoizedProps:v,O=s.type,L=s.updateQueue;if(s.updateQueue=null,L!==null)try{O==="input"&&v.type==="radio"&&v.name!=null&&On(m,v),Ci(O,S);var Y=Ci(O,v);for(S=0;S<L.length;S+=2){var ae=L[S],ce=L[S+1];ae==="style"?yr(m,ce):ae==="dangerouslySetInnerHTML"?jr(m,ce):ae==="children"?Jn(m,ce):z(m,ae,ce,Y)}switch(O){case"input":Yn(m,v);break;case"textarea":wt(m,v);break;case"select":var ie=m._wrapperState.wasMultiple;m._wrapperState.wasMultiple=!!v.multiple;var we=v.value;we!=null?gn(m,!!v.multiple,we,!1):ie!==!!v.multiple&&(v.defaultValue!=null?gn(m,!!v.multiple,v.defaultValue,!0):gn(m,!!v.multiple,v.multiple?[]:"",!1))}m[ul]=v}catch(Ne){At(s,s.return,Ne)}}break;case 6:if(kr(o,s),Xr(s),f&4){if(s.stateNode===null)throw Error(t(162));m=s.stateNode,v=s.memoizedProps;try{m.nodeValue=v}catch(Ne){At(s,s.return,Ne)}}break;case 3:if(kr(o,s),Xr(s),f&4&&l!==null&&l.memoizedState.isDehydrated)try{Cr(o.containerInfo)}catch(Ne){At(s,s.return,Ne)}break;case 4:kr(o,s),Xr(s);break;case 13:kr(o,s),Xr(s),m=s.child,m.flags&8192&&(v=m.memoizedState!==null,m.stateNode.isHidden=v,!v||m.alternate!==null&&m.alternate.memoizedState!==null||(Ef=ut())),f&4&&Cy(s);break;case 22:if(ae=l!==null&&l.memoizedState!==null,s.mode&1?(an=(Y=an)||ae,kr(o,s),an=Y):kr(o,s),Xr(s),f&8192){if(Y=s.memoizedState!==null,(s.stateNode.isHidden=Y)&&!ae&&s.mode&1)for(Ie=s,ae=s.child;ae!==null;){for(ce=Ie=ae;Ie!==null;){switch(ie=Ie,we=ie.child,ie.tag){case 0:case 11:case 14:case 15:wl(4,ie,ie.return);break;case 1:na(ie,ie.return);var Se=ie.stateNode;if(typeof Se.componentWillUnmount=="function"){f=ie,l=ie.return;try{o=f,Se.props=o.memoizedProps,Se.state=o.memoizedState,Se.componentWillUnmount()}catch(Ne){At(f,l,Ne)}}break;case 5:na(ie,ie.return);break;case 22:if(ie.memoizedState!==null){Ry(ce);continue}}we!==null?(we.return=ie,Ie=we):Ry(ce)}ae=ae.sibling}e:for(ae=null,ce=s;;){if(ce.tag===5){if(ae===null){ae=ce;try{m=ce.stateNode,Y?(v=m.style,typeof v.setProperty=="function"?v.setProperty("display","none","important"):v.display="none"):(O=ce.stateNode,L=ce.memoizedProps.style,S=L!=null&&L.hasOwnProperty("display")?L.display:null,O.style.display=gr("display",S))}catch(Ne){At(s,s.return,Ne)}}}else if(ce.tag===6){if(ae===null)try{ce.stateNode.nodeValue=Y?"":ce.memoizedProps}catch(Ne){At(s,s.return,Ne)}}else if((ce.tag!==22&&ce.tag!==23||ce.memoizedState===null||ce===s)&&ce.child!==null){ce.child.return=ce,ce=ce.child;continue}if(ce===s)break e;for(;ce.sibling===null;){if(ce.return===null||ce.return===s)break e;ae===ce&&(ae=null),ce=ce.return}ae===ce&&(ae=null),ce.sibling.return=ce.return,ce=ce.sibling}}break;case 19:kr(o,s),Xr(s),f&4&&Cy(s);break;case 21:break;default:kr(o,s),Xr(s)}}function Xr(s){var o=s.flags;if(o&2){try{e:{for(var l=s.return;l!==null;){if(Ty(l)){var f=l;break e}l=l.return}throw Error(t(160))}switch(f.tag){case 5:var m=f.stateNode;f.flags&32&&(Jn(m,""),f.flags&=-33);var v=Iy(s);vf(s,v,m);break;case 3:case 4:var S=f.stateNode.containerInfo,O=Iy(s);yf(s,O,S);break;default:throw Error(t(161))}}catch(L){At(s,s.return,L)}s.flags&=-3}o&4096&&(s.flags&=-4097)}function gI(s,o,l){Ie=s,xy(s)}function xy(s,o,l){for(var f=(s.mode&1)!==0;Ie!==null;){var m=Ie,v=m.child;if(m.tag===22&&f){var S=m.memoizedState!==null||wc;if(!S){var O=m.alternate,L=O!==null&&O.memoizedState!==null||an;O=wc;var Y=an;if(wc=S,(an=L)&&!Y)for(Ie=m;Ie!==null;)S=Ie,L=S.child,S.tag===22&&S.memoizedState!==null?Py(m):L!==null?(L.return=S,Ie=L):Py(m);for(;v!==null;)Ie=v,xy(v),v=v.sibling;Ie=m,wc=O,an=Y}Ny(s)}else m.subtreeFlags&8772&&v!==null?(v.return=m,Ie=v):Ny(s)}}function Ny(s){for(;Ie!==null;){var o=Ie;if(o.flags&8772){var l=o.alternate;try{if(o.flags&8772)switch(o.tag){case 0:case 11:case 15:an||Ec(5,o);break;case 1:var f=o.stateNode;if(o.flags&4&&!an)if(l===null)f.componentDidMount();else{var m=o.elementType===o.type?l.memoizedProps:Rr(o.type,l.memoizedProps);f.componentDidUpdate(m,l.memoizedState,f.__reactInternalSnapshotBeforeUpdate)}var v=o.updateQueue;v!==null&&Rg(o,v,f);break;case 3:var S=o.updateQueue;if(S!==null){if(l=null,o.child!==null)switch(o.child.tag){case 5:l=o.child.stateNode;break;case 1:l=o.child.stateNode}Rg(o,S,l)}break;case 5:var O=o.stateNode;if(l===null&&o.flags&4){l=O;var L=o.memoizedProps;switch(o.type){case"button":case"input":case"select":case"textarea":L.autoFocus&&l.focus();break;case"img":L.src&&(l.src=L.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(o.memoizedState===null){var Y=o.alternate;if(Y!==null){var ae=Y.memoizedState;if(ae!==null){var ce=ae.dehydrated;ce!==null&&Cr(ce)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}an||o.flags&512&&gf(o)}catch(ie){At(o,o.return,ie)}}if(o===s){Ie=null;break}if(l=o.sibling,l!==null){l.return=o.return,Ie=l;break}Ie=o.return}}function Ry(s){for(;Ie!==null;){var o=Ie;if(o===s){Ie=null;break}var l=o.sibling;if(l!==null){l.return=o.return,Ie=l;break}Ie=o.return}}function Py(s){for(;Ie!==null;){var o=Ie;try{switch(o.tag){case 0:case 11:case 15:var l=o.return;try{Ec(4,o)}catch(L){At(o,l,L)}break;case 1:var f=o.stateNode;if(typeof f.componentDidMount=="function"){var m=o.return;try{f.componentDidMount()}catch(L){At(o,m,L)}}var v=o.return;try{gf(o)}catch(L){At(o,v,L)}break;case 5:var S=o.return;try{gf(o)}catch(L){At(o,S,L)}}}catch(L){At(o,o.return,L)}if(o===s){Ie=null;break}var O=o.sibling;if(O!==null){O.return=o.return,Ie=O;break}Ie=o.return}}var yI=Math.ceil,Tc=X.ReactCurrentDispatcher,_f=X.ReactCurrentOwner,ar=X.ReactCurrentBatchConfig,Ze=0,Gt=null,Ft=null,en=0,Gn=0,ra=$s(0),zt=0,El=null,Wi=0,Ic=0,wf=0,Tl=null,Pn=null,Ef=0,sa=1/0,_s=null,Sc=!1,Tf=null,Qs=null,Cc=!1,Xs=null,Ac=0,Il=0,If=null,xc=-1,Nc=0;function Tn(){return Ze&6?ut():xc!==-1?xc:xc=ut()}function Ys(s){return s.mode&1?Ze&2&&en!==0?en&-en:eI.transition!==null?(Nc===0&&(Nc=bi()),Nc):(s=Ke,s!==0||(s=window.event,s=s===void 0?16:Ya(s.type)),s):1}function br(s,o,l,f){if(50<Il)throw Il=0,If=null,Error(t(185));Ms(s,l,f),(!(Ze&2)||s!==Gt)&&(s===Gt&&(!(Ze&2)&&(Ic|=l),zt===4&&Zs(s,en)),kn(s,f),l===1&&Ze===0&&!(o.mode&1)&&(sa=ut()+500,nc&&qs()))}function kn(s,o){var l=s.callbackNode;as(s,o);var f=ki(s,s===Gt?en:0);if(f===0)l!==null&&Ga(l),s.callbackNode=null,s.callbackPriority=0;else if(o=f&-f,s.callbackPriority!==o){if(l!=null&&Ga(l),o===1)s.tag===0?JT(by.bind(null,s)):yg(by.bind(null,s)),QT(function(){!(Ze&6)&&qs()}),l=null;else{switch(Fs(f)){case 1:l=Ri;break;case 4:l=bs;break;case 16:l=er;break;case 536870912:l=Nu;break;default:l=er}l=By(l,ky.bind(null,s))}s.callbackPriority=o,s.callbackNode=l}}function ky(s,o){if(xc=-1,Nc=0,Ze&6)throw Error(t(327));var l=s.callbackNode;if(ia()&&s.callbackNode!==l)return null;var f=ki(s,s===Gt?en:0);if(f===0)return null;if(f&30||f&s.expiredLanes||o)o=Rc(s,f);else{o=f;var m=Ze;Ze|=2;var v=Vy();(Gt!==s||en!==o)&&(_s=null,sa=ut()+500,Gi(s,o));do try{wI();break}catch(O){Dy(s,O)}while(!0);Bd(),Tc.current=v,Ze=m,Ft!==null?o=0:(Gt=null,en=0,o=zt)}if(o!==0){if(o===2&&(m=zn(s),m!==0&&(f=m,o=Sf(s,m))),o===1)throw l=El,Gi(s,0),Zs(s,f),kn(s,ut()),l;if(o===6)Zs(s,f);else{if(m=s.current.alternate,!(f&30)&&!vI(m)&&(o=Rc(s,f),o===2&&(v=zn(s),v!==0&&(f=v,o=Sf(s,v))),o===1))throw l=El,Gi(s,0),Zs(s,f),kn(s,ut()),l;switch(s.finishedWork=m,s.finishedLanes=f,o){case 0:case 1:throw Error(t(345));case 2:Ki(s,Pn,_s);break;case 3:if(Zs(s,f),(f&130023424)===f&&(o=Ef+500-ut(),10<o)){if(ki(s,0)!==0)break;if(m=s.suspendedLanes,(m&f)!==f){Tn(),s.pingedLanes|=s.suspendedLanes&m;break}s.timeoutHandle=Rd(Ki.bind(null,s,Pn,_s),o);break}Ki(s,Pn,_s);break;case 4:if(Zs(s,f),(f&4194240)===f)break;for(o=s.eventTimes,m=-1;0<f;){var S=31-_n(f);v=1<<S,S=o[S],S>m&&(m=S),f&=~v}if(f=m,f=ut()-f,f=(120>f?120:480>f?480:1080>f?1080:1920>f?1920:3e3>f?3e3:4320>f?4320:1960*yI(f/1960))-f,10<f){s.timeoutHandle=Rd(Ki.bind(null,s,Pn,_s),f);break}Ki(s,Pn,_s);break;case 5:Ki(s,Pn,_s);break;default:throw Error(t(329))}}}return kn(s,ut()),s.callbackNode===l?ky.bind(null,s):null}function Sf(s,o){var l=Tl;return s.current.memoizedState.isDehydrated&&(Gi(s,o).flags|=256),s=Rc(s,o),s!==2&&(o=Pn,Pn=l,o!==null&&Cf(o)),s}function Cf(s){Pn===null?Pn=s:Pn.push.apply(Pn,s)}function vI(s){for(var o=s;;){if(o.flags&16384){var l=o.updateQueue;if(l!==null&&(l=l.stores,l!==null))for(var f=0;f<l.length;f++){var m=l[f],v=m.getSnapshot;m=m.value;try{if(!xr(v(),m))return!1}catch{return!1}}}if(l=o.child,o.subtreeFlags&16384&&l!==null)l.return=o,o=l;else{if(o===s)break;for(;o.sibling===null;){if(o.return===null||o.return===s)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function Zs(s,o){for(o&=~wf,o&=~Ic,s.suspendedLanes|=o,s.pingedLanes&=~o,s=s.expirationTimes;0<o;){var l=31-_n(o),f=1<<l;s[l]=-1,o&=~f}}function by(s){if(Ze&6)throw Error(t(327));ia();var o=ki(s,0);if(!(o&1))return kn(s,ut()),null;var l=Rc(s,o);if(s.tag!==0&&l===2){var f=zn(s);f!==0&&(o=f,l=Sf(s,f))}if(l===1)throw l=El,Gi(s,0),Zs(s,o),kn(s,ut()),l;if(l===6)throw Error(t(345));return s.finishedWork=s.current.alternate,s.finishedLanes=o,Ki(s,Pn,_s),kn(s,ut()),null}function Af(s,o){var l=Ze;Ze|=1;try{return s(o)}finally{Ze=l,Ze===0&&(sa=ut()+500,nc&&qs())}}function qi(s){Xs!==null&&Xs.tag===0&&!(Ze&6)&&ia();var o=Ze;Ze|=1;var l=ar.transition,f=Ke;try{if(ar.transition=null,Ke=1,s)return s()}finally{Ke=f,ar.transition=l,Ze=o,!(Ze&6)&&qs()}}function xf(){Gn=ra.current,pt(ra)}function Gi(s,o){s.finishedWork=null,s.finishedLanes=0;var l=s.timeoutHandle;if(l!==-1&&(s.timeoutHandle=-1,HT(l)),Ft!==null)for(l=Ft.return;l!==null;){var f=l;switch(Md(f),f.tag){case 1:f=f.type.childContextTypes,f!=null&&ec();break;case 3:ea(),pt(xn),pt(rn),Hd();break;case 5:Gd(f);break;case 4:ea();break;case 13:pt(Tt);break;case 19:pt(Tt);break;case 10:zd(f.type._context);break;case 22:case 23:xf()}l=l.return}if(Gt=s,Ft=s=Js(s.current,null),en=Gn=o,zt=0,El=null,wf=Ic=Wi=0,Pn=Tl=null,zi!==null){for(o=0;o<zi.length;o++)if(l=zi[o],f=l.interleaved,f!==null){l.interleaved=null;var m=f.next,v=l.pending;if(v!==null){var S=v.next;v.next=m,f.next=S}l.pending=f}zi=null}return s}function Dy(s,o){do{var l=Ft;try{if(Bd(),dc.current=gc,fc){for(var f=It.memoizedState;f!==null;){var m=f.queue;m!==null&&(m.pending=null),f=f.next}fc=!1}if($i=0,qt=Bt=It=null,ml=!1,gl=0,_f.current=null,l===null||l.return===null){zt=1,El=o,Ft=null;break}e:{var v=s,S=l.return,O=l,L=o;if(o=en,O.flags|=32768,L!==null&&typeof L=="object"&&typeof L.then=="function"){var Y=L,ae=O,ce=ae.tag;if(!(ae.mode&1)&&(ce===0||ce===11||ce===15)){var ie=ae.alternate;ie?(ae.updateQueue=ie.updateQueue,ae.memoizedState=ie.memoizedState,ae.lanes=ie.lanes):(ae.updateQueue=null,ae.memoizedState=null)}var we=sy(S);if(we!==null){we.flags&=-257,iy(we,S,O,v,o),we.mode&1&&ry(v,Y,o),o=we,L=Y;var Se=o.updateQueue;if(Se===null){var Ne=new Set;Ne.add(L),o.updateQueue=Ne}else Se.add(L);break e}else{if(!(o&1)){ry(v,Y,o),Nf();break e}L=Error(t(426))}}else if(yt&&O.mode&1){var kt=sy(S);if(kt!==null){!(kt.flags&65536)&&(kt.flags|=256),iy(kt,S,O,v,o),Ld(ta(L,O));break e}}v=L=ta(L,O),zt!==4&&(zt=2),Tl===null?Tl=[v]:Tl.push(v),v=S;do{switch(v.tag){case 3:v.flags|=65536,o&=-o,v.lanes|=o;var H=ty(v,L,o);Ng(v,H);break e;case 1:O=L;var B=v.type,Q=v.stateNode;if(!(v.flags&128)&&(typeof B.getDerivedStateFromError=="function"||Q!==null&&typeof Q.componentDidCatch=="function"&&(Qs===null||!Qs.has(Q)))){v.flags|=65536,o&=-o,v.lanes|=o;var he=ny(v,O,o);Ng(v,he);break e}}v=v.return}while(v!==null)}Oy(l)}catch(Pe){o=Pe,Ft===l&&l!==null&&(Ft=l=l.return);continue}break}while(!0)}function Vy(){var s=Tc.current;return Tc.current=gc,s===null?gc:s}function Nf(){(zt===0||zt===3||zt===2)&&(zt=4),Gt===null||!(Wi&268435455)&&!(Ic&268435455)||Zs(Gt,en)}function Rc(s,o){var l=Ze;Ze|=2;var f=Vy();(Gt!==s||en!==o)&&(_s=null,Gi(s,o));do try{_I();break}catch(m){Dy(s,m)}while(!0);if(Bd(),Ze=l,Tc.current=f,Ft!==null)throw Error(t(261));return Gt=null,en=0,zt}function _I(){for(;Ft!==null;)My(Ft)}function wI(){for(;Ft!==null&&!Au();)My(Ft)}function My(s){var o=jy(s.alternate,s,Gn);s.memoizedProps=s.pendingProps,o===null?Oy(s):Ft=o,_f.current=null}function Oy(s){var o=s;do{var l=o.alternate;if(s=o.return,o.flags&32768){if(l=fI(l,o),l!==null){l.flags&=32767,Ft=l;return}if(s!==null)s.flags|=32768,s.subtreeFlags=0,s.deletions=null;else{zt=6,Ft=null;return}}else if(l=dI(l,o,Gn),l!==null){Ft=l;return}if(o=o.sibling,o!==null){Ft=o;return}Ft=o=s}while(o!==null);zt===0&&(zt=5)}function Ki(s,o,l){var f=Ke,m=ar.transition;try{ar.transition=null,Ke=1,EI(s,o,l,f)}finally{ar.transition=m,Ke=f}return null}function EI(s,o,l,f){do ia();while(Xs!==null);if(Ze&6)throw Error(t(327));l=s.finishedWork;var m=s.finishedLanes;if(l===null)return null;if(s.finishedWork=null,s.finishedLanes=0,l===s.current)throw Error(t(177));s.callbackNode=null,s.callbackPriority=0;var v=l.lanes|l.childLanes;if(ot(s,v),s===Gt&&(Ft=Gt=null,en=0),!(l.subtreeFlags&2064)&&!(l.flags&2064)||Cc||(Cc=!0,By(er,function(){return ia(),null})),v=(l.flags&15990)!==0,l.subtreeFlags&15990||v){v=ar.transition,ar.transition=null;var S=Ke;Ke=1;var O=Ze;Ze|=4,_f.current=null,mI(s,l),Ay(l,s),zT(xd),js=!!Ad,xd=Ad=null,s.current=l,gI(l),cd(),Ze=O,Ke=S,ar.transition=v}else s.current=l;if(Cc&&(Cc=!1,Xs=s,Ac=m),v=s.pendingLanes,v===0&&(Qs=null),Ru(l.stateNode),kn(s,ut()),o!==null)for(f=s.onRecoverableError,l=0;l<o.length;l++)m=o[l],f(m.value,{componentStack:m.stack,digest:m.digest});if(Sc)throw Sc=!1,s=Tf,Tf=null,s;return Ac&1&&s.tag!==0&&ia(),v=s.pendingLanes,v&1?s===If?Il++:(Il=0,If=s):Il=0,qs(),null}function ia(){if(Xs!==null){var s=Fs(Ac),o=ar.transition,l=Ke;try{if(ar.transition=null,Ke=16>s?16:s,Xs===null)var f=!1;else{if(s=Xs,Xs=null,Ac=0,Ze&6)throw Error(t(331));var m=Ze;for(Ze|=4,Ie=s.current;Ie!==null;){var v=Ie,S=v.child;if(Ie.flags&16){var O=v.deletions;if(O!==null){for(var L=0;L<O.length;L++){var Y=O[L];for(Ie=Y;Ie!==null;){var ae=Ie;switch(ae.tag){case 0:case 11:case 15:wl(8,ae,v)}var ce=ae.child;if(ce!==null)ce.return=ae,Ie=ce;else for(;Ie!==null;){ae=Ie;var ie=ae.sibling,we=ae.return;if(Ey(ae),ae===Y){Ie=null;break}if(ie!==null){ie.return=we,Ie=ie;break}Ie=we}}}var Se=v.alternate;if(Se!==null){var Ne=Se.child;if(Ne!==null){Se.child=null;do{var kt=Ne.sibling;Ne.sibling=null,Ne=kt}while(Ne!==null)}}Ie=v}}if(v.subtreeFlags&2064&&S!==null)S.return=v,Ie=S;else e:for(;Ie!==null;){if(v=Ie,v.flags&2048)switch(v.tag){case 0:case 11:case 15:wl(9,v,v.return)}var H=v.sibling;if(H!==null){H.return=v.return,Ie=H;break e}Ie=v.return}}var B=s.current;for(Ie=B;Ie!==null;){S=Ie;var Q=S.child;if(S.subtreeFlags&2064&&Q!==null)Q.return=S,Ie=Q;else e:for(S=B;Ie!==null;){if(O=Ie,O.flags&2048)try{switch(O.tag){case 0:case 11:case 15:Ec(9,O)}}catch(Pe){At(O,O.return,Pe)}if(O===S){Ie=null;break e}var he=O.sibling;if(he!==null){he.return=O.return,Ie=he;break e}Ie=O.return}}if(Ze=m,qs(),Bn&&typeof Bn.onPostCommitFiberRoot=="function")try{Bn.onPostCommitFiberRoot(Pi,s)}catch{}f=!0}return f}finally{Ke=l,ar.transition=o}}return!1}function Fy(s,o,l){o=ta(l,o),o=ty(s,o,1),s=Ks(s,o,1),o=Tn(),s!==null&&(Ms(s,1,o),kn(s,o))}function At(s,o,l){if(s.tag===3)Fy(s,s,l);else for(;o!==null;){if(o.tag===3){Fy(o,s,l);break}else if(o.tag===1){var f=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof f.componentDidCatch=="function"&&(Qs===null||!Qs.has(f))){s=ta(l,s),s=ny(o,s,1),o=Ks(o,s,1),s=Tn(),o!==null&&(Ms(o,1,s),kn(o,s));break}}o=o.return}}function TI(s,o,l){var f=s.pingCache;f!==null&&f.delete(o),o=Tn(),s.pingedLanes|=s.suspendedLanes&l,Gt===s&&(en&l)===l&&(zt===4||zt===3&&(en&130023424)===en&&500>ut()-Ef?Gi(s,0):wf|=l),kn(s,o)}function Ly(s,o){o===0&&(s.mode&1?(o=No,No<<=1,!(No&130023424)&&(No=4194304)):o=1);var l=Tn();s=gs(s,o),s!==null&&(Ms(s,o,l),kn(s,l))}function II(s){var o=s.memoizedState,l=0;o!==null&&(l=o.retryLane),Ly(s,l)}function SI(s,o){var l=0;switch(s.tag){case 13:var f=s.stateNode,m=s.memoizedState;m!==null&&(l=m.retryLane);break;case 19:f=s.stateNode;break;default:throw Error(t(314))}f!==null&&f.delete(o),Ly(s,l)}var jy;jy=function(s,o,l){if(s!==null)if(s.memoizedProps!==o.pendingProps||xn.current)Rn=!0;else{if(!(s.lanes&l)&&!(o.flags&128))return Rn=!1,hI(s,o,l);Rn=!!(s.flags&131072)}else Rn=!1,yt&&o.flags&1048576&&vg(o,sc,o.index);switch(o.lanes=0,o.tag){case 2:var f=o.type;_c(s,o),s=o.pendingProps;var m=Ko(o,rn.current);Jo(o,l),m=Yd(null,o,f,s,m,l);var v=Zd();return o.flags|=1,typeof m=="object"&&m!==null&&typeof m.render=="function"&&m.$$typeof===void 0?(o.tag=1,o.memoizedState=null,o.updateQueue=null,Nn(f)?(v=!0,tc(o)):v=!1,o.memoizedState=m.state!==null&&m.state!==void 0?m.state:null,Wd(o),m.updater=yc,o.stateNode=m,m._reactInternals=o,sf(o,f,s,l),o=uf(null,o,f,!0,v,l)):(o.tag=0,yt&&v&&Vd(o),En(null,o,m,l),o=o.child),o;case 16:f=o.elementType;e:{switch(_c(s,o),s=o.pendingProps,m=f._init,f=m(f._payload),o.type=f,m=o.tag=AI(f),s=Rr(f,s),m){case 0:o=lf(null,o,f,s,l);break e;case 1:o=hy(null,o,f,s,l);break e;case 11:o=oy(null,o,f,s,l);break e;case 14:o=ay(null,o,f,Rr(f.type,s),l);break e}throw Error(t(306,f,""))}return o;case 0:return f=o.type,m=o.pendingProps,m=o.elementType===f?m:Rr(f,m),lf(s,o,f,m,l);case 1:return f=o.type,m=o.pendingProps,m=o.elementType===f?m:Rr(f,m),hy(s,o,f,m,l);case 3:e:{if(dy(o),s===null)throw Error(t(387));f=o.pendingProps,v=o.memoizedState,m=v.element,xg(s,o),cc(o,f,null,l);var S=o.memoizedState;if(f=S.element,v.isDehydrated)if(v={element:f,isDehydrated:!1,cache:S.cache,pendingSuspenseBoundaries:S.pendingSuspenseBoundaries,transitions:S.transitions},o.updateQueue.baseState=v,o.memoizedState=v,o.flags&256){m=ta(Error(t(423)),o),o=fy(s,o,f,l,m);break e}else if(f!==m){m=ta(Error(t(424)),o),o=fy(s,o,f,l,m);break e}else for(qn=Us(o.stateNode.containerInfo.firstChild),Wn=o,yt=!0,Nr=null,l=Cg(o,null,f,l),o.child=l;l;)l.flags=l.flags&-3|4096,l=l.sibling;else{if(Xo(),f===m){o=vs(s,o,l);break e}En(s,o,f,l)}o=o.child}return o;case 5:return Pg(o),s===null&&Fd(o),f=o.type,m=o.pendingProps,v=s!==null?s.memoizedProps:null,S=m.children,Nd(f,m)?S=null:v!==null&&Nd(f,v)&&(o.flags|=32),cy(s,o),En(s,o,S,l),o.child;case 6:return s===null&&Fd(o),null;case 13:return py(s,o,l);case 4:return qd(o,o.stateNode.containerInfo),f=o.pendingProps,s===null?o.child=Yo(o,null,f,l):En(s,o,f,l),o.child;case 11:return f=o.type,m=o.pendingProps,m=o.elementType===f?m:Rr(f,m),oy(s,o,f,m,l);case 7:return En(s,o,o.pendingProps,l),o.child;case 8:return En(s,o,o.pendingProps.children,l),o.child;case 12:return En(s,o,o.pendingProps.children,l),o.child;case 10:e:{if(f=o.type._context,m=o.pendingProps,v=o.memoizedProps,S=m.value,ct(ac,f._currentValue),f._currentValue=S,v!==null)if(xr(v.value,S)){if(v.children===m.children&&!xn.current){o=vs(s,o,l);break e}}else for(v=o.child,v!==null&&(v.return=o);v!==null;){var O=v.dependencies;if(O!==null){S=v.child;for(var L=O.firstContext;L!==null;){if(L.context===f){if(v.tag===1){L=ys(-1,l&-l),L.tag=2;var Y=v.updateQueue;if(Y!==null){Y=Y.shared;var ae=Y.pending;ae===null?L.next=L:(L.next=ae.next,ae.next=L),Y.pending=L}}v.lanes|=l,L=v.alternate,L!==null&&(L.lanes|=l),Ud(v.return,l,o),O.lanes|=l;break}L=L.next}}else if(v.tag===10)S=v.type===o.type?null:v.child;else if(v.tag===18){if(S=v.return,S===null)throw Error(t(341));S.lanes|=l,O=S.alternate,O!==null&&(O.lanes|=l),Ud(S,l,o),S=v.sibling}else S=v.child;if(S!==null)S.return=v;else for(S=v;S!==null;){if(S===o){S=null;break}if(v=S.sibling,v!==null){v.return=S.return,S=v;break}S=S.return}v=S}En(s,o,m.children,l),o=o.child}return o;case 9:return m=o.type,f=o.pendingProps.children,Jo(o,l),m=ir(m),f=f(m),o.flags|=1,En(s,o,f,l),o.child;case 14:return f=o.type,m=Rr(f,o.pendingProps),m=Rr(f.type,m),ay(s,o,f,m,l);case 15:return ly(s,o,o.type,o.pendingProps,l);case 17:return f=o.type,m=o.pendingProps,m=o.elementType===f?m:Rr(f,m),_c(s,o),o.tag=1,Nn(f)?(s=!0,tc(o)):s=!1,Jo(o,l),Jg(o,f,m),sf(o,f,m,l),uf(null,o,f,!0,s,l);case 19:return gy(s,o,l);case 22:return uy(s,o,l)}throw Error(t(156,o.tag))};function By(s,o){return Ao(s,o)}function CI(s,o,l,f){this.tag=s,this.key=l,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=f,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function lr(s,o,l,f){return new CI(s,o,l,f)}function Rf(s){return s=s.prototype,!(!s||!s.isReactComponent)}function AI(s){if(typeof s=="function")return Rf(s)?1:0;if(s!=null){if(s=s.$$typeof,s===V)return 11;if(s===ve)return 14}return 2}function Js(s,o){var l=s.alternate;return l===null?(l=lr(s.tag,o,s.key,s.mode),l.elementType=s.elementType,l.type=s.type,l.stateNode=s.stateNode,l.alternate=s,s.alternate=l):(l.pendingProps=o,l.type=s.type,l.flags=0,l.subtreeFlags=0,l.deletions=null),l.flags=s.flags&14680064,l.childLanes=s.childLanes,l.lanes=s.lanes,l.child=s.child,l.memoizedProps=s.memoizedProps,l.memoizedState=s.memoizedState,l.updateQueue=s.updateQueue,o=s.dependencies,l.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},l.sibling=s.sibling,l.index=s.index,l.ref=s.ref,l}function Pc(s,o,l,f,m,v){var S=2;if(f=s,typeof s=="function")Rf(s)&&(S=1);else if(typeof s=="string")S=5;else e:switch(s){case x:return Hi(l.children,m,v,o);case I:S=8,m|=8;break;case R:return s=lr(12,l,o,m|2),s.elementType=R,s.lanes=v,s;case k:return s=lr(13,l,o,m),s.elementType=k,s.lanes=v,s;case ue:return s=lr(19,l,o,m),s.elementType=ue,s.lanes=v,s;case de:return kc(l,m,v,o);default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case b:S=10;break e;case D:S=9;break e;case V:S=11;break e;case ve:S=14;break e;case pe:S=16,f=null;break e}throw Error(t(130,s==null?s:typeof s,""))}return o=lr(S,l,o,m),o.elementType=s,o.type=f,o.lanes=v,o}function Hi(s,o,l,f){return s=lr(7,s,f,o),s.lanes=l,s}function kc(s,o,l,f){return s=lr(22,s,f,o),s.elementType=de,s.lanes=l,s.stateNode={isHidden:!1},s}function Pf(s,o,l){return s=lr(6,s,null,o),s.lanes=l,s}function kf(s,o,l){return o=lr(4,s.children!==null?s.children:[],s.key,o),o.lanes=l,o.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},o}function xI(s,o,l,f,m){this.tag=o,this.containerInfo=s,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Vs(0),this.expirationTimes=Vs(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Vs(0),this.identifierPrefix=f,this.onRecoverableError=m,this.mutableSourceEagerHydrationData=null}function bf(s,o,l,f,m,v,S,O,L){return s=new xI(s,o,l,O,L),o===1?(o=1,v===!0&&(o|=8)):o=0,v=lr(3,null,null,o),s.current=v,v.stateNode=s,v.memoizedState={element:f,isDehydrated:l,cache:null,transitions:null,pendingSuspenseBoundaries:null},Wd(v),s}function NI(s,o,l){var f=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:$,key:f==null?null:""+f,children:s,containerInfo:o,implementation:l}}function zy(s){if(!s)return Ws;s=s._reactInternals;e:{if(wr(s)!==s||s.tag!==1)throw Error(t(170));var o=s;do{switch(o.tag){case 3:o=o.stateNode.context;break e;case 1:if(Nn(o.type)){o=o.stateNode.__reactInternalMemoizedMergedChildContext;break e}}o=o.return}while(o!==null);throw Error(t(171))}if(s.tag===1){var l=s.type;if(Nn(l))return mg(s,l,o)}return o}function Uy(s,o,l,f,m,v,S,O,L){return s=bf(l,f,!0,s,m,v,S,O,L),s.context=zy(null),l=s.current,f=Tn(),m=Ys(l),v=ys(f,m),v.callback=o??null,Ks(l,v,m),s.current.lanes=m,Ms(s,m,f),kn(s,f),s}function bc(s,o,l,f){var m=o.current,v=Tn(),S=Ys(m);return l=zy(l),o.context===null?o.context=l:o.pendingContext=l,o=ys(v,S),o.payload={element:s},f=f===void 0?null:f,f!==null&&(o.callback=f),s=Ks(m,o,S),s!==null&&(br(s,m,S,v),uc(s,m,S)),S}function Dc(s){if(s=s.current,!s.child)return null;switch(s.child.tag){case 5:return s.child.stateNode;default:return s.child.stateNode}}function $y(s,o){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var l=s.retryLane;s.retryLane=l!==0&&l<o?l:o}}function Df(s,o){$y(s,o),(s=s.alternate)&&$y(s,o)}function RI(){return null}var Wy=typeof reportError=="function"?reportError:function(s){console.error(s)};function Vf(s){this._internalRoot=s}Vc.prototype.render=Vf.prototype.render=function(s){var o=this._internalRoot;if(o===null)throw Error(t(409));bc(s,o,null,null)},Vc.prototype.unmount=Vf.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var o=s.containerInfo;qi(function(){bc(null,s,null,null)}),o[ds]=null}};function Vc(s){this._internalRoot=s}Vc.prototype.unstable_scheduleHydration=function(s){if(s){var o=Vu();s={blockedOn:null,target:s,priority:o};for(var l=0;l<$r.length&&o!==0&&o<$r[l].priority;l++);$r.splice(l,0,s),l===0&&Fu(s)}};function Mf(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function Mc(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11&&(s.nodeType!==8||s.nodeValue!==" react-mount-point-unstable "))}function qy(){}function PI(s,o,l,f,m){if(m){if(typeof f=="function"){var v=f;f=function(){var Y=Dc(S);v.call(Y)}}var S=Uy(o,f,s,0,null,!1,!1,"",qy);return s._reactRootContainer=S,s[ds]=S.current,al(s.nodeType===8?s.parentNode:s),qi(),S}for(;m=s.lastChild;)s.removeChild(m);if(typeof f=="function"){var O=f;f=function(){var Y=Dc(L);O.call(Y)}}var L=bf(s,0,!1,null,null,!1,!1,"",qy);return s._reactRootContainer=L,s[ds]=L.current,al(s.nodeType===8?s.parentNode:s),qi(function(){bc(o,L,l,f)}),L}function Oc(s,o,l,f,m){var v=l._reactRootContainer;if(v){var S=v;if(typeof m=="function"){var O=m;m=function(){var L=Dc(S);O.call(L)}}bc(o,S,s,m)}else S=PI(l,o,s,m,f);return Dc(S)}bu=function(s){switch(s.tag){case 3:var o=s.stateNode;if(o.current.memoizedState.isDehydrated){var l=Ds(o.pendingLanes);l!==0&&(Os(o,l|1),kn(o,ut()),!(Ze&6)&&(sa=ut()+500,qs()))}break;case 13:qi(function(){var f=gs(s,1);if(f!==null){var m=Tn();br(f,s,1,m)}}),Df(s,1)}},Ro=function(s){if(s.tag===13){var o=gs(s,134217728);if(o!==null){var l=Tn();br(o,s,134217728,l)}Df(s,134217728)}},Du=function(s){if(s.tag===13){var o=Ys(s),l=gs(s,o);if(l!==null){var f=Tn();br(l,s,o,f)}Df(s,o)}},Vu=function(){return Ke},Mu=function(s,o){var l=Ke;try{return Ke=s,o()}finally{Ke=l}},xe=function(s,o,l){switch(o){case"input":if(Yn(s,l),o=l.name,l.type==="radio"&&o!=null){for(l=s;l.parentNode;)l=l.parentNode;for(l=l.querySelectorAll("input[name="+JSON.stringify(""+o)+'][type="radio"]'),o=0;o<l.length;o++){var f=l[o];if(f!==s&&f.form===s.form){var m=Ju(f);if(!m)throw Error(t(90));$e(f),Yn(f,m)}}}break;case"textarea":wt(s,l);break;case"select":o=l.value,o!=null&&gn(s,!!l.multiple,o,!1)}},jn=Af,ks=qi;var kI={usingClientEntryPoint:!1,Events:[cl,qo,Ju,Ct,nn,Af]},Sl={findFiberByHostInstance:Fi,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},bI={bundleType:Sl.bundleType,version:Sl.version,rendererPackageName:Sl.rendererPackageName,rendererConfig:Sl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:X.ReactCurrentDispatcher,findHostInstanceByFiber:function(s){return s=qa(s),s===null?null:s.stateNode},findFiberByHostInstance:Sl.findFiberByHostInstance||RI,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Fc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Fc.isDisabled&&Fc.supportsFiber)try{Pi=Fc.inject(bI),Bn=Fc}catch{}}return bn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=kI,bn.createPortal=function(s,o){var l=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Mf(o))throw Error(t(200));return NI(s,o,null,l)},bn.createRoot=function(s,o){if(!Mf(s))throw Error(t(299));var l=!1,f="",m=Wy;return o!=null&&(o.unstable_strictMode===!0&&(l=!0),o.identifierPrefix!==void 0&&(f=o.identifierPrefix),o.onRecoverableError!==void 0&&(m=o.onRecoverableError)),o=bf(s,1,!1,null,null,l,!1,f,m),s[ds]=o.current,al(s.nodeType===8?s.parentNode:s),new Vf(o)},bn.findDOMNode=function(s){if(s==null)return null;if(s.nodeType===1)return s;var o=s._reactInternals;if(o===void 0)throw typeof s.render=="function"?Error(t(188)):(s=Object.keys(s).join(","),Error(t(268,s)));return s=qa(o),s=s===null?null:s.stateNode,s},bn.flushSync=function(s){return qi(s)},bn.hydrate=function(s,o,l){if(!Mc(o))throw Error(t(200));return Oc(null,s,o,!0,l)},bn.hydrateRoot=function(s,o,l){if(!Mf(s))throw Error(t(405));var f=l!=null&&l.hydratedSources||null,m=!1,v="",S=Wy;if(l!=null&&(l.unstable_strictMode===!0&&(m=!0),l.identifierPrefix!==void 0&&(v=l.identifierPrefix),l.onRecoverableError!==void 0&&(S=l.onRecoverableError)),o=Uy(o,null,s,1,l??null,m,!1,v,S),s[ds]=o.current,al(s),f)for(s=0;s<f.length;s++)l=f[s],m=l._getVersion,m=m(l._source),o.mutableSourceEagerHydrationData==null?o.mutableSourceEagerHydrationData=[l,m]:o.mutableSourceEagerHydrationData.push(l,m);return new Vc(o)},bn.render=function(s,o,l){if(!Mc(o))throw Error(t(200));return Oc(null,s,o,!1,l)},bn.unmountComponentAtNode=function(s){if(!Mc(s))throw Error(t(40));return s._reactRootContainer?(qi(function(){Oc(null,null,s,!1,function(){s._reactRootContainer=null,s[ds]=null})}),!0):!1},bn.unstable_batchedUpdates=Af,bn.unstable_renderSubtreeIntoContainer=function(s,o,l,f){if(!Mc(l))throw Error(t(200));if(s==null||s._reactInternals===void 0)throw Error(t(38));return Oc(s,o,l,!1,f)},bn.version="18.3.1-next-f1338f8080-20240426",bn}var ev;function zI(){if(ev)return Lf.exports;ev=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(e){console.error(e)}}return r(),Lf.exports=BI(),Lf.exports}var tv;function UI(){if(tv)return Lc;tv=1;var r=zI();return Lc.createRoot=r.createRoot,Lc.hydrateRoot=r.hydrateRoot,Lc}var $I=UI();/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WI=r=>r.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),lw=(...r)=>r.filter((e,t,n)=>!!e&&e.trim()!==""&&n.indexOf(e)===t).join(" ").trim();/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var qI={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GI=le.forwardRef(({color:r="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:n,className:i="",children:a,iconNode:u,...c},d)=>le.createElement("svg",{ref:d,...qI,width:e,height:e,stroke:r,strokeWidth:n?Number(t)*24/Number(e):t,className:lw("lucide",i),...c},[...u.map(([p,g])=>le.createElement(p,g)),...Array.isArray(a)?a:[a]]));/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tt=(r,e)=>{const t=le.forwardRef(({className:n,...i},a)=>le.createElement(GI,{ref:a,iconNode:e,className:lw(`lucide-${WI(r)}`,n),...i}));return t.displayName=`${r}`,t};/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KI=[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]],HI=tt("Award",KI);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QI=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],XI=tt("ChevronDown",QI);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YI=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],Xi=tt("ChevronLeft",YI);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZI=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],ii=tt("ChevronRight",ZI);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JI=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],eS=tt("ChevronUp",JI);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tS=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]],nS=tt("CirclePlus",tS);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rS=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"9",x2:"15",y1:"15",y2:"9",key:"1dfufj"}]],sS=tt("CircleSlash",rS);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iS=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]],uw=tt("Clock",iS);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oS=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]],cw=tt("Download",oS);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aS=[["path",{d:"m15 15 6 6",key:"1s409w"}],["path",{d:"m15 9 6-6",key:"ko1vev"}],["path",{d:"M21 16.2V21h-4.8",key:"1hrera"}],["path",{d:"M21 7.8V3h-4.8",key:"ul1q53"}],["path",{d:"M3 16.2V21h4.8",key:"1x04uo"}],["path",{d:"m3 21 6-6",key:"wwnumi"}],["path",{d:"M3 7.8V3h4.8",key:"1ijppm"}],["path",{d:"M9 9 3 3",key:"v551iv"}]],lS=tt("Expand",aS);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uS=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],cS=tt("FileText",uS);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hS=[["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}],["line",{x1:"3",x2:"9",y1:"12",y2:"12",key:"1dyftd"}],["line",{x1:"15",x2:"21",y1:"12",y2:"12",key:"oup4p8"}]],dS=tt("GitCommitHorizontal",hS);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fS=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],pS=tt("Globe",fS);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mS=[["path",{d:"M16 5h6",key:"1vod17"}],["path",{d:"M19 2v6",key:"4bpg5p"}],["path",{d:"M21 11.5V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h7.5",key:"1ue2ih"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}]],gS=tt("ImagePlus",mS);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yS=[["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m16.2 7.8 2.9-2.9",key:"r700ao"}],["path",{d:"M18 12h4",key:"wj9ykh"}],["path",{d:"m16.2 16.2 2.9 2.9",key:"1bxg5t"}],["path",{d:"M12 18v4",key:"jadmvz"}],["path",{d:"m4.9 19.1 2.9-2.9",key:"bwix9q"}],["path",{d:"M2 12h4",key:"j09sii"}],["path",{d:"m4.9 4.9 2.9 2.9",key:"giyufr"}]],vS=tt("Loader",yS);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _S=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],wS=tt("Lock",_S);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ES=[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]],TS=tt("MessageSquare",ES);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IS=[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]],SS=tt("Mic",IS);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CS=[["path",{d:"M8 3v3a2 2 0 0 1-2 2H3",key:"hohbtr"}],["path",{d:"M21 8h-3a2 2 0 0 1-2-2V3",key:"5jw1f3"}],["path",{d:"M3 16h3a2 2 0 0 1 2 2v3",key:"198tvr"}],["path",{d:"M16 21v-3a2 2 0 0 1 2-2h3",key:"ph8mxp"}]],AS=tt("Minimize",CS);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xS=[["path",{d:"M5 12h14",key:"1ays0h"}]],NS=tt("Minus",xS);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RS=[["path",{d:"M9 18V5l12-2v13",key:"1jmyc2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["circle",{cx:"18",cy:"16",r:"3",key:"1hluhg"}]],$p=tt("Music",RS);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PS=[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]],hw=tt("Pause",PS);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kS=[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]],dw=tt("Play",kS);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bS=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],DS=tt("Plus",bS);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VS=[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]],MS=tt("RotateCw",VS);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OS=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],fw=tt("Save",OS);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FS=[["path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8",key:"1b2hhj"}],["polyline",{points:"16 6 12 2 8 6",key:"m901s6"}],["line",{x1:"12",x2:"12",y1:"2",y2:"15",key:"1p0rca"}]],LS=tt("Share",FS);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jS=[["path",{d:"M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z",key:"hou9p0"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}]],BS=tt("ShoppingBag",jS);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zS=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],US=tt("SquarePen",zS);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $S=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],WS=tt("Trash2",$S);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qS=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],lo=tt("X",qS),GS=()=>{};var nv={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pw=function(r){const e=[];let t=0;for(let n=0;n<r.length;n++){let i=r.charCodeAt(n);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&n+1<r.length&&(r.charCodeAt(n+1)&64512)===56320?(i=65536+((i&1023)<<10)+(r.charCodeAt(++n)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},KS=function(r){const e=[];let t=0,n=0;for(;t<r.length;){const i=r[t++];if(i<128)e[n++]=String.fromCharCode(i);else if(i>191&&i<224){const a=r[t++];e[n++]=String.fromCharCode((i&31)<<6|a&63)}else if(i>239&&i<365){const a=r[t++],u=r[t++],c=r[t++],d=((i&7)<<18|(a&63)<<12|(u&63)<<6|c&63)-65536;e[n++]=String.fromCharCode(55296+(d>>10)),e[n++]=String.fromCharCode(56320+(d&1023))}else{const a=r[t++],u=r[t++];e[n++]=String.fromCharCode((i&15)<<12|(a&63)<<6|u&63)}}return e.join("")},mw={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(r,e){if(!Array.isArray(r))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let i=0;i<r.length;i+=3){const a=r[i],u=i+1<r.length,c=u?r[i+1]:0,d=i+2<r.length,p=d?r[i+2]:0,g=a>>2,_=(a&3)<<4|c>>4;let E=(c&15)<<2|p>>6,C=p&63;d||(C=64,u||(E=64)),n.push(t[g],t[_],t[E],t[C])}return n.join("")},encodeString(r,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(r):this.encodeByteArray(pw(r),e)},decodeString(r,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(r):KS(this.decodeStringToByteArray(r,e))},decodeStringToByteArray(r,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let i=0;i<r.length;){const a=t[r.charAt(i++)],c=i<r.length?t[r.charAt(i)]:0;++i;const p=i<r.length?t[r.charAt(i)]:64;++i;const _=i<r.length?t[r.charAt(i)]:64;if(++i,a==null||c==null||p==null||_==null)throw new HS;const E=a<<2|c>>4;if(n.push(E),p!==64){const C=c<<4&240|p>>2;if(n.push(C),_!==64){const A=p<<6&192|_;n.push(A)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let r=0;r<this.ENCODED_VALS.length;r++)this.byteToCharMap_[r]=this.ENCODED_VALS.charAt(r),this.charToByteMap_[this.byteToCharMap_[r]]=r,this.byteToCharMapWebSafe_[r]=this.ENCODED_VALS_WEBSAFE.charAt(r),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[r]]=r,r>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(r)]=r,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(r)]=r)}}};class HS extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const QS=function(r){const e=pw(r);return mw.encodeByteArray(e,!0)},sh=function(r){return QS(r).replace(/\./g,"")},XS=function(r){try{return mw.decodeString(r,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YS(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZS=()=>YS().__FIREBASE_DEFAULTS__,JS=()=>{if(typeof process>"u"||typeof nv>"u")return;const r=nv.__FIREBASE_DEFAULTS__;if(r)return JSON.parse(r)},e1=()=>{if(typeof document>"u")return;let r;try{r=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=r&&XS(r[1]);return e&&JSON.parse(e)},Wp=()=>{try{return GS()||ZS()||JS()||e1()}catch(r){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${r}`);return}},t1=r=>{var e,t;return(t=(e=Wp())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[r]},n1=r=>{const e=t1(r);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),n]:[e.substring(0,t),n]},gw=()=>{var r;return(r=Wp())===null||r===void 0?void 0:r.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r1{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,n))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function s1(r,e){if(r.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},n=e||"demo-project",i=r.iat||0,a=r.sub||r.user_id;if(!a)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const u=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:a,user_id:a,firebase:{sign_in_provider:"custom",identities:{}}},r);return[sh(JSON.stringify(t)),sh(JSON.stringify(u)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ih(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function i1(){var r;const e=(r=Wp())===null||r===void 0?void 0:r.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function yw(){return!i1()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function vw(){try{return typeof indexedDB=="object"}catch{return!1}}function o1(){return new Promise((r,e)=>{try{let t=!0;const n="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(n);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(n),r(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{var a;e(((a=i.error)===null||a===void 0?void 0:a.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const a1="FirebaseError";class vo extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name=a1,Object.setPrototypeOf(this,vo.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,_w.prototype.create)}}class _w{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){const n=t[0]||{},i=`${this.service}/${e}`,a=this.errors[e],u=a?l1(a,n):"Error",c=`${this.serviceName}: ${u} (${i}).`;return new vo(i,c,n)}}function l1(r,e){return r.replace(u1,(t,n)=>{const i=e[n];return i!=null?String(i):`<${n}?>`})}const u1=/\{\$([^}]+)}/g;function oh(r,e){if(r===e)return!0;const t=Object.keys(r),n=Object.keys(e);for(const i of t){if(!n.includes(i))return!1;const a=r[i],u=e[i];if(rv(a)&&rv(u)){if(!oh(a,u))return!1}else if(a!==u)return!1}for(const i of n)if(!t.includes(i))return!1;return!0}function rv(r){return r!==null&&typeof r=="object"}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ww(r){return r&&r._delegate?r._delegate:r}class _a{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yi="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c1{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const n=new r1;if(this.instancesDeferred.set(t,n),this.isInitialized(t)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:t});i&&n.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(a){if(i)return null;throw a}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(d1(e))try{this.getOrInitializeService({instanceIdentifier:Yi})}catch{}for(const[t,n]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(t);try{const a=this.getOrInitializeService({instanceIdentifier:i});n.resolve(a)}catch{}}}}clearInstance(e=Yi){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Yi){return this.instances.has(e)}getOptions(e=Yi){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[a,u]of this.instancesDeferred.entries()){const c=this.normalizeInstanceIdentifier(a);n===c&&u.resolve(i)}return i}onInit(e,t){var n;const i=this.normalizeInstanceIdentifier(t),a=(n=this.onInitCallbacks.get(i))!==null&&n!==void 0?n:new Set;a.add(e),this.onInitCallbacks.set(i,a);const u=this.instances.get(i);return u&&e(u,i),()=>{a.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const i of n)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:h1(e),options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=Yi){return this.component?this.component.multipleInstances?e:Yi:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function h1(r){return r===Yi?void 0:r}function d1(r){return r.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f1{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new c1(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ye;(function(r){r[r.DEBUG=0]="DEBUG",r[r.VERBOSE=1]="VERBOSE",r[r.INFO=2]="INFO",r[r.WARN=3]="WARN",r[r.ERROR=4]="ERROR",r[r.SILENT=5]="SILENT"})(Ye||(Ye={}));const p1={debug:Ye.DEBUG,verbose:Ye.VERBOSE,info:Ye.INFO,warn:Ye.WARN,error:Ye.ERROR,silent:Ye.SILENT},m1=Ye.INFO,g1={[Ye.DEBUG]:"log",[Ye.VERBOSE]:"log",[Ye.INFO]:"info",[Ye.WARN]:"warn",[Ye.ERROR]:"error"},y1=(r,e,...t)=>{if(e<r.logLevel)return;const n=new Date().toISOString(),i=g1[e];if(i)console[i](`[${n}]  ${r.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Ew{constructor(e){this.name=e,this._logLevel=m1,this._logHandler=y1,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ye))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?p1[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ye.DEBUG,...e),this._logHandler(this,Ye.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ye.VERBOSE,...e),this._logHandler(this,Ye.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ye.INFO,...e),this._logHandler(this,Ye.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ye.WARN,...e),this._logHandler(this,Ye.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ye.ERROR,...e),this._logHandler(this,Ye.ERROR,...e)}}const v1=(r,e)=>e.some(t=>r instanceof t);let sv,iv;function _1(){return sv||(sv=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function w1(){return iv||(iv=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Tw=new WeakMap,ip=new WeakMap,Iw=new WeakMap,zf=new WeakMap,qp=new WeakMap;function E1(r){const e=new Promise((t,n)=>{const i=()=>{r.removeEventListener("success",a),r.removeEventListener("error",u)},a=()=>{t(ui(r.result)),i()},u=()=>{n(r.error),i()};r.addEventListener("success",a),r.addEventListener("error",u)});return e.then(t=>{t instanceof IDBCursor&&Tw.set(t,r)}).catch(()=>{}),qp.set(e,r),e}function T1(r){if(ip.has(r))return;const e=new Promise((t,n)=>{const i=()=>{r.removeEventListener("complete",a),r.removeEventListener("error",u),r.removeEventListener("abort",u)},a=()=>{t(),i()},u=()=>{n(r.error||new DOMException("AbortError","AbortError")),i()};r.addEventListener("complete",a),r.addEventListener("error",u),r.addEventListener("abort",u)});ip.set(r,e)}let op={get(r,e,t){if(r instanceof IDBTransaction){if(e==="done")return ip.get(r);if(e==="objectStoreNames")return r.objectStoreNames||Iw.get(r);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return ui(r[e])},set(r,e,t){return r[e]=t,!0},has(r,e){return r instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in r}};function I1(r){op=r(op)}function S1(r){return r===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const n=r.call(Uf(this),e,...t);return Iw.set(n,e.sort?e.sort():[e]),ui(n)}:w1().includes(r)?function(...e){return r.apply(Uf(this),e),ui(Tw.get(this))}:function(...e){return ui(r.apply(Uf(this),e))}}function C1(r){return typeof r=="function"?S1(r):(r instanceof IDBTransaction&&T1(r),v1(r,_1())?new Proxy(r,op):r)}function ui(r){if(r instanceof IDBRequest)return E1(r);if(zf.has(r))return zf.get(r);const e=C1(r);return e!==r&&(zf.set(r,e),qp.set(e,r)),e}const Uf=r=>qp.get(r);function A1(r,e,{blocked:t,upgrade:n,blocking:i,terminated:a}={}){const u=indexedDB.open(r,e),c=ui(u);return n&&u.addEventListener("upgradeneeded",d=>{n(ui(u.result),d.oldVersion,d.newVersion,ui(u.transaction),d)}),t&&u.addEventListener("blocked",d=>t(d.oldVersion,d.newVersion,d)),c.then(d=>{a&&d.addEventListener("close",()=>a()),i&&d.addEventListener("versionchange",p=>i(p.oldVersion,p.newVersion,p))}).catch(()=>{}),c}const x1=["get","getKey","getAll","getAllKeys","count"],N1=["put","add","delete","clear"],$f=new Map;function ov(r,e){if(!(r instanceof IDBDatabase&&!(e in r)&&typeof e=="string"))return;if($f.get(e))return $f.get(e);const t=e.replace(/FromIndex$/,""),n=e!==t,i=N1.includes(t);if(!(t in(n?IDBIndex:IDBObjectStore).prototype)||!(i||x1.includes(t)))return;const a=async function(u,...c){const d=this.transaction(u,i?"readwrite":"readonly");let p=d.store;return n&&(p=p.index(c.shift())),(await Promise.all([p[t](...c),i&&d.done]))[0]};return $f.set(e,a),a}I1(r=>({...r,get:(e,t,n)=>ov(e,t)||r.get(e,t,n),has:(e,t)=>!!ov(e,t)||r.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R1{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(P1(t)){const n=t.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(t=>t).join(" ")}}function P1(r){const e=r.getComponent();return(e==null?void 0:e.type)==="VERSION"}const ap="@firebase/app",av="0.11.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cs=new Ew("@firebase/app"),k1="@firebase/app-compat",b1="@firebase/analytics-compat",D1="@firebase/analytics",V1="@firebase/app-check-compat",M1="@firebase/app-check",O1="@firebase/auth",F1="@firebase/auth-compat",L1="@firebase/database",j1="@firebase/data-connect",B1="@firebase/database-compat",z1="@firebase/functions",U1="@firebase/functions-compat",$1="@firebase/installations",W1="@firebase/installations-compat",q1="@firebase/messaging",G1="@firebase/messaging-compat",K1="@firebase/performance",H1="@firebase/performance-compat",Q1="@firebase/remote-config",X1="@firebase/remote-config-compat",Y1="@firebase/storage",Z1="@firebase/storage-compat",J1="@firebase/firestore",eC="@firebase/vertexai",tC="@firebase/firestore-compat",nC="firebase",rC="11.4.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lp="[DEFAULT]",sC={[ap]:"fire-core",[k1]:"fire-core-compat",[D1]:"fire-analytics",[b1]:"fire-analytics-compat",[M1]:"fire-app-check",[V1]:"fire-app-check-compat",[O1]:"fire-auth",[F1]:"fire-auth-compat",[L1]:"fire-rtdb",[j1]:"fire-data-connect",[B1]:"fire-rtdb-compat",[z1]:"fire-fn",[U1]:"fire-fn-compat",[$1]:"fire-iid",[W1]:"fire-iid-compat",[q1]:"fire-fcm",[G1]:"fire-fcm-compat",[K1]:"fire-perf",[H1]:"fire-perf-compat",[Q1]:"fire-rc",[X1]:"fire-rc-compat",[Y1]:"fire-gcs",[Z1]:"fire-gcs-compat",[J1]:"fire-fst",[tC]:"fire-fst-compat",[eC]:"fire-vertex","fire-js":"fire-js",[nC]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ah=new Map,iC=new Map,up=new Map;function lv(r,e){try{r.container.addComponent(e)}catch(t){Cs.debug(`Component ${e.name} failed to register with FirebaseApp ${r.name}`,t)}}function Ul(r){const e=r.name;if(up.has(e))return Cs.debug(`There were multiple attempts to register component ${e}.`),!1;up.set(e,r);for(const t of ah.values())lv(t,r);for(const t of iC.values())lv(t,r);return!0}function Sw(r,e){const t=r.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),r.container.getProvider(e)}function Cw(r){return r==null?!1:r.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oC={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},ci=new _w("app","Firebase",oC);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aC{constructor(e,t,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new _a("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ci.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Aw=rC;function xw(r,e={}){let t=r;typeof e!="object"&&(e={name:e});const n=Object.assign({name:lp,automaticDataCollectionEnabled:!1},e),i=n.name;if(typeof i!="string"||!i)throw ci.create("bad-app-name",{appName:String(i)});if(t||(t=gw()),!t)throw ci.create("no-options");const a=ah.get(i);if(a){if(oh(t,a.options)&&oh(n,a.config))return a;throw ci.create("duplicate-app",{appName:i})}const u=new f1(i);for(const d of up.values())u.addComponent(d);const c=new aC(t,n,u);return ah.set(i,c),c}function lC(r=lp){const e=ah.get(r);if(!e&&r===lp&&gw())return xw();if(!e)throw ci.create("no-app",{appName:r});return e}function hi(r,e,t){var n;let i=(n=sC[r])!==null&&n!==void 0?n:r;t&&(i+=`-${t}`);const a=i.match(/\s|\//),u=e.match(/\s|\//);if(a||u){const c=[`Unable to register library "${i}" with version "${e}":`];a&&c.push(`library name "${i}" contains illegal characters (whitespace or "/")`),a&&u&&c.push("and"),u&&c.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Cs.warn(c.join(" "));return}Ul(new _a(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uC="firebase-heartbeat-database",cC=1,$l="firebase-heartbeat-store";let Wf=null;function Nw(){return Wf||(Wf=A1(uC,cC,{upgrade:(r,e)=>{switch(e){case 0:try{r.createObjectStore($l)}catch(t){console.warn(t)}}}}).catch(r=>{throw ci.create("idb-open",{originalErrorMessage:r.message})})),Wf}async function hC(r){try{const t=(await Nw()).transaction($l),n=await t.objectStore($l).get(Rw(r));return await t.done,n}catch(e){if(e instanceof vo)Cs.warn(e.message);else{const t=ci.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Cs.warn(t.message)}}}async function uv(r,e){try{const n=(await Nw()).transaction($l,"readwrite");await n.objectStore($l).put(e,Rw(r)),await n.done}catch(t){if(t instanceof vo)Cs.warn(t.message);else{const n=ci.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});Cs.warn(n.message)}}}function Rw(r){return`${r.name}!${r.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dC=1024,fC=30;class pC{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new gC(t),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,t;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),a=cv();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===a||this._heartbeatsCache.heartbeats.some(u=>u.date===a))return;if(this._heartbeatsCache.heartbeats.push({date:a,agent:i}),this._heartbeatsCache.heartbeats.length>fC){const u=yC(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(u,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(n){Cs.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=cv(),{heartbeatsToSend:n,unsentEntries:i}=mC(this._heartbeatsCache.heartbeats),a=sh(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),a}catch(t){return Cs.warn(t),""}}}function cv(){return new Date().toISOString().substring(0,10)}function mC(r,e=dC){const t=[];let n=r.slice();for(const i of r){const a=t.find(u=>u.agent===i.agent);if(a){if(a.dates.push(i.date),hv(t)>e){a.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),hv(t)>e){t.pop();break}n=n.slice(1)}return{heartbeatsToSend:t,unsentEntries:n}}class gC{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return vw()?o1().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await hC(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const i=await this.read();return uv(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const i=await this.read();return uv(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function hv(r){return sh(JSON.stringify({version:2,heartbeats:r})).length}function yC(r){if(r.length===0)return-1;let e=0,t=r[0].date;for(let n=1;n<r.length;n++)r[n].date<t&&(t=r[n].date,e=n);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vC(r){Ul(new _a("platform-logger",e=>new R1(e),"PRIVATE")),Ul(new _a("heartbeat",e=>new pC(e),"PRIVATE")),hi(ap,av,r),hi(ap,av,"esm2017"),hi("fire-js","")}vC("");var _C="firebase",wC="11.4.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */hi(_C,wC,"app");var dv=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var di,Pw;(function(){var r;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(x,I){function R(){}R.prototype=I.prototype,x.D=I.prototype,x.prototype=new R,x.prototype.constructor=x,x.C=function(b,D,V){for(var k=Array(arguments.length-2),ue=2;ue<arguments.length;ue++)k[ue-2]=arguments[ue];return I.prototype[D].apply(b,k)}}function t(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,t),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(x,I,R){R||(R=0);var b=Array(16);if(typeof I=="string")for(var D=0;16>D;++D)b[D]=I.charCodeAt(R++)|I.charCodeAt(R++)<<8|I.charCodeAt(R++)<<16|I.charCodeAt(R++)<<24;else for(D=0;16>D;++D)b[D]=I[R++]|I[R++]<<8|I[R++]<<16|I[R++]<<24;I=x.g[0],R=x.g[1],D=x.g[2];var V=x.g[3],k=I+(V^R&(D^V))+b[0]+3614090360&4294967295;I=R+(k<<7&4294967295|k>>>25),k=V+(D^I&(R^D))+b[1]+3905402710&4294967295,V=I+(k<<12&4294967295|k>>>20),k=D+(R^V&(I^R))+b[2]+606105819&4294967295,D=V+(k<<17&4294967295|k>>>15),k=R+(I^D&(V^I))+b[3]+3250441966&4294967295,R=D+(k<<22&4294967295|k>>>10),k=I+(V^R&(D^V))+b[4]+4118548399&4294967295,I=R+(k<<7&4294967295|k>>>25),k=V+(D^I&(R^D))+b[5]+1200080426&4294967295,V=I+(k<<12&4294967295|k>>>20),k=D+(R^V&(I^R))+b[6]+2821735955&4294967295,D=V+(k<<17&4294967295|k>>>15),k=R+(I^D&(V^I))+b[7]+4249261313&4294967295,R=D+(k<<22&4294967295|k>>>10),k=I+(V^R&(D^V))+b[8]+1770035416&4294967295,I=R+(k<<7&4294967295|k>>>25),k=V+(D^I&(R^D))+b[9]+2336552879&4294967295,V=I+(k<<12&4294967295|k>>>20),k=D+(R^V&(I^R))+b[10]+4294925233&4294967295,D=V+(k<<17&4294967295|k>>>15),k=R+(I^D&(V^I))+b[11]+2304563134&4294967295,R=D+(k<<22&4294967295|k>>>10),k=I+(V^R&(D^V))+b[12]+1804603682&4294967295,I=R+(k<<7&4294967295|k>>>25),k=V+(D^I&(R^D))+b[13]+4254626195&4294967295,V=I+(k<<12&4294967295|k>>>20),k=D+(R^V&(I^R))+b[14]+2792965006&4294967295,D=V+(k<<17&4294967295|k>>>15),k=R+(I^D&(V^I))+b[15]+1236535329&4294967295,R=D+(k<<22&4294967295|k>>>10),k=I+(D^V&(R^D))+b[1]+4129170786&4294967295,I=R+(k<<5&4294967295|k>>>27),k=V+(R^D&(I^R))+b[6]+3225465664&4294967295,V=I+(k<<9&4294967295|k>>>23),k=D+(I^R&(V^I))+b[11]+643717713&4294967295,D=V+(k<<14&4294967295|k>>>18),k=R+(V^I&(D^V))+b[0]+3921069994&4294967295,R=D+(k<<20&4294967295|k>>>12),k=I+(D^V&(R^D))+b[5]+3593408605&4294967295,I=R+(k<<5&4294967295|k>>>27),k=V+(R^D&(I^R))+b[10]+38016083&4294967295,V=I+(k<<9&4294967295|k>>>23),k=D+(I^R&(V^I))+b[15]+3634488961&4294967295,D=V+(k<<14&4294967295|k>>>18),k=R+(V^I&(D^V))+b[4]+3889429448&4294967295,R=D+(k<<20&4294967295|k>>>12),k=I+(D^V&(R^D))+b[9]+568446438&4294967295,I=R+(k<<5&4294967295|k>>>27),k=V+(R^D&(I^R))+b[14]+3275163606&4294967295,V=I+(k<<9&4294967295|k>>>23),k=D+(I^R&(V^I))+b[3]+4107603335&4294967295,D=V+(k<<14&4294967295|k>>>18),k=R+(V^I&(D^V))+b[8]+1163531501&4294967295,R=D+(k<<20&4294967295|k>>>12),k=I+(D^V&(R^D))+b[13]+2850285829&4294967295,I=R+(k<<5&4294967295|k>>>27),k=V+(R^D&(I^R))+b[2]+4243563512&4294967295,V=I+(k<<9&4294967295|k>>>23),k=D+(I^R&(V^I))+b[7]+1735328473&4294967295,D=V+(k<<14&4294967295|k>>>18),k=R+(V^I&(D^V))+b[12]+2368359562&4294967295,R=D+(k<<20&4294967295|k>>>12),k=I+(R^D^V)+b[5]+4294588738&4294967295,I=R+(k<<4&4294967295|k>>>28),k=V+(I^R^D)+b[8]+2272392833&4294967295,V=I+(k<<11&4294967295|k>>>21),k=D+(V^I^R)+b[11]+1839030562&4294967295,D=V+(k<<16&4294967295|k>>>16),k=R+(D^V^I)+b[14]+4259657740&4294967295,R=D+(k<<23&4294967295|k>>>9),k=I+(R^D^V)+b[1]+2763975236&4294967295,I=R+(k<<4&4294967295|k>>>28),k=V+(I^R^D)+b[4]+1272893353&4294967295,V=I+(k<<11&4294967295|k>>>21),k=D+(V^I^R)+b[7]+4139469664&4294967295,D=V+(k<<16&4294967295|k>>>16),k=R+(D^V^I)+b[10]+3200236656&4294967295,R=D+(k<<23&4294967295|k>>>9),k=I+(R^D^V)+b[13]+681279174&4294967295,I=R+(k<<4&4294967295|k>>>28),k=V+(I^R^D)+b[0]+3936430074&4294967295,V=I+(k<<11&4294967295|k>>>21),k=D+(V^I^R)+b[3]+3572445317&4294967295,D=V+(k<<16&4294967295|k>>>16),k=R+(D^V^I)+b[6]+76029189&4294967295,R=D+(k<<23&4294967295|k>>>9),k=I+(R^D^V)+b[9]+3654602809&4294967295,I=R+(k<<4&4294967295|k>>>28),k=V+(I^R^D)+b[12]+3873151461&4294967295,V=I+(k<<11&4294967295|k>>>21),k=D+(V^I^R)+b[15]+530742520&4294967295,D=V+(k<<16&4294967295|k>>>16),k=R+(D^V^I)+b[2]+3299628645&4294967295,R=D+(k<<23&4294967295|k>>>9),k=I+(D^(R|~V))+b[0]+4096336452&4294967295,I=R+(k<<6&4294967295|k>>>26),k=V+(R^(I|~D))+b[7]+1126891415&4294967295,V=I+(k<<10&4294967295|k>>>22),k=D+(I^(V|~R))+b[14]+2878612391&4294967295,D=V+(k<<15&4294967295|k>>>17),k=R+(V^(D|~I))+b[5]+4237533241&4294967295,R=D+(k<<21&4294967295|k>>>11),k=I+(D^(R|~V))+b[12]+1700485571&4294967295,I=R+(k<<6&4294967295|k>>>26),k=V+(R^(I|~D))+b[3]+2399980690&4294967295,V=I+(k<<10&4294967295|k>>>22),k=D+(I^(V|~R))+b[10]+4293915773&4294967295,D=V+(k<<15&4294967295|k>>>17),k=R+(V^(D|~I))+b[1]+2240044497&4294967295,R=D+(k<<21&4294967295|k>>>11),k=I+(D^(R|~V))+b[8]+1873313359&4294967295,I=R+(k<<6&4294967295|k>>>26),k=V+(R^(I|~D))+b[15]+4264355552&4294967295,V=I+(k<<10&4294967295|k>>>22),k=D+(I^(V|~R))+b[6]+2734768916&4294967295,D=V+(k<<15&4294967295|k>>>17),k=R+(V^(D|~I))+b[13]+1309151649&4294967295,R=D+(k<<21&4294967295|k>>>11),k=I+(D^(R|~V))+b[4]+4149444226&4294967295,I=R+(k<<6&4294967295|k>>>26),k=V+(R^(I|~D))+b[11]+3174756917&4294967295,V=I+(k<<10&4294967295|k>>>22),k=D+(I^(V|~R))+b[2]+718787259&4294967295,D=V+(k<<15&4294967295|k>>>17),k=R+(V^(D|~I))+b[9]+3951481745&4294967295,x.g[0]=x.g[0]+I&4294967295,x.g[1]=x.g[1]+(D+(k<<21&4294967295|k>>>11))&4294967295,x.g[2]=x.g[2]+D&4294967295,x.g[3]=x.g[3]+V&4294967295}n.prototype.u=function(x,I){I===void 0&&(I=x.length);for(var R=I-this.blockSize,b=this.B,D=this.h,V=0;V<I;){if(D==0)for(;V<=R;)i(this,x,V),V+=this.blockSize;if(typeof x=="string"){for(;V<I;)if(b[D++]=x.charCodeAt(V++),D==this.blockSize){i(this,b),D=0;break}}else for(;V<I;)if(b[D++]=x[V++],D==this.blockSize){i(this,b),D=0;break}}this.h=D,this.o+=I},n.prototype.v=function(){var x=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);x[0]=128;for(var I=1;I<x.length-8;++I)x[I]=0;var R=8*this.o;for(I=x.length-8;I<x.length;++I)x[I]=R&255,R/=256;for(this.u(x),x=Array(16),I=R=0;4>I;++I)for(var b=0;32>b;b+=8)x[R++]=this.g[I]>>>b&255;return x};function a(x,I){var R=c;return Object.prototype.hasOwnProperty.call(R,x)?R[x]:R[x]=I(x)}function u(x,I){this.h=I;for(var R=[],b=!0,D=x.length-1;0<=D;D--){var V=x[D]|0;b&&V==I||(R[D]=V,b=!1)}this.g=R}var c={};function d(x){return-128<=x&&128>x?a(x,function(I){return new u([I|0],0>I?-1:0)}):new u([x|0],0>x?-1:0)}function p(x){if(isNaN(x)||!isFinite(x))return _;if(0>x)return M(p(-x));for(var I=[],R=1,b=0;x>=R;b++)I[b]=x/R|0,R*=4294967296;return new u(I,0)}function g(x,I){if(x.length==0)throw Error("number format error: empty string");if(I=I||10,2>I||36<I)throw Error("radix out of range: "+I);if(x.charAt(0)=="-")return M(g(x.substring(1),I));if(0<=x.indexOf("-"))throw Error('number format error: interior "-" character');for(var R=p(Math.pow(I,8)),b=_,D=0;D<x.length;D+=8){var V=Math.min(8,x.length-D),k=parseInt(x.substring(D,D+V),I);8>V?(V=p(Math.pow(I,V)),b=b.j(V).add(p(k))):(b=b.j(R),b=b.add(p(k)))}return b}var _=d(0),E=d(1),C=d(16777216);r=u.prototype,r.m=function(){if(P(this))return-M(this).m();for(var x=0,I=1,R=0;R<this.g.length;R++){var b=this.i(R);x+=(0<=b?b:4294967296+b)*I,I*=4294967296}return x},r.toString=function(x){if(x=x||10,2>x||36<x)throw Error("radix out of range: "+x);if(A(this))return"0";if(P(this))return"-"+M(this).toString(x);for(var I=p(Math.pow(x,6)),R=this,b="";;){var D=X(R,I).g;R=U(R,D.j(I));var V=((0<R.g.length?R.g[0]:R.h)>>>0).toString(x);if(R=D,A(R))return V+b;for(;6>V.length;)V="0"+V;b=V+b}},r.i=function(x){return 0>x?0:x<this.g.length?this.g[x]:this.h};function A(x){if(x.h!=0)return!1;for(var I=0;I<x.g.length;I++)if(x.g[I]!=0)return!1;return!0}function P(x){return x.h==-1}r.l=function(x){return x=U(this,x),P(x)?-1:A(x)?0:1};function M(x){for(var I=x.g.length,R=[],b=0;b<I;b++)R[b]=~x.g[b];return new u(R,~x.h).add(E)}r.abs=function(){return P(this)?M(this):this},r.add=function(x){for(var I=Math.max(this.g.length,x.g.length),R=[],b=0,D=0;D<=I;D++){var V=b+(this.i(D)&65535)+(x.i(D)&65535),k=(V>>>16)+(this.i(D)>>>16)+(x.i(D)>>>16);b=k>>>16,V&=65535,k&=65535,R[D]=k<<16|V}return new u(R,R[R.length-1]&-2147483648?-1:0)};function U(x,I){return x.add(M(I))}r.j=function(x){if(A(this)||A(x))return _;if(P(this))return P(x)?M(this).j(M(x)):M(M(this).j(x));if(P(x))return M(this.j(M(x)));if(0>this.l(C)&&0>x.l(C))return p(this.m()*x.m());for(var I=this.g.length+x.g.length,R=[],b=0;b<2*I;b++)R[b]=0;for(b=0;b<this.g.length;b++)for(var D=0;D<x.g.length;D++){var V=this.i(b)>>>16,k=this.i(b)&65535,ue=x.i(D)>>>16,ve=x.i(D)&65535;R[2*b+2*D]+=k*ve,W(R,2*b+2*D),R[2*b+2*D+1]+=V*ve,W(R,2*b+2*D+1),R[2*b+2*D+1]+=k*ue,W(R,2*b+2*D+1),R[2*b+2*D+2]+=V*ue,W(R,2*b+2*D+2)}for(b=0;b<I;b++)R[b]=R[2*b+1]<<16|R[2*b];for(b=I;b<2*I;b++)R[b]=0;return new u(R,0)};function W(x,I){for(;(x[I]&65535)!=x[I];)x[I+1]+=x[I]>>>16,x[I]&=65535,I++}function z(x,I){this.g=x,this.h=I}function X(x,I){if(A(I))throw Error("division by zero");if(A(x))return new z(_,_);if(P(x))return I=X(M(x),I),new z(M(I.g),M(I.h));if(P(I))return I=X(x,M(I)),new z(M(I.g),I.h);if(30<x.g.length){if(P(x)||P(I))throw Error("slowDivide_ only works with positive integers.");for(var R=E,b=I;0>=b.l(x);)R=j(R),b=j(b);var D=$(R,1),V=$(b,1);for(b=$(b,2),R=$(R,2);!A(b);){var k=V.add(b);0>=k.l(x)&&(D=D.add(R),V=k),b=$(b,1),R=$(R,1)}return I=U(x,D.j(I)),new z(D,I)}for(D=_;0<=x.l(I);){for(R=Math.max(1,Math.floor(x.m()/I.m())),b=Math.ceil(Math.log(R)/Math.LN2),b=48>=b?1:Math.pow(2,b-48),V=p(R),k=V.j(I);P(k)||0<k.l(x);)R-=b,V=p(R),k=V.j(I);A(V)&&(V=E),D=D.add(V),x=U(x,k)}return new z(D,x)}r.A=function(x){return X(this,x).h},r.and=function(x){for(var I=Math.max(this.g.length,x.g.length),R=[],b=0;b<I;b++)R[b]=this.i(b)&x.i(b);return new u(R,this.h&x.h)},r.or=function(x){for(var I=Math.max(this.g.length,x.g.length),R=[],b=0;b<I;b++)R[b]=this.i(b)|x.i(b);return new u(R,this.h|x.h)},r.xor=function(x){for(var I=Math.max(this.g.length,x.g.length),R=[],b=0;b<I;b++)R[b]=this.i(b)^x.i(b);return new u(R,this.h^x.h)};function j(x){for(var I=x.g.length+1,R=[],b=0;b<I;b++)R[b]=x.i(b)<<1|x.i(b-1)>>>31;return new u(R,x.h)}function $(x,I){var R=I>>5;I%=32;for(var b=x.g.length-R,D=[],V=0;V<b;V++)D[V]=0<I?x.i(V+R)>>>I|x.i(V+R+1)<<32-I:x.i(V+R);return new u(D,x.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,Pw=n,u.prototype.add=u.prototype.add,u.prototype.multiply=u.prototype.j,u.prototype.modulo=u.prototype.A,u.prototype.compare=u.prototype.l,u.prototype.toNumber=u.prototype.m,u.prototype.toString=u.prototype.toString,u.prototype.getBits=u.prototype.i,u.fromNumber=p,u.fromString=g,di=u}).apply(typeof dv<"u"?dv:typeof self<"u"?self:typeof window<"u"?window:{});var jc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var kw,kl,bw,Hc,cp,Dw,Vw,Mw;(function(){var r,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(h,y,w){return h==Array.prototype||h==Object.prototype||(h[y]=w.value),h};function t(h){h=[typeof globalThis=="object"&&globalThis,h,typeof window=="object"&&window,typeof self=="object"&&self,typeof jc=="object"&&jc];for(var y=0;y<h.length;++y){var w=h[y];if(w&&w.Math==Math)return w}throw Error("Cannot find global object")}var n=t(this);function i(h,y){if(y)e:{var w=n;h=h.split(".");for(var N=0;N<h.length-1;N++){var K=h[N];if(!(K in w))break e;w=w[K]}h=h[h.length-1],N=w[h],y=y(N),y!=N&&y!=null&&e(w,h,{configurable:!0,writable:!0,value:y})}}function a(h,y){h instanceof String&&(h+="");var w=0,N=!1,K={next:function(){if(!N&&w<h.length){var J=w++;return{value:y(J,h[J]),done:!1}}return N=!0,{done:!0,value:void 0}}};return K[Symbol.iterator]=function(){return K},K}i("Array.prototype.values",function(h){return h||function(){return a(this,function(y,w){return w})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var u=u||{},c=this||self;function d(h){var y=typeof h;return y=y!="object"?y:h?Array.isArray(h)?"array":y:"null",y=="array"||y=="object"&&typeof h.length=="number"}function p(h){var y=typeof h;return y=="object"&&h!=null||y=="function"}function g(h,y,w){return h.call.apply(h.bind,arguments)}function _(h,y,w){if(!h)throw Error();if(2<arguments.length){var N=Array.prototype.slice.call(arguments,2);return function(){var K=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(K,N),h.apply(y,K)}}return function(){return h.apply(y,arguments)}}function E(h,y,w){return E=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?g:_,E.apply(null,arguments)}function C(h,y){var w=Array.prototype.slice.call(arguments,1);return function(){var N=w.slice();return N.push.apply(N,arguments),h.apply(this,N)}}function A(h,y){function w(){}w.prototype=y.prototype,h.aa=y.prototype,h.prototype=new w,h.prototype.constructor=h,h.Qb=function(N,K,J){for(var fe=Array(arguments.length-2),nt=2;nt<arguments.length;nt++)fe[nt-2]=arguments[nt];return y.prototype[K].apply(N,fe)}}function P(h){const y=h.length;if(0<y){const w=Array(y);for(let N=0;N<y;N++)w[N]=h[N];return w}return[]}function M(h,y){for(let w=1;w<arguments.length;w++){const N=arguments[w];if(d(N)){const K=h.length||0,J=N.length||0;h.length=K+J;for(let fe=0;fe<J;fe++)h[K+fe]=N[fe]}else h.push(N)}}class U{constructor(y,w){this.i=y,this.j=w,this.h=0,this.g=null}get(){let y;return 0<this.h?(this.h--,y=this.g,this.g=y.next,y.next=null):y=this.i(),y}}function W(h){return/^[\s\xa0]*$/.test(h)}function z(){var h=c.navigator;return h&&(h=h.userAgent)?h:""}function X(h){return X[" "](h),h}X[" "]=function(){};var j=z().indexOf("Gecko")!=-1&&!(z().toLowerCase().indexOf("webkit")!=-1&&z().indexOf("Edge")==-1)&&!(z().indexOf("Trident")!=-1||z().indexOf("MSIE")!=-1)&&z().indexOf("Edge")==-1;function $(h,y,w){for(const N in h)y.call(w,h[N],N,h)}function x(h,y){for(const w in h)y.call(void 0,h[w],w,h)}function I(h){const y={};for(const w in h)y[w]=h[w];return y}const R="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function b(h,y){let w,N;for(let K=1;K<arguments.length;K++){N=arguments[K];for(w in N)h[w]=N[w];for(let J=0;J<R.length;J++)w=R[J],Object.prototype.hasOwnProperty.call(N,w)&&(h[w]=N[w])}}function D(h){var y=1;h=h.split(":");const w=[];for(;0<y&&h.length;)w.push(h.shift()),y--;return h.length&&w.push(h.join(":")),w}function V(h){c.setTimeout(()=>{throw h},0)}function k(){var h=ne;let y=null;return h.g&&(y=h.g,h.g=h.g.next,h.g||(h.h=null),y.next=null),y}class ue{constructor(){this.h=this.g=null}add(y,w){const N=ve.get();N.set(y,w),this.h?this.h.next=N:this.g=N,this.h=N}}var ve=new U(()=>new pe,h=>h.reset());class pe{constructor(){this.next=this.g=this.h=null}set(y,w){this.h=y,this.g=w,this.next=null}reset(){this.next=this.g=this.h=null}}let de,ee=!1,ne=new ue,re=()=>{const h=c.Promise.resolve(void 0);de=()=>{h.then(F)}};var F=()=>{for(var h;h=k();){try{h.h.call(h.g)}catch(w){V(w)}var y=ve;y.j(h),100>y.h&&(y.h++,h.next=y.g,y.g=h)}ee=!1};function Z(){this.s=this.s,this.C=this.C}Z.prototype.s=!1,Z.prototype.ma=function(){this.s||(this.s=!0,this.N())},Z.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function Ee(h,y){this.type=h,this.g=this.target=y,this.defaultPrevented=!1}Ee.prototype.h=function(){this.defaultPrevented=!0};var Ve=function(){if(!c.addEventListener||!Object.defineProperty)return!1;var h=!1,y=Object.defineProperty({},"passive",{get:function(){h=!0}});try{const w=()=>{};c.addEventListener("test",w,y),c.removeEventListener("test",w,y)}catch{}return h}();function me(h,y){if(Ee.call(this,h?h.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,h){var w=this.type=h.type,N=h.changedTouches&&h.changedTouches.length?h.changedTouches[0]:null;if(this.target=h.target||h.srcElement,this.g=y,y=h.relatedTarget){if(j){e:{try{X(y.nodeName);var K=!0;break e}catch{}K=!1}K||(y=null)}}else w=="mouseover"?y=h.fromElement:w=="mouseout"&&(y=h.toElement);this.relatedTarget=y,N?(this.clientX=N.clientX!==void 0?N.clientX:N.pageX,this.clientY=N.clientY!==void 0?N.clientY:N.pageY,this.screenX=N.screenX||0,this.screenY=N.screenY||0):(this.clientX=h.clientX!==void 0?h.clientX:h.pageX,this.clientY=h.clientY!==void 0?h.clientY:h.pageY,this.screenX=h.screenX||0,this.screenY=h.screenY||0),this.button=h.button,this.key=h.key||"",this.ctrlKey=h.ctrlKey,this.altKey=h.altKey,this.shiftKey=h.shiftKey,this.metaKey=h.metaKey,this.pointerId=h.pointerId||0,this.pointerType=typeof h.pointerType=="string"?h.pointerType:Be[h.pointerType]||"",this.state=h.state,this.i=h,h.defaultPrevented&&me.aa.h.call(this)}}A(me,Ee);var Be={2:"touch",3:"pen",4:"mouse"};me.prototype.h=function(){me.aa.h.call(this);var h=this.i;h.preventDefault?h.preventDefault():h.returnValue=!1};var te="closure_listenable_"+(1e6*Math.random()|0),q=0;function ge(h,y,w,N,K){this.listener=h,this.proxy=null,this.src=y,this.type=w,this.capture=!!N,this.ha=K,this.key=++q,this.da=this.fa=!1}function Te(h){h.da=!0,h.listener=null,h.proxy=null,h.src=null,h.ha=null}function be(h){this.src=h,this.g={},this.h=0}be.prototype.add=function(h,y,w,N,K){var J=h.toString();h=this.g[J],h||(h=this.g[J]=[],this.h++);var fe=et(h,y,N,K);return-1<fe?(y=h[fe],w||(y.fa=!1)):(y=new ge(y,this.src,J,!!N,K),y.fa=w,h.push(y)),y};function $e(h,y){var w=y.type;if(w in h.g){var N=h.g[w],K=Array.prototype.indexOf.call(N,y,void 0),J;(J=0<=K)&&Array.prototype.splice.call(N,K,1),J&&(Te(y),h.g[w].length==0&&(delete h.g[w],h.h--))}}function et(h,y,w,N){for(var K=0;K<h.length;++K){var J=h[K];if(!J.da&&J.listener==y&&J.capture==!!w&&J.ha==N)return K}return-1}var Le="closure_lm_"+(1e6*Math.random()|0),Pt={};function On(h,y,w,N,K){if(Array.isArray(y)){for(var J=0;J<y.length;J++)On(h,y[J],w,N,K);return null}return w=Fn(w),h&&h[te]?h.K(y,w,p(N)?!!N.capture:!1,K):Yn(h,y,w,!1,N,K)}function Yn(h,y,w,N,K,J){if(!y)throw Error("Invalid event type");var fe=p(K)?!!K.capture:!!K,nt=pr(h);if(nt||(h[Le]=nt=new be(h)),w=nt.add(y,w,N,fe,J),w.proxy)return w;if(N=fr(),w.proxy=N,N.src=h,N.listener=w,h.addEventListener)Ve||(K=fe),K===void 0&&(K=!1),h.addEventListener(y.toString(),N,K);else if(h.attachEvent)h.attachEvent(gn(y.toString()),N);else if(h.addListener&&h.removeListener)h.addListener(N);else throw Error("addEventListener and attachEvent are unavailable.");return w}function fr(){function h(w){return y.call(h.src,h.listener,w)}const y=Lr;return h}function Zn(h,y,w,N,K){if(Array.isArray(y))for(var J=0;J<y.length;J++)Zn(h,y[J],w,N,K);else N=p(N)?!!N.capture:!!N,w=Fn(w),h&&h[te]?(h=h.i,y=String(y).toString(),y in h.g&&(J=h.g[y],w=et(J,w,N,K),-1<w&&(Te(J[w]),Array.prototype.splice.call(J,w,1),J.length==0&&(delete h.g[y],h.h--)))):h&&(h=pr(h))&&(y=h.g[y.toString()],h=-1,y&&(h=et(y,w,N,K)),(w=-1<h?y[h]:null)&&mn(w))}function mn(h){if(typeof h!="number"&&h&&!h.da){var y=h.src;if(y&&y[te])$e(y.i,h);else{var w=h.type,N=h.proxy;y.removeEventListener?y.removeEventListener(w,N,h.capture):y.detachEvent?y.detachEvent(gn(w),N):y.addListener&&y.removeListener&&y.removeListener(N),(w=pr(y))?($e(w,h),w.h==0&&(w.src=null,y[Le]=null)):Te(h)}}}function gn(h){return h in Pt?Pt[h]:Pt[h]="on"+h}function Lr(h,y){if(h.da)h=!0;else{y=new me(y,this);var w=h.listener,N=h.ha||h.src;h.fa&&mn(h),h=w.call(N,y)}return h}function pr(h){return h=h[Le],h instanceof be?h:null}var wt="__closure_events_fn_"+(1e9*Math.random()>>>0);function Fn(h){return typeof h=="function"?h:(h[wt]||(h[wt]=function(y){return h.handleEvent(y)}),h[wt])}function st(){Z.call(this),this.i=new be(this),this.M=this,this.F=null}A(st,Z),st.prototype[te]=!0,st.prototype.removeEventListener=function(h,y,w,N){Zn(this,h,y,w,N)};function ht(h,y){var w,N=h.F;if(N)for(w=[];N;N=N.F)w.push(N);if(h=h.M,N=y.type||y,typeof y=="string")y=new Ee(y,h);else if(y instanceof Ee)y.target=y.target||h;else{var K=y;y=new Ee(N,h),b(y,K)}if(K=!0,w)for(var J=w.length-1;0<=J;J--){var fe=y.g=w[J];K=yn(fe,N,!0,y)&&K}if(fe=y.g=h,K=yn(fe,N,!0,y)&&K,K=yn(fe,N,!1,y)&&K,w)for(J=0;J<w.length;J++)fe=y.g=w[J],K=yn(fe,N,!1,y)&&K}st.prototype.N=function(){if(st.aa.N.call(this),this.i){var h=this.i,y;for(y in h.g){for(var w=h.g[y],N=0;N<w.length;N++)Te(w[N]);delete h.g[y],h.h--}}this.F=null},st.prototype.K=function(h,y,w,N){return this.i.add(String(h),y,!1,w,N)},st.prototype.L=function(h,y,w,N){return this.i.add(String(h),y,!0,w,N)};function yn(h,y,w,N){if(y=h.i.g[String(y)],!y)return!0;y=y.concat();for(var K=!0,J=0;J<y.length;++J){var fe=y[J];if(fe&&!fe.da&&fe.capture==w){var nt=fe.listener,jt=fe.ha||fe.src;fe.fa&&$e(h.i,fe),K=nt.call(jt,N)!==!1&&K}}return K&&!N.defaultPrevented}function jr(h,y,w){if(typeof h=="function")w&&(h=E(h,w));else if(h&&typeof h.handleEvent=="function")h=E(h.handleEvent,h);else throw Error("Invalid listener argument");return 2147483647<Number(y)?-1:c.setTimeout(h,y||0)}function Jn(h){h.g=jr(()=>{h.g=null,h.i&&(h.i=!1,Jn(h))},h.l);const y=h.h;h.h=null,h.m.apply(null,y)}class mr extends Z{constructor(y,w){super(),this.m=y,this.l=w,this.h=null,this.i=!1,this.g=null}j(y){this.h=arguments,this.g?this.i=!0:Jn(this)}N(){super.N(),this.g&&(c.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Ln(h){Z.call(this),this.h=h,this.g={}}A(Ln,Z);var gr=[];function yr(h){$(h.g,function(y,w){this.g.hasOwnProperty(w)&&mn(y)},h),h.g={}}Ln.prototype.N=function(){Ln.aa.N.call(this),yr(this)},Ln.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Ii=c.JSON.stringify,Si=c.JSON.parse,Ci=class{stringify(h){return c.JSON.stringify(h,void 0)}parse(h){return c.JSON.parse(h,void 0)}};function vr(){}vr.prototype.h=null;function _e(h){return h.h||(h.h=h.i())}function xe(){}var Fe={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Ge(){Ee.call(this,"d")}A(Ge,Ee);function dt(){Ee.call(this,"c")}A(dt,Ee);var Ct={},nn=null;function jn(){return nn=nn||new st}Ct.La="serverreachability";function ks(h){Ee.call(this,Ct.La,h)}A(ks,Ee);function _r(h){const y=jn();ht(y,new ks(y))}Ct.STAT_EVENT="statevent";function Ai(h,y){Ee.call(this,Ct.STAT_EVENT,h),this.stat=y}A(Ai,Ee);function Et(h){const y=jn();ht(y,new Ai(y,h))}Ct.Ma="timingevent";function Br(h,y){Ee.call(this,Ct.Ma,h),this.size=y}A(Br,Ee);function We(h,y){if(typeof h!="function")throw Error("Fn must not be null and must be a function");return c.setTimeout(function(){h()},y)}function lt(){this.g=!0}lt.prototype.xa=function(){this.g=!1};function $t(h,y,w,N,K,J){h.info(function(){if(h.g)if(J)for(var fe="",nt=J.split("&"),jt=0;jt<nt.length;jt++){var Qe=nt[jt].split("=");if(1<Qe.length){var Wt=Qe[0];Qe=Qe[1];var Ot=Wt.split("_");fe=2<=Ot.length&&Ot[1]=="type"?fe+(Wt+"="+Qe+"&"):fe+(Wt+"=redacted&")}}else fe=null;else fe=J;return"XMLHTTP REQ ("+N+") [attempt "+K+"]: "+y+`
`+w+`
`+fe})}function zr(h,y,w,N,K,J,fe){h.info(function(){return"XMLHTTP RESP ("+N+") [ attempt "+K+"]: "+y+`
`+w+`
`+J+" "+fe})}function vn(h,y,w,N){h.info(function(){return"XMLHTTP TEXT ("+y+"): "+xi(h,w)+(N?" "+N:"")})}function os(h,y){h.info(function(){return"TIMEOUT: "+y})}lt.prototype.info=function(){};function xi(h,y){if(!h.g)return y;if(!y)return null;try{var w=JSON.parse(y);if(w){for(h=0;h<w.length;h++)if(Array.isArray(w[h])){var N=w[h];if(!(2>N.length)){var K=N[1];if(Array.isArray(K)&&!(1>K.length)){var J=K[0];if(J!="noop"&&J!="stop"&&J!="close")for(var fe=1;fe<K.length;fe++)K[fe]=""}}}}return Ii(w)}catch{return y}}var So={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Su={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},wr;function Ni(){}A(Ni,vr),Ni.prototype.g=function(){return new XMLHttpRequest},Ni.prototype.i=function(){return{}},wr=new Ni;function Er(h,y,w,N){this.j=h,this.i=y,this.l=w,this.R=N||1,this.U=new Ln(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Cu}function Cu(){this.i=null,this.g="",this.h=!1}var qa={},Co={};function Ao(h,y,w){h.L=1,h.v=Os(zn(y)),h.m=w,h.P=!0,Ga(h,null)}function Ga(h,y){h.F=Date.now(),ut(h),h.A=zn(h.v);var w=h.A,N=h.R;Array.isArray(N)||(N=[String(N)]),Ls(w.i,"t",N),h.C=0,w=h.j.J,h.h=new Cu,h.g=$u(h.j,w?y:null,!h.m),0<h.O&&(h.M=new mr(E(h.Y,h,h.g),h.O)),y=h.U,w=h.g,N=h.ca;var K="readystatechange";Array.isArray(K)||(K&&(gr[0]=K.toString()),K=gr);for(var J=0;J<K.length;J++){var fe=On(w,K[J],N||y.handleEvent,!1,y.h||y);if(!fe)break;y.g[fe.key]=fe}y=h.H?I(h.H):{},h.m?(h.u||(h.u="POST"),y["Content-Type"]="application/x-www-form-urlencoded",h.g.ea(h.A,h.u,h.m,y)):(h.u="GET",h.g.ea(h.A,h.u,null,y)),_r(),$t(h.i,h.u,h.A,h.l,h.R,h.m)}Er.prototype.ca=function(h){h=h.target;const y=this.M;y&&An(h)==3?y.j():this.Y(h)},Er.prototype.Y=function(h){try{if(h==this.g)e:{const Ot=An(this.g);var y=this.g.Ba();const nr=this.g.Z();if(!(3>Ot)&&(Ot!=3||this.g&&(this.h.h||this.g.oa()||Za(this.g)))){this.J||Ot!=4||y==7||(y==8||0>=nr?_r(3):_r(2)),Ri(this);var w=this.g.Z();this.X=w;t:if(Au(this)){var N=Za(this.g);h="";var K=N.length,J=An(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){er(this),bs(this);var fe="";break t}this.h.i=new c.TextDecoder}for(y=0;y<K;y++)this.h.h=!0,h+=this.h.i.decode(N[y],{stream:!(J&&y==K-1)});N.length=0,this.h.g+=h,this.C=0,fe=this.h.g}else fe=this.g.oa();if(this.o=w==200,zr(this.i,this.u,this.A,this.l,this.R,Ot,w),this.o){if(this.T&&!this.K){t:{if(this.g){var nt,jt=this.g;if((nt=jt.g?jt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!W(nt)){var Qe=nt;break t}}Qe=null}if(w=Qe)vn(this.i,this.l,w,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Ka(this,w);else{this.o=!1,this.s=3,Et(12),er(this),bs(this);break e}}if(this.P){w=!0;let $n;for(;!this.J&&this.C<fe.length;)if($n=cd(this,fe),$n==Co){Ot==4&&(this.s=4,Et(14),w=!1),vn(this.i,this.l,null,"[Incomplete Response]");break}else if($n==qa){this.s=4,Et(15),vn(this.i,this.l,fe,"[Invalid Chunk]"),w=!1;break}else vn(this.i,this.l,$n,null),Ka(this,$n);if(Au(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Ot!=4||fe.length!=0||this.h.h||(this.s=1,Et(16),w=!1),this.o=this.o&&w,!w)vn(this.i,this.l,fe,"[Invalid Chunked Response]"),er(this),bs(this);else if(0<fe.length&&!this.W){this.W=!0;var Wt=this.j;Wt.g==this&&Wt.ba&&!Wt.M&&(Wt.j.info("Great, no buffering proxy detected. Bytes received: "+fe.length),el(Wt),Wt.M=!0,Et(11))}}else vn(this.i,this.l,fe,null),Ka(this,fe);Ot==4&&er(this),this.o&&!this.J&&(Ot==4?Fo(this.j,this):(this.o=!1,ut(this)))}else bo(this.g),w==400&&0<fe.indexOf("Unknown SID")?(this.s=3,Et(12)):(this.s=0,Et(13)),er(this),bs(this)}}}catch{}finally{}};function Au(h){return h.g?h.u=="GET"&&h.L!=2&&h.j.Ca:!1}function cd(h,y){var w=h.C,N=y.indexOf(`
`,w);return N==-1?Co:(w=Number(y.substring(w,N)),isNaN(w)?qa:(N+=1,N+w>y.length?Co:(y=y.slice(N,N+w),h.C=N+w,y)))}Er.prototype.cancel=function(){this.J=!0,er(this)};function ut(h){h.S=Date.now()+h.I,xu(h,h.I)}function xu(h,y){if(h.B!=null)throw Error("WatchDog timer not null");h.B=We(E(h.ba,h),y)}function Ri(h){h.B&&(c.clearTimeout(h.B),h.B=null)}Er.prototype.ba=function(){this.B=null;const h=Date.now();0<=h-this.S?(os(this.i,this.A),this.L!=2&&(_r(),Et(17)),er(this),this.s=2,bs(this)):xu(this,this.S-h)};function bs(h){h.j.G==0||h.J||Fo(h.j,h)}function er(h){Ri(h);var y=h.M;y&&typeof y.ma=="function"&&y.ma(),h.M=null,yr(h.U),h.g&&(y=h.g,h.g=null,y.abort(),y.ma())}function Ka(h,y){try{var w=h.j;if(w.G!=0&&(w.g==h||_n(w.h,h))){if(!h.K&&_n(w.h,h)&&w.G==3){try{var N=w.Da.g.parse(y)}catch{N=null}if(Array.isArray(N)&&N.length==3){var K=N;if(K[0]==0){e:if(!w.u){if(w.g)if(w.g.F+3e3<h.F)Oo(w),Ar(w);else break e;Mo(w),Et(18)}}else w.za=K[1],0<w.za-w.T&&37500>K[2]&&w.F&&w.v==0&&!w.C&&(w.C=We(E(w.Za,w),6e3));if(1>=Ru(w.h)&&w.ca){try{w.ca()}catch{}w.ca=void 0}}else hs(w,11)}else if((h.K||w.g==h)&&Oo(w),!W(y))for(K=w.Da.g.parse(y),y=0;y<K.length;y++){let Qe=K[y];if(w.T=Qe[0],Qe=Qe[1],w.G==2)if(Qe[0]=="c"){w.K=Qe[1],w.ia=Qe[2];const Wt=Qe[3];Wt!=null&&(w.la=Wt,w.j.info("VER="+w.la));const Ot=Qe[4];Ot!=null&&(w.Aa=Ot,w.j.info("SVER="+w.Aa));const nr=Qe[5];nr!=null&&typeof nr=="number"&&0<nr&&(N=1.5*nr,w.L=N,w.j.info("backChannelRequestTimeoutMs_="+N)),N=w;const $n=h.g;if($n){const Oi=$n.g?$n.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Oi){var J=N.h;J.g||Oi.indexOf("spdy")==-1&&Oi.indexOf("quic")==-1&&Oi.indexOf("h2")==-1||(J.j=J.l,J.g=new Set,J.h&&(Ha(J,J.h),J.h=null))}if(N.D){const jo=$n.g?$n.g.getResponseHeader("X-HTTP-Session-Id"):null;jo&&(N.ya=jo,ot(N.I,N.D,jo))}}w.G=3,w.l&&w.l.ua(),w.ba&&(w.R=Date.now()-h.F,w.j.info("Handshake RTT: "+w.R+"ms")),N=w;var fe=h;if(N.qa=Uu(N,N.J?N.ia:null,N.W),fe.K){Pu(N.h,fe);var nt=fe,jt=N.L;jt&&(nt.I=jt),nt.B&&(Ri(nt),ut(nt)),N.g=fe}else Mi(N);0<w.i.length&&qr(w)}else Qe[0]!="stop"&&Qe[0]!="close"||hs(w,7);else w.G==3&&(Qe[0]=="stop"||Qe[0]=="close"?Qe[0]=="stop"?hs(w,7):Zt(w):Qe[0]!="noop"&&w.l&&w.l.ta(Qe),w.v=0)}}_r(4)}catch{}}var Nu=class{constructor(h,y){this.g=h,this.map=y}};function Pi(h){this.l=h||10,c.PerformanceNavigationTiming?(h=c.performance.getEntriesByType("navigation"),h=0<h.length&&(h[0].nextHopProtocol=="hq"||h[0].nextHopProtocol=="h2")):h=!!(c.chrome&&c.chrome.loadTimes&&c.chrome.loadTimes()&&c.chrome.loadTimes().wasFetchedViaSpdy),this.j=h?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Bn(h){return h.h?!0:h.g?h.g.size>=h.j:!1}function Ru(h){return h.h?1:h.g?h.g.size:0}function _n(h,y){return h.h?h.h==y:h.g?h.g.has(y):!1}function Ha(h,y){h.g?h.g.add(y):h.h=y}function Pu(h,y){h.h&&h.h==y?h.h=null:h.g&&h.g.has(y)&&h.g.delete(y)}Pi.prototype.cancel=function(){if(this.i=ku(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const h of this.g.values())h.cancel();this.g.clear()}};function ku(h){if(h.h!=null)return h.i.concat(h.h.D);if(h.g!=null&&h.g.size!==0){let y=h.i;for(const w of h.g.values())y=y.concat(w.D);return y}return P(h.i)}function xo(h){if(h.V&&typeof h.V=="function")return h.V();if(typeof Map<"u"&&h instanceof Map||typeof Set<"u"&&h instanceof Set)return Array.from(h.values());if(typeof h=="string")return h.split("");if(d(h)){for(var y=[],w=h.length,N=0;N<w;N++)y.push(h[N]);return y}y=[],w=0;for(N in h)y[w++]=h[N];return y}function No(h){if(h.na&&typeof h.na=="function")return h.na();if(!h.V||typeof h.V!="function"){if(typeof Map<"u"&&h instanceof Map)return Array.from(h.keys());if(!(typeof Set<"u"&&h instanceof Set)){if(d(h)||typeof h=="string"){var y=[];h=h.length;for(var w=0;w<h;w++)y.push(w);return y}y=[],w=0;for(const N in h)y[w++]=N;return y}}}function Ds(h,y){if(h.forEach&&typeof h.forEach=="function")h.forEach(y,void 0);else if(d(h)||typeof h=="string")Array.prototype.forEach.call(h,y,void 0);else for(var w=No(h),N=xo(h),K=N.length,J=0;J<K;J++)y.call(void 0,N[J],w&&w[J],h)}var ki=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function hd(h,y){if(h){h=h.split("&");for(var w=0;w<h.length;w++){var N=h[w].indexOf("="),K=null;if(0<=N){var J=h[w].substring(0,N);K=h[w].substring(N+1)}else J=h[w];y(J,K?decodeURIComponent(K.replace(/\+/g," ")):"")}}}function as(h){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,h instanceof as){this.h=h.h,bi(this,h.j),this.o=h.o,this.g=h.g,Vs(this,h.s),this.l=h.l;var y=h.i,w=new Ur;w.i=y.i,y.g&&(w.g=new Map(y.g),w.h=y.h),Ms(this,w),this.m=h.m}else h&&(y=String(h).match(ki))?(this.h=!1,bi(this,y[1]||"",!0),this.o=Ke(y[2]||""),this.g=Ke(y[3]||"",!0),Vs(this,y[4]),this.l=Ke(y[5]||"",!0),Ms(this,y[6]||"",!0),this.m=Ke(y[7]||"")):(this.h=!1,this.i=new Ur(null,this.h))}as.prototype.toString=function(){var h=[],y=this.j;y&&h.push(Fs(y,Ro,!0),":");var w=this.g;return(w||y=="file")&&(h.push("//"),(y=this.o)&&h.push(Fs(y,Ro,!0),"@"),h.push(encodeURIComponent(String(w)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),w=this.s,w!=null&&h.push(":",String(w))),(w=this.l)&&(this.g&&w.charAt(0)!="/"&&h.push("/"),h.push(Fs(w,w.charAt(0)=="/"?Vu:Du,!0))),(w=this.i.toString())&&h.push("?",w),(w=this.m)&&h.push("#",Fs(w,Qa)),h.join("")};function zn(h){return new as(h)}function bi(h,y,w){h.j=w?Ke(y,!0):y,h.j&&(h.j=h.j.replace(/:$/,""))}function Vs(h,y){if(y){if(y=Number(y),isNaN(y)||0>y)throw Error("Bad port number "+y);h.s=y}else h.s=null}function Ms(h,y,w){y instanceof Ur?(h.i=y,$r(h.i,h.h)):(w||(y=Fs(y,Mu)),h.i=new Ur(y,h.h))}function ot(h,y,w){h.i.set(y,w)}function Os(h){return ot(h,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),h}function Ke(h,y){return h?y?decodeURI(h.replace(/%25/g,"%2525")):decodeURIComponent(h):""}function Fs(h,y,w){return typeof h=="string"?(h=encodeURI(h).replace(y,bu),w&&(h=h.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),h):null}function bu(h){return h=h.charCodeAt(0),"%"+(h>>4&15).toString(16)+(h&15).toString(16)}var Ro=/[#\/\?@]/g,Du=/[#\?:]/g,Vu=/[#\?]/g,Mu=/[#\?@]/g,Qa=/#/g;function Ur(h,y){this.h=this.g=null,this.i=h||null,this.j=!!y}function Yt(h){h.g||(h.g=new Map,h.h=0,h.i&&hd(h.i,function(y,w){h.add(decodeURIComponent(y.replace(/\+/g," ")),w)}))}r=Ur.prototype,r.add=function(h,y){Yt(this),this.i=null,h=tr(this,h);var w=this.g.get(h);return w||this.g.set(h,w=[]),w.push(y),this.h+=1,this};function Tr(h,y){Yt(h),y=tr(h,y),h.g.has(y)&&(h.i=null,h.h-=h.g.get(y).length,h.g.delete(y))}function Ir(h,y){return Yt(h),y=tr(h,y),h.g.has(y)}r.forEach=function(h,y){Yt(this),this.g.forEach(function(w,N){w.forEach(function(K){h.call(y,K,N,this)},this)},this)},r.na=function(){Yt(this);const h=Array.from(this.g.values()),y=Array.from(this.g.keys()),w=[];for(let N=0;N<y.length;N++){const K=h[N];for(let J=0;J<K.length;J++)w.push(y[N])}return w},r.V=function(h){Yt(this);let y=[];if(typeof h=="string")Ir(this,h)&&(y=y.concat(this.g.get(tr(this,h))));else{h=Array.from(this.g.values());for(let w=0;w<h.length;w++)y=y.concat(h[w])}return y},r.set=function(h,y){return Yt(this),this.i=null,h=tr(this,h),Ir(this,h)&&(this.h-=this.g.get(h).length),this.g.set(h,[y]),this.h+=1,this},r.get=function(h,y){return h?(h=this.V(h),0<h.length?String(h[0]):y):y};function Ls(h,y,w){Tr(h,y),0<w.length&&(h.i=null,h.g.set(tr(h,y),P(w)),h.h+=w.length)}r.toString=function(){if(this.i)return this.i;if(!this.g)return"";const h=[],y=Array.from(this.g.keys());for(var w=0;w<y.length;w++){var N=y[w];const J=encodeURIComponent(String(N)),fe=this.V(N);for(N=0;N<fe.length;N++){var K=J;fe[N]!==""&&(K+="="+encodeURIComponent(String(fe[N]))),h.push(K)}}return this.i=h.join("&")};function tr(h,y){return y=String(y),h.j&&(y=y.toLowerCase()),y}function $r(h,y){y&&!h.j&&(Yt(h),h.i=null,h.g.forEach(function(w,N){var K=N.toLowerCase();N!=K&&(Tr(this,N),Ls(this,K,w))},h)),h.j=y}function dd(h,y){const w=new lt;if(c.Image){const N=new Image;N.onload=C(Cn,w,"TestLoadImage: loaded",!0,y,N),N.onerror=C(Cn,w,"TestLoadImage: error",!1,y,N),N.onabort=C(Cn,w,"TestLoadImage: abort",!1,y,N),N.ontimeout=C(Cn,w,"TestLoadImage: timeout",!1,y,N),c.setTimeout(function(){N.ontimeout&&N.ontimeout()},1e4),N.src=h}else y(!1)}function Ou(h,y){const w=new lt,N=new AbortController,K=setTimeout(()=>{N.abort(),Cn(w,"TestPingServer: timeout",!1,y)},1e4);fetch(h,{signal:N.signal}).then(J=>{clearTimeout(K),J.ok?Cn(w,"TestPingServer: ok",!0,y):Cn(w,"TestPingServer: server error",!1,y)}).catch(()=>{clearTimeout(K),Cn(w,"TestPingServer: error",!1,y)})}function Cn(h,y,w,N,K){try{K&&(K.onload=null,K.onerror=null,K.onabort=null,K.ontimeout=null),N(w)}catch{}}function fd(){this.g=new Ci}function Fu(h,y,w){const N=w||"";try{Ds(h,function(K,J){let fe=K;p(K)&&(fe=Ii(K)),y.push(N+J+"="+encodeURIComponent(fe))})}catch(K){throw y.push(N+"type="+encodeURIComponent("_badmap")),K}}function ls(h){this.l=h.Ub||null,this.j=h.eb||!1}A(ls,vr),ls.prototype.g=function(){return new Di(this.l,this.j)},ls.prototype.i=function(h){return function(){return h}}({});function Di(h,y){st.call(this),this.D=h,this.o=y,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}A(Di,st),r=Di.prototype,r.open=function(h,y){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=h,this.A=y,this.readyState=1,Cr(this)},r.send=function(h){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const y={headers:this.u,method:this.B,credentials:this.m,cache:void 0};h&&(y.body=h),(this.D||c).fetch(new Request(this.A,y)).then(this.Sa.bind(this),this.ga.bind(this))},r.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Sr(this)),this.readyState=0},r.Sa=function(h){if(this.g&&(this.l=h,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=h.headers,this.readyState=2,Cr(this)),this.g&&(this.readyState=3,Cr(this),this.g)))if(this.responseType==="arraybuffer")h.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof c.ReadableStream<"u"&&"body"in h){if(this.j=h.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Lu(this)}else h.text().then(this.Ra.bind(this),this.ga.bind(this))};function Lu(h){h.j.read().then(h.Pa.bind(h)).catch(h.ga.bind(h))}r.Pa=function(h){if(this.g){if(this.o&&h.value)this.response.push(h.value);else if(!this.o){var y=h.value?h.value:new Uint8Array(0);(y=this.v.decode(y,{stream:!h.done}))&&(this.response=this.responseText+=y)}h.done?Sr(this):Cr(this),this.readyState==3&&Lu(this)}},r.Ra=function(h){this.g&&(this.response=this.responseText=h,Sr(this))},r.Qa=function(h){this.g&&(this.response=h,Sr(this))},r.ga=function(){this.g&&Sr(this)};function Sr(h){h.readyState=4,h.l=null,h.j=null,h.v=null,Cr(h)}r.setRequestHeader=function(h,y){this.u.append(h,y)},r.getResponseHeader=function(h){return this.h&&this.h.get(h.toLowerCase())||""},r.getAllResponseHeaders=function(){if(!this.h)return"";const h=[],y=this.h.entries();for(var w=y.next();!w.done;)w=w.value,h.push(w[0]+": "+w[1]),w=y.next();return h.join(`\r
`)};function Cr(h){h.onreadystatechange&&h.onreadystatechange.call(h)}Object.defineProperty(Di.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(h){this.m=h?"include":"same-origin"}});function us(h){let y="";return $(h,function(w,N){y+=N,y+=":",y+=w,y+=`\r
`}),y}function js(h,y,w){e:{for(N in w){var N=!1;break e}N=!0}N||(w=us(w),typeof h=="string"?w!=null&&encodeURIComponent(String(w)):ot(h,y,w))}function gt(h){st.call(this),this.headers=new Map,this.o=h||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}A(gt,st);var pd=/^https?$/i,Xa=["POST","PUT"];r=gt.prototype,r.Ha=function(h){this.J=h},r.ea=function(h,y,w,N){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+h);y=y?y.toUpperCase():"GET",this.D=h,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():wr.g(),this.v=this.o?_e(this.o):_e(wr),this.g.onreadystatechange=E(this.Ea,this);try{this.B=!0,this.g.open(y,String(h),!0),this.B=!1}catch(J){Vi(this,J);return}if(h=w||"",w=new Map(this.headers),N)if(Object.getPrototypeOf(N)===Object.prototype)for(var K in N)w.set(K,N[K]);else if(typeof N.keys=="function"&&typeof N.get=="function")for(const J of N.keys())w.set(J,N.get(J));else throw Error("Unknown input type for opt_headers: "+String(N));N=Array.from(w.keys()).find(J=>J.toLowerCase()=="content-type"),K=c.FormData&&h instanceof c.FormData,!(0<=Array.prototype.indexOf.call(Xa,y,void 0))||N||K||w.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[J,fe]of w)this.g.setRequestHeader(J,fe);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{ko(this),this.u=!0,this.g.send(h),this.u=!1}catch(J){Vi(this,J)}};function Vi(h,y){h.h=!1,h.g&&(h.j=!0,h.g.abort(),h.j=!1),h.l=y,h.m=5,Po(h),Un(h)}function Po(h){h.A||(h.A=!0,ht(h,"complete"),ht(h,"error"))}r.abort=function(h){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=h||7,ht(this,"complete"),ht(this,"abort"),Un(this))},r.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Un(this,!0)),gt.aa.N.call(this)},r.Ea=function(){this.s||(this.B||this.u||this.j?Ya(this):this.bb())},r.bb=function(){Ya(this)};function Ya(h){if(h.h&&typeof u<"u"&&(!h.v[1]||An(h)!=4||h.Z()!=2)){if(h.u&&An(h)==4)jr(h.Ea,0,h);else if(ht(h,"readystatechange"),An(h)==4){h.h=!1;try{const fe=h.Z();e:switch(fe){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var y=!0;break e;default:y=!1}var w;if(!(w=y)){var N;if(N=fe===0){var K=String(h.D).match(ki)[1]||null;!K&&c.self&&c.self.location&&(K=c.self.location.protocol.slice(0,-1)),N=!pd.test(K?K.toLowerCase():"")}w=N}if(w)ht(h,"complete"),ht(h,"success");else{h.m=6;try{var J=2<An(h)?h.g.statusText:""}catch{J=""}h.l=J+" ["+h.Z()+"]",Po(h)}}finally{Un(h)}}}}function Un(h,y){if(h.g){ko(h);const w=h.g,N=h.v[0]?()=>{}:null;h.g=null,h.v=null,y||ht(h,"ready");try{w.onreadystatechange=N}catch{}}}function ko(h){h.I&&(c.clearTimeout(h.I),h.I=null)}r.isActive=function(){return!!this.g};function An(h){return h.g?h.g.readyState:0}r.Z=function(){try{return 2<An(this)?this.g.status:-1}catch{return-1}},r.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},r.Oa=function(h){if(this.g){var y=this.g.responseText;return h&&y.indexOf(h)==0&&(y=y.substring(h.length)),Si(y)}};function Za(h){try{if(!h.g)return null;if("response"in h.g)return h.g.response;switch(h.H){case"":case"text":return h.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in h.g)return h.g.mozResponseArrayBuffer}return null}catch{return null}}function bo(h){const y={};h=(h.g&&2<=An(h)&&h.g.getAllResponseHeaders()||"").split(`\r
`);for(let N=0;N<h.length;N++){if(W(h[N]))continue;var w=D(h[N]);const K=w[0];if(w=w[1],typeof w!="string")continue;w=w.trim();const J=y[K]||[];y[K]=J,J.push(w)}x(y,function(N){return N.join(", ")})}r.Ba=function(){return this.m},r.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Wr(h,y,w){return w&&w.internalChannelParams&&w.internalChannelParams[h]||y}function Ja(h){this.Aa=0,this.i=[],this.j=new lt,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Wr("failFast",!1,h),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Wr("baseRetryDelayMs",5e3,h),this.cb=Wr("retryDelaySeedMs",1e4,h),this.Wa=Wr("forwardChannelMaxRetries",2,h),this.wa=Wr("forwardChannelRequestTimeoutMs",2e4,h),this.pa=h&&h.xmlHttpFactory||void 0,this.Xa=h&&h.Tb||void 0,this.Ca=h&&h.useFetchStreams||!1,this.L=void 0,this.J=h&&h.supportsCrossDomainXhr||!1,this.K="",this.h=new Pi(h&&h.concurrentRequestLimit),this.Da=new fd,this.P=h&&h.fastHandshake||!1,this.O=h&&h.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=h&&h.Rb||!1,h&&h.xa&&this.j.xa(),h&&h.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&h&&h.detectBufferingProxy||!1,this.ja=void 0,h&&h.longPollingTimeout&&0<h.longPollingTimeout&&(this.ja=h.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}r=Ja.prototype,r.la=8,r.G=1,r.connect=function(h,y,w,N){Et(0),this.W=h,this.H=y||{},w&&N!==void 0&&(this.H.OSID=w,this.H.OAID=N),this.F=this.X,this.I=Uu(this,null,this.W),qr(this)};function Zt(h){if(Do(h),h.G==3){var y=h.U++,w=zn(h.I);if(ot(w,"SID",h.K),ot(w,"RID",y),ot(w,"TYPE","terminate"),cs(h,w),y=new Er(h,h.j,y),y.L=2,y.v=Os(zn(w)),w=!1,c.navigator&&c.navigator.sendBeacon)try{w=c.navigator.sendBeacon(y.v.toString(),"")}catch{}!w&&c.Image&&(new Image().src=y.v,w=!0),w||(y.g=$u(y.j,null),y.g.ea(y.v)),y.F=Date.now(),ut(y)}zu(h)}function Ar(h){h.g&&(el(h),h.g.cancel(),h.g=null)}function Do(h){Ar(h),h.u&&(c.clearTimeout(h.u),h.u=null),Oo(h),h.h.cancel(),h.s&&(typeof h.s=="number"&&c.clearTimeout(h.s),h.s=null)}function qr(h){if(!Bn(h.h)&&!h.s){h.s=!0;var y=h.Ga;de||re(),ee||(de(),ee=!0),ne.add(y,h),h.B=0}}function md(h,y){return Ru(h.h)>=h.h.j-(h.s?1:0)?!1:h.s?(h.i=y.D.concat(h.i),!0):h.G==1||h.G==2||h.B>=(h.Va?0:h.Wa)?!1:(h.s=We(E(h.Ga,h,y),Bu(h,h.B)),h.B++,!0)}r.Ga=function(h){if(this.s)if(this.s=null,this.G==1){if(!h){this.U=Math.floor(1e5*Math.random()),h=this.U++;const K=new Er(this,this.j,h);let J=this.o;if(this.S&&(J?(J=I(J),b(J,this.S)):J=this.S),this.m!==null||this.O||(K.H=J,J=null),this.P)e:{for(var y=0,w=0;w<this.i.length;w++){t:{var N=this.i[w];if("__data__"in N.map&&(N=N.map.__data__,typeof N=="string")){N=N.length;break t}N=void 0}if(N===void 0)break;if(y+=N,4096<y){y=w;break e}if(y===4096||w===this.i.length-1){y=w+1;break e}}y=1e3}else y=1e3;y=Bs(this,K,y),w=zn(this.I),ot(w,"RID",h),ot(w,"CVER",22),this.D&&ot(w,"X-HTTP-Session-Id",this.D),cs(this,w),J&&(this.O?y="headers="+encodeURIComponent(String(us(J)))+"&"+y:this.m&&js(w,this.m,J)),Ha(this.h,K),this.Ua&&ot(w,"TYPE","init"),this.P?(ot(w,"$req",y),ot(w,"SID","null"),K.T=!0,Ao(K,w,null)):Ao(K,w,y),this.G=2}}else this.G==3&&(h?Vo(this,h):this.i.length==0||Bn(this.h)||Vo(this))};function Vo(h,y){var w;y?w=y.l:w=h.U++;const N=zn(h.I);ot(N,"SID",h.K),ot(N,"RID",w),ot(N,"AID",h.T),cs(h,N),h.m&&h.o&&js(N,h.m,h.o),w=new Er(h,h.j,w,h.B+1),h.m===null&&(w.H=h.o),y&&(h.i=y.D.concat(h.i)),y=Bs(h,w,1e3),w.I=Math.round(.5*h.wa)+Math.round(.5*h.wa*Math.random()),Ha(h.h,w),Ao(w,N,y)}function cs(h,y){h.H&&$(h.H,function(w,N){ot(y,N,w)}),h.l&&Ds({},function(w,N){ot(y,N,w)})}function Bs(h,y,w){w=Math.min(h.i.length,w);var N=h.l?E(h.l.Na,h.l,h):null;e:{var K=h.i;let J=-1;for(;;){const fe=["count="+w];J==-1?0<w?(J=K[0].g,fe.push("ofs="+J)):J=0:fe.push("ofs="+J);let nt=!0;for(let jt=0;jt<w;jt++){let Qe=K[jt].g;const Wt=K[jt].map;if(Qe-=J,0>Qe)J=Math.max(0,K[jt].g-100),nt=!1;else try{Fu(Wt,fe,"req"+Qe+"_")}catch{N&&N(Wt)}}if(nt){N=fe.join("&");break e}}}return h=h.i.splice(0,w),y.D=h,N}function Mi(h){if(!h.g&&!h.u){h.Y=1;var y=h.Fa;de||re(),ee||(de(),ee=!0),ne.add(y,h),h.v=0}}function Mo(h){return h.g||h.u||3<=h.v?!1:(h.Y++,h.u=We(E(h.Fa,h),Bu(h,h.v)),h.v++,!0)}r.Fa=function(){if(this.u=null,ju(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var h=2*this.R;this.j.info("BP detection timer enabled: "+h),this.A=We(E(this.ab,this),h)}},r.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Et(10),Ar(this),ju(this))};function el(h){h.A!=null&&(c.clearTimeout(h.A),h.A=null)}function ju(h){h.g=new Er(h,h.j,"rpc",h.Y),h.m===null&&(h.g.H=h.o),h.g.O=0;var y=zn(h.qa);ot(y,"RID","rpc"),ot(y,"SID",h.K),ot(y,"AID",h.T),ot(y,"CI",h.F?"0":"1"),!h.F&&h.ja&&ot(y,"TO",h.ja),ot(y,"TYPE","xmlhttp"),cs(h,y),h.m&&h.o&&js(y,h.m,h.o),h.L&&(h.g.I=h.L);var w=h.g;h=h.ia,w.L=1,w.v=Os(zn(y)),w.m=null,w.P=!0,Ga(w,h)}r.Za=function(){this.C!=null&&(this.C=null,Ar(this),Mo(this),Et(19))};function Oo(h){h.C!=null&&(c.clearTimeout(h.C),h.C=null)}function Fo(h,y){var w=null;if(h.g==y){Oo(h),el(h),h.g=null;var N=2}else if(_n(h.h,y))w=y.D,Pu(h.h,y),N=1;else return;if(h.G!=0){if(y.o)if(N==1){w=y.m?y.m.length:0,y=Date.now()-y.F;var K=h.B;N=jn(),ht(N,new Br(N,w)),qr(h)}else Mi(h);else if(K=y.s,K==3||K==0&&0<y.X||!(N==1&&md(h,y)||N==2&&Mo(h)))switch(w&&0<w.length&&(y=h.h,y.i=y.i.concat(w)),K){case 1:hs(h,5);break;case 4:hs(h,10);break;case 3:hs(h,6);break;default:hs(h,2)}}}function Bu(h,y){let w=h.Ta+Math.floor(Math.random()*h.cb);return h.isActive()||(w*=2),w*y}function hs(h,y){if(h.j.info("Error code "+y),y==2){var w=E(h.fb,h),N=h.Xa;const K=!N;N=new as(N||"//www.google.com/images/cleardot.gif"),c.location&&c.location.protocol=="http"||bi(N,"https"),Os(N),K?dd(N.toString(),w):Ou(N.toString(),w)}else Et(2);h.G=0,h.l&&h.l.sa(y),zu(h),Do(h)}r.fb=function(h){h?(this.j.info("Successfully pinged google.com"),Et(2)):(this.j.info("Failed to ping google.com"),Et(1))};function zu(h){if(h.G=0,h.ka=[],h.l){const y=ku(h.h);(y.length!=0||h.i.length!=0)&&(M(h.ka,y),M(h.ka,h.i),h.h.i.length=0,P(h.i),h.i.length=0),h.l.ra()}}function Uu(h,y,w){var N=w instanceof as?zn(w):new as(w);if(N.g!="")y&&(N.g=y+"."+N.g),Vs(N,N.s);else{var K=c.location;N=K.protocol,y=y?y+"."+K.hostname:K.hostname,K=+K.port;var J=new as(null);N&&bi(J,N),y&&(J.g=y),K&&Vs(J,K),w&&(J.l=w),N=J}return w=h.D,y=h.ya,w&&y&&ot(N,w,y),ot(N,"VER",h.la),cs(h,N),N}function $u(h,y,w){if(y&&!h.J)throw Error("Can't create secondary domain capable XhrIo object.");return y=h.Ca&&!h.pa?new gt(new ls({eb:w})):new gt(h.pa),y.Ha(h.J),y}r.isActive=function(){return!!this.l&&this.l.isActive(this)};function tl(){}r=tl.prototype,r.ua=function(){},r.ta=function(){},r.sa=function(){},r.ra=function(){},r.isActive=function(){return!0},r.Na=function(){};function Lo(){}Lo.prototype.g=function(h,y){return new wn(h,y)};function wn(h,y){st.call(this),this.g=new Ja(y),this.l=h,this.h=y&&y.messageUrlParams||null,h=y&&y.messageHeaders||null,y&&y.clientProtocolHeaderRequired&&(h?h["X-Client-Protocol"]="webchannel":h={"X-Client-Protocol":"webchannel"}),this.g.o=h,h=y&&y.initMessageHeaders||null,y&&y.messageContentType&&(h?h["X-WebChannel-Content-Type"]=y.messageContentType:h={"X-WebChannel-Content-Type":y.messageContentType}),y&&y.va&&(h?h["X-WebChannel-Client-Profile"]=y.va:h={"X-WebChannel-Client-Profile":y.va}),this.g.S=h,(h=y&&y.Sb)&&!W(h)&&(this.g.m=h),this.v=y&&y.supportsCrossDomainXhr||!1,this.u=y&&y.sendRawJson||!1,(y=y&&y.httpSessionIdParam)&&!W(y)&&(this.g.D=y,h=this.h,h!==null&&y in h&&(h=this.h,y in h&&delete h[y])),this.j=new Gr(this)}A(wn,st),wn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},wn.prototype.close=function(){Zt(this.g)},wn.prototype.o=function(h){var y=this.g;if(typeof h=="string"){var w={};w.__data__=h,h=w}else this.u&&(w={},w.__data__=Ii(h),h=w);y.i.push(new Nu(y.Ya++,h)),y.G==3&&qr(y)},wn.prototype.N=function(){this.g.l=null,delete this.j,Zt(this.g),delete this.g,wn.aa.N.call(this)};function Wu(h){Ge.call(this),h.__headers__&&(this.headers=h.__headers__,this.statusCode=h.__status__,delete h.__headers__,delete h.__status__);var y=h.__sm__;if(y){e:{for(const w in y){h=w;break e}h=void 0}(this.i=h)&&(h=this.i,y=y!==null&&h in y?y[h]:void 0),this.data=y}else this.data=h}A(Wu,Ge);function qu(){dt.call(this),this.status=1}A(qu,dt);function Gr(h){this.g=h}A(Gr,tl),Gr.prototype.ua=function(){ht(this.g,"a")},Gr.prototype.ta=function(h){ht(this.g,new Wu(h))},Gr.prototype.sa=function(h){ht(this.g,new qu)},Gr.prototype.ra=function(){ht(this.g,"b")},Lo.prototype.createWebChannel=Lo.prototype.g,wn.prototype.send=wn.prototype.o,wn.prototype.open=wn.prototype.m,wn.prototype.close=wn.prototype.close,Mw=function(){return new Lo},Vw=function(){return jn()},Dw=Ct,cp={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},So.NO_ERROR=0,So.TIMEOUT=8,So.HTTP_ERROR=6,Hc=So,Su.COMPLETE="complete",bw=Su,xe.EventType=Fe,Fe.OPEN="a",Fe.CLOSE="b",Fe.ERROR="c",Fe.MESSAGE="d",st.prototype.listen=st.prototype.K,kl=xe,gt.prototype.listenOnce=gt.prototype.L,gt.prototype.getLastError=gt.prototype.Ka,gt.prototype.getLastErrorCode=gt.prototype.Ba,gt.prototype.getStatus=gt.prototype.Z,gt.prototype.getResponseJson=gt.prototype.Oa,gt.prototype.getResponseText=gt.prototype.oa,gt.prototype.send=gt.prototype.ea,gt.prototype.setWithCredentials=gt.prototype.Ha,kw=gt}).apply(typeof jc<"u"?jc:typeof self<"u"?self:typeof window<"u"?window:{});const fv="@firebase/firestore",pv="4.7.9";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}cn.UNAUTHENTICATED=new cn(null),cn.GOOGLE_CREDENTIALS=new cn("google-credentials-uid"),cn.FIRST_PARTY=new cn("first-party-uid"),cn.MOCK_USER=new cn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Fa="11.4.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uo=new Ew("@firebase/firestore");function da(){return uo.logLevel}function oe(r,...e){if(uo.logLevel<=Ye.DEBUG){const t=e.map(Gp);uo.debug(`Firestore (${Fa}): ${r}`,...t)}}function bt(r,...e){if(uo.logLevel<=Ye.ERROR){const t=e.map(Gp);uo.error(`Firestore (${Fa}): ${r}`,...t)}}function Wl(r,...e){if(uo.logLevel<=Ye.WARN){const t=e.map(Gp);uo.warn(`Firestore (${Fa}): ${r}`,...t)}}function Gp(r){if(typeof r=="string")return r;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(t){return JSON.stringify(t)}(r)}catch{return r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ae(r="Unexpected state"){const e=`FIRESTORE (${Fa}) INTERNAL ASSERTION FAILED: `+r;throw bt(e),new Error(e)}function ke(r,e){r||Ae()}function Re(r,e){return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const se={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ce extends vo{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fi{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EC{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class TC{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(cn.UNAUTHENTICATED))}shutdown(){}}class IC{constructor(e){this.t=e,this.currentUser=cn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){ke(this.o===void 0);let n=this.i;const i=d=>this.i!==n?(n=this.i,t(d)):Promise.resolve();let a=new fi;this.o=()=>{this.i++,this.currentUser=this.u(),a.resolve(),a=new fi,e.enqueueRetryable(()=>i(this.currentUser))};const u=()=>{const d=a;e.enqueueRetryable(async()=>{await d.promise,await i(this.currentUser)})},c=d=>{oe("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=d,this.o&&(this.auth.addAuthTokenListener(this.o),u())};this.t.onInit(d=>c(d)),setTimeout(()=>{if(!this.auth){const d=this.t.getImmediate({optional:!0});d?c(d):(oe("FirebaseAuthCredentialsProvider","Auth not yet detected"),a.resolve(),a=new fi)}},0),u()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(n=>this.i!==e?(oe("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(ke(typeof n.accessToken=="string"),new EC(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return ke(e===null||typeof e=="string"),new cn(e)}}class SC{constructor(e,t,n){this.l=e,this.h=t,this.P=n,this.type="FirstParty",this.user=cn.FIRST_PARTY,this.T=new Map}I(){return this.P?this.P():null}get headers(){this.T.set("X-Goog-AuthUser",this.l);const e=this.I();return e&&this.T.set("Authorization",e),this.h&&this.T.set("X-Goog-Iam-Authorization-Token",this.h),this.T}}class CC{constructor(e,t,n){this.l=e,this.h=t,this.P=n}getToken(){return Promise.resolve(new SC(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(cn.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class mv{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class AC{constructor(e,t){this.A=t,this.forceRefresh=!1,this.appCheck=null,this.R=null,this.V=null,Cw(e)&&e.settings.appCheckToken&&(this.V=e.settings.appCheckToken)}start(e,t){ke(this.o===void 0);const n=a=>{a.error!=null&&oe("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${a.error.message}`);const u=a.token!==this.R;return this.R=a.token,oe("FirebaseAppCheckTokenProvider",`Received ${u?"new":"existing"} token.`),u?t(a.token):Promise.resolve()};this.o=a=>{e.enqueueRetryable(()=>n(a))};const i=a=>{oe("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=a,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(a=>i(a)),setTimeout(()=>{if(!this.appCheck){const a=this.A.getImmediate({optional:!0});a?i(a):oe("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.V)return Promise.resolve(new mv(this.V));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(ke(typeof t.token=="string"),this.R=t.token,new mv(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xC(r){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(r);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let n=0;n<r;n++)t[n]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ow{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const i=xC(40);for(let a=0;a<i.length;++a)n.length<20&&i[a]<t&&(n+=e.charAt(i[a]%62))}return n}}function ze(r,e){return r<e?-1:r>e?1:0}function wa(r,e,t){return r.length===e.length&&r.every((n,i)=>t(n,e[i]))}function Fw(r){return r+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gv=-62135596800,yv=1e6;class Qt{static now(){return Qt.fromMillis(Date.now())}static fromDate(e){return Qt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor((e-1e3*t)*yv);return new Qt(t,n)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Ce(se.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Ce(se.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<gv)throw new Ce(se.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Ce(se.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/yv}_compareTo(e){return this.seconds===e.seconds?ze(this.nanoseconds,e.nanoseconds):ze(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds-gv;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class De{static fromTimestamp(e){return new De(e)}static min(){return new De(new Qt(0,0))}static max(){return new De(new Qt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vv="__name__";class Yr{constructor(e,t,n){t===void 0?t=0:t>e.length&&Ae(),n===void 0?n=e.length-t:n>e.length-t&&Ae(),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return Yr.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Yr?e.forEach(n=>{t.push(n)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let i=0;i<n;i++){const a=Yr.compareSegments(e.get(i),t.get(i));if(a!==0)return a}return Math.sign(e.length-t.length)}static compareSegments(e,t){const n=Yr.isNumericId(e),i=Yr.isNumericId(t);return n&&!i?-1:!n&&i?1:n&&i?Yr.extractNumericId(e).compare(Yr.extractNumericId(t)):e<t?-1:e>t?1:0}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return di.fromString(e.substring(4,e.length-2))}}class at extends Yr{construct(e,t,n){return new at(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const n of e){if(n.indexOf("//")>=0)throw new Ce(se.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter(i=>i.length>0))}return new at(t)}static emptyPath(){return new at([])}}const NC=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Dt extends Yr{construct(e,t,n){return new Dt(e,t,n)}static isValidIdentifier(e){return NC.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Dt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===vv}static keyField(){return new Dt([vv])}static fromServerFormat(e){const t=[];let n="",i=0;const a=()=>{if(n.length===0)throw new Ce(se.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let u=!1;for(;i<e.length;){const c=e[i];if(c==="\\"){if(i+1===e.length)throw new Ce(se.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const d=e[i+1];if(d!=="\\"&&d!=="."&&d!=="`")throw new Ce(se.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=d,i+=2}else c==="`"?(u=!u,i++):c!=="."||u?(n+=c,i++):(a(),i++)}if(a(),u)throw new Ce(se.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Dt(t)}static emptyPath(){return new Dt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ye{constructor(e){this.path=e}static fromPath(e){return new ye(at.fromString(e))}static fromName(e){return new ye(at.fromString(e).popFirst(5))}static empty(){return new ye(at.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&at.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return at.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ye(new at(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ea=-1;class lh{constructor(e,t,n,i){this.indexId=e,this.collectionGroup=t,this.fields=n,this.indexState=i}}function hp(r){return r.fields.find(e=>e.kind===2)}function Zi(r){return r.fields.filter(e=>e.kind!==2)}lh.UNKNOWN_ID=-1;class Qc{constructor(e,t){this.fieldPath=e,this.kind=t}}class ql{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new ql(0,Xn.min())}}function Lw(r,e){const t=r.toTimestamp().seconds,n=r.toTimestamp().nanoseconds+1,i=De.fromTimestamp(n===1e9?new Qt(t+1,0):new Qt(t,n));return new Xn(i,ye.empty(),e)}function jw(r){return new Xn(r.readTime,r.key,Ea)}class Xn{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new Xn(De.min(),ye.empty(),Ea)}static max(){return new Xn(De.max(),ye.empty(),Ea)}}function Kp(r,e){let t=r.readTime.compareTo(e.readTime);return t!==0?t:(t=ye.comparator(r.documentKey,e.documentKey),t!==0?t:ze(r.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bw="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class zw{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _i(r){if(r.code!==se.FAILED_PRECONDITION||r.message!==Bw)throw r;oe("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Ae(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new G((n,i)=>{this.nextCallback=a=>{this.wrapSuccess(e,a).next(n,i)},this.catchCallback=a=>{this.wrapFailure(t,a).next(n,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof G?t:G.resolve(t)}catch(t){return G.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):G.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):G.reject(t)}static resolve(e){return new G((t,n)=>{t(e)})}static reject(e){return new G((t,n)=>{n(e)})}static waitFor(e){return new G((t,n)=>{let i=0,a=0,u=!1;e.forEach(c=>{++i,c.next(()=>{++a,u&&a===i&&t()},d=>n(d))}),u=!0,a===i&&t()})}static or(e){let t=G.resolve(!1);for(const n of e)t=t.next(i=>i?G.resolve(i):n());return t}static forEach(e,t){const n=[];return e.forEach((i,a)=>{n.push(t.call(this,i,a))}),this.waitFor(n)}static mapArray(e,t){return new G((n,i)=>{const a=e.length,u=new Array(a);let c=0;for(let d=0;d<a;d++){const p=d;t(e[p]).next(g=>{u[p]=g,++c,c===a&&n(u)},g=>i(g))}})}static doWhile(e,t){return new G((n,i)=>{const a=()=>{e()===!0?t().next(()=>{a()},i):n()};a()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kn="SimpleDb";class Lh{static open(e,t,n,i){try{return new Lh(t,e.transaction(i,n))}catch(a){throw new Ml(t,a)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.m=new fi,this.transaction.oncomplete=()=>{this.m.resolve()},this.transaction.onabort=()=>{t.error?this.m.reject(new Ml(e,t.error)):this.m.resolve()},this.transaction.onerror=n=>{const i=Hp(n.target.error);this.m.reject(new Ml(e,i))}}get p(){return this.m.promise}abort(e){e&&this.m.reject(e),this.aborted||(oe(Kn,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}S(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new PC(t)}}class pi{static delete(e){return oe(Kn,"Removing database:",e),eo(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!vw())return!1;if(pi.v())return!0;const e=ih(),t=pi.C(e),n=0<t&&t<10,i=Uw(e),a=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||n||a)}static v(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.F)==="YES"}static M(e,t){return e.store(t)}static C(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(n)}constructor(e,t,n){this.name=e,this.version=t,this.O=n,pi.C(ih())===12.2&&bt("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async N(e){return this.db||(oe(Kn,"Opening database:",this.name),this.db=await new Promise((t,n)=>{const i=indexedDB.open(this.name,this.version);i.onsuccess=a=>{const u=a.target.result;t(u)},i.onblocked=()=>{n(new Ml(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=a=>{const u=a.target.error;u.name==="VersionError"?n(new Ce(se.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):u.name==="InvalidStateError"?n(new Ce(se.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+u)):n(new Ml(e,u))},i.onupgradeneeded=a=>{oe(Kn,'Database "'+this.name+'" requires upgrade from version:',a.oldVersion);const u=a.target.result;this.O.B(u,i.transaction,a.oldVersion,this.version).next(()=>{oe(Kn,"Database upgrade to version "+this.version+" complete")})}})),this.L&&(this.db.onversionchange=t=>this.L(t)),this.db}k(e){this.L=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,n,i){const a=t==="readonly";let u=0;for(;;){++u;try{this.db=await this.N(e);const c=Lh.open(this.db,e,a?"readonly":"readwrite",n),d=i(c).next(p=>(c.S(),p)).catch(p=>(c.abort(p),G.reject(p))).toPromise();return d.catch(()=>{}),await c.p,d}catch(c){const d=c,p=d.name!=="FirebaseError"&&u<3;if(oe(Kn,"Transaction failed with error:",d.message,"Retrying:",p),this.close(),!p)return Promise.reject(d)}}}close(){this.db&&this.db.close(),this.db=void 0}}function Uw(r){const e=r.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class RC{constructor(e){this.q=e,this.$=!1,this.K=null}get isDone(){return this.$}get U(){return this.K}set cursor(e){this.q=e}done(){this.$=!0}W(e){this.K=e}delete(){return eo(this.q.delete())}}class Ml extends Ce{constructor(e,t){super(se.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function wi(r){return r.name==="IndexedDbTransactionError"}class PC{constructor(e){this.store=e}put(e,t){let n;return t!==void 0?(oe(Kn,"PUT",this.store.name,e,t),n=this.store.put(t,e)):(oe(Kn,"PUT",this.store.name,"<auto-key>",e),n=this.store.put(e)),eo(n)}add(e){return oe(Kn,"ADD",this.store.name,e,e),eo(this.store.add(e))}get(e){return eo(this.store.get(e)).next(t=>(t===void 0&&(t=null),oe(Kn,"GET",this.store.name,e,t),t))}delete(e){return oe(Kn,"DELETE",this.store.name,e),eo(this.store.delete(e))}count(){return oe(Kn,"COUNT",this.store.name),eo(this.store.count())}G(e,t){const n=this.options(e,t),i=n.index?this.store.index(n.index):this.store;if(typeof i.getAll=="function"){const a=i.getAll(n.range);return new G((u,c)=>{a.onerror=d=>{c(d.target.error)},a.onsuccess=d=>{u(d.target.result)}})}{const a=this.cursor(n),u=[];return this.j(a,(c,d)=>{u.push(d)}).next(()=>u)}}H(e,t){const n=this.store.getAll(e,t===null?void 0:t);return new G((i,a)=>{n.onerror=u=>{a(u.target.error)},n.onsuccess=u=>{i(u.target.result)}})}J(e,t){oe(Kn,"DELETE ALL",this.store.name);const n=this.options(e,t);n.Y=!1;const i=this.cursor(n);return this.j(i,(a,u,c)=>c.delete())}Z(e,t){let n;t?n=e:(n={},t=e);const i=this.cursor(n);return this.j(i,t)}X(e){const t=this.cursor({});return new G((n,i)=>{t.onerror=a=>{const u=Hp(a.target.error);i(u)},t.onsuccess=a=>{const u=a.target.result;u?e(u.primaryKey,u.value).next(c=>{c?u.continue():n()}):n()}})}j(e,t){const n=[];return new G((i,a)=>{e.onerror=u=>{a(u.target.error)},e.onsuccess=u=>{const c=u.target.result;if(!c)return void i();const d=new RC(c),p=t(c.primaryKey,c.value,d);if(p instanceof G){const g=p.catch(_=>(d.done(),G.reject(_)));n.push(g)}d.isDone?i():d.U===null?c.continue():c.continue(d.U)}}).next(()=>G.waitFor(n))}options(e,t){let n;return e!==void 0&&(typeof e=="string"?n=e:t=e),{index:n,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const n=this.store.index(e.index);return e.Y?n.openKeyCursor(e.range,t):n.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function eo(r){return new G((e,t)=>{r.onsuccess=n=>{const i=n.target.result;e(i)},r.onerror=n=>{const i=Hp(n.target.error);t(i)}})}let _v=!1;function Hp(r){const e=pi.C(ih());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(r.message.indexOf(t)>=0){const n=new Ce("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return _v||(_v=!0,setTimeout(()=>{throw n},0)),n}}return r}const Ol="IndexBackfiller";class kC{constructor(e,t){this.asyncQueue=e,this.ee=t,this.task=null}start(){this.te(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}te(e){oe(Ol,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{const t=await this.ee.ne();oe(Ol,`Documents written: ${t}`)}catch(t){wi(t)?oe(Ol,"Ignoring IndexedDB error during index backfill: ",t):await _i(t)}await this.te(6e4)})}}class bC{constructor(e,t){this.localStore=e,this.persistence=t}async ne(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",t=>this.re(t,e))}re(e,t){const n=new Set;let i=t,a=!0;return G.doWhile(()=>a===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(u=>{if(u!==null&&!n.has(u))return oe(Ol,`Processing collection: ${u}`),this.ie(e,u,i).next(c=>{i-=c,n.add(u)});a=!1})).next(()=>t-i)}ie(e,t,n){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(i=>this.localStore.localDocuments.getNextDocuments(e,t,i,n).next(a=>{const u=a.changes;return this.localStore.indexManager.updateIndexEntries(e,u).next(()=>this.se(i,a)).next(c=>(oe(Ol,`Updating offset: ${c}`),this.localStore.indexManager.updateCollectionGroup(e,t,c))).next(()=>u.size)}))}se(e,t){let n=e;return t.changes.forEach((i,a)=>{const u=jw(a);Kp(u,n)>0&&(n=u)}),new Xn(n.readTime,n.documentKey,Math.max(t.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vn{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=n=>this.oe(n),this._e=n=>t.writeSequenceNumber(n))}oe(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this._e&&this._e(e),e}}Vn.ae=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const io=-1;function jh(r){return r==null}function Gl(r){return r===0&&1/r==-1/0}function DC(r){return typeof r=="number"&&Number.isInteger(r)&&!Gl(r)&&r<=Number.MAX_SAFE_INTEGER&&r>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uh="";function dn(r){let e="";for(let t=0;t<r.length;t++)e.length>0&&(e=wv(e)),e=VC(r.get(t),e);return wv(e)}function VC(r,e){let t=e;const n=r.length;for(let i=0;i<n;i++){const a=r.charAt(i);switch(a){case"\0":t+="";break;case uh:t+="";break;default:t+=a}}return t}function wv(r){return r+uh+""}function Jr(r){const e=r.length;if(ke(e>=2),e===2)return ke(r.charAt(0)===uh&&r.charAt(1)===""),at.emptyPath();const t=e-2,n=[];let i="";for(let a=0;a<e;){const u=r.indexOf(uh,a);switch((u<0||u>t)&&Ae(),r.charAt(u+1)){case"":const c=r.substring(a,u);let d;i.length===0?d=c:(i+=c,d=i,i=""),n.push(d);break;case"":i+=r.substring(a,u),i+="\0";break;case"":i+=r.substring(a,u+1);break;default:Ae()}a=u+2}return new at(n)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ji="remoteDocuments",au="owner",oa="owner",Kl="mutationQueues",MC="userId",Dr="mutations",Ev="batchId",so="userMutationsIndex",Tv=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xc(r,e){return[r,dn(e)]}function $w(r,e,t){return[r,dn(e),t]}const OC={},Ta="documentMutations",ch="remoteDocumentsV14",FC=["prefixPath","collectionGroup","readTime","documentId"],Yc="documentKeyIndex",LC=["prefixPath","collectionGroup","documentId"],Ww="collectionGroupIndex",jC=["collectionGroup","readTime","prefixPath","documentId"],Hl="remoteDocumentGlobal",dp="remoteDocumentGlobalKey",Ia="targets",qw="queryTargetsIndex",BC=["canonicalId","targetId"],Sa="targetDocuments",zC=["targetId","path"],Qp="documentTargetsIndex",UC=["path","targetId"],hh="targetGlobalKey",oo="targetGlobal",Ql="collectionParents",$C=["collectionId","parent"],Ca="clientMetadata",WC="clientId",Bh="bundles",qC="bundleId",zh="namedQueries",GC="name",Xp="indexConfiguration",KC="indexId",fp="collectionGroupIndex",HC="collectionGroup",dh="indexState",QC=["indexId","uid"],Gw="sequenceNumberIndex",XC=["uid","sequenceNumber"],fh="indexEntries",YC=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],Kw="documentKeyIndex",ZC=["indexId","uid","orderedDocumentKey"],Uh="documentOverlays",JC=["userId","collectionPath","documentId"],pp="collectionPathOverlayIndex",eA=["userId","collectionPath","largestBatchId"],Hw="collectionGroupOverlayIndex",tA=["userId","collectionGroup","largestBatchId"],Yp="globals",nA="name",Qw=[Kl,Dr,Ta,Ji,Ia,au,oo,Sa,Ca,Hl,Ql,Bh,zh],rA=[...Qw,Uh],Xw=[Kl,Dr,Ta,ch,Ia,au,oo,Sa,Ca,Hl,Ql,Bh,zh,Uh],Yw=Xw,Zp=[...Yw,Xp,dh,fh],sA=Zp,iA=[...Zp,Yp];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mp extends zw{constructor(e,t){super(),this.ue=e,this.currentSequenceNumber=t}}function Ut(r,e){const t=Re(r);return pi.M(t.ue,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Iv(r){let e=0;for(const t in r)Object.prototype.hasOwnProperty.call(r,t)&&e++;return e}function lu(r,e){for(const t in r)Object.prototype.hasOwnProperty.call(r,t)&&e(t,r[t])}function oA(r){for(const e in r)if(Object.prototype.hasOwnProperty.call(r,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mt{constructor(e,t){this.comparator=e,this.root=t||tn.EMPTY}insert(e,t){return new mt(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,tn.BLACK,null,null))}remove(e){return new mt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,tn.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(n===0)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(i===0)return t+n.left.size;i<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,n)=>(e(t,n),!1))}toString(){const e=[];return this.inorderTraversal((t,n)=>(e.push(`${t}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Bc(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Bc(this.root,e,this.comparator,!1)}getReverseIterator(){return new Bc(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Bc(this.root,e,this.comparator,!0)}}class Bc{constructor(e,t,n,i){this.isReverse=i,this.nodeStack=[];let a=1;for(;!e.isEmpty();)if(a=t?n(e.key,t):1,t&&i&&(a*=-1),a<0)e=this.isReverse?e.left:e.right;else{if(a===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class tn{constructor(e,t,n,i,a){this.key=e,this.value=t,this.color=n??tn.RED,this.left=i??tn.EMPTY,this.right=a??tn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,i,a){return new tn(e??this.key,t??this.value,n??this.color,i??this.left,a??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let i=this;const a=n(e,i.key);return i=a<0?i.copy(null,null,null,i.left.insert(e,t,n),null):a===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return tn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return tn.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,tn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,tn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw Ae();const e=this.left.check();if(e!==this.right.check())throw Ae();return e+(this.isRed()?0:1)}}tn.EMPTY=null,tn.RED=!0,tn.BLACK=!1;tn.EMPTY=new class{constructor(){this.size=0}get key(){throw Ae()}get value(){throw Ae()}get color(){throw Ae()}get left(){throw Ae()}get right(){throw Ae()}copy(e,t,n,i,a){return this}insert(e,t,n){return new tn(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rt{constructor(e){this.comparator=e,this.data=new mt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,n)=>(e(t),!1))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let n;for(n=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Sv(this.data.getIterator())}getIteratorFrom(e){return new Sv(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(n=>{t=t.add(n)}),t}isEqual(e){if(!(e instanceof rt)||this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const i=t.getNext().key,a=n.getNext().key;if(this.comparator(i,a)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new rt(this.comparator);return t.data=e,t}}class Sv{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function aa(r){return r.hasNext()?r.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Es{constructor(e){this.fields=e,e.sort(Dt.comparator)}static empty(){return new Es([])}unionWith(e){let t=new rt(Dt.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new Es(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return wa(this.fields,e.fields,(t,n)=>t.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zw extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vt{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(i){try{return atob(i)}catch(a){throw typeof DOMException<"u"&&a instanceof DOMException?new Zw("Invalid base64 string: "+a):a}}(e);return new Vt(t)}static fromUint8Array(e){const t=function(i){let a="";for(let u=0;u<i.length;++u)a+=String.fromCharCode(i[u]);return a}(e);return new Vt(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const n=new Uint8Array(t.length);for(let i=0;i<t.length;i++)n[i]=t.charCodeAt(i);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ze(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Vt.EMPTY_BYTE_STRING=new Vt("");const aA=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function As(r){if(ke(!!r),typeof r=="string"){let e=0;const t=aA.exec(r);if(ke(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}const n=new Date(r);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:vt(r.seconds),nanos:vt(r.nanos)}}function vt(r){return typeof r=="number"?r:typeof r=="string"?Number(r):0}function xs(r){return typeof r=="string"?Vt.fromBase64String(r):Vt.fromUint8Array(r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jw="server_timestamp",e0="__type__",t0="__previous_value__",n0="__local_write_time__";function Jp(r){var e,t;return((t=(((e=r==null?void 0:r.mapValue)===null||e===void 0?void 0:e.fields)||{})[e0])===null||t===void 0?void 0:t.stringValue)===Jw}function $h(r){const e=r.mapValue.fields[t0];return Jp(e)?$h(e):e}function Xl(r){const e=As(r.mapValue.fields[n0].timestampValue);return new Qt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lA{constructor(e,t,n,i,a,u,c,d,p){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=i,this.ssl=a,this.forceLongPolling=u,this.autoDetectLongPolling=c,this.longPollingOptions=d,this.useFetchStreams=p}}const ph="(default)";class co{constructor(e,t){this.projectId=e,this.database=t||ph}static empty(){return new co("","")}get isDefaultDatabase(){return this.database===ph}isEqual(e){return e instanceof co&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const r0="__type__",s0="__max__",li={mapValue:{fields:{__type__:{stringValue:s0}}}},i0="__vector__",Yl="value",Zc={nullValue:"NULL_VALUE"};function mi(r){return"nullValue"in r?0:"booleanValue"in r?1:"integerValue"in r||"doubleValue"in r?2:"timestampValue"in r?3:"stringValue"in r?5:"bytesValue"in r?6:"referenceValue"in r?7:"geoPointValue"in r?8:"arrayValue"in r?9:"mapValue"in r?Jp(r)?4:o0(r)?9007199254740991:Wh(r)?10:11:Ae()}function ts(r,e){if(r===e)return!0;const t=mi(r);if(t!==mi(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return r.booleanValue===e.booleanValue;case 4:return Xl(r).isEqual(Xl(e));case 3:return function(i,a){if(typeof i.timestampValue=="string"&&typeof a.timestampValue=="string"&&i.timestampValue.length===a.timestampValue.length)return i.timestampValue===a.timestampValue;const u=As(i.timestampValue),c=As(a.timestampValue);return u.seconds===c.seconds&&u.nanos===c.nanos}(r,e);case 5:return r.stringValue===e.stringValue;case 6:return function(i,a){return xs(i.bytesValue).isEqual(xs(a.bytesValue))}(r,e);case 7:return r.referenceValue===e.referenceValue;case 8:return function(i,a){return vt(i.geoPointValue.latitude)===vt(a.geoPointValue.latitude)&&vt(i.geoPointValue.longitude)===vt(a.geoPointValue.longitude)}(r,e);case 2:return function(i,a){if("integerValue"in i&&"integerValue"in a)return vt(i.integerValue)===vt(a.integerValue);if("doubleValue"in i&&"doubleValue"in a){const u=vt(i.doubleValue),c=vt(a.doubleValue);return u===c?Gl(u)===Gl(c):isNaN(u)&&isNaN(c)}return!1}(r,e);case 9:return wa(r.arrayValue.values||[],e.arrayValue.values||[],ts);case 10:case 11:return function(i,a){const u=i.mapValue.fields||{},c=a.mapValue.fields||{};if(Iv(u)!==Iv(c))return!1;for(const d in u)if(u.hasOwnProperty(d)&&(c[d]===void 0||!ts(u[d],c[d])))return!1;return!0}(r,e);default:return Ae()}}function Zl(r,e){return(r.values||[]).find(t=>ts(t,e))!==void 0}function gi(r,e){if(r===e)return 0;const t=mi(r),n=mi(e);if(t!==n)return ze(t,n);switch(t){case 0:case 9007199254740991:return 0;case 1:return ze(r.booleanValue,e.booleanValue);case 2:return function(a,u){const c=vt(a.integerValue||a.doubleValue),d=vt(u.integerValue||u.doubleValue);return c<d?-1:c>d?1:c===d?0:isNaN(c)?isNaN(d)?0:-1:1}(r,e);case 3:return Cv(r.timestampValue,e.timestampValue);case 4:return Cv(Xl(r),Xl(e));case 5:return ze(r.stringValue,e.stringValue);case 6:return function(a,u){const c=xs(a),d=xs(u);return c.compareTo(d)}(r.bytesValue,e.bytesValue);case 7:return function(a,u){const c=a.split("/"),d=u.split("/");for(let p=0;p<c.length&&p<d.length;p++){const g=ze(c[p],d[p]);if(g!==0)return g}return ze(c.length,d.length)}(r.referenceValue,e.referenceValue);case 8:return function(a,u){const c=ze(vt(a.latitude),vt(u.latitude));return c!==0?c:ze(vt(a.longitude),vt(u.longitude))}(r.geoPointValue,e.geoPointValue);case 9:return Av(r.arrayValue,e.arrayValue);case 10:return function(a,u){var c,d,p,g;const _=a.fields||{},E=u.fields||{},C=(c=_[Yl])===null||c===void 0?void 0:c.arrayValue,A=(d=E[Yl])===null||d===void 0?void 0:d.arrayValue,P=ze(((p=C==null?void 0:C.values)===null||p===void 0?void 0:p.length)||0,((g=A==null?void 0:A.values)===null||g===void 0?void 0:g.length)||0);return P!==0?P:Av(C,A)}(r.mapValue,e.mapValue);case 11:return function(a,u){if(a===li.mapValue&&u===li.mapValue)return 0;if(a===li.mapValue)return 1;if(u===li.mapValue)return-1;const c=a.fields||{},d=Object.keys(c),p=u.fields||{},g=Object.keys(p);d.sort(),g.sort();for(let _=0;_<d.length&&_<g.length;++_){const E=ze(d[_],g[_]);if(E!==0)return E;const C=gi(c[d[_]],p[g[_]]);if(C!==0)return C}return ze(d.length,g.length)}(r.mapValue,e.mapValue);default:throw Ae()}}function Cv(r,e){if(typeof r=="string"&&typeof e=="string"&&r.length===e.length)return ze(r,e);const t=As(r),n=As(e),i=ze(t.seconds,n.seconds);return i!==0?i:ze(t.nanos,n.nanos)}function Av(r,e){const t=r.values||[],n=e.values||[];for(let i=0;i<t.length&&i<n.length;++i){const a=gi(t[i],n[i]);if(a)return a}return ze(t.length,n.length)}function Aa(r){return gp(r)}function gp(r){return"nullValue"in r?"null":"booleanValue"in r?""+r.booleanValue:"integerValue"in r?""+r.integerValue:"doubleValue"in r?""+r.doubleValue:"timestampValue"in r?function(t){const n=As(t);return`time(${n.seconds},${n.nanos})`}(r.timestampValue):"stringValue"in r?r.stringValue:"bytesValue"in r?function(t){return xs(t).toBase64()}(r.bytesValue):"referenceValue"in r?function(t){return ye.fromName(t).toString()}(r.referenceValue):"geoPointValue"in r?function(t){return`geo(${t.latitude},${t.longitude})`}(r.geoPointValue):"arrayValue"in r?function(t){let n="[",i=!0;for(const a of t.values||[])i?i=!1:n+=",",n+=gp(a);return n+"]"}(r.arrayValue):"mapValue"in r?function(t){const n=Object.keys(t.fields||{}).sort();let i="{",a=!0;for(const u of n)a?a=!1:i+=",",i+=`${u}:${gp(t.fields[u])}`;return i+"}"}(r.mapValue):Ae()}function Jc(r){switch(mi(r)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=$h(r);return e?16+Jc(e):16;case 5:return 2*r.stringValue.length;case 6:return xs(r.bytesValue).approximateByteSize();case 7:return r.referenceValue.length;case 9:return function(n){return(n.values||[]).reduce((i,a)=>i+Jc(a),0)}(r.arrayValue);case 10:case 11:return function(n){let i=0;return lu(n.fields,(a,u)=>{i+=a.length+Jc(u)}),i}(r.mapValue);default:throw Ae()}}function em(r,e){return{referenceValue:`projects/${r.projectId}/databases/${r.database}/documents/${e.path.canonicalString()}`}}function yp(r){return!!r&&"integerValue"in r}function Jl(r){return!!r&&"arrayValue"in r}function xv(r){return!!r&&"nullValue"in r}function Nv(r){return!!r&&"doubleValue"in r&&isNaN(Number(r.doubleValue))}function qf(r){return!!r&&"mapValue"in r}function Wh(r){var e,t;return((t=(((e=r==null?void 0:r.mapValue)===null||e===void 0?void 0:e.fields)||{})[r0])===null||t===void 0?void 0:t.stringValue)===i0}function Fl(r){if(r.geoPointValue)return{geoPointValue:Object.assign({},r.geoPointValue)};if(r.timestampValue&&typeof r.timestampValue=="object")return{timestampValue:Object.assign({},r.timestampValue)};if(r.mapValue){const e={mapValue:{fields:{}}};return lu(r.mapValue.fields,(t,n)=>e.mapValue.fields[t]=Fl(n)),e}if(r.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(r.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Fl(r.arrayValue.values[t]);return e}return Object.assign({},r)}function o0(r){return(((r.mapValue||{}).fields||{}).__type__||{}).stringValue===s0}const a0={mapValue:{fields:{[r0]:{stringValue:i0},[Yl]:{arrayValue:{}}}}};function uA(r){return"nullValue"in r?Zc:"booleanValue"in r?{booleanValue:!1}:"integerValue"in r||"doubleValue"in r?{doubleValue:NaN}:"timestampValue"in r?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in r?{stringValue:""}:"bytesValue"in r?{bytesValue:""}:"referenceValue"in r?em(co.empty(),ye.empty()):"geoPointValue"in r?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in r?{arrayValue:{}}:"mapValue"in r?Wh(r)?a0:{mapValue:{}}:Ae()}function cA(r){return"nullValue"in r?{booleanValue:!1}:"booleanValue"in r?{doubleValue:NaN}:"integerValue"in r||"doubleValue"in r?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in r?{stringValue:""}:"stringValue"in r?{bytesValue:""}:"bytesValue"in r?em(co.empty(),ye.empty()):"referenceValue"in r?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in r?{arrayValue:{}}:"arrayValue"in r?a0:"mapValue"in r?Wh(r)?{mapValue:{}}:li:Ae()}function Rv(r,e){const t=gi(r.value,e.value);return t!==0?t:r.inclusive&&!e.inclusive?-1:!r.inclusive&&e.inclusive?1:0}function Pv(r,e){const t=gi(r.value,e.value);return t!==0?t:r.inclusive&&!e.inclusive?1:!r.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cr{constructor(e){this.value=e}static empty(){return new cr({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!qf(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Fl(t)}setAll(e){let t=Dt.emptyPath(),n={},i=[];e.forEach((u,c)=>{if(!t.isImmediateParentOf(c)){const d=this.getFieldsMap(t);this.applyChanges(d,n,i),n={},i=[],t=c.popLast()}u?n[c.lastSegment()]=Fl(u):i.push(c.lastSegment())});const a=this.getFieldsMap(t);this.applyChanges(a,n,i)}delete(e){const t=this.field(e.popLast());qf(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return ts(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let i=t.mapValue.fields[e.get(n)];qf(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,n){lu(t,(i,a)=>e[i]=a);for(const i of n)delete e[i]}clone(){return new cr(Fl(this.value))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xt{constructor(e,t,n,i,a,u,c){this.key=e,this.documentType=t,this.version=n,this.readTime=i,this.createTime=a,this.data=u,this.documentState=c}static newInvalidDocument(e){return new xt(e,0,De.min(),De.min(),De.min(),cr.empty(),0)}static newFoundDocument(e,t,n,i){return new xt(e,1,t,De.min(),n,i,0)}static newNoDocument(e,t){return new xt(e,2,t,De.min(),De.min(),cr.empty(),0)}static newUnknownDocument(e,t){return new xt(e,3,t,De.min(),De.min(),cr.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(De.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=cr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=cr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=De.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof xt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new xt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xa{constructor(e,t){this.position=e,this.inclusive=t}}function kv(r,e,t){let n=0;for(let i=0;i<r.position.length;i++){const a=e[i],u=r.position[i];if(a.field.isKeyField()?n=ye.comparator(ye.fromName(u.referenceValue),t.key):n=gi(u,t.data.field(a.field)),a.dir==="desc"&&(n*=-1),n!==0)break}return n}function bv(r,e){if(r===null)return e===null;if(e===null||r.inclusive!==e.inclusive||r.position.length!==e.position.length)return!1;for(let t=0;t<r.position.length;t++)if(!ts(r.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mh{constructor(e,t="asc"){this.field=e,this.dir=t}}function hA(r,e){return r.dir===e.dir&&r.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l0{}class He extends l0{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,n):new dA(e,t,n):t==="array-contains"?new mA(e,n):t==="in"?new p0(e,n):t==="not-in"?new gA(e,n):t==="array-contains-any"?new yA(e,n):new He(e,t,n)}static createKeyFieldInFilter(e,t,n){return t==="in"?new fA(e,n):new pA(e,n)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(gi(t,this.value)):t!==null&&mi(this.value)===mi(t)&&this.matchesComparison(gi(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Ae()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class it extends l0{constructor(e,t){super(),this.filters=e,this.op=t,this.ce=null}static create(e,t){return new it(e,t)}matches(e){return Na(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ce!==null||(this.ce=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ce}getFilters(){return Object.assign([],this.filters)}}function Na(r){return r.op==="and"}function vp(r){return r.op==="or"}function tm(r){return u0(r)&&Na(r)}function u0(r){for(const e of r.filters)if(e instanceof it)return!1;return!0}function _p(r){if(r instanceof He)return r.field.canonicalString()+r.op.toString()+Aa(r.value);if(tm(r))return r.filters.map(e=>_p(e)).join(",");{const e=r.filters.map(t=>_p(t)).join(",");return`${r.op}(${e})`}}function c0(r,e){return r instanceof He?function(n,i){return i instanceof He&&n.op===i.op&&n.field.isEqual(i.field)&&ts(n.value,i.value)}(r,e):r instanceof it?function(n,i){return i instanceof it&&n.op===i.op&&n.filters.length===i.filters.length?n.filters.reduce((a,u,c)=>a&&c0(u,i.filters[c]),!0):!1}(r,e):void Ae()}function h0(r,e){const t=r.filters.concat(e);return it.create(t,r.op)}function d0(r){return r instanceof He?function(t){return`${t.field.canonicalString()} ${t.op} ${Aa(t.value)}`}(r):r instanceof it?function(t){return t.op.toString()+" {"+t.getFilters().map(d0).join(" ,")+"}"}(r):"Filter"}class dA extends He{constructor(e,t,n){super(e,t,n),this.key=ye.fromName(n.referenceValue)}matches(e){const t=ye.comparator(e.key,this.key);return this.matchesComparison(t)}}class fA extends He{constructor(e,t){super(e,"in",t),this.keys=f0("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class pA extends He{constructor(e,t){super(e,"not-in",t),this.keys=f0("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function f0(r,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(n=>ye.fromName(n.referenceValue))}class mA extends He{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Jl(t)&&Zl(t.arrayValue,this.value)}}class p0 extends He{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Zl(this.value.arrayValue,t)}}class gA extends He{constructor(e,t){super(e,"not-in",t)}matches(e){if(Zl(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&!Zl(this.value.arrayValue,t)}}class yA extends He{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Jl(t)||!t.arrayValue.values)&&t.arrayValue.values.some(n=>Zl(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vA{constructor(e,t=null,n=[],i=[],a=null,u=null,c=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=i,this.limit=a,this.startAt=u,this.endAt=c,this.le=null}}function wp(r,e=null,t=[],n=[],i=null,a=null,u=null){return new vA(r,e,t,n,i,a,u)}function ho(r){const e=Re(r);if(e.le===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(n=>_p(n)).join(","),t+="|ob:",t+=e.orderBy.map(n=>function(a){return a.field.canonicalString()+a.dir}(n)).join(","),jh(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(n=>Aa(n)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(n=>Aa(n)).join(",")),e.le=t}return e.le}function uu(r,e){if(r.limit!==e.limit||r.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<r.orderBy.length;t++)if(!hA(r.orderBy[t],e.orderBy[t]))return!1;if(r.filters.length!==e.filters.length)return!1;for(let t=0;t<r.filters.length;t++)if(!c0(r.filters[t],e.filters[t]))return!1;return r.collectionGroup===e.collectionGroup&&!!r.path.isEqual(e.path)&&!!bv(r.startAt,e.startAt)&&bv(r.endAt,e.endAt)}function gh(r){return ye.isDocumentKey(r.path)&&r.collectionGroup===null&&r.filters.length===0}function yh(r,e){return r.filters.filter(t=>t instanceof He&&t.field.isEqual(e))}function Dv(r,e,t){let n=Zc,i=!0;for(const a of yh(r,e)){let u=Zc,c=!0;switch(a.op){case"<":case"<=":u=uA(a.value);break;case"==":case"in":case">=":u=a.value;break;case">":u=a.value,c=!1;break;case"!=":case"not-in":u=Zc}Rv({value:n,inclusive:i},{value:u,inclusive:c})<0&&(n=u,i=c)}if(t!==null){for(let a=0;a<r.orderBy.length;++a)if(r.orderBy[a].field.isEqual(e)){const u=t.position[a];Rv({value:n,inclusive:i},{value:u,inclusive:t.inclusive})<0&&(n=u,i=t.inclusive);break}}return{value:n,inclusive:i}}function Vv(r,e,t){let n=li,i=!0;for(const a of yh(r,e)){let u=li,c=!0;switch(a.op){case">=":case">":u=cA(a.value),c=!1;break;case"==":case"in":case"<=":u=a.value;break;case"<":u=a.value,c=!1;break;case"!=":case"not-in":u=li}Pv({value:n,inclusive:i},{value:u,inclusive:c})>0&&(n=u,i=c)}if(t!==null){for(let a=0;a<r.orderBy.length;++a)if(r.orderBy[a].field.isEqual(e)){const u=t.position[a];Pv({value:n,inclusive:i},{value:u,inclusive:t.inclusive})>0&&(n=u,i=t.inclusive);break}}return{value:n,inclusive:i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qh{constructor(e,t=null,n=[],i=[],a=null,u="F",c=null,d=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=i,this.limit=a,this.limitType=u,this.startAt=c,this.endAt=d,this.he=null,this.Pe=null,this.Te=null,this.startAt,this.endAt}}function m0(r,e,t,n,i,a,u,c){return new qh(r,e,t,n,i,a,u,c)}function Gh(r){return new qh(r)}function Mv(r){return r.filters.length===0&&r.limit===null&&r.startAt==null&&r.endAt==null&&(r.explicitOrderBy.length===0||r.explicitOrderBy.length===1&&r.explicitOrderBy[0].field.isKeyField())}function _A(r){return r.collectionGroup!==null}function Ll(r){const e=Re(r);if(e.he===null){e.he=[];const t=new Set;for(const a of e.explicitOrderBy)e.he.push(a),t.add(a.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(u){let c=new rt(Dt.comparator);return u.filters.forEach(d=>{d.getFlattenedFilters().forEach(p=>{p.isInequality()&&(c=c.add(p.field))})}),c})(e).forEach(a=>{t.has(a.canonicalString())||a.isKeyField()||e.he.push(new mh(a,n))}),t.has(Dt.keyField().canonicalString())||e.he.push(new mh(Dt.keyField(),n))}return e.he}function Qn(r){const e=Re(r);return e.Pe||(e.Pe=wA(e,Ll(r))),e.Pe}function wA(r,e){if(r.limitType==="F")return wp(r.path,r.collectionGroup,e,r.filters,r.limit,r.startAt,r.endAt);{e=e.map(i=>{const a=i.dir==="desc"?"asc":"desc";return new mh(i.field,a)});const t=r.endAt?new xa(r.endAt.position,r.endAt.inclusive):null,n=r.startAt?new xa(r.startAt.position,r.startAt.inclusive):null;return wp(r.path,r.collectionGroup,e,r.filters,r.limit,t,n)}}function Ep(r,e,t){return new qh(r.path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),e,t,r.startAt,r.endAt)}function Kh(r,e){return uu(Qn(r),Qn(e))&&r.limitType===e.limitType}function g0(r){return`${ho(Qn(r))}|lt:${r.limitType}`}function fa(r){return`Query(target=${function(t){let n=t.path.canonicalString();return t.collectionGroup!==null&&(n+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(n+=`, filters: [${t.filters.map(i=>d0(i)).join(", ")}]`),jh(t.limit)||(n+=", limit: "+t.limit),t.orderBy.length>0&&(n+=`, orderBy: [${t.orderBy.map(i=>function(u){return`${u.field.canonicalString()} (${u.dir})`}(i)).join(", ")}]`),t.startAt&&(n+=", startAt: ",n+=t.startAt.inclusive?"b:":"a:",n+=t.startAt.position.map(i=>Aa(i)).join(",")),t.endAt&&(n+=", endAt: ",n+=t.endAt.inclusive?"a:":"b:",n+=t.endAt.position.map(i=>Aa(i)).join(",")),`Target(${n})`}(Qn(r))}; limitType=${r.limitType})`}function cu(r,e){return e.isFoundDocument()&&function(n,i){const a=i.key.path;return n.collectionGroup!==null?i.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(a):ye.isDocumentKey(n.path)?n.path.isEqual(a):n.path.isImmediateParentOf(a)}(r,e)&&function(n,i){for(const a of Ll(n))if(!a.field.isKeyField()&&i.data.field(a.field)===null)return!1;return!0}(r,e)&&function(n,i){for(const a of n.filters)if(!a.matches(i))return!1;return!0}(r,e)&&function(n,i){return!(n.startAt&&!function(u,c,d){const p=kv(u,c,d);return u.inclusive?p<=0:p<0}(n.startAt,Ll(n),i)||n.endAt&&!function(u,c,d){const p=kv(u,c,d);return u.inclusive?p>=0:p>0}(n.endAt,Ll(n),i))}(r,e)}function y0(r){return r.collectionGroup||(r.path.length%2==1?r.path.lastSegment():r.path.get(r.path.length-2))}function v0(r){return(e,t)=>{let n=!1;for(const i of Ll(r)){const a=EA(i,e,t);if(a!==0)return a;n=n||i.field.isKeyField()}return 0}}function EA(r,e,t){const n=r.field.isKeyField()?ye.comparator(e.key,t.key):function(a,u,c){const d=u.data.field(a),p=c.data.field(a);return d!==null&&p!==null?gi(d,p):Ae()}(r.field,e,t);switch(r.dir){case"asc":return n;case"desc":return-1*n;default:return Ae()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ns{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(n!==void 0){for(const[i,a]of n)if(this.equalsFn(i,e))return a}}has(e){return this.get(e)!==void 0}set(e,t){const n=this.mapKeyFn(e),i=this.inner[n];if(i===void 0)return this.inner[n]=[[e,t]],void this.innerSize++;for(let a=0;a<i.length;a++)if(this.equalsFn(i[a][0],e))return void(i[a]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(n===void 0)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],e))return n.length===1?delete this.inner[t]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(e){lu(this.inner,(t,n)=>{for(const[i,a]of n)e(i,a)})}isEmpty(){return oA(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TA=new mt(ye.comparator);function hr(){return TA}const _0=new mt(ye.comparator);function bl(...r){let e=_0;for(const t of r)e=e.insert(t.key,t);return e}function IA(r){let e=_0;return r.forEach((t,n)=>e=e.insert(t,n.overlayedDocument)),e}function es(){return jl()}function w0(){return jl()}function jl(){return new Ns(r=>r.toString(),(r,e)=>r.isEqual(e))}const SA=new mt(ye.comparator),CA=new rt(ye.comparator);function qe(...r){let e=CA;for(const t of r)e=e.add(t);return e}const AA=new rt(ze);function nm(){return AA}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xA(r,e){if(r.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Gl(e)?"-0":e}}function NA(r){return{integerValue:""+r}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hh{constructor(){this._=void 0}}function RA(r,e,t){return r instanceof eu?function(i,a){const u={fields:{[e0]:{stringValue:Jw},[n0]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return a&&Jp(a)&&(a=$h(a)),a&&(u.fields[t0]=a),{mapValue:u}}(t,e):r instanceof Ra?E0(r,e):r instanceof Pa?T0(r,e):function(i,a){const u=kA(i,a),c=Ov(u)+Ov(i.Ie);return yp(u)&&yp(i.Ie)?NA(c):xA(i.serializer,c)}(r,e)}function PA(r,e,t){return r instanceof Ra?E0(r,e):r instanceof Pa?T0(r,e):t}function kA(r,e){return r instanceof tu?function(n){return yp(n)||function(a){return!!a&&"doubleValue"in a}(n)}(e)?e:{integerValue:0}:null}class eu extends Hh{}class Ra extends Hh{constructor(e){super(),this.elements=e}}function E0(r,e){const t=I0(e);for(const n of r.elements)t.some(i=>ts(i,n))||t.push(n);return{arrayValue:{values:t}}}class Pa extends Hh{constructor(e){super(),this.elements=e}}function T0(r,e){let t=I0(e);for(const n of r.elements)t=t.filter(i=>!ts(i,n));return{arrayValue:{values:t}}}class tu extends Hh{constructor(e,t){super(),this.serializer=e,this.Ie=t}}function Ov(r){return vt(r.integerValue||r.doubleValue)}function I0(r){return Jl(r)&&r.arrayValue.values?r.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bA{constructor(e,t){this.field=e,this.transform=t}}function DA(r,e){return r.field.isEqual(e.field)&&function(n,i){return n instanceof Ra&&i instanceof Ra||n instanceof Pa&&i instanceof Pa?wa(n.elements,i.elements,ts):n instanceof tu&&i instanceof tu?ts(n.Ie,i.Ie):n instanceof eu&&i instanceof eu}(r.transform,e.transform)}class VA{constructor(e,t){this.version=e,this.transformResults=t}}class Vr{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Vr}static exists(e){return new Vr(void 0,e)}static updateTime(e){return new Vr(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function eh(r,e){return r.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(r.updateTime):r.exists===void 0||r.exists===e.isFoundDocument()}class Qh{}function S0(r,e){if(!r.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return r.isNoDocument()?new rm(r.key,Vr.none()):new hu(r.key,r.data,Vr.none());{const t=r.data,n=cr.empty();let i=new rt(Dt.comparator);for(let a of e.fields)if(!i.has(a)){let u=t.field(a);u===null&&a.length>1&&(a=a.popLast(),u=t.field(a)),u===null?n.delete(a):n.set(a,u),i=i.add(a)}return new La(r.key,n,new Es(i.toArray()),Vr.none())}}function MA(r,e,t){r instanceof hu?function(i,a,u){const c=i.value.clone(),d=Lv(i.fieldTransforms,a,u.transformResults);c.setAll(d),a.convertToFoundDocument(u.version,c).setHasCommittedMutations()}(r,e,t):r instanceof La?function(i,a,u){if(!eh(i.precondition,a))return void a.convertToUnknownDocument(u.version);const c=Lv(i.fieldTransforms,a,u.transformResults),d=a.data;d.setAll(C0(i)),d.setAll(c),a.convertToFoundDocument(u.version,d).setHasCommittedMutations()}(r,e,t):function(i,a,u){a.convertToNoDocument(u.version).setHasCommittedMutations()}(0,e,t)}function Bl(r,e,t,n){return r instanceof hu?function(a,u,c,d){if(!eh(a.precondition,u))return c;const p=a.value.clone(),g=jv(a.fieldTransforms,d,u);return p.setAll(g),u.convertToFoundDocument(u.version,p).setHasLocalMutations(),null}(r,e,t,n):r instanceof La?function(a,u,c,d){if(!eh(a.precondition,u))return c;const p=jv(a.fieldTransforms,d,u),g=u.data;return g.setAll(C0(a)),g.setAll(p),u.convertToFoundDocument(u.version,g).setHasLocalMutations(),c===null?null:c.unionWith(a.fieldMask.fields).unionWith(a.fieldTransforms.map(_=>_.field))}(r,e,t,n):function(a,u,c){return eh(a.precondition,u)?(u.convertToNoDocument(u.version).setHasLocalMutations(),null):c}(r,e,t)}function Fv(r,e){return r.type===e.type&&!!r.key.isEqual(e.key)&&!!r.precondition.isEqual(e.precondition)&&!!function(n,i){return n===void 0&&i===void 0||!(!n||!i)&&wa(n,i,(a,u)=>DA(a,u))}(r.fieldTransforms,e.fieldTransforms)&&(r.type===0?r.value.isEqual(e.value):r.type!==1||r.data.isEqual(e.data)&&r.fieldMask.isEqual(e.fieldMask))}class hu extends Qh{constructor(e,t,n,i=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class La extends Qh{constructor(e,t,n,i,a=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=i,this.fieldTransforms=a,this.type=1}getFieldMask(){return this.fieldMask}}function C0(r){const e=new Map;return r.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const n=r.data.field(t);e.set(t,n)}}),e}function Lv(r,e,t){const n=new Map;ke(r.length===t.length);for(let i=0;i<t.length;i++){const a=r[i],u=a.transform,c=e.data.field(a.field);n.set(a.field,PA(u,c,t[i]))}return n}function jv(r,e,t){const n=new Map;for(const i of r){const a=i.transform,u=t.data.field(i.field);n.set(i.field,RA(a,u,e))}return n}class rm extends Qh{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class A0 extends Qh{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sm{constructor(e,t,n,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const a=this.mutations[i];a.key.isEqual(e.key)&&MA(a,e,n[i])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=Bl(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=Bl(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=w0();return this.mutations.forEach(i=>{const a=e.get(i.key),u=a.overlayedDocument;let c=this.applyToLocalView(u,a.mutatedFields);c=t.has(i.key)?null:c;const d=S0(u,c);d!==null&&n.set(i.key,d),u.isValidDocument()||u.convertToNoDocument(De.min())}),n}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),qe())}isEqual(e){return this.batchId===e.batchId&&wa(this.mutations,e.mutations,(t,n)=>Fv(t,n))&&wa(this.baseMutations,e.baseMutations,(t,n)=>Fv(t,n))}}class im{constructor(e,t,n,i){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=i}static from(e,t,n){ke(e.mutations.length===n.length);let i=function(){return SA}();const a=e.mutations;for(let u=0;u<a.length;u++)i=i.insert(a[u].key,n[u].version);return new im(e,t,n,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class om{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OA{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Lt,Xe;function FA(r){switch(r){case se.OK:return Ae();case se.CANCELLED:case se.UNKNOWN:case se.DEADLINE_EXCEEDED:case se.RESOURCE_EXHAUSTED:case se.INTERNAL:case se.UNAVAILABLE:case se.UNAUTHENTICATED:return!1;case se.INVALID_ARGUMENT:case se.NOT_FOUND:case se.ALREADY_EXISTS:case se.PERMISSION_DENIED:case se.FAILED_PRECONDITION:case se.ABORTED:case se.OUT_OF_RANGE:case se.UNIMPLEMENTED:case se.DATA_LOSS:return!0;default:return Ae()}}function x0(r){if(r===void 0)return bt("GRPC error has no .code"),se.UNKNOWN;switch(r){case Lt.OK:return se.OK;case Lt.CANCELLED:return se.CANCELLED;case Lt.UNKNOWN:return se.UNKNOWN;case Lt.DEADLINE_EXCEEDED:return se.DEADLINE_EXCEEDED;case Lt.RESOURCE_EXHAUSTED:return se.RESOURCE_EXHAUSTED;case Lt.INTERNAL:return se.INTERNAL;case Lt.UNAVAILABLE:return se.UNAVAILABLE;case Lt.UNAUTHENTICATED:return se.UNAUTHENTICATED;case Lt.INVALID_ARGUMENT:return se.INVALID_ARGUMENT;case Lt.NOT_FOUND:return se.NOT_FOUND;case Lt.ALREADY_EXISTS:return se.ALREADY_EXISTS;case Lt.PERMISSION_DENIED:return se.PERMISSION_DENIED;case Lt.FAILED_PRECONDITION:return se.FAILED_PRECONDITION;case Lt.ABORTED:return se.ABORTED;case Lt.OUT_OF_RANGE:return se.OUT_OF_RANGE;case Lt.UNIMPLEMENTED:return se.UNIMPLEMENTED;case Lt.DATA_LOSS:return se.DATA_LOSS;default:return Ae()}}(Xe=Lt||(Lt={}))[Xe.OK=0]="OK",Xe[Xe.CANCELLED=1]="CANCELLED",Xe[Xe.UNKNOWN=2]="UNKNOWN",Xe[Xe.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Xe[Xe.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Xe[Xe.NOT_FOUND=5]="NOT_FOUND",Xe[Xe.ALREADY_EXISTS=6]="ALREADY_EXISTS",Xe[Xe.PERMISSION_DENIED=7]="PERMISSION_DENIED",Xe[Xe.UNAUTHENTICATED=16]="UNAUTHENTICATED",Xe[Xe.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Xe[Xe.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Xe[Xe.ABORTED=10]="ABORTED",Xe[Xe.OUT_OF_RANGE=11]="OUT_OF_RANGE",Xe[Xe.UNIMPLEMENTED=12]="UNIMPLEMENTED",Xe[Xe.INTERNAL=13]="INTERNAL",Xe[Xe.UNAVAILABLE=14]="UNAVAILABLE",Xe[Xe.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LA(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jA=new di([4294967295,4294967295],0);function Bv(r){const e=LA().encode(r),t=new Pw;return t.update(e),new Uint8Array(t.digest())}function zv(r){const e=new DataView(r.buffer),t=e.getUint32(0,!0),n=e.getUint32(4,!0),i=e.getUint32(8,!0),a=e.getUint32(12,!0);return[new di([t,n],0),new di([i,a],0)]}class am{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new Dl(`Invalid padding: ${t}`);if(n<0)throw new Dl(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new Dl(`Invalid hash count: ${n}`);if(e.length===0&&t!==0)throw new Dl(`Invalid padding when bitmap length is 0: ${t}`);this.Ee=8*e.length-t,this.de=di.fromNumber(this.Ee)}Ae(e,t,n){let i=e.add(t.multiply(di.fromNumber(n)));return i.compare(jA)===1&&(i=new di([i.getBits(0),i.getBits(1)],0)),i.modulo(this.de).toNumber()}Re(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.Ee===0)return!1;const t=Bv(e),[n,i]=zv(t);for(let a=0;a<this.hashCount;a++){const u=this.Ae(n,i,a);if(!this.Re(u))return!1}return!0}static create(e,t,n){const i=e%8==0?0:8-e%8,a=new Uint8Array(Math.ceil(e/8)),u=new am(a,i,t);return n.forEach(c=>u.insert(c)),u}insert(e){if(this.Ee===0)return;const t=Bv(e),[n,i]=zv(t);for(let a=0;a<this.hashCount;a++){const u=this.Ae(n,i,a);this.Ve(u)}}Ve(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class Dl extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class du{constructor(e,t,n,i,a){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=a}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const i=new Map;return i.set(e,fu.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new du(De.min(),i,new mt(ze),hr(),qe())}}class fu{constructor(e,t,n,i,a){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=a}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new fu(n,t,qe(),qe(),qe())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class th{constructor(e,t,n,i){this.me=e,this.removedTargetIds=t,this.key=n,this.fe=i}}class N0{constructor(e,t){this.targetId=e,this.ge=t}}class R0{constructor(e,t,n=Vt.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=i}}class Uv{constructor(){this.pe=0,this.ye=$v(),this.we=Vt.EMPTY_BYTE_STRING,this.be=!1,this.Se=!0}get current(){return this.be}get resumeToken(){return this.we}get De(){return this.pe!==0}get ve(){return this.Se}Ce(e){e.approximateByteSize()>0&&(this.Se=!0,this.we=e)}Fe(){let e=qe(),t=qe(),n=qe();return this.ye.forEach((i,a)=>{switch(a){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:n=n.add(i);break;default:Ae()}}),new fu(this.we,this.be,e,t,n)}Me(){this.Se=!1,this.ye=$v()}xe(e,t){this.Se=!0,this.ye=this.ye.insert(e,t)}Oe(e){this.Se=!0,this.ye=this.ye.remove(e)}Ne(){this.pe+=1}Be(){this.pe-=1,ke(this.pe>=0)}Le(){this.Se=!0,this.be=!0}}class BA{constructor(e){this.ke=e,this.qe=new Map,this.Qe=hr(),this.$e=zc(),this.Ke=zc(),this.Ue=new mt(ze)}We(e){for(const t of e.me)e.fe&&e.fe.isFoundDocument()?this.Ge(t,e.fe):this.ze(t,e.key,e.fe);for(const t of e.removedTargetIds)this.ze(t,e.key,e.fe)}je(e){this.forEachTarget(e,t=>{const n=this.He(t);switch(e.state){case 0:this.Je(t)&&n.Ce(e.resumeToken);break;case 1:n.Be(),n.De||n.Me(),n.Ce(e.resumeToken);break;case 2:n.Be(),n.De||this.removeTarget(t);break;case 3:this.Je(t)&&(n.Le(),n.Ce(e.resumeToken));break;case 4:this.Je(t)&&(this.Ye(t),n.Ce(e.resumeToken));break;default:Ae()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.qe.forEach((n,i)=>{this.Je(i)&&t(i)})}Ze(e){const t=e.targetId,n=e.ge.count,i=this.Xe(t);if(i){const a=i.target;if(gh(a))if(n===0){const u=new ye(a.path);this.ze(t,u,xt.newNoDocument(u,De.min()))}else ke(n===1);else{const u=this.et(t);if(u!==n){const c=this.tt(e),d=c?this.nt(c,e,u):1;if(d!==0){this.Ye(t);const p=d===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ue=this.Ue.insert(t,p)}}}}}tt(e){const t=e.ge.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:n="",padding:i=0},hashCount:a=0}=t;let u,c;try{u=xs(n).toUint8Array()}catch(d){if(d instanceof Zw)return Wl("Decoding the base64 bloom filter in existence filter failed ("+d.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw d}try{c=new am(u,i,a)}catch(d){return Wl(d instanceof Dl?"BloomFilter error: ":"Applying bloom filter failed: ",d),null}return c.Ee===0?null:c}nt(e,t,n){return t.ge.count===n-this.st(e,t.targetId)?0:2}st(e,t){const n=this.ke.getRemoteKeysForTarget(t);let i=0;return n.forEach(a=>{const u=this.ke.it(),c=`projects/${u.projectId}/databases/${u.database}/documents/${a.path.canonicalString()}`;e.mightContain(c)||(this.ze(t,a,null),i++)}),i}ot(e){const t=new Map;this.qe.forEach((a,u)=>{const c=this.Xe(u);if(c){if(a.current&&gh(c.target)){const d=new ye(c.target.path);this._t(d).has(u)||this.ut(u,d)||this.ze(u,d,xt.newNoDocument(d,e))}a.ve&&(t.set(u,a.Fe()),a.Me())}});let n=qe();this.Ke.forEach((a,u)=>{let c=!0;u.forEachWhile(d=>{const p=this.Xe(d);return!p||p.purpose==="TargetPurposeLimboResolution"||(c=!1,!1)}),c&&(n=n.add(a))}),this.Qe.forEach((a,u)=>u.setReadTime(e));const i=new du(e,t,this.Ue,this.Qe,n);return this.Qe=hr(),this.$e=zc(),this.Ke=zc(),this.Ue=new mt(ze),i}Ge(e,t){if(!this.Je(e))return;const n=this.ut(e,t.key)?2:0;this.He(e).xe(t.key,n),this.Qe=this.Qe.insert(t.key,t),this.$e=this.$e.insert(t.key,this._t(t.key).add(e)),this.Ke=this.Ke.insert(t.key,this.ct(t.key).add(e))}ze(e,t,n){if(!this.Je(e))return;const i=this.He(e);this.ut(e,t)?i.xe(t,1):i.Oe(t),this.Ke=this.Ke.insert(t,this.ct(t).delete(e)),this.Ke=this.Ke.insert(t,this.ct(t).add(e)),n&&(this.Qe=this.Qe.insert(t,n))}removeTarget(e){this.qe.delete(e)}et(e){const t=this.He(e).Fe();return this.ke.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ne(e){this.He(e).Ne()}He(e){let t=this.qe.get(e);return t||(t=new Uv,this.qe.set(e,t)),t}ct(e){let t=this.Ke.get(e);return t||(t=new rt(ze),this.Ke=this.Ke.insert(e,t)),t}_t(e){let t=this.$e.get(e);return t||(t=new rt(ze),this.$e=this.$e.insert(e,t)),t}Je(e){const t=this.Xe(e)!==null;return t||oe("WatchChangeAggregator","Detected inactive target",e),t}Xe(e){const t=this.qe.get(e);return t&&t.De?null:this.ke.lt(e)}Ye(e){this.qe.set(e,new Uv),this.ke.getRemoteKeysForTarget(e).forEach(t=>{this.ze(e,t,null)})}ut(e,t){return this.ke.getRemoteKeysForTarget(e).has(t)}}function zc(){return new mt(ye.comparator)}function $v(){return new mt(ye.comparator)}const zA={asc:"ASCENDING",desc:"DESCENDING"},UA={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},$A={and:"AND",or:"OR"};class WA{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Tp(r,e){return r.useProto3Json||jh(e)?e:{value:e}}function vh(r,e){return r.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function qA(r,e){return r.useProto3Json?e.toBase64():e.toUint8Array()}function GA(r,e){return vh(r,e.toTimestamp())}function In(r){return ke(!!r),De.fromTimestamp(function(t){const n=As(t);return new Qt(n.seconds,n.nanos)}(r))}function P0(r,e){return Ip(r,e).canonicalString()}function Ip(r,e){const t=function(i){return new at(["projects",i.projectId,"databases",i.database])}(r).child("documents");return e===void 0?t:t.child(e)}function k0(r){const e=at.fromString(r);return ke(B0(e)),e}function _h(r,e){return P0(r.databaseId,e.path)}function ao(r,e){const t=k0(e);if(t.get(1)!==r.databaseId.projectId)throw new Ce(se.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+r.databaseId.projectId);if(t.get(3)!==r.databaseId.database)throw new Ce(se.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+r.databaseId.database);return new ye(V0(t))}function b0(r,e){return P0(r.databaseId,e)}function D0(r){const e=k0(r);return e.length===4?at.emptyPath():V0(e)}function Sp(r){return new at(["projects",r.databaseId.projectId,"databases",r.databaseId.database]).canonicalString()}function V0(r){return ke(r.length>4&&r.get(4)==="documents"),r.popFirst(5)}function Wv(r,e,t){return{name:_h(r,e),fields:t.value.mapValue.fields}}function KA(r,e,t){const n=ao(r,e.name),i=In(e.updateTime),a=e.createTime?In(e.createTime):De.min(),u=new cr({mapValue:{fields:e.fields}}),c=xt.newFoundDocument(n,i,a,u);return t&&c.setHasCommittedMutations(),t?c.setHasCommittedMutations():c}function HA(r,e){let t;if("targetChange"in e){e.targetChange;const n=function(p){return p==="NO_CHANGE"?0:p==="ADD"?1:p==="REMOVE"?2:p==="CURRENT"?3:p==="RESET"?4:Ae()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],a=function(p,g){return p.useProto3Json?(ke(g===void 0||typeof g=="string"),Vt.fromBase64String(g||"")):(ke(g===void 0||g instanceof Buffer||g instanceof Uint8Array),Vt.fromUint8Array(g||new Uint8Array))}(r,e.targetChange.resumeToken),u=e.targetChange.cause,c=u&&function(p){const g=p.code===void 0?se.UNKNOWN:x0(p.code);return new Ce(g,p.message||"")}(u);t=new R0(n,i,a,c||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const i=ao(r,n.document.name),a=In(n.document.updateTime),u=n.document.createTime?In(n.document.createTime):De.min(),c=new cr({mapValue:{fields:n.document.fields}}),d=xt.newFoundDocument(i,a,u,c),p=n.targetIds||[],g=n.removedTargetIds||[];t=new th(p,g,d.key,d)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const i=ao(r,n.document),a=n.readTime?In(n.readTime):De.min(),u=xt.newNoDocument(i,a),c=n.removedTargetIds||[];t=new th([],c,u.key,u)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const i=ao(r,n.document),a=n.removedTargetIds||[];t=new th([],a,i,null)}else{if(!("filter"in e))return Ae();{e.filter;const n=e.filter;n.targetId;const{count:i=0,unchangedNames:a}=n,u=new OA(i,a),c=n.targetId;t=new N0(c,u)}}return t}function wh(r,e){let t;if(e instanceof hu)t={update:Wv(r,e.key,e.value)};else if(e instanceof rm)t={delete:_h(r,e.key)};else if(e instanceof La)t={update:Wv(r,e.key,e.data),updateMask:ex(e.fieldMask)};else{if(!(e instanceof A0))return Ae();t={verify:_h(r,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(n=>function(a,u){const c=u.transform;if(c instanceof eu)return{fieldPath:u.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof Ra)return{fieldPath:u.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof Pa)return{fieldPath:u.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof tu)return{fieldPath:u.field.canonicalString(),increment:c.Ie};throw Ae()}(0,n))),e.precondition.isNone||(t.currentDocument=function(i,a){return a.updateTime!==void 0?{updateTime:GA(i,a.updateTime)}:a.exists!==void 0?{exists:a.exists}:Ae()}(r,e.precondition)),t}function Cp(r,e){const t=e.currentDocument?function(a){return a.updateTime!==void 0?Vr.updateTime(In(a.updateTime)):a.exists!==void 0?Vr.exists(a.exists):Vr.none()}(e.currentDocument):Vr.none(),n=e.updateTransforms?e.updateTransforms.map(i=>function(u,c){let d=null;if("setToServerValue"in c)ke(c.setToServerValue==="REQUEST_TIME"),d=new eu;else if("appendMissingElements"in c){const g=c.appendMissingElements.values||[];d=new Ra(g)}else if("removeAllFromArray"in c){const g=c.removeAllFromArray.values||[];d=new Pa(g)}else"increment"in c?d=new tu(u,c.increment):Ae();const p=Dt.fromServerFormat(c.fieldPath);return new bA(p,d)}(r,i)):[];if(e.update){e.update.name;const i=ao(r,e.update.name),a=new cr({mapValue:{fields:e.update.fields}});if(e.updateMask){const u=function(d){const p=d.fieldPaths||[];return new Es(p.map(g=>Dt.fromServerFormat(g)))}(e.updateMask);return new La(i,a,u,t,n)}return new hu(i,a,t,n)}if(e.delete){const i=ao(r,e.delete);return new rm(i,t)}if(e.verify){const i=ao(r,e.verify);return new A0(i,t)}return Ae()}function QA(r,e){return r&&r.length>0?(ke(e!==void 0),r.map(t=>function(i,a){let u=i.updateTime?In(i.updateTime):In(a);return u.isEqual(De.min())&&(u=In(a)),new VA(u,i.transformResults||[])}(t,e))):[]}function M0(r,e){return{documents:[b0(r,e.path)]}}function O0(r,e){const t={structuredQuery:{}},n=e.path;let i;e.collectionGroup!==null?(i=n,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=n.popLast(),t.structuredQuery.from=[{collectionId:n.lastSegment()}]),t.parent=b0(r,i);const a=function(p){if(p.length!==0)return j0(it.create(p,"and"))}(e.filters);a&&(t.structuredQuery.where=a);const u=function(p){if(p.length!==0)return p.map(g=>function(E){return{field:pa(E.field),direction:YA(E.dir)}}(g))}(e.orderBy);u&&(t.structuredQuery.orderBy=u);const c=Tp(r,e.limit);return c!==null&&(t.structuredQuery.limit=c),e.startAt&&(t.structuredQuery.startAt=function(p){return{before:p.inclusive,values:p.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(p){return{before:!p.inclusive,values:p.position}}(e.endAt)),{ht:t,parent:i}}function F0(r){let e=D0(r.parent);const t=r.structuredQuery,n=t.from?t.from.length:0;let i=null;if(n>0){ke(n===1);const g=t.from[0];g.allDescendants?i=g.collectionId:e=e.child(g.collectionId)}let a=[];t.where&&(a=function(_){const E=L0(_);return E instanceof it&&tm(E)?E.getFilters():[E]}(t.where));let u=[];t.orderBy&&(u=function(_){return _.map(E=>function(A){return new mh(ma(A.field),function(M){switch(M){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(A.direction))}(E))}(t.orderBy));let c=null;t.limit&&(c=function(_){let E;return E=typeof _=="object"?_.value:_,jh(E)?null:E}(t.limit));let d=null;t.startAt&&(d=function(_){const E=!!_.before,C=_.values||[];return new xa(C,E)}(t.startAt));let p=null;return t.endAt&&(p=function(_){const E=!_.before,C=_.values||[];return new xa(C,E)}(t.endAt)),m0(e,i,u,a,c,"F",d,p)}function XA(r,e){const t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Ae()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function L0(r){return r.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const n=ma(t.unaryFilter.field);return He.create(n,"==",{doubleValue:NaN});case"IS_NULL":const i=ma(t.unaryFilter.field);return He.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const a=ma(t.unaryFilter.field);return He.create(a,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const u=ma(t.unaryFilter.field);return He.create(u,"!=",{nullValue:"NULL_VALUE"});default:return Ae()}}(r):r.fieldFilter!==void 0?function(t){return He.create(ma(t.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Ae()}}(t.fieldFilter.op),t.fieldFilter.value)}(r):r.compositeFilter!==void 0?function(t){return it.create(t.compositeFilter.filters.map(n=>L0(n)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return Ae()}}(t.compositeFilter.op))}(r):Ae()}function YA(r){return zA[r]}function ZA(r){return UA[r]}function JA(r){return $A[r]}function pa(r){return{fieldPath:r.canonicalString()}}function ma(r){return Dt.fromServerFormat(r.fieldPath)}function j0(r){return r instanceof He?function(t){if(t.op==="=="){if(Nv(t.value))return{unaryFilter:{field:pa(t.field),op:"IS_NAN"}};if(xv(t.value))return{unaryFilter:{field:pa(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(Nv(t.value))return{unaryFilter:{field:pa(t.field),op:"IS_NOT_NAN"}};if(xv(t.value))return{unaryFilter:{field:pa(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:pa(t.field),op:ZA(t.op),value:t.value}}}(r):r instanceof it?function(t){const n=t.getFilters().map(i=>j0(i));return n.length===1?n[0]:{compositeFilter:{op:JA(t.op),filters:n}}}(r):Ae()}function ex(r){const e=[];return r.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function B0(r){return r.length>=4&&r.get(0)==="projects"&&r.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ts{constructor(e,t,n,i,a=De.min(),u=De.min(),c=Vt.EMPTY_BYTE_STRING,d=null){this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=u,this.resumeToken=c,this.expectedCount=d}withSequenceNumber(e){return new Ts(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Ts(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Ts(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Ts(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z0{constructor(e){this.Tt=e}}function tx(r,e){let t;if(e.document)t=KA(r.Tt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const n=ye.fromSegments(e.noDocument.path),i=po(e.noDocument.readTime);t=xt.newNoDocument(n,i),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return Ae();{const n=ye.fromSegments(e.unknownDocument.path),i=po(e.unknownDocument.version);t=xt.newUnknownDocument(n,i)}}return e.readTime&&t.setReadTime(function(i){const a=new Qt(i[0],i[1]);return De.fromTimestamp(a)}(e.readTime)),t}function qv(r,e){const t=e.key,n={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:Eh(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())n.document=function(a,u){return{name:_h(a,u.key),fields:u.data.value.mapValue.fields,updateTime:vh(a,u.version.toTimestamp()),createTime:vh(a,u.createTime.toTimestamp())}}(r.Tt,e);else if(e.isNoDocument())n.noDocument={path:t.path.toArray(),readTime:fo(e.version)};else{if(!e.isUnknownDocument())return Ae();n.unknownDocument={path:t.path.toArray(),version:fo(e.version)}}return n}function Eh(r){const e=r.toTimestamp();return[e.seconds,e.nanoseconds]}function fo(r){const e=r.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function po(r){const e=new Qt(r.seconds,r.nanoseconds);return De.fromTimestamp(e)}function to(r,e){const t=(e.baseMutations||[]).map(a=>Cp(r.Tt,a));for(let a=0;a<e.mutations.length-1;++a){const u=e.mutations[a];if(a+1<e.mutations.length&&e.mutations[a+1].transform!==void 0){const c=e.mutations[a+1];u.updateTransforms=c.transform.fieldTransforms,e.mutations.splice(a+1,1),++a}}const n=e.mutations.map(a=>Cp(r.Tt,a)),i=Qt.fromMillis(e.localWriteTimeMs);return new sm(e.batchId,i,t,n)}function Vl(r){const e=po(r.readTime),t=r.lastLimboFreeSnapshotVersion!==void 0?po(r.lastLimboFreeSnapshotVersion):De.min();let n;return n=function(a){return a.documents!==void 0}(r.query)?function(a){return ke(a.documents.length===1),Qn(Gh(D0(a.documents[0])))}(r.query):function(a){return Qn(F0(a))}(r.query),new Ts(n,r.targetId,"TargetPurposeListen",r.lastListenSequenceNumber,e,t,Vt.fromBase64String(r.resumeToken))}function U0(r,e){const t=fo(e.snapshotVersion),n=fo(e.lastLimboFreeSnapshotVersion);let i;i=gh(e.target)?M0(r.Tt,e.target):O0(r.Tt,e.target).ht;const a=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:ho(e.target),readTime:t,resumeToken:a,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:n,query:i}}function $0(r){const e=F0({parent:r.parent,structuredQuery:r.structuredQuery});return r.limitType==="LAST"?Ep(e,e.limit,"L"):e}function Gf(r,e){return new om(e.largestBatchId,Cp(r.Tt,e.overlayMutation))}function Gv(r,e){const t=e.path.lastSegment();return[r,dn(e.path.popLast()),t]}function Kv(r,e,t,n){return{indexId:r,uid:e,sequenceNumber:t,readTime:fo(n.readTime),documentKey:dn(n.documentKey.path),largestBatchId:n.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nx{getBundleMetadata(e,t){return Hv(e).get(t).next(n=>{if(n)return function(a){return{id:a.bundleId,createTime:po(a.createTime),version:a.version}}(n)})}saveBundleMetadata(e,t){return Hv(e).put(function(i){return{bundleId:i.id,createTime:fo(In(i.createTime)),version:i.version}}(t))}getNamedQuery(e,t){return Qv(e).get(t).next(n=>{if(n)return function(a){return{name:a.name,query:$0(a.bundledQuery),readTime:po(a.readTime)}}(n)})}saveNamedQuery(e,t){return Qv(e).put(function(i){return{name:i.name,readTime:fo(In(i.readTime)),bundledQuery:i.bundledQuery}}(t))}}function Hv(r){return Ut(r,Bh)}function Qv(r){return Ut(r,zh)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xh{constructor(e,t){this.serializer=e,this.userId=t}static It(e,t){const n=t.uid||"";return new Xh(e,n)}getOverlay(e,t){return Al(e).get(Gv(this.userId,t)).next(n=>n?Gf(this.serializer,n):null)}getOverlays(e,t){const n=es();return G.forEach(t,i=>this.getOverlay(e,i).next(a=>{a!==null&&n.set(i,a)})).next(()=>n)}saveOverlays(e,t,n){const i=[];return n.forEach((a,u)=>{const c=new om(t,u);i.push(this.Et(e,c))}),G.waitFor(i)}removeOverlaysForBatchId(e,t,n){const i=new Set;t.forEach(u=>i.add(dn(u.getCollectionPath())));const a=[];return i.forEach(u=>{const c=IDBKeyRange.bound([this.userId,u,n],[this.userId,u,n+1],!1,!0);a.push(Al(e).J(pp,c))}),G.waitFor(a)}getOverlaysForCollection(e,t,n){const i=es(),a=dn(t),u=IDBKeyRange.bound([this.userId,a,n],[this.userId,a,Number.POSITIVE_INFINITY],!0);return Al(e).G(pp,u).next(c=>{for(const d of c){const p=Gf(this.serializer,d);i.set(p.getKey(),p)}return i})}getOverlaysForCollectionGroup(e,t,n,i){const a=es();let u;const c=IDBKeyRange.bound([this.userId,t,n],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Al(e).Z({index:Hw,range:c},(d,p,g)=>{const _=Gf(this.serializer,p);a.size()<i||_.largestBatchId===u?(a.set(_.getKey(),_),u=_.largestBatchId):g.done()}).next(()=>a)}Et(e,t){return Al(e).put(function(i,a,u){const[c,d,p]=Gv(a,u.mutation.key);return{userId:a,collectionPath:d,documentId:p,collectionGroup:u.mutation.key.getCollectionGroup(),largestBatchId:u.largestBatchId,overlayMutation:wh(i.Tt,u.mutation)}}(this.serializer,this.userId,t))}}function Al(r){return Ut(r,Uh)}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rx{dt(e){return Ut(e,Yp)}getSessionToken(e){return this.dt(e).get("sessionToken").next(t=>{const n=t==null?void 0:t.value;return n?Vt.fromUint8Array(n):Vt.EMPTY_BYTE_STRING})}setSessionToken(e,t){return this.dt(e).put({name:"sessionToken",value:t.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class no{constructor(){}At(e,t){this.Rt(e,t),t.Vt()}Rt(e,t){if("nullValue"in e)this.ft(t,5);else if("booleanValue"in e)this.ft(t,10),t.gt(e.booleanValue?1:0);else if("integerValue"in e)this.ft(t,15),t.gt(vt(e.integerValue));else if("doubleValue"in e){const n=vt(e.doubleValue);isNaN(n)?this.ft(t,13):(this.ft(t,15),Gl(n)?t.gt(0):t.gt(n))}else if("timestampValue"in e){let n=e.timestampValue;this.ft(t,20),typeof n=="string"&&(n=As(n)),t.yt(`${n.seconds||""}`),t.gt(n.nanos||0)}else if("stringValue"in e)this.wt(e.stringValue,t),this.bt(t);else if("bytesValue"in e)this.ft(t,30),t.St(xs(e.bytesValue)),this.bt(t);else if("referenceValue"in e)this.Dt(e.referenceValue,t);else if("geoPointValue"in e){const n=e.geoPointValue;this.ft(t,45),t.gt(n.latitude||0),t.gt(n.longitude||0)}else"mapValue"in e?o0(e)?this.ft(t,Number.MAX_SAFE_INTEGER):Wh(e)?this.vt(e.mapValue,t):(this.Ct(e.mapValue,t),this.bt(t)):"arrayValue"in e?(this.Ft(e.arrayValue,t),this.bt(t)):Ae()}wt(e,t){this.ft(t,25),this.Mt(e,t)}Mt(e,t){t.yt(e)}Ct(e,t){const n=e.fields||{};this.ft(t,55);for(const i of Object.keys(n))this.wt(i,t),this.Rt(n[i],t)}vt(e,t){var n,i;const a=e.fields||{};this.ft(t,53);const u=Yl,c=((i=(n=a[u].arrayValue)===null||n===void 0?void 0:n.values)===null||i===void 0?void 0:i.length)||0;this.ft(t,15),t.gt(vt(c)),this.wt(u,t),this.Rt(a[u],t)}Ft(e,t){const n=e.values||[];this.ft(t,50);for(const i of n)this.Rt(i,t)}Dt(e,t){this.ft(t,37),ye.fromName(e).path.forEach(n=>{this.ft(t,60),this.Mt(n,t)})}ft(e,t){e.gt(t)}bt(e){e.gt(2)}}no.xt=new no;/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law | agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES | CONDITIONS OF ANY KIND, either express | implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const la=255;function sx(r){if(r===0)return 8;let e=0;return r>>4||(e+=4,r<<=4),r>>6||(e+=2,r<<=2),r>>7||(e+=1),e}function Xv(r){const e=64-function(n){let i=0;for(let a=0;a<8;++a){const u=sx(255&n[a]);if(i+=u,u!==8)break}return i}(r);return Math.ceil(e/8)}class ix{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Ot(e){const t=e[Symbol.iterator]();let n=t.next();for(;!n.done;)this.Nt(n.value),n=t.next();this.Bt()}Lt(e){const t=e[Symbol.iterator]();let n=t.next();for(;!n.done;)this.kt(n.value),n=t.next();this.qt()}Qt(e){for(const t of e){const n=t.charCodeAt(0);if(n<128)this.Nt(n);else if(n<2048)this.Nt(960|n>>>6),this.Nt(128|63&n);else if(t<"\uD800"||"\uDBFF"<t)this.Nt(480|n>>>12),this.Nt(128|63&n>>>6),this.Nt(128|63&n);else{const i=t.codePointAt(0);this.Nt(240|i>>>18),this.Nt(128|63&i>>>12),this.Nt(128|63&i>>>6),this.Nt(128|63&i)}}this.Bt()}$t(e){for(const t of e){const n=t.charCodeAt(0);if(n<128)this.kt(n);else if(n<2048)this.kt(960|n>>>6),this.kt(128|63&n);else if(t<"\uD800"||"\uDBFF"<t)this.kt(480|n>>>12),this.kt(128|63&n>>>6),this.kt(128|63&n);else{const i=t.codePointAt(0);this.kt(240|i>>>18),this.kt(128|63&i>>>12),this.kt(128|63&i>>>6),this.kt(128|63&i)}}this.qt()}Kt(e){const t=this.Ut(e),n=Xv(t);this.Wt(1+n),this.buffer[this.position++]=255&n;for(let i=t.length-n;i<t.length;++i)this.buffer[this.position++]=255&t[i]}Gt(e){const t=this.Ut(e),n=Xv(t);this.Wt(1+n),this.buffer[this.position++]=~(255&n);for(let i=t.length-n;i<t.length;++i)this.buffer[this.position++]=~(255&t[i])}zt(){this.jt(la),this.jt(255)}Ht(){this.Jt(la),this.Jt(255)}reset(){this.position=0}seed(e){this.Wt(e.length),this.buffer.set(e,this.position),this.position+=e.length}Yt(){return this.buffer.slice(0,this.position)}Ut(e){const t=function(a){const u=new DataView(new ArrayBuffer(8));return u.setFloat64(0,a,!1),new Uint8Array(u.buffer)}(e),n=!!(128&t[0]);t[0]^=n?255:128;for(let i=1;i<t.length;++i)t[i]^=n?255:0;return t}Nt(e){const t=255&e;t===0?(this.jt(0),this.jt(255)):t===la?(this.jt(la),this.jt(0)):this.jt(t)}kt(e){const t=255&e;t===0?(this.Jt(0),this.Jt(255)):t===la?(this.Jt(la),this.Jt(0)):this.Jt(e)}Bt(){this.jt(0),this.jt(1)}qt(){this.Jt(0),this.Jt(1)}jt(e){this.Wt(1),this.buffer[this.position++]=e}Jt(e){this.Wt(1),this.buffer[this.position++]=~e}Wt(e){const t=e+this.position;if(t<=this.buffer.length)return;let n=2*this.buffer.length;n<t&&(n=t);const i=new Uint8Array(n);i.set(this.buffer),this.buffer=i}}class ox{constructor(e){this.Zt=e}St(e){this.Zt.Ot(e)}yt(e){this.Zt.Qt(e)}gt(e){this.Zt.Kt(e)}Vt(){this.Zt.zt()}}class ax{constructor(e){this.Zt=e}St(e){this.Zt.Lt(e)}yt(e){this.Zt.$t(e)}gt(e){this.Zt.Gt(e)}Vt(){this.Zt.Ht()}}class xl{constructor(){this.Zt=new ix,this.Xt=new ox(this.Zt),this.en=new ax(this.Zt)}seed(e){this.Zt.seed(e)}tn(e){return e===0?this.Xt:this.en}Yt(){return this.Zt.Yt()}reset(){this.Zt.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ro{constructor(e,t,n,i){this.indexId=e,this.documentKey=t,this.arrayValue=n,this.directionalValue=i}nn(){const e=this.directionalValue.length,t=e===0||this.directionalValue[e-1]===255?e+1:e,n=new Uint8Array(t);return n.set(this.directionalValue,0),t!==e?n.set([0],this.directionalValue.length):++n[n.length-1],new ro(this.indexId,this.documentKey,this.arrayValue,n)}}function ti(r,e){let t=r.indexId-e.indexId;return t!==0?t:(t=Yv(r.arrayValue,e.arrayValue),t!==0?t:(t=Yv(r.directionalValue,e.directionalValue),t!==0?t:ye.comparator(r.documentKey,e.documentKey)))}function Yv(r,e){for(let t=0;t<r.length&&t<e.length;++t){const n=r[t]-e[t];if(n!==0)return n}return r.length-e.length}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zv{constructor(e){this.rn=new rt((t,n)=>Dt.comparator(t.field,n.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.sn=e.orderBy,this._n=[];for(const t of e.filters){const n=t;n.isInequality()?this.rn=this.rn.add(n):this._n.push(n)}}get an(){return this.rn.size>1}un(e){if(ke(e.collectionGroup===this.collectionId),this.an)return!1;const t=hp(e);if(t!==void 0&&!this.cn(t))return!1;const n=Zi(e);let i=new Set,a=0,u=0;for(;a<n.length&&this.cn(n[a]);++a)i=i.add(n[a].fieldPath.canonicalString());if(a===n.length)return!0;if(this.rn.size>0){const c=this.rn.getIterator().getNext();if(!i.has(c.field.canonicalString())){const d=n[a];if(!this.ln(c,d)||!this.hn(this.sn[u++],d))return!1}++a}for(;a<n.length;++a){const c=n[a];if(u>=this.sn.length||!this.hn(this.sn[u++],c))return!1}return!0}Pn(){if(this.an)return null;let e=new rt(Dt.comparator);const t=[];for(const n of this._n)if(!n.field.isKeyField())if(n.op==="array-contains"||n.op==="array-contains-any")t.push(new Qc(n.field,2));else{if(e.has(n.field))continue;e=e.add(n.field),t.push(new Qc(n.field,0))}for(const n of this.sn)n.field.isKeyField()||e.has(n.field)||(e=e.add(n.field),t.push(new Qc(n.field,n.dir==="asc"?0:1)));return new lh(lh.UNKNOWN_ID,this.collectionId,t,ql.empty())}cn(e){for(const t of this._n)if(this.ln(t,e))return!0;return!1}ln(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const n=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===n}hn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function W0(r){var e,t;if(ke(r instanceof He||r instanceof it),r instanceof He){if(r instanceof p0){const i=((t=(e=r.value.arrayValue)===null||e===void 0?void 0:e.values)===null||t===void 0?void 0:t.map(a=>He.create(r.field,"==",a)))||[];return it.create(i,"or")}return r}const n=r.filters.map(i=>W0(i));return it.create(n,r.op)}function lx(r){if(r.getFilters().length===0)return[];const e=Np(W0(r));return ke(q0(e)),Ap(e)||xp(e)?[e]:e.getFilters()}function Ap(r){return r instanceof He}function xp(r){return r instanceof it&&tm(r)}function q0(r){return Ap(r)||xp(r)||function(t){if(t instanceof it&&vp(t)){for(const n of t.getFilters())if(!Ap(n)&&!xp(n))return!1;return!0}return!1}(r)}function Np(r){if(ke(r instanceof He||r instanceof it),r instanceof He)return r;if(r.filters.length===1)return Np(r.filters[0]);const e=r.filters.map(n=>Np(n));let t=it.create(e,r.op);return t=Th(t),q0(t)?t:(ke(t instanceof it),ke(Na(t)),ke(t.filters.length>1),t.filters.reduce((n,i)=>lm(n,i)))}function lm(r,e){let t;return ke(r instanceof He||r instanceof it),ke(e instanceof He||e instanceof it),t=r instanceof He?e instanceof He?function(i,a){return it.create([i,a],"and")}(r,e):Jv(r,e):e instanceof He?Jv(e,r):function(i,a){if(ke(i.filters.length>0&&a.filters.length>0),Na(i)&&Na(a))return h0(i,a.getFilters());const u=vp(i)?i:a,c=vp(i)?a:i,d=u.filters.map(p=>lm(p,c));return it.create(d,"or")}(r,e),Th(t)}function Jv(r,e){if(Na(e))return h0(e,r.getFilters());{const t=e.filters.map(n=>lm(r,n));return it.create(t,"or")}}function Th(r){if(ke(r instanceof He||r instanceof it),r instanceof He)return r;const e=r.getFilters();if(e.length===1)return Th(e[0]);if(u0(r))return r;const t=e.map(i=>Th(i)),n=[];return t.forEach(i=>{i instanceof He?n.push(i):i instanceof it&&(i.op===r.op?n.push(...i.filters):n.push(i))}),n.length===1?n[0]:it.create(n,r.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ux{constructor(){this.Tn=new um}addToCollectionParentIndex(e,t){return this.Tn.add(t),G.resolve()}getCollectionParents(e,t){return G.resolve(this.Tn.getEntries(t))}addFieldIndex(e,t){return G.resolve()}deleteFieldIndex(e,t){return G.resolve()}deleteAllFieldIndexes(e){return G.resolve()}createTargetIndexes(e,t){return G.resolve()}getDocumentsMatchingTarget(e,t){return G.resolve(null)}getIndexType(e,t){return G.resolve(0)}getFieldIndexes(e,t){return G.resolve([])}getNextCollectionGroupToUpdate(e){return G.resolve(null)}getMinOffset(e,t){return G.resolve(Xn.min())}getMinOffsetFromCollectionGroup(e,t){return G.resolve(Xn.min())}updateCollectionGroup(e,t,n){return G.resolve()}updateIndexEntries(e,t){return G.resolve()}}class um{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),i=this.index[t]||new rt(at.comparator),a=!i.has(n);return this.index[t]=i.add(n),a}has(e){const t=e.lastSegment(),n=e.popLast(),i=this.index[t];return i&&i.has(n)}getEntries(e){return(this.index[e]||new rt(at.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e_="IndexedDbIndexManager",Uc=new Uint8Array(0);class cx{constructor(e,t){this.databaseId=t,this.In=new um,this.En=new Ns(n=>ho(n),(n,i)=>uu(n,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.In.has(t)){const n=t.lastSegment(),i=t.popLast();e.addOnCommittedListener(()=>{this.In.add(t)});const a={collectionId:n,parent:dn(i)};return t_(e).put(a)}return G.resolve()}getCollectionParents(e,t){const n=[],i=IDBKeyRange.bound([t,""],[Fw(t),""],!1,!0);return t_(e).G(i).next(a=>{for(const u of a){if(u.collectionId!==t)break;n.push(Jr(u.parent))}return n})}addFieldIndex(e,t){const n=Nl(e),i=function(c){return{indexId:c.indexId,collectionGroup:c.collectionGroup,fields:c.fields.map(d=>[d.fieldPath.canonicalString(),d.kind])}}(t);delete i.indexId;const a=n.add(i);if(t.indexState){const u=ca(e);return a.next(c=>{u.put(Kv(c,this.uid,t.indexState.sequenceNumber,t.indexState.offset))})}return a.next()}deleteFieldIndex(e,t){const n=Nl(e),i=ca(e),a=ua(e);return n.delete(t.indexId).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>a.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const t=Nl(e),n=ua(e),i=ca(e);return t.J().next(()=>n.J()).next(()=>i.J())}createTargetIndexes(e,t){return G.forEach(this.dn(t),n=>this.getIndexType(e,n).next(i=>{if(i===0||i===1){const a=new Zv(n).Pn();if(a!=null)return this.addFieldIndex(e,a)}}))}getDocumentsMatchingTarget(e,t){const n=ua(e);let i=!0;const a=new Map;return G.forEach(this.dn(t),u=>this.An(e,u).next(c=>{i&&(i=!!c),a.set(u,c)})).next(()=>{if(i){let u=qe();const c=[];return G.forEach(a,(d,p)=>{oe(e_,`Using index ${function(z){return`id=${z.indexId}|cg=${z.collectionGroup}|f=${z.fields.map(X=>`${X.fieldPath}:${X.kind}`).join(",")}`}(d)} to execute ${ho(t)}`);const g=function(z,X){const j=hp(X);if(j===void 0)return null;for(const $ of yh(z,j.fieldPath))switch($.op){case"array-contains-any":return $.value.arrayValue.values||[];case"array-contains":return[$.value]}return null}(p,d),_=function(z,X){const j=new Map;for(const $ of Zi(X))for(const x of yh(z,$.fieldPath))switch(x.op){case"==":case"in":j.set($.fieldPath.canonicalString(),x.value);break;case"not-in":case"!=":return j.set($.fieldPath.canonicalString(),x.value),Array.from(j.values())}return null}(p,d),E=function(z,X){const j=[];let $=!0;for(const x of Zi(X)){const I=x.kind===0?Dv(z,x.fieldPath,z.startAt):Vv(z,x.fieldPath,z.startAt);j.push(I.value),$&&($=I.inclusive)}return new xa(j,$)}(p,d),C=function(z,X){const j=[];let $=!0;for(const x of Zi(X)){const I=x.kind===0?Vv(z,x.fieldPath,z.endAt):Dv(z,x.fieldPath,z.endAt);j.push(I.value),$&&($=I.inclusive)}return new xa(j,$)}(p,d),A=this.Rn(d,p,E),P=this.Rn(d,p,C),M=this.Vn(d,p,_),U=this.mn(d.indexId,g,A,E.inclusive,P,C.inclusive,M);return G.forEach(U,W=>n.H(W,t.limit).next(z=>{z.forEach(X=>{const j=ye.fromSegments(X.documentKey);u.has(j)||(u=u.add(j),c.push(j))})}))}).next(()=>c)}return G.resolve(null)})}dn(e){let t=this.En.get(e);return t||(e.filters.length===0?t=[e]:t=lx(it.create(e.filters,"and")).map(n=>wp(e.path,e.collectionGroup,e.orderBy,n.getFilters(),e.limit,e.startAt,e.endAt)),this.En.set(e,t),t)}mn(e,t,n,i,a,u,c){const d=(t!=null?t.length:1)*Math.max(n.length,a.length),p=d/(t!=null?t.length:1),g=[];for(let _=0;_<d;++_){const E=t?this.fn(t[_/p]):Uc,C=this.gn(e,E,n[_%p],i),A=this.pn(e,E,a[_%p],u),P=c.map(M=>this.gn(e,E,M,!0));g.push(...this.createRange(C,A,P))}return g}gn(e,t,n,i){const a=new ro(e,ye.empty(),t,n);return i?a:a.nn()}pn(e,t,n,i){const a=new ro(e,ye.empty(),t,n);return i?a.nn():a}An(e,t){const n=new Zv(t),i=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,i).next(a=>{let u=null;for(const c of a)n.un(c)&&(!u||c.fields.length>u.fields.length)&&(u=c);return u})}getIndexType(e,t){let n=2;const i=this.dn(t);return G.forEach(i,a=>this.An(e,a).next(u=>{u?n!==0&&u.fields.length<function(d){let p=new rt(Dt.comparator),g=!1;for(const _ of d.filters)for(const E of _.getFlattenedFilters())E.field.isKeyField()||(E.op==="array-contains"||E.op==="array-contains-any"?g=!0:p=p.add(E.field));for(const _ of d.orderBy)_.field.isKeyField()||(p=p.add(_.field));return p.size+(g?1:0)}(a)&&(n=1):n=0})).next(()=>function(u){return u.limit!==null}(t)&&i.length>1&&n===2?1:n)}yn(e,t){const n=new xl;for(const i of Zi(e)){const a=t.data.field(i.fieldPath);if(a==null)return null;const u=n.tn(i.kind);no.xt.At(a,u)}return n.Yt()}fn(e){const t=new xl;return no.xt.At(e,t.tn(0)),t.Yt()}wn(e,t){const n=new xl;return no.xt.At(em(this.databaseId,t),n.tn(function(a){const u=Zi(a);return u.length===0?0:u[u.length-1].kind}(e))),n.Yt()}Vn(e,t,n){if(n===null)return[];let i=[];i.push(new xl);let a=0;for(const u of Zi(e)){const c=n[a++];for(const d of i)if(this.bn(t,u.fieldPath)&&Jl(c))i=this.Sn(i,u,c);else{const p=d.tn(u.kind);no.xt.At(c,p)}}return this.Dn(i)}Rn(e,t,n){return this.Vn(e,t,n.position)}Dn(e){const t=[];for(let n=0;n<e.length;++n)t[n]=e[n].Yt();return t}Sn(e,t,n){const i=[...e],a=[];for(const u of n.arrayValue.values||[])for(const c of i){const d=new xl;d.seed(c.Yt()),no.xt.At(u,d.tn(t.kind)),a.push(d)}return a}bn(e,t){return!!e.filters.find(n=>n instanceof He&&n.field.isEqual(t)&&(n.op==="in"||n.op==="not-in"))}getFieldIndexes(e,t){const n=Nl(e),i=ca(e);return(t?n.G(fp,IDBKeyRange.bound(t,t)):n.G()).next(a=>{const u=[];return G.forEach(a,c=>i.get([c.indexId,this.uid]).next(d=>{u.push(function(g,_){const E=_?new ql(_.sequenceNumber,new Xn(po(_.readTime),new ye(Jr(_.documentKey)),_.largestBatchId)):ql.empty(),C=g.fields.map(([A,P])=>new Qc(Dt.fromServerFormat(A),P));return new lh(g.indexId,g.collectionGroup,C,E)}(c,d))})).next(()=>u)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>t.length===0?null:(t.sort((n,i)=>{const a=n.indexState.sequenceNumber-i.indexState.sequenceNumber;return a!==0?a:ze(n.collectionGroup,i.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,n){const i=Nl(e),a=ca(e);return this.vn(e).next(u=>i.G(fp,IDBKeyRange.bound(t,t)).next(c=>G.forEach(c,d=>a.put(Kv(d.indexId,this.uid,u,n)))))}updateIndexEntries(e,t){const n=new Map;return G.forEach(t,(i,a)=>{const u=n.get(i.collectionGroup);return(u?G.resolve(u):this.getFieldIndexes(e,i.collectionGroup)).next(c=>(n.set(i.collectionGroup,c),G.forEach(c,d=>this.Cn(e,i,d).next(p=>{const g=this.Fn(a,d);return p.isEqual(g)?G.resolve():this.Mn(e,a,d,p,g)}))))})}xn(e,t,n,i){return ua(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.wn(n,t.key),documentKey:t.key.path.toArray()})}On(e,t,n,i){return ua(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.wn(n,t.key),t.key.path.toArray()])}Cn(e,t,n){const i=ua(e);let a=new rt(ti);return i.Z({index:Kw,range:IDBKeyRange.only([n.indexId,this.uid,this.wn(n,t)])},(u,c)=>{a=a.add(new ro(n.indexId,t,c.arrayValue,c.directionalValue))}).next(()=>a)}Fn(e,t){let n=new rt(ti);const i=this.yn(t,e);if(i==null)return n;const a=hp(t);if(a!=null){const u=e.data.field(a.fieldPath);if(Jl(u))for(const c of u.arrayValue.values||[])n=n.add(new ro(t.indexId,e.key,this.fn(c),i))}else n=n.add(new ro(t.indexId,e.key,Uc,i));return n}Mn(e,t,n,i,a){oe(e_,"Updating index entries for document '%s'",t.key);const u=[];return function(d,p,g,_,E){const C=d.getIterator(),A=p.getIterator();let P=aa(C),M=aa(A);for(;P||M;){let U=!1,W=!1;if(P&&M){const z=g(P,M);z<0?W=!0:z>0&&(U=!0)}else P!=null?W=!0:U=!0;U?(_(M),M=aa(A)):W?(E(P),P=aa(C)):(P=aa(C),M=aa(A))}}(i,a,ti,c=>{u.push(this.xn(e,t,n,c))},c=>{u.push(this.On(e,t,n,c))}),G.waitFor(u)}vn(e){let t=1;return ca(e).Z({index:Gw,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(n,i,a)=>{a.done(),t=i.sequenceNumber+1}).next(()=>t)}createRange(e,t,n){n=n.sort((u,c)=>ti(u,c)).filter((u,c,d)=>!c||ti(u,d[c-1])!==0);const i=[];i.push(e);for(const u of n){const c=ti(u,e),d=ti(u,t);if(c===0)i[0]=e.nn();else if(c>0&&d<0)i.push(u),i.push(u.nn());else if(d>0)break}i.push(t);const a=[];for(let u=0;u<i.length;u+=2){if(this.Nn(i[u],i[u+1]))return[];const c=[i[u].indexId,this.uid,i[u].arrayValue,i[u].directionalValue,Uc,[]],d=[i[u+1].indexId,this.uid,i[u+1].arrayValue,i[u+1].directionalValue,Uc,[]];a.push(IDBKeyRange.bound(c,d))}return a}Nn(e,t){return ti(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(n_)}getMinOffset(e,t){return G.mapArray(this.dn(t),n=>this.An(e,n).next(i=>i||Ae())).next(n_)}}function t_(r){return Ut(r,Ql)}function ua(r){return Ut(r,fh)}function Nl(r){return Ut(r,Xp)}function ca(r){return Ut(r,dh)}function n_(r){ke(r.length!==0);let e=r[0].indexState.offset,t=e.largestBatchId;for(let n=1;n<r.length;n++){const i=r[n].indexState.offset;Kp(i,e)<0&&(e=i),t<i.largestBatchId&&(t=i.largestBatchId)}return new Xn(e.readTime,e.documentKey,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const r_={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},G0=41943040;class hn{static withCacheSize(e){return new hn(e,hn.DEFAULT_COLLECTION_PERCENTILE,hn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function K0(r,e,t){const n=r.store(Dr),i=r.store(Ta),a=[],u=IDBKeyRange.only(t.batchId);let c=0;const d=n.Z({range:u},(g,_,E)=>(c++,E.delete()));a.push(d.next(()=>{ke(c===1)}));const p=[];for(const g of t.mutations){const _=$w(e,g.key.path,t.batchId);a.push(i.delete(_)),p.push(g.key)}return G.waitFor(a).next(()=>p)}function Ih(r){if(!r)return 0;let e;if(r.document)e=r.document;else if(r.unknownDocument)e=r.unknownDocument;else{if(!r.noDocument)throw Ae();e=r.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */hn.DEFAULT_COLLECTION_PERCENTILE=10,hn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,hn.DEFAULT=new hn(G0,hn.DEFAULT_COLLECTION_PERCENTILE,hn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),hn.DISABLED=new hn(-1,0,0);class Yh{constructor(e,t,n,i){this.userId=e,this.serializer=t,this.indexManager=n,this.referenceDelegate=i,this.Bn={}}static It(e,t,n,i){ke(e.uid!=="");const a=e.isAuthenticated()?e.uid:"";return new Yh(a,t,n,i)}checkEmpty(e){let t=!0;const n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return ni(e).Z({index:so,range:n},(i,a,u)=>{t=!1,u.done()}).next(()=>t)}addMutationBatch(e,t,n,i){const a=ga(e),u=ni(e);return u.add({}).next(c=>{ke(typeof c=="number");const d=new sm(c,t,n,i),p=function(C,A,P){const M=P.baseMutations.map(W=>wh(C.Tt,W)),U=P.mutations.map(W=>wh(C.Tt,W));return{userId:A,batchId:P.batchId,localWriteTimeMs:P.localWriteTime.toMillis(),baseMutations:M,mutations:U}}(this.serializer,this.userId,d),g=[];let _=new rt((E,C)=>ze(E.canonicalString(),C.canonicalString()));for(const E of i){const C=$w(this.userId,E.key.path,c);_=_.add(E.key.path.popLast()),g.push(u.put(p)),g.push(a.put(C,OC))}return _.forEach(E=>{g.push(this.indexManager.addToCollectionParentIndex(e,E))}),e.addOnCommittedListener(()=>{this.Bn[c]=d.keys()}),G.waitFor(g).next(()=>d)})}lookupMutationBatch(e,t){return ni(e).get(t).next(n=>n?(ke(n.userId===this.userId),to(this.serializer,n)):null)}Ln(e,t){return this.Bn[t]?G.resolve(this.Bn[t]):this.lookupMutationBatch(e,t).next(n=>{if(n){const i=n.keys();return this.Bn[t]=i,i}return null})}getNextMutationBatchAfterBatchId(e,t){const n=t+1,i=IDBKeyRange.lowerBound([this.userId,n]);let a=null;return ni(e).Z({index:so,range:i},(u,c,d)=>{c.userId===this.userId&&(ke(c.batchId>=n),a=to(this.serializer,c)),d.done()}).next(()=>a)}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let n=io;return ni(e).Z({index:so,range:t,reverse:!0},(i,a,u)=>{n=a.batchId,u.done()}).next(()=>n)}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,io],[this.userId,Number.POSITIVE_INFINITY]);return ni(e).G(so,t).next(n=>n.map(i=>to(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,t){const n=Xc(this.userId,t.path),i=IDBKeyRange.lowerBound(n),a=[];return ga(e).Z({range:i},(u,c,d)=>{const[p,g,_]=u,E=Jr(g);if(p===this.userId&&t.path.isEqual(E))return ni(e).get(_).next(C=>{if(!C)throw Ae();ke(C.userId===this.userId),a.push(to(this.serializer,C))});d.done()}).next(()=>a)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new rt(ze);const i=[];return t.forEach(a=>{const u=Xc(this.userId,a.path),c=IDBKeyRange.lowerBound(u),d=ga(e).Z({range:c},(p,g,_)=>{const[E,C,A]=p,P=Jr(C);E===this.userId&&a.path.isEqual(P)?n=n.add(A):_.done()});i.push(d)}),G.waitFor(i).next(()=>this.kn(e,n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,i=n.length+1,a=Xc(this.userId,n),u=IDBKeyRange.lowerBound(a);let c=new rt(ze);return ga(e).Z({range:u},(d,p,g)=>{const[_,E,C]=d,A=Jr(E);_===this.userId&&n.isPrefixOf(A)?A.length===i&&(c=c.add(C)):g.done()}).next(()=>this.kn(e,c))}kn(e,t){const n=[],i=[];return t.forEach(a=>{i.push(ni(e).get(a).next(u=>{if(u===null)throw Ae();ke(u.userId===this.userId),n.push(to(this.serializer,u))}))}),G.waitFor(i).next(()=>n)}removeMutationBatch(e,t){return K0(e.ue,this.userId,t).next(n=>(e.addOnCommittedListener(()=>{this.qn(t.batchId)}),G.forEach(n,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}qn(e){delete this.Bn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return G.resolve();const n=IDBKeyRange.lowerBound(function(u){return[u]}(this.userId)),i=[];return ga(e).Z({range:n},(a,u,c)=>{if(a[0]===this.userId){const d=Jr(a[1]);i.push(d)}else c.done()}).next(()=>{ke(i.length===0)})})}containsKey(e,t){return H0(e,this.userId,t)}Qn(e){return Q0(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:io,lastStreamToken:""})}}function H0(r,e,t){const n=Xc(e,t.path),i=n[1],a=IDBKeyRange.lowerBound(n);let u=!1;return ga(r).Z({range:a,Y:!0},(c,d,p)=>{const[g,_,E]=c;g===e&&_===i&&(u=!0),p.done()}).next(()=>u)}function ni(r){return Ut(r,Dr)}function ga(r){return Ut(r,Ta)}function Q0(r){return Ut(r,Kl)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mo{constructor(e){this.$n=e}next(){return this.$n+=2,this.$n}static Kn(){return new mo(0)}static Un(){return new mo(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hx{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.Wn(e).next(t=>{const n=new mo(t.highestTargetId);return t.highestTargetId=n.next(),this.Gn(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.Wn(e).next(t=>De.fromTimestamp(new Qt(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.Wn(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,n){return this.Wn(e).next(i=>(i.highestListenSequenceNumber=t,n&&(i.lastRemoteSnapshotVersion=n.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this.Gn(e,i)))}addTargetData(e,t){return this.zn(e,t).next(()=>this.Wn(e).next(n=>(n.targetCount+=1,this.jn(t,n),this.Gn(e,n))))}updateTargetData(e,t){return this.zn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>ha(e).delete(t.targetId)).next(()=>this.Wn(e)).next(n=>(ke(n.targetCount>0),n.targetCount-=1,this.Gn(e,n)))}removeTargets(e,t,n){let i=0;const a=[];return ha(e).Z((u,c)=>{const d=Vl(c);d.sequenceNumber<=t&&n.get(d.targetId)===null&&(i++,a.push(this.removeTargetData(e,d)))}).next(()=>G.waitFor(a)).next(()=>i)}forEachTarget(e,t){return ha(e).Z((n,i)=>{const a=Vl(i);t(a)})}Wn(e){return s_(e).get(hh).next(t=>(ke(t!==null),t))}Gn(e,t){return s_(e).put(hh,t)}zn(e,t){return ha(e).put(U0(this.serializer,t))}jn(e,t){let n=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,n=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,n=!0),n}getTargetCount(e){return this.Wn(e).next(t=>t.targetCount)}getTargetData(e,t){const n=ho(t),i=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]);let a=null;return ha(e).Z({range:i,index:qw},(u,c,d)=>{const p=Vl(c);uu(t,p.target)&&(a=p,d.done())}).next(()=>a)}addMatchingKeys(e,t,n){const i=[],a=ai(e);return t.forEach(u=>{const c=dn(u.path);i.push(a.put({targetId:n,path:c})),i.push(this.referenceDelegate.addReference(e,n,u))}),G.waitFor(i)}removeMatchingKeys(e,t,n){const i=ai(e);return G.forEach(t,a=>{const u=dn(a.path);return G.waitFor([i.delete([n,u]),this.referenceDelegate.removeReference(e,n,a)])})}removeMatchingKeysForTargetId(e,t){const n=ai(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return n.delete(i)}getMatchingKeysForTargetId(e,t){const n=IDBKeyRange.bound([t],[t+1],!1,!0),i=ai(e);let a=qe();return i.Z({range:n,Y:!0},(u,c,d)=>{const p=Jr(u[1]),g=new ye(p);a=a.add(g)}).next(()=>a)}containsKey(e,t){const n=dn(t.path),i=IDBKeyRange.bound([n],[Fw(n)],!1,!0);let a=0;return ai(e).Z({index:Qp,Y:!0,range:i},([u,c],d,p)=>{u!==0&&(a++,p.done())}).next(()=>a>0)}lt(e,t){return ha(e).get(t).next(n=>n?Vl(n):null)}}function ha(r){return Ut(r,Ia)}function s_(r){return Ut(r,oo)}function ai(r){return Ut(r,Sa)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i_="LruGarbageCollector",X0=1048576;function o_([r,e],[t,n]){const i=ze(r,t);return i===0?ze(e,n):i}class dx{constructor(e){this.Hn=e,this.buffer=new rt(o_),this.Jn=0}Yn(){return++this.Jn}Zn(e){const t=[e,this.Yn()];if(this.buffer.size<this.Hn)this.buffer=this.buffer.add(t);else{const n=this.buffer.last();o_(t,n)<0&&(this.buffer=this.buffer.delete(n).add(t))}}get maxValue(){return this.buffer.last()[0]}}class Y0{constructor(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.Xn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.er(6e4)}stop(){this.Xn&&(this.Xn.cancel(),this.Xn=null)}get started(){return this.Xn!==null}er(e){oe(i_,`Garbage collection scheduled in ${e}ms`),this.Xn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Xn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){wi(t)?oe(i_,"Ignoring IndexedDB error during garbage collection: ",t):await _i(t)}await this.er(3e5)})}}class fx{constructor(e,t){this.tr=e,this.params=t}calculateTargetCount(e,t){return this.tr.nr(e).next(n=>Math.floor(t/100*n))}nthSequenceNumber(e,t){if(t===0)return G.resolve(Vn.ae);const n=new dx(t);return this.tr.forEachTarget(e,i=>n.Zn(i.sequenceNumber)).next(()=>this.tr.rr(e,i=>n.Zn(i))).next(()=>n.maxValue)}removeTargets(e,t,n){return this.tr.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.tr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(oe("LruGarbageCollector","Garbage collection skipped; disabled"),G.resolve(r_)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(oe("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),r_):this.ir(e,t))}getCacheSize(e){return this.tr.getCacheSize(e)}ir(e,t){let n,i,a,u,c,d,p;const g=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(_=>(_>this.params.maximumSequenceNumbersToCollect?(oe("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${_}`),i=this.params.maximumSequenceNumbersToCollect):i=_,u=Date.now(),this.nthSequenceNumber(e,i))).next(_=>(n=_,c=Date.now(),this.removeTargets(e,n,t))).next(_=>(a=_,d=Date.now(),this.removeOrphanedDocuments(e,n))).next(_=>(p=Date.now(),da()<=Ye.DEBUG&&oe("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${u-g}ms
	Determined least recently used ${i} in `+(c-u)+`ms
	Removed ${a} targets in `+(d-c)+`ms
	Removed ${_} documents in `+(p-d)+`ms
Total Duration: ${p-g}ms`),G.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:a,documentsRemoved:_})))}}function Z0(r,e){return new fx(r,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class px{constructor(e,t){this.db=e,this.garbageCollector=Z0(this,t)}nr(e){const t=this.sr(e);return this.db.getTargetCache().getTargetCount(e).next(n=>t.next(i=>n+i))}sr(e){let t=0;return this.rr(e,n=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}rr(e,t){return this._r(e,(n,i)=>t(i))}addReference(e,t,n){return $c(e,n)}removeReference(e,t,n){return $c(e,n)}removeTargets(e,t,n){return this.db.getTargetCache().removeTargets(e,t,n)}markPotentiallyOrphaned(e,t){return $c(e,t)}ar(e,t){return function(i,a){let u=!1;return Q0(i).X(c=>H0(i,c,a).next(d=>(d&&(u=!0),G.resolve(!d)))).next(()=>u)}(e,t)}removeOrphanedDocuments(e,t){const n=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let a=0;return this._r(e,(u,c)=>{if(c<=t){const d=this.ar(e,u).next(p=>{if(!p)return a++,n.getEntry(e,u).next(()=>(n.removeEntry(u,De.min()),ai(e).delete(function(_){return[0,dn(_.path)]}(u))))});i.push(d)}}).next(()=>G.waitFor(i)).next(()=>n.apply(e)).next(()=>a)}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,n)}updateLimboDocument(e,t){return $c(e,t)}_r(e,t){const n=ai(e);let i,a=Vn.ae;return n.Z({index:Qp},([u,c],{path:d,sequenceNumber:p})=>{u===0?(a!==Vn.ae&&t(new ye(Jr(i)),a),a=p,i=d):a=Vn.ae}).next(()=>{a!==Vn.ae&&t(new ye(Jr(i)),a)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function $c(r,e){return ai(r).put(function(n,i){return{targetId:0,path:dn(n.path),sequenceNumber:i}}(e,r.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J0{constructor(){this.changes=new Ns(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,xt.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return n!==void 0?G.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mx{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,n){return Qi(e).put(n)}removeEntry(e,t,n){return Qi(e).delete(function(a,u){const c=a.path.toArray();return[c.slice(0,c.length-2),c[c.length-2],Eh(u),c[c.length-1]]}(t,n))}updateMetadata(e,t){return this.getMetadata(e).next(n=>(n.byteSize+=t,this.ur(e,n)))}getEntry(e,t){let n=xt.newInvalidDocument(t);return Qi(e).Z({index:Yc,range:IDBKeyRange.only(Rl(t))},(i,a)=>{n=this.cr(t,a)}).next(()=>n)}lr(e,t){let n={size:0,document:xt.newInvalidDocument(t)};return Qi(e).Z({index:Yc,range:IDBKeyRange.only(Rl(t))},(i,a)=>{n={document:this.cr(t,a),size:Ih(a)}}).next(()=>n)}getEntries(e,t){let n=hr();return this.hr(e,t,(i,a)=>{const u=this.cr(i,a);n=n.insert(i,u)}).next(()=>n)}Pr(e,t){let n=hr(),i=new mt(ye.comparator);return this.hr(e,t,(a,u)=>{const c=this.cr(a,u);n=n.insert(a,c),i=i.insert(a,Ih(u))}).next(()=>({documents:n,Tr:i}))}hr(e,t,n){if(t.isEmpty())return G.resolve();let i=new rt(u_);t.forEach(d=>i=i.add(d));const a=IDBKeyRange.bound(Rl(i.first()),Rl(i.last())),u=i.getIterator();let c=u.getNext();return Qi(e).Z({index:Yc,range:a},(d,p,g)=>{const _=ye.fromSegments([...p.prefixPath,p.collectionGroup,p.documentId]);for(;c&&u_(c,_)<0;)n(c,null),c=u.getNext();c&&c.isEqual(_)&&(n(c,p),c=u.hasNext()?u.getNext():null),c?g.W(Rl(c)):g.done()}).next(()=>{for(;c;)n(c,null),c=u.hasNext()?u.getNext():null})}getDocumentsMatchingQuery(e,t,n,i,a){const u=t.path,c=[u.popLast().toArray(),u.lastSegment(),Eh(n.readTime),n.documentKey.path.isEmpty()?"":n.documentKey.path.lastSegment()],d=[u.popLast().toArray(),u.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Qi(e).G(IDBKeyRange.bound(c,d,!0)).next(p=>{a==null||a.incrementDocumentReadCount(p.length);let g=hr();for(const _ of p){const E=this.cr(ye.fromSegments(_.prefixPath.concat(_.collectionGroup,_.documentId)),_);E.isFoundDocument()&&(cu(t,E)||i.has(E.key))&&(g=g.insert(E.key,E))}return g})}getAllFromCollectionGroup(e,t,n,i){let a=hr();const u=l_(t,n),c=l_(t,Xn.max());return Qi(e).Z({index:Ww,range:IDBKeyRange.bound(u,c,!0)},(d,p,g)=>{const _=this.cr(ye.fromSegments(p.prefixPath.concat(p.collectionGroup,p.documentId)),p);a=a.insert(_.key,_),a.size===i&&g.done()}).next(()=>a)}newChangeBuffer(e){return new gx(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return a_(e).get(dp).next(t=>(ke(!!t),t))}ur(e,t){return a_(e).put(dp,t)}cr(e,t){if(t){const n=tx(this.serializer,t);if(!(n.isNoDocument()&&n.version.isEqual(De.min())))return n}return xt.newInvalidDocument(e)}}function eE(r){return new mx(r)}class gx extends J0{constructor(e,t){super(),this.Ir=e,this.trackRemovals=t,this.Er=new Ns(n=>n.toString(),(n,i)=>n.isEqual(i))}applyChanges(e){const t=[];let n=0,i=new rt((a,u)=>ze(a.canonicalString(),u.canonicalString()));return this.changes.forEach((a,u)=>{const c=this.Er.get(a);if(t.push(this.Ir.removeEntry(e,a,c.readTime)),u.isValidDocument()){const d=qv(this.Ir.serializer,u);i=i.add(a.path.popLast());const p=Ih(d);n+=p-c.size,t.push(this.Ir.addEntry(e,a,d))}else if(n-=c.size,this.trackRemovals){const d=qv(this.Ir.serializer,u.convertToNoDocument(De.min()));t.push(this.Ir.addEntry(e,a,d))}}),i.forEach(a=>{t.push(this.Ir.indexManager.addToCollectionParentIndex(e,a))}),t.push(this.Ir.updateMetadata(e,n)),G.waitFor(t)}getFromCache(e,t){return this.Ir.lr(e,t).next(n=>(this.Er.set(t,{size:n.size,readTime:n.document.readTime}),n.document))}getAllFromCache(e,t){return this.Ir.Pr(e,t).next(({documents:n,Tr:i})=>(i.forEach((a,u)=>{this.Er.set(a,{size:u,readTime:n.get(a).readTime})}),n))}}function a_(r){return Ut(r,Hl)}function Qi(r){return Ut(r,ch)}function Rl(r){const e=r.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function l_(r,e){const t=e.documentKey.path.toArray();return[r,Eh(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function u_(r,e){const t=r.path.toArray(),n=e.path.toArray();let i=0;for(let a=0;a<t.length-2&&a<n.length-2;++a)if(i=ze(t[a],n[a]),i)return i;return i=ze(t.length,n.length),i||(i=ze(t[t.length-2],n[n.length-2]),i||ze(t[t.length-1],n[n.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yx{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tE{constructor(e,t,n,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=i}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(n=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(n!==null&&Bl(n.mutation,i,Es.empty(),Qt.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(n=>this.getLocalViewOfDocuments(e,n,qe()).next(()=>n))}getLocalViewOfDocuments(e,t,n=qe()){const i=es();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,n).next(a=>{let u=bl();return a.forEach((c,d)=>{u=u.insert(c,d.overlayedDocument)}),u}))}getOverlayedDocuments(e,t){const n=es();return this.populateOverlays(e,n,t).next(()=>this.computeViews(e,t,n,qe()))}populateOverlays(e,t,n){const i=[];return n.forEach(a=>{t.has(a)||i.push(a)}),this.documentOverlayCache.getOverlays(e,i).next(a=>{a.forEach((u,c)=>{t.set(u,c)})})}computeViews(e,t,n,i){let a=hr();const u=jl(),c=function(){return jl()}();return t.forEach((d,p)=>{const g=n.get(p.key);i.has(p.key)&&(g===void 0||g.mutation instanceof La)?a=a.insert(p.key,p):g!==void 0?(u.set(p.key,g.mutation.getFieldMask()),Bl(g.mutation,p,g.mutation.getFieldMask(),Qt.now())):u.set(p.key,Es.empty())}),this.recalculateAndSaveOverlays(e,a).next(d=>(d.forEach((p,g)=>u.set(p,g)),t.forEach((p,g)=>{var _;return c.set(p,new yx(g,(_=u.get(p))!==null&&_!==void 0?_:null))}),c))}recalculateAndSaveOverlays(e,t){const n=jl();let i=new mt((u,c)=>u-c),a=qe();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(u=>{for(const c of u)c.keys().forEach(d=>{const p=t.get(d);if(p===null)return;let g=n.get(d)||Es.empty();g=c.applyToLocalView(p,g),n.set(d,g);const _=(i.get(c.batchId)||qe()).add(d);i=i.insert(c.batchId,_)})}).next(()=>{const u=[],c=i.getReverseIterator();for(;c.hasNext();){const d=c.getNext(),p=d.key,g=d.value,_=w0();g.forEach(E=>{if(!a.has(E)){const C=S0(t.get(E),n.get(E));C!==null&&_.set(E,C),a=a.add(E)}}),u.push(this.documentOverlayCache.saveOverlays(e,p,_))}return G.waitFor(u)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,t,n,i){return function(u){return ye.isDocumentKey(u.path)&&u.collectionGroup===null&&u.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):_A(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,i):this.getDocumentsMatchingCollectionQuery(e,t,n,i)}getNextDocuments(e,t,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,i).next(a=>{const u=i-a.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,i-a.size):G.resolve(es());let c=Ea,d=a;return u.next(p=>G.forEach(p,(g,_)=>(c<_.largestBatchId&&(c=_.largestBatchId),a.get(g)?G.resolve():this.remoteDocumentCache.getEntry(e,g).next(E=>{d=d.insert(g,E)}))).next(()=>this.populateOverlays(e,p,a)).next(()=>this.computeViews(e,d,p,qe())).next(g=>({batchId:c,changes:IA(g)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new ye(t)).next(n=>{let i=bl();return n.isFoundDocument()&&(i=i.insert(n.key,n)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,n,i){const a=t.collectionGroup;let u=bl();return this.indexManager.getCollectionParents(e,a).next(c=>G.forEach(c,d=>{const p=function(_,E){return new qh(E,null,_.explicitOrderBy.slice(),_.filters.slice(),_.limit,_.limitType,_.startAt,_.endAt)}(t,d.child(a));return this.getDocumentsMatchingCollectionQuery(e,p,n,i).next(g=>{g.forEach((_,E)=>{u=u.insert(_,E)})})}).next(()=>u))}getDocumentsMatchingCollectionQuery(e,t,n,i){let a;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next(u=>(a=u,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,a,i))).next(u=>{a.forEach((d,p)=>{const g=p.getKey();u.get(g)===null&&(u=u.insert(g,xt.newInvalidDocument(g)))});let c=bl();return u.forEach((d,p)=>{const g=a.get(d);g!==void 0&&Bl(g.mutation,p,Es.empty(),Qt.now()),cu(t,p)&&(c=c.insert(d,p))}),c})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vx{constructor(e){this.serializer=e,this.dr=new Map,this.Ar=new Map}getBundleMetadata(e,t){return G.resolve(this.dr.get(t))}saveBundleMetadata(e,t){return this.dr.set(t.id,function(i){return{id:i.id,version:i.version,createTime:In(i.createTime)}}(t)),G.resolve()}getNamedQuery(e,t){return G.resolve(this.Ar.get(t))}saveNamedQuery(e,t){return this.Ar.set(t.name,function(i){return{name:i.name,query:$0(i.bundledQuery),readTime:In(i.readTime)}}(t)),G.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _x{constructor(){this.overlays=new mt(ye.comparator),this.Rr=new Map}getOverlay(e,t){return G.resolve(this.overlays.get(t))}getOverlays(e,t){const n=es();return G.forEach(t,i=>this.getOverlay(e,i).next(a=>{a!==null&&n.set(i,a)})).next(()=>n)}saveOverlays(e,t,n){return n.forEach((i,a)=>{this.Et(e,t,a)}),G.resolve()}removeOverlaysForBatchId(e,t,n){const i=this.Rr.get(n);return i!==void 0&&(i.forEach(a=>this.overlays=this.overlays.remove(a)),this.Rr.delete(n)),G.resolve()}getOverlaysForCollection(e,t,n){const i=es(),a=t.length+1,u=new ye(t.child("")),c=this.overlays.getIteratorFrom(u);for(;c.hasNext();){const d=c.getNext().value,p=d.getKey();if(!t.isPrefixOf(p.path))break;p.path.length===a&&d.largestBatchId>n&&i.set(d.getKey(),d)}return G.resolve(i)}getOverlaysForCollectionGroup(e,t,n,i){let a=new mt((p,g)=>p-g);const u=this.overlays.getIterator();for(;u.hasNext();){const p=u.getNext().value;if(p.getKey().getCollectionGroup()===t&&p.largestBatchId>n){let g=a.get(p.largestBatchId);g===null&&(g=es(),a=a.insert(p.largestBatchId,g)),g.set(p.getKey(),p)}}const c=es(),d=a.getIterator();for(;d.hasNext()&&(d.getNext().value.forEach((p,g)=>c.set(p,g)),!(c.size()>=i)););return G.resolve(c)}Et(e,t,n){const i=this.overlays.get(n.key);if(i!==null){const u=this.Rr.get(i.largestBatchId).delete(n.key);this.Rr.set(i.largestBatchId,u)}this.overlays=this.overlays.insert(n.key,new om(t,n));let a=this.Rr.get(t);a===void 0&&(a=qe(),this.Rr.set(t,a)),this.Rr.set(t,a.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wx{constructor(){this.sessionToken=Vt.EMPTY_BYTE_STRING}getSessionToken(e){return G.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,G.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cm{constructor(){this.Vr=new rt(Ht.mr),this.gr=new rt(Ht.pr)}isEmpty(){return this.Vr.isEmpty()}addReference(e,t){const n=new Ht(e,t);this.Vr=this.Vr.add(n),this.gr=this.gr.add(n)}yr(e,t){e.forEach(n=>this.addReference(n,t))}removeReference(e,t){this.wr(new Ht(e,t))}br(e,t){e.forEach(n=>this.removeReference(n,t))}Sr(e){const t=new ye(new at([])),n=new Ht(t,e),i=new Ht(t,e+1),a=[];return this.gr.forEachInRange([n,i],u=>{this.wr(u),a.push(u.key)}),a}Dr(){this.Vr.forEach(e=>this.wr(e))}wr(e){this.Vr=this.Vr.delete(e),this.gr=this.gr.delete(e)}vr(e){const t=new ye(new at([])),n=new Ht(t,e),i=new Ht(t,e+1);let a=qe();return this.gr.forEachInRange([n,i],u=>{a=a.add(u.key)}),a}containsKey(e){const t=new Ht(e,0),n=this.Vr.firstAfterOrEqual(t);return n!==null&&e.isEqual(n.key)}}class Ht{constructor(e,t){this.key=e,this.Cr=t}static mr(e,t){return ye.comparator(e.key,t.key)||ze(e.Cr,t.Cr)}static pr(e,t){return ze(e.Cr,t.Cr)||ye.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ex{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Fr=1,this.Mr=new rt(Ht.mr)}checkEmpty(e){return G.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,n,i){const a=this.Fr;this.Fr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const u=new sm(a,t,n,i);this.mutationQueue.push(u);for(const c of i)this.Mr=this.Mr.add(new Ht(c.key,a)),this.indexManager.addToCollectionParentIndex(e,c.key.path.popLast());return G.resolve(u)}lookupMutationBatch(e,t){return G.resolve(this.Or(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,i=this.Nr(n),a=i<0?0:i;return G.resolve(this.mutationQueue.length>a?this.mutationQueue[a]:null)}getHighestUnacknowledgedBatchId(){return G.resolve(this.mutationQueue.length===0?io:this.Fr-1)}getAllMutationBatches(e){return G.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new Ht(t,0),i=new Ht(t,Number.POSITIVE_INFINITY),a=[];return this.Mr.forEachInRange([n,i],u=>{const c=this.Or(u.Cr);a.push(c)}),G.resolve(a)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new rt(ze);return t.forEach(i=>{const a=new Ht(i,0),u=new Ht(i,Number.POSITIVE_INFINITY);this.Mr.forEachInRange([a,u],c=>{n=n.add(c.Cr)})}),G.resolve(this.Br(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,i=n.length+1;let a=n;ye.isDocumentKey(a)||(a=a.child(""));const u=new Ht(new ye(a),0);let c=new rt(ze);return this.Mr.forEachWhile(d=>{const p=d.key.path;return!!n.isPrefixOf(p)&&(p.length===i&&(c=c.add(d.Cr)),!0)},u),G.resolve(this.Br(c))}Br(e){const t=[];return e.forEach(n=>{const i=this.Or(n);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){ke(this.Lr(t.batchId,"removed")===0),this.mutationQueue.shift();let n=this.Mr;return G.forEach(t.mutations,i=>{const a=new Ht(i.key,t.batchId);return n=n.delete(a),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Mr=n})}qn(e){}containsKey(e,t){const n=new Ht(t,0),i=this.Mr.firstAfterOrEqual(n);return G.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,G.resolve()}Lr(e,t){return this.Nr(e)}Nr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Or(e){const t=this.Nr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tx{constructor(e){this.kr=e,this.docs=function(){return new mt(ye.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,i=this.docs.get(n),a=i?i.size:0,u=this.kr(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:u}),this.size+=u-a,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return G.resolve(n?n.document.mutableCopy():xt.newInvalidDocument(t))}getEntries(e,t){let n=hr();return t.forEach(i=>{const a=this.docs.get(i);n=n.insert(i,a?a.document.mutableCopy():xt.newInvalidDocument(i))}),G.resolve(n)}getDocumentsMatchingQuery(e,t,n,i){let a=hr();const u=t.path,c=new ye(u.child("__id-9223372036854775808__")),d=this.docs.getIteratorFrom(c);for(;d.hasNext();){const{key:p,value:{document:g}}=d.getNext();if(!u.isPrefixOf(p.path))break;p.path.length>u.length+1||Kp(jw(g),n)<=0||(i.has(g.key)||cu(t,g))&&(a=a.insert(g.key,g.mutableCopy()))}return G.resolve(a)}getAllFromCollectionGroup(e,t,n,i){Ae()}qr(e,t){return G.forEach(this.docs,n=>t(n))}newChangeBuffer(e){return new Ix(this)}getSize(e){return G.resolve(this.size)}}class Ix extends J0{constructor(e){super(),this.Ir=e}applyChanges(e){const t=[];return this.changes.forEach((n,i)=>{i.isValidDocument()?t.push(this.Ir.addEntry(e,i)):this.Ir.removeEntry(n)}),G.waitFor(t)}getFromCache(e,t){return this.Ir.getEntry(e,t)}getAllFromCache(e,t){return this.Ir.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sx{constructor(e){this.persistence=e,this.Qr=new Ns(t=>ho(t),uu),this.lastRemoteSnapshotVersion=De.min(),this.highestTargetId=0,this.$r=0,this.Kr=new cm,this.targetCount=0,this.Ur=mo.Kn()}forEachTarget(e,t){return this.Qr.forEach((n,i)=>t(i)),G.resolve()}getLastRemoteSnapshotVersion(e){return G.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return G.resolve(this.$r)}allocateTargetId(e){return this.highestTargetId=this.Ur.next(),G.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.$r&&(this.$r=t),G.resolve()}zn(e){this.Qr.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.Ur=new mo(t),this.highestTargetId=t),e.sequenceNumber>this.$r&&(this.$r=e.sequenceNumber)}addTargetData(e,t){return this.zn(t),this.targetCount+=1,G.resolve()}updateTargetData(e,t){return this.zn(t),G.resolve()}removeTargetData(e,t){return this.Qr.delete(t.target),this.Kr.Sr(t.targetId),this.targetCount-=1,G.resolve()}removeTargets(e,t,n){let i=0;const a=[];return this.Qr.forEach((u,c)=>{c.sequenceNumber<=t&&n.get(c.targetId)===null&&(this.Qr.delete(u),a.push(this.removeMatchingKeysForTargetId(e,c.targetId)),i++)}),G.waitFor(a).next(()=>i)}getTargetCount(e){return G.resolve(this.targetCount)}getTargetData(e,t){const n=this.Qr.get(t)||null;return G.resolve(n)}addMatchingKeys(e,t,n){return this.Kr.yr(t,n),G.resolve()}removeMatchingKeys(e,t,n){this.Kr.br(t,n);const i=this.persistence.referenceDelegate,a=[];return i&&t.forEach(u=>{a.push(i.markPotentiallyOrphaned(e,u))}),G.waitFor(a)}removeMatchingKeysForTargetId(e,t){return this.Kr.Sr(t),G.resolve()}getMatchingKeysForTargetId(e,t){const n=this.Kr.vr(t);return G.resolve(n)}containsKey(e,t){return G.resolve(this.Kr.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hm{constructor(e,t){this.Wr={},this.overlays={},this.Gr=new Vn(0),this.zr=!1,this.zr=!0,this.jr=new wx,this.referenceDelegate=e(this),this.Hr=new Sx(this),this.indexManager=new ux,this.remoteDocumentCache=function(i){return new Tx(i)}(n=>this.referenceDelegate.Jr(n)),this.serializer=new z0(t),this.Yr=new vx(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.zr=!1,Promise.resolve()}get started(){return this.zr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new _x,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.Wr[e.toKey()];return n||(n=new Ex(t,this.referenceDelegate),this.Wr[e.toKey()]=n),n}getGlobalsCache(){return this.jr}getTargetCache(){return this.Hr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Yr}runTransaction(e,t,n){oe("MemoryPersistence","Starting transaction:",e);const i=new Cx(this.Gr.next());return this.referenceDelegate.Zr(),n(i).next(a=>this.referenceDelegate.Xr(i).next(()=>a)).toPromise().then(a=>(i.raiseOnCommittedEvent(),a))}ei(e,t){return G.or(Object.values(this.Wr).map(n=>()=>n.containsKey(e,t)))}}class Cx extends zw{constructor(e){super(),this.currentSequenceNumber=e}}class Zh{constructor(e){this.persistence=e,this.ti=new cm,this.ni=null}static ri(e){return new Zh(e)}get ii(){if(this.ni)return this.ni;throw Ae()}addReference(e,t,n){return this.ti.addReference(n,t),this.ii.delete(n.toString()),G.resolve()}removeReference(e,t,n){return this.ti.removeReference(n,t),this.ii.add(n.toString()),G.resolve()}markPotentiallyOrphaned(e,t){return this.ii.add(t.toString()),G.resolve()}removeTarget(e,t){this.ti.Sr(t.targetId).forEach(i=>this.ii.add(i.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(a=>this.ii.add(a.toString()))}).next(()=>n.removeTargetData(e,t))}Zr(){this.ni=new Set}Xr(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return G.forEach(this.ii,n=>{const i=ye.fromPath(n);return this.si(e,i).next(a=>{a||t.removeEntry(i,De.min())})}).next(()=>(this.ni=null,t.apply(e)))}updateLimboDocument(e,t){return this.si(e,t).next(n=>{n?this.ii.delete(t.toString()):this.ii.add(t.toString())})}Jr(e){return 0}si(e,t){return G.or([()=>G.resolve(this.ti.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.ei(e,t)])}}class Sh{constructor(e,t){this.persistence=e,this.oi=new Ns(n=>dn(n.path),(n,i)=>n.isEqual(i)),this.garbageCollector=Z0(this,t)}static ri(e,t){return new Sh(e,t)}Zr(){}Xr(e){return G.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}nr(e){const t=this.sr(e);return this.persistence.getTargetCache().getTargetCount(e).next(n=>t.next(i=>n+i))}sr(e){let t=0;return this.rr(e,n=>{t++}).next(()=>t)}rr(e,t){return G.forEach(this.oi,(n,i)=>this.ar(e,n,i).next(a=>a?G.resolve():t(i)))}removeTargets(e,t,n){return this.persistence.getTargetCache().removeTargets(e,t,n)}removeOrphanedDocuments(e,t){let n=0;const i=this.persistence.getRemoteDocumentCache(),a=i.newChangeBuffer();return i.qr(e,u=>this.ar(e,u,t).next(c=>{c||(n++,a.removeEntry(u,De.min()))})).next(()=>a.apply(e)).next(()=>n)}markPotentiallyOrphaned(e,t){return this.oi.set(t,e.currentSequenceNumber),G.resolve()}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,t,n){return this.oi.set(n,e.currentSequenceNumber),G.resolve()}removeReference(e,t,n){return this.oi.set(n,e.currentSequenceNumber),G.resolve()}updateLimboDocument(e,t){return this.oi.set(t,e.currentSequenceNumber),G.resolve()}Jr(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Jc(e.data.value)),t}ar(e,t,n){return G.or([()=>this.persistence.ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const i=this.oi.get(t);return G.resolve(i!==void 0&&i>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ax{constructor(e){this.serializer=e}B(e,t,n,i){const a=new Lh("createOrUpgrade",t);n<1&&i>=1&&(function(d){d.createObjectStore(au)}(e),function(d){d.createObjectStore(Kl,{keyPath:MC}),d.createObjectStore(Dr,{keyPath:Ev,autoIncrement:!0}).createIndex(so,Tv,{unique:!0}),d.createObjectStore(Ta)}(e),c_(e),function(d){d.createObjectStore(Ji)}(e));let u=G.resolve();return n<3&&i>=3&&(n!==0&&(function(d){d.deleteObjectStore(Sa),d.deleteObjectStore(Ia),d.deleteObjectStore(oo)}(e),c_(e)),u=u.next(()=>function(d){const p=d.store(oo),g={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:De.min().toTimestamp(),targetCount:0};return p.put(hh,g)}(a))),n<4&&i>=4&&(n!==0&&(u=u.next(()=>function(d,p){return p.store(Dr).G().next(_=>{d.deleteObjectStore(Dr),d.createObjectStore(Dr,{keyPath:Ev,autoIncrement:!0}).createIndex(so,Tv,{unique:!0});const E=p.store(Dr),C=_.map(A=>E.put(A));return G.waitFor(C)})}(e,a))),u=u.next(()=>{(function(d){d.createObjectStore(Ca,{keyPath:WC})})(e)})),n<5&&i>=5&&(u=u.next(()=>this._i(a))),n<6&&i>=6&&(u=u.next(()=>(function(d){d.createObjectStore(Hl)}(e),this.ai(a)))),n<7&&i>=7&&(u=u.next(()=>this.ui(a))),n<8&&i>=8&&(u=u.next(()=>this.ci(e,a))),n<9&&i>=9&&(u=u.next(()=>{(function(d){d.objectStoreNames.contains("remoteDocumentChanges")&&d.deleteObjectStore("remoteDocumentChanges")})(e)})),n<10&&i>=10&&(u=u.next(()=>this.li(a))),n<11&&i>=11&&(u=u.next(()=>{(function(d){d.createObjectStore(Bh,{keyPath:qC})})(e),function(d){d.createObjectStore(zh,{keyPath:GC})}(e)})),n<12&&i>=12&&(u=u.next(()=>{(function(d){const p=d.createObjectStore(Uh,{keyPath:JC});p.createIndex(pp,eA,{unique:!1}),p.createIndex(Hw,tA,{unique:!1})})(e)})),n<13&&i>=13&&(u=u.next(()=>function(d){const p=d.createObjectStore(ch,{keyPath:FC});p.createIndex(Yc,LC),p.createIndex(Ww,jC)}(e)).next(()=>this.hi(e,a)).next(()=>e.deleteObjectStore(Ji))),n<14&&i>=14&&(u=u.next(()=>this.Pi(e,a))),n<15&&i>=15&&(u=u.next(()=>function(d){d.createObjectStore(Xp,{keyPath:KC,autoIncrement:!0}).createIndex(fp,HC,{unique:!1}),d.createObjectStore(dh,{keyPath:QC}).createIndex(Gw,XC,{unique:!1}),d.createObjectStore(fh,{keyPath:YC}).createIndex(Kw,ZC,{unique:!1})}(e))),n<16&&i>=16&&(u=u.next(()=>{t.objectStore(dh).clear()}).next(()=>{t.objectStore(fh).clear()})),n<17&&i>=17&&(u=u.next(()=>{(function(d){d.createObjectStore(Yp,{keyPath:nA})})(e)})),u}ai(e){let t=0;return e.store(Ji).Z((n,i)=>{t+=Ih(i)}).next(()=>{const n={byteSize:t};return e.store(Hl).put(dp,n)})}_i(e){const t=e.store(Kl),n=e.store(Dr);return t.G().next(i=>G.forEach(i,a=>{const u=IDBKeyRange.bound([a.userId,io],[a.userId,a.lastAcknowledgedBatchId]);return n.G(so,u).next(c=>G.forEach(c,d=>{ke(d.userId===a.userId);const p=to(this.serializer,d);return K0(e,a.userId,p).next(()=>{})}))}))}ui(e){const t=e.store(Sa),n=e.store(Ji);return e.store(oo).get(hh).next(i=>{const a=[];return n.Z((u,c)=>{const d=new at(u),p=function(_){return[0,dn(_)]}(d);a.push(t.get(p).next(g=>g?G.resolve():(_=>t.put({targetId:0,path:dn(_),sequenceNumber:i.highestListenSequenceNumber}))(d)))}).next(()=>G.waitFor(a))})}ci(e,t){e.createObjectStore(Ql,{keyPath:$C});const n=t.store(Ql),i=new um,a=u=>{if(i.add(u)){const c=u.lastSegment(),d=u.popLast();return n.put({collectionId:c,parent:dn(d)})}};return t.store(Ji).Z({Y:!0},(u,c)=>{const d=new at(u);return a(d.popLast())}).next(()=>t.store(Ta).Z({Y:!0},([u,c,d],p)=>{const g=Jr(c);return a(g.popLast())}))}li(e){const t=e.store(Ia);return t.Z((n,i)=>{const a=Vl(i),u=U0(this.serializer,a);return t.put(u)})}hi(e,t){const n=t.store(Ji),i=[];return n.Z((a,u)=>{const c=t.store(ch),d=function(_){return _.document?new ye(at.fromString(_.document.name).popFirst(5)):_.noDocument?ye.fromSegments(_.noDocument.path):_.unknownDocument?ye.fromSegments(_.unknownDocument.path):Ae()}(u).path.toArray(),p={prefixPath:d.slice(0,d.length-2),collectionGroup:d[d.length-2],documentId:d[d.length-1],readTime:u.readTime||[0,0],unknownDocument:u.unknownDocument,noDocument:u.noDocument,document:u.document,hasCommittedMutations:!!u.hasCommittedMutations};i.push(c.put(p))}).next(()=>G.waitFor(i))}Pi(e,t){const n=t.store(Dr),i=eE(this.serializer),a=new hm(Zh.ri,this.serializer.Tt);return n.G().next(u=>{const c=new Map;return u.forEach(d=>{var p;let g=(p=c.get(d.userId))!==null&&p!==void 0?p:qe();to(this.serializer,d).keys().forEach(_=>g=g.add(_)),c.set(d.userId,g)}),G.forEach(c,(d,p)=>{const g=new cn(p),_=Xh.It(this.serializer,g),E=a.getIndexManager(g),C=Yh.It(g,this.serializer,E,a.referenceDelegate);return new tE(i,C,_,E).recalculateAndSaveOverlaysForDocumentKeys(new mp(t,Vn.ae),d).next()})})}}function c_(r){r.createObjectStore(Sa,{keyPath:zC}).createIndex(Qp,UC,{unique:!0}),r.createObjectStore(Ia,{keyPath:"targetId"}).createIndex(qw,BC,{unique:!0}),r.createObjectStore(oo)}const ri="IndexedDbPersistence",Kf=18e5,Hf=5e3,Qf="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",xx="main";class dm{constructor(e,t,n,i,a,u,c,d,p,g,_=17){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=n,this.Ti=a,this.window=u,this.document=c,this.Ii=p,this.Ei=g,this.di=_,this.Gr=null,this.zr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Ai=null,this.inForeground=!1,this.Ri=null,this.Vi=null,this.mi=Number.NEGATIVE_INFINITY,this.fi=E=>Promise.resolve(),!dm.D())throw new Ce(se.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new px(this,i),this.gi=t+xx,this.serializer=new z0(d),this.pi=new pi(this.gi,this.di,new Ax(this.serializer)),this.jr=new rx,this.Hr=new hx(this.referenceDelegate,this.serializer),this.remoteDocumentCache=eE(this.serializer),this.Yr=new nx,this.window&&this.window.localStorage?this.yi=this.window.localStorage:(this.yi=null,g===!1&&bt(ri,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.wi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new Ce(se.FAILED_PRECONDITION,Qf);return this.bi(),this.Si(),this.Di(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Hr.getHighestSequenceNumber(e))}).then(e=>{this.Gr=new Vn(e,this.Ii)}).then(()=>{this.zr=!0}).catch(e=>(this.pi&&this.pi.close(),Promise.reject(e)))}Ci(e){return this.fi=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.pi.k(async t=>{t.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Ti.enqueueAndForget(async()=>{this.started&&await this.wi()}))}wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>Wc(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.Fi(e).next(t=>{t||(this.isPrimary=!1,this.Ti.enqueueRetryable(()=>this.fi(!1)))})}).next(()=>this.Mi(e)).next(t=>this.isPrimary&&!t?this.xi(e).next(()=>!1):!!t&&this.Oi(e).next(()=>!0))).catch(e=>{if(wi(e))return oe(ri,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return oe(ri,"Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.Ti.enqueueRetryable(()=>this.fi(e)),this.isPrimary=e})}Fi(e){return Pl(e).get(oa).next(t=>G.resolve(this.Ni(t)))}Bi(e){return Wc(e).delete(this.clientId)}async Li(){if(this.isPrimary&&!this.ki(this.mi,Kf)){this.mi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",t=>{const n=Ut(t,Ca);return n.G().next(i=>{const a=this.qi(i,Kf),u=i.filter(c=>a.indexOf(c)===-1);return G.forEach(u,c=>n.delete(c.clientId)).next(()=>u)})}).catch(()=>[]);if(this.yi)for(const t of e)this.yi.removeItem(this.Qi(t.clientId))}}Di(){this.Vi=this.Ti.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.wi().then(()=>this.Li()).then(()=>this.Di()))}Ni(e){return!!e&&e.ownerId===this.clientId}Mi(e){return this.Ei?G.resolve(!0):Pl(e).get(oa).next(t=>{if(t!==null&&this.ki(t.leaseTimestampMs,Hf)&&!this.$i(t.ownerId)){if(this.Ni(t)&&this.networkEnabled)return!0;if(!this.Ni(t)){if(!t.allowTabSynchronization)throw new Ce(se.FAILED_PRECONDITION,Qf);return!1}}return!(!this.networkEnabled||!this.inForeground)||Wc(e).G().next(n=>this.qi(n,Hf).find(i=>{if(this.clientId!==i.clientId){const a=!this.networkEnabled&&i.networkEnabled,u=!this.inForeground&&i.inForeground,c=this.networkEnabled===i.networkEnabled;if(a||u&&c)return!0}return!1})===void 0)}).next(t=>(this.isPrimary!==t&&oe(ri,`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}async shutdown(){this.zr=!1,this.Ki(),this.Vi&&(this.Vi.cancel(),this.Vi=null),this.Ui(),this.Wi(),await this.pi.runTransaction("shutdown","readwrite",[au,Ca],e=>{const t=new mp(e,Vn.ae);return this.xi(t).next(()=>this.Bi(t))}),this.pi.close(),this.Gi()}qi(e,t){return e.filter(n=>this.ki(n.updateTimeMs,t)&&!this.$i(n.clientId))}zi(){return this.runTransaction("getActiveClients","readonly",e=>Wc(e).G().next(t=>this.qi(t,Kf).map(n=>n.clientId)))}get started(){return this.zr}getGlobalsCache(){return this.jr}getMutationQueue(e,t){return Yh.It(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Hr}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new cx(e,this.serializer.Tt.databaseId)}getDocumentOverlayCache(e){return Xh.It(this.serializer,e)}getBundleCache(){return this.Yr}runTransaction(e,t,n){oe(ri,"Starting transaction:",e);const i=t==="readonly"?"readonly":"readwrite",a=function(d){return d===17?iA:d===16?sA:d===15?Zp:d===14?Yw:d===13?Xw:d===12?rA:d===11?Qw:void Ae()}(this.di);let u;return this.pi.runTransaction(e,i,a,c=>(u=new mp(c,this.Gr?this.Gr.next():Vn.ae),t==="readwrite-primary"?this.Fi(u).next(d=>!!d||this.Mi(u)).next(d=>{if(!d)throw bt(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Ti.enqueueRetryable(()=>this.fi(!1)),new Ce(se.FAILED_PRECONDITION,Bw);return n(u)}).next(d=>this.Oi(u).next(()=>d)):this.ji(u).next(()=>n(u)))).then(c=>(u.raiseOnCommittedEvent(),c))}ji(e){return Pl(e).get(oa).next(t=>{if(t!==null&&this.ki(t.leaseTimestampMs,Hf)&&!this.$i(t.ownerId)&&!this.Ni(t)&&!(this.Ei||this.allowTabSynchronization&&t.allowTabSynchronization))throw new Ce(se.FAILED_PRECONDITION,Qf)})}Oi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Pl(e).put(oa,t)}static D(){return pi.D()}xi(e){const t=Pl(e);return t.get(oa).next(n=>this.Ni(n)?(oe(ri,"Releasing primary lease."),t.delete(oa)):G.resolve())}ki(e,t){const n=Date.now();return!(e<n-t)&&(!(e>n)||(bt(`Detected an update time that is in the future: ${e} > ${n}`),!1))}bi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ri=()=>{this.Ti.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.wi()))},this.document.addEventListener("visibilitychange",this.Ri),this.inForeground=this.document.visibilityState==="visible")}Ui(){this.Ri&&(this.document.removeEventListener("visibilitychange",this.Ri),this.Ri=null)}Si(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Ai=()=>{this.Ki();const t=/(?:Version|Mobile)\/1[456]/;yw()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.Ti.enterRestrictedMode(!0),this.Ti.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Ai))}Wi(){this.Ai&&(this.window.removeEventListener("pagehide",this.Ai),this.Ai=null)}$i(e){var t;try{const n=((t=this.yi)===null||t===void 0?void 0:t.getItem(this.Qi(e)))!==null;return oe(ri,`Client '${e}' ${n?"is":"is not"} zombied in LocalStorage`),n}catch(n){return bt(ri,"Failed to get zombied client id.",n),!1}}Ki(){if(this.yi)try{this.yi.setItem(this.Qi(this.clientId),String(Date.now()))}catch(e){bt("Failed to set zombie client id.",e)}}Gi(){if(this.yi)try{this.yi.removeItem(this.Qi(this.clientId))}catch{}}Qi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Pl(r){return Ut(r,au)}function Wc(r){return Ut(r,Ca)}function nE(r,e){let t=r.projectId;return r.isDefaultDatabase||(t+="."+r.database),"firestore/"+e+"/"+t+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fm{constructor(e,t,n,i){this.targetId=e,this.fromCache=t,this.Hi=n,this.Ji=i}static Yi(e,t){let n=qe(),i=qe();for(const a of t.docChanges)switch(a.type){case 0:n=n.add(a.doc.key);break;case 1:i=i.add(a.doc.key)}return new fm(e,t.fromCache,n,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nx{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rE{constructor(){this.Zi=!1,this.Xi=!1,this.es=100,this.ts=function(){return yw()?8:Uw(ih())>0?6:4}()}initialize(e,t){this.ns=e,this.indexManager=t,this.Zi=!0}getDocumentsMatchingQuery(e,t,n,i){const a={result:null};return this.rs(e,t).next(u=>{a.result=u}).next(()=>{if(!a.result)return this.ss(e,t,i,n).next(u=>{a.result=u})}).next(()=>{if(a.result)return;const u=new Nx;return this._s(e,t,u).next(c=>{if(a.result=c,this.Xi)return this.us(e,t,u,c.size)})}).next(()=>a.result)}us(e,t,n,i){return n.documentReadCount<this.es?(da()<=Ye.DEBUG&&oe("QueryEngine","SDK will not create cache indexes for query:",fa(t),"since it only creates cache indexes for collection contains","more than or equal to",this.es,"documents"),G.resolve()):(da()<=Ye.DEBUG&&oe("QueryEngine","Query:",fa(t),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.ts*i?(da()<=Ye.DEBUG&&oe("QueryEngine","The SDK decides to create cache indexes for query:",fa(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Qn(t))):G.resolve())}rs(e,t){if(Mv(t))return G.resolve(null);let n=Qn(t);return this.indexManager.getIndexType(e,n).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=Ep(t,null,"F"),n=Qn(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next(a=>{const u=qe(...a);return this.ns.getDocuments(e,u).next(c=>this.indexManager.getMinOffset(e,n).next(d=>{const p=this.cs(t,c);return this.ls(t,p,u,d.readTime)?this.rs(e,Ep(t,null,"F")):this.hs(e,p,t,d)}))})))}ss(e,t,n,i){return Mv(t)||i.isEqual(De.min())?G.resolve(null):this.ns.getDocuments(e,n).next(a=>{const u=this.cs(t,a);return this.ls(t,u,n,i)?G.resolve(null):(da()<=Ye.DEBUG&&oe("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),fa(t)),this.hs(e,u,t,Lw(i,Ea)).next(c=>c))})}cs(e,t){let n=new rt(v0(e));return t.forEach((i,a)=>{cu(e,a)&&(n=n.add(a))}),n}ls(e,t,n,i){if(e.limit===null)return!1;if(n.size!==t.size)return!0;const a=e.limitType==="F"?t.last():t.first();return!!a&&(a.hasPendingWrites||a.version.compareTo(i)>0)}_s(e,t,n){return da()<=Ye.DEBUG&&oe("QueryEngine","Using full collection scan to execute query:",fa(t)),this.ns.getDocumentsMatchingQuery(e,t,Xn.min(),n)}hs(e,t,n,i){return this.ns.getDocumentsMatchingQuery(e,n,i).next(a=>(t.forEach(u=>{a=a.insert(u.key,u)}),a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pm="LocalStore",Rx=3e8;class Px{constructor(e,t,n,i){this.persistence=e,this.Ps=t,this.serializer=i,this.Ts=new mt(ze),this.Is=new Ns(a=>ho(a),uu),this.Es=new Map,this.ds=e.getRemoteDocumentCache(),this.Hr=e.getTargetCache(),this.Yr=e.getBundleCache(),this.As(n)}As(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new tE(this.ds,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.ds.setIndexManager(this.indexManager),this.Ps.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Ts))}}function sE(r,e,t,n){return new Px(r,e,t,n)}async function iE(r,e){const t=Re(r);return await t.persistence.runTransaction("Handle user change","readonly",n=>{let i;return t.mutationQueue.getAllMutationBatches(n).next(a=>(i=a,t.As(e),t.mutationQueue.getAllMutationBatches(n))).next(a=>{const u=[],c=[];let d=qe();for(const p of i){u.push(p.batchId);for(const g of p.mutations)d=d.add(g.key)}for(const p of a){c.push(p.batchId);for(const g of p.mutations)d=d.add(g.key)}return t.localDocuments.getDocuments(n,d).next(p=>({Rs:p,removedBatchIds:u,addedBatchIds:c}))})})}function kx(r,e){const t=Re(r);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const i=e.batch.keys(),a=t.ds.newChangeBuffer({trackRemovals:!0});return function(c,d,p,g){const _=p.batch,E=_.keys();let C=G.resolve();return E.forEach(A=>{C=C.next(()=>g.getEntry(d,A)).next(P=>{const M=p.docVersions.get(A);ke(M!==null),P.version.compareTo(M)<0&&(_.applyToRemoteDocument(P,p),P.isValidDocument()&&(P.setReadTime(p.commitVersion),g.addEntry(P)))})}),C.next(()=>c.mutationQueue.removeMutationBatch(d,_))}(t,n,e,a).next(()=>a.apply(n)).next(()=>t.mutationQueue.performConsistencyCheck(n)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(n,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(c){let d=qe();for(let p=0;p<c.mutationResults.length;++p)c.mutationResults[p].transformResults.length>0&&(d=d.add(c.batch.mutations[p].key));return d}(e))).next(()=>t.localDocuments.getDocuments(n,i))})}function oE(r){const e=Re(r);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Hr.getLastRemoteSnapshotVersion(t))}function bx(r,e){const t=Re(r),n=e.snapshotVersion;let i=t.Ts;return t.persistence.runTransaction("Apply remote event","readwrite-primary",a=>{const u=t.ds.newChangeBuffer({trackRemovals:!0});i=t.Ts;const c=[];e.targetChanges.forEach((g,_)=>{const E=i.get(_);if(!E)return;c.push(t.Hr.removeMatchingKeys(a,g.removedDocuments,_).next(()=>t.Hr.addMatchingKeys(a,g.addedDocuments,_)));let C=E.withSequenceNumber(a.currentSequenceNumber);e.targetMismatches.get(_)!==null?C=C.withResumeToken(Vt.EMPTY_BYTE_STRING,De.min()).withLastLimboFreeSnapshotVersion(De.min()):g.resumeToken.approximateByteSize()>0&&(C=C.withResumeToken(g.resumeToken,n)),i=i.insert(_,C),function(P,M,U){return P.resumeToken.approximateByteSize()===0||M.snapshotVersion.toMicroseconds()-P.snapshotVersion.toMicroseconds()>=Rx?!0:U.addedDocuments.size+U.modifiedDocuments.size+U.removedDocuments.size>0}(E,C,g)&&c.push(t.Hr.updateTargetData(a,C))});let d=hr(),p=qe();if(e.documentUpdates.forEach(g=>{e.resolvedLimboDocuments.has(g)&&c.push(t.persistence.referenceDelegate.updateLimboDocument(a,g))}),c.push(Dx(a,u,e.documentUpdates).next(g=>{d=g.Vs,p=g.fs})),!n.isEqual(De.min())){const g=t.Hr.getLastRemoteSnapshotVersion(a).next(_=>t.Hr.setTargetsMetadata(a,a.currentSequenceNumber,n));c.push(g)}return G.waitFor(c).next(()=>u.apply(a)).next(()=>t.localDocuments.getLocalViewOfDocuments(a,d,p)).next(()=>d)}).then(a=>(t.Ts=i,a))}function Dx(r,e,t){let n=qe(),i=qe();return t.forEach(a=>n=n.add(a)),e.getEntries(r,n).next(a=>{let u=hr();return t.forEach((c,d)=>{const p=a.get(c);d.isFoundDocument()!==p.isFoundDocument()&&(i=i.add(c)),d.isNoDocument()&&d.version.isEqual(De.min())?(e.removeEntry(c,d.readTime),u=u.insert(c,d)):!p.isValidDocument()||d.version.compareTo(p.version)>0||d.version.compareTo(p.version)===0&&p.hasPendingWrites?(e.addEntry(d),u=u.insert(c,d)):oe(pm,"Ignoring outdated watch update for ",c,". Current version:",p.version," Watch version:",d.version)}),{Vs:u,fs:i}})}function Vx(r,e){const t=Re(r);return t.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=io),t.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function Ch(r,e){const t=Re(r);return t.persistence.runTransaction("Allocate target","readwrite",n=>{let i;return t.Hr.getTargetData(n,e).next(a=>a?(i=a,G.resolve(i)):t.Hr.allocateTargetId(n).next(u=>(i=new Ts(e,u,"TargetPurposeListen",n.currentSequenceNumber),t.Hr.addTargetData(n,i).next(()=>i))))}).then(n=>{const i=t.Ts.get(n.targetId);return(i===null||n.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.Ts=t.Ts.insert(n.targetId,n),t.Is.set(e,n.targetId)),n})}async function ka(r,e,t){const n=Re(r),i=n.Ts.get(e),a=t?"readwrite":"readwrite-primary";try{t||await n.persistence.runTransaction("Release target",a,u=>n.persistence.referenceDelegate.removeTarget(u,i))}catch(u){if(!wi(u))throw u;oe(pm,`Failed to update sequence numbers for target ${e}: ${u}`)}n.Ts=n.Ts.remove(e),n.Is.delete(i.target)}function Rp(r,e,t){const n=Re(r);let i=De.min(),a=qe();return n.persistence.runTransaction("Execute query","readwrite",u=>function(d,p,g){const _=Re(d),E=_.Is.get(g);return E!==void 0?G.resolve(_.Ts.get(E)):_.Hr.getTargetData(p,g)}(n,u,Qn(e)).next(c=>{if(c)return i=c.lastLimboFreeSnapshotVersion,n.Hr.getMatchingKeysForTargetId(u,c.targetId).next(d=>{a=d})}).next(()=>n.Ps.getDocumentsMatchingQuery(u,e,t?i:De.min(),t?a:qe())).next(c=>(uE(n,y0(e),c),{documents:c,gs:a})))}function aE(r,e){const t=Re(r),n=Re(t.Hr),i=t.Ts.get(e);return i?Promise.resolve(i.target):t.persistence.runTransaction("Get target data","readonly",a=>n.lt(a,e).next(u=>u?u.target:null))}function lE(r,e){const t=Re(r),n=t.Es.get(e)||De.min();return t.persistence.runTransaction("Get new document changes","readonly",i=>t.ds.getAllFromCollectionGroup(i,e,Lw(n,Ea),Number.MAX_SAFE_INTEGER)).then(i=>(uE(t,e,i),i))}function uE(r,e,t){let n=r.Es.get(e)||De.min();t.forEach((i,a)=>{a.readTime.compareTo(n)>0&&(n=a.readTime)}),r.Es.set(e,n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cE="firestore_clients";function h_(r,e){return`${cE}_${r}_${e}`}const hE="firestore_mutations";function d_(r,e,t){let n=`${hE}_${r}_${t}`;return e.isAuthenticated()&&(n+=`_${e.uid}`),n}const dE="firestore_targets";function Xf(r,e){return`${dE}_${r}_${e}`}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zr="SharedClientState";class Ah{constructor(e,t,n,i){this.user=e,this.batchId=t,this.state=n,this.error=i}static bs(e,t,n){const i=JSON.parse(n);let a,u=typeof i=="object"&&["pending","acknowledged","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return u&&i.error&&(u=typeof i.error.message=="string"&&typeof i.error.code=="string",u&&(a=new Ce(i.error.code,i.error.message))),u?new Ah(e,t,i.state,a):(bt(Zr,`Failed to parse mutation state for ID '${t}': ${n}`),null)}Ss(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class zl{constructor(e,t,n){this.targetId=e,this.state=t,this.error=n}static bs(e,t){const n=JSON.parse(t);let i,a=typeof n=="object"&&["not-current","current","rejected"].indexOf(n.state)!==-1&&(n.error===void 0||typeof n.error=="object");return a&&n.error&&(a=typeof n.error.message=="string"&&typeof n.error.code=="string",a&&(i=new Ce(n.error.code,n.error.message))),a?new zl(e,n.state,i):(bt(Zr,`Failed to parse target state for ID '${e}': ${t}`),null)}Ss(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class xh{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static bs(e,t){const n=JSON.parse(t);let i=typeof n=="object"&&n.activeTargetIds instanceof Array,a=nm();for(let u=0;i&&u<n.activeTargetIds.length;++u)i=DC(n.activeTargetIds[u]),a=a.add(n.activeTargetIds[u]);return i?new xh(e,a):(bt(Zr,`Failed to parse client data for instance '${e}': ${t}`),null)}}class mm{constructor(e,t){this.clientId=e,this.onlineState=t}static bs(e){const t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new mm(t.clientId,t.onlineState):(bt(Zr,`Failed to parse online state: ${e}`),null)}}class Pp{constructor(){this.activeTargetIds=nm()}Ds(e){this.activeTargetIds=this.activeTargetIds.add(e)}vs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ss(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Yf{constructor(e,t,n,i,a){this.window=e,this.Ti=t,this.persistenceKey=n,this.Cs=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.Fs=this.Ms.bind(this),this.xs=new mt(ze),this.started=!1,this.Os=[];const u=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=a,this.Ns=h_(this.persistenceKey,this.Cs),this.Bs=function(d){return`firestore_sequence_number_${d}`}(this.persistenceKey),this.xs=this.xs.insert(this.Cs,new Pp),this.Ls=new RegExp(`^${cE}_${u}_([^_]*)$`),this.ks=new RegExp(`^${hE}_${u}_(\\d+)(?:_(.*))?$`),this.qs=new RegExp(`^${dE}_${u}_(\\d+)$`),this.Qs=function(d){return`firestore_online_state_${d}`}(this.persistenceKey),this.$s=function(d){return`firestore_bundle_loaded_v2_${d}`}(this.persistenceKey),this.window.addEventListener("storage",this.Fs)}static D(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.zi();for(const n of e){if(n===this.Cs)continue;const i=this.getItem(h_(this.persistenceKey,n));if(i){const a=xh.bs(n,i);a&&(this.xs=this.xs.insert(a.clientId,a))}}this.Ks();const t=this.storage.getItem(this.Qs);if(t){const n=this.Us(t);n&&this.Ws(n)}for(const n of this.Os)this.Ms(n);this.Os=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(e){this.setItem(this.Bs,JSON.stringify(e))}getAllActiveQueryTargets(){return this.Gs(this.xs)}isActiveQueryTarget(e){let t=!1;return this.xs.forEach((n,i)=>{i.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.zs(e,"pending")}updateMutationState(e,t,n){this.zs(e,t,n),this.js(e)}addLocalQueryTarget(e,t=!0){let n="not-current";if(this.isActiveQueryTarget(e)){const i=this.storage.getItem(Xf(this.persistenceKey,e));if(i){const a=zl.bs(e,i);a&&(n=a.state)}}return t&&this.Hs.Ds(e),this.Ks(),n}removeLocalQueryTarget(e){this.Hs.vs(e),this.Ks()}isLocalQueryTarget(e){return this.Hs.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(Xf(this.persistenceKey,e))}updateQueryState(e,t,n){this.Js(e,t,n)}handleUserChange(e,t,n){t.forEach(i=>{this.js(i)}),this.currentUser=e,n.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.Ys(e)}notifyBundleLoaded(e){this.Zs(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.Fs),this.removeItem(this.Ns),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return oe(Zr,"READ",e,t),t}setItem(e,t){oe(Zr,"SET",e,t),this.storage.setItem(e,t)}removeItem(e){oe(Zr,"REMOVE",e),this.storage.removeItem(e)}Ms(e){const t=e;if(t.storageArea===this.storage){if(oe(Zr,"EVENT",t.key,t.newValue),t.key===this.Ns)return void bt("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Ti.enqueueRetryable(async()=>{if(this.started){if(t.key!==null){if(this.Ls.test(t.key)){if(t.newValue==null){const n=this.Xs(t.key);return this.eo(n,null)}{const n=this.no(t.key,t.newValue);if(n)return this.eo(n.clientId,n)}}else if(this.ks.test(t.key)){if(t.newValue!==null){const n=this.ro(t.key,t.newValue);if(n)return this.io(n)}}else if(this.qs.test(t.key)){if(t.newValue!==null){const n=this.so(t.key,t.newValue);if(n)return this.oo(n)}}else if(t.key===this.Qs){if(t.newValue!==null){const n=this.Us(t.newValue);if(n)return this.Ws(n)}}else if(t.key===this.Bs){const n=function(a){let u=Vn.ae;if(a!=null)try{const c=JSON.parse(a);ke(typeof c=="number"),u=c}catch(c){bt(Zr,"Failed to read sequence number from WebStorage",c)}return u}(t.newValue);n!==Vn.ae&&this.sequenceNumberHandler(n)}else if(t.key===this.$s){const n=this._o(t.newValue);await Promise.all(n.map(i=>this.syncEngine.ao(i)))}}}else this.Os.push(t)})}}get Hs(){return this.xs.get(this.Cs)}Ks(){this.setItem(this.Ns,this.Hs.Ss())}zs(e,t,n){const i=new Ah(this.currentUser,e,t,n),a=d_(this.persistenceKey,this.currentUser,e);this.setItem(a,i.Ss())}js(e){const t=d_(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Ys(e){const t={clientId:this.Cs,onlineState:e};this.storage.setItem(this.Qs,JSON.stringify(t))}Js(e,t,n){const i=Xf(this.persistenceKey,e),a=new zl(e,t,n);this.setItem(i,a.Ss())}Zs(e){const t=JSON.stringify(Array.from(e));this.setItem(this.$s,t)}Xs(e){const t=this.Ls.exec(e);return t?t[1]:null}no(e,t){const n=this.Xs(e);return xh.bs(n,t)}ro(e,t){const n=this.ks.exec(e),i=Number(n[1]),a=n[2]!==void 0?n[2]:null;return Ah.bs(new cn(a),i,t)}so(e,t){const n=this.qs.exec(e),i=Number(n[1]);return zl.bs(i,t)}Us(e){return mm.bs(e)}_o(e){return JSON.parse(e)}async io(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.uo(e.batchId,e.state,e.error);oe(Zr,`Ignoring mutation for non-active user ${e.user.uid}`)}oo(e){return this.syncEngine.co(e.targetId,e.state,e.error)}eo(e,t){const n=t?this.xs.insert(e,t):this.xs.remove(e),i=this.Gs(this.xs),a=this.Gs(n),u=[],c=[];return a.forEach(d=>{i.has(d)||u.push(d)}),i.forEach(d=>{a.has(d)||c.push(d)}),this.syncEngine.lo(u,c).then(()=>{this.xs=n})}Ws(e){this.xs.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}Gs(e){let t=nm();return e.forEach((n,i)=>{t=t.unionWith(i.activeTargetIds)}),t}}class fE{constructor(){this.ho=new Pp,this.Po={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e,t=!0){return t&&this.ho.Ds(e),this.Po[e]||"not-current"}updateQueryState(e,t,n){this.Po[e]=t}removeLocalQueryTarget(e){this.ho.vs(e)}isLocalQueryTarget(e){return this.ho.activeTargetIds.has(e)}clearQueryState(e){delete this.Po[e]}getAllActiveQueryTargets(){return this.ho.activeTargetIds}isActiveQueryTarget(e){return this.ho.activeTargetIds.has(e)}start(){return this.ho=new Pp,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mx{To(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f_="ConnectivityMonitor";class p_{constructor(){this.Io=()=>this.Eo(),this.Ao=()=>this.Ro(),this.Vo=[],this.mo()}To(e){this.Vo.push(e)}shutdown(){window.removeEventListener("online",this.Io),window.removeEventListener("offline",this.Ao)}mo(){window.addEventListener("online",this.Io),window.addEventListener("offline",this.Ao)}Eo(){oe(f_,"Network connectivity changed: AVAILABLE");for(const e of this.Vo)e(0)}Ro(){oe(f_,"Network connectivity changed: UNAVAILABLE");for(const e of this.Vo)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let qc=null;function kp(){return qc===null?qc=function(){return 268435456+Math.round(2147483648*Math.random())}():qc++,"0x"+qc.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zf="RestConnection",Ox={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Fx{get fo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.po=t+"://"+e.host,this.yo=`projects/${n}/databases/${i}`,this.wo=this.databaseId.database===ph?`project_id=${n}`:`project_id=${n}&database_id=${i}`}bo(e,t,n,i,a){const u=kp(),c=this.So(e,t.toUriEncodedString());oe(Zf,`Sending RPC '${e}' ${u}:`,c,n);const d={"google-cloud-resource-prefix":this.yo,"x-goog-request-params":this.wo};return this.Do(d,i,a),this.vo(e,c,d,n).then(p=>(oe(Zf,`Received RPC '${e}' ${u}: `,p),p),p=>{throw Wl(Zf,`RPC '${e}' ${u} failed with error: `,p,"url: ",c,"request:",n),p})}Co(e,t,n,i,a,u){return this.bo(e,t,n,i,a)}Do(e,t,n){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Fa}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((i,a)=>e[a]=i),n&&n.headers.forEach((i,a)=>e[a]=i)}So(e,t){const n=Ox[e];return`${this.po}/v1/${t}:${n}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lx{constructor(e){this.Fo=e.Fo,this.Mo=e.Mo}xo(e){this.Oo=e}No(e){this.Bo=e}Lo(e){this.ko=e}onMessage(e){this.qo=e}close(){this.Mo()}send(e){this.Fo(e)}Qo(){this.Oo()}$o(){this.Bo()}Ko(e){this.ko(e)}Uo(e){this.qo(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ln="WebChannelConnection";class jx extends Fx{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}vo(e,t,n,i){const a=kp();return new Promise((u,c)=>{const d=new kw;d.setWithCredentials(!0),d.listenOnce(bw.COMPLETE,()=>{try{switch(d.getLastErrorCode()){case Hc.NO_ERROR:const g=d.getResponseJson();oe(ln,`XHR for RPC '${e}' ${a} received:`,JSON.stringify(g)),u(g);break;case Hc.TIMEOUT:oe(ln,`RPC '${e}' ${a} timed out`),c(new Ce(se.DEADLINE_EXCEEDED,"Request time out"));break;case Hc.HTTP_ERROR:const _=d.getStatus();if(oe(ln,`RPC '${e}' ${a} failed with status:`,_,"response text:",d.getResponseText()),_>0){let E=d.getResponseJson();Array.isArray(E)&&(E=E[0]);const C=E==null?void 0:E.error;if(C&&C.status&&C.message){const A=function(M){const U=M.toLowerCase().replace(/_/g,"-");return Object.values(se).indexOf(U)>=0?U:se.UNKNOWN}(C.status);c(new Ce(A,C.message))}else c(new Ce(se.UNKNOWN,"Server responded with status "+d.getStatus()))}else c(new Ce(se.UNAVAILABLE,"Connection failed."));break;default:Ae()}}finally{oe(ln,`RPC '${e}' ${a} completed.`)}});const p=JSON.stringify(i);oe(ln,`RPC '${e}' ${a} sending request:`,i),d.send(t,"POST",p,n,15)})}Wo(e,t,n){const i=kp(),a=[this.po,"/","google.firestore.v1.Firestore","/",e,"/channel"],u=Mw(),c=Vw(),d={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},p=this.longPollingOptions.timeoutSeconds;p!==void 0&&(d.longPollingTimeout=Math.round(1e3*p)),this.useFetchStreams&&(d.useFetchStreams=!0),this.Do(d.initMessageHeaders,t,n),d.encodeInitMessageHeaders=!0;const g=a.join("");oe(ln,`Creating RPC '${e}' stream ${i}: ${g}`,d);const _=u.createWebChannel(g,d);let E=!1,C=!1;const A=new Lx({Fo:M=>{C?oe(ln,`Not sending because RPC '${e}' stream ${i} is closed:`,M):(E||(oe(ln,`Opening RPC '${e}' stream ${i} transport.`),_.open(),E=!0),oe(ln,`RPC '${e}' stream ${i} sending:`,M),_.send(M))},Mo:()=>_.close()}),P=(M,U,W)=>{M.listen(U,z=>{try{W(z)}catch(X){setTimeout(()=>{throw X},0)}})};return P(_,kl.EventType.OPEN,()=>{C||(oe(ln,`RPC '${e}' stream ${i} transport opened.`),A.Qo())}),P(_,kl.EventType.CLOSE,()=>{C||(C=!0,oe(ln,`RPC '${e}' stream ${i} transport closed`),A.Ko())}),P(_,kl.EventType.ERROR,M=>{C||(C=!0,Wl(ln,`RPC '${e}' stream ${i} transport errored:`,M),A.Ko(new Ce(se.UNAVAILABLE,"The operation could not be completed")))}),P(_,kl.EventType.MESSAGE,M=>{var U;if(!C){const W=M.data[0];ke(!!W);const z=W,X=(z==null?void 0:z.error)||((U=z[0])===null||U===void 0?void 0:U.error);if(X){oe(ln,`RPC '${e}' stream ${i} received error:`,X);const j=X.status;let $=function(R){const b=Lt[R];if(b!==void 0)return x0(b)}(j),x=X.message;$===void 0&&($=se.INTERNAL,x="Unknown error status: "+j+" with message "+X.message),C=!0,A.Ko(new Ce($,x)),_.close()}else oe(ln,`RPC '${e}' stream ${i} received:`,W),A.Uo(W)}}),P(c,Dw.STAT_EVENT,M=>{M.stat===cp.PROXY?oe(ln,`RPC '${e}' stream ${i} detected buffering proxy`):M.stat===cp.NOPROXY&&oe(ln,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{A.$o()},0),A}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pE(){return typeof window<"u"?window:null}function nh(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mE(r){return new WA(r,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gE{constructor(e,t,n=1e3,i=1.5,a=6e4){this.Ti=e,this.timerId=t,this.Go=n,this.zo=i,this.jo=a,this.Ho=0,this.Jo=null,this.Yo=Date.now(),this.reset()}reset(){this.Ho=0}Zo(){this.Ho=this.jo}Xo(e){this.cancel();const t=Math.floor(this.Ho+this.e_()),n=Math.max(0,Date.now()-this.Yo),i=Math.max(0,t-n);i>0&&oe("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ho} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.Jo=this.Ti.enqueueAfterDelay(this.timerId,i,()=>(this.Yo=Date.now(),e())),this.Ho*=this.zo,this.Ho<this.Go&&(this.Ho=this.Go),this.Ho>this.jo&&(this.Ho=this.jo)}t_(){this.Jo!==null&&(this.Jo.skipDelay(),this.Jo=null)}cancel(){this.Jo!==null&&(this.Jo.cancel(),this.Jo=null)}e_(){return(Math.random()-.5)*this.Ho}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m_="PersistentStream";class yE{constructor(e,t,n,i,a,u,c,d){this.Ti=e,this.n_=n,this.r_=i,this.connection=a,this.authCredentialsProvider=u,this.appCheckCredentialsProvider=c,this.listener=d,this.state=0,this.i_=0,this.s_=null,this.o_=null,this.stream=null,this.__=0,this.a_=new gE(e,t)}u_(){return this.state===1||this.state===5||this.c_()}c_(){return this.state===2||this.state===3}start(){this.__=0,this.state!==4?this.auth():this.l_()}async stop(){this.u_()&&await this.close(0)}h_(){this.state=0,this.a_.reset()}P_(){this.c_()&&this.s_===null&&(this.s_=this.Ti.enqueueAfterDelay(this.n_,6e4,()=>this.T_()))}I_(e){this.E_(),this.stream.send(e)}async T_(){if(this.c_())return this.close(0)}E_(){this.s_&&(this.s_.cancel(),this.s_=null)}d_(){this.o_&&(this.o_.cancel(),this.o_=null)}async close(e,t){this.E_(),this.d_(),this.a_.cancel(),this.i_++,e!==4?this.a_.reset():t&&t.code===se.RESOURCE_EXHAUSTED?(bt(t.toString()),bt("Using maximum backoff delay to prevent overloading the backend."),this.a_.Zo()):t&&t.code===se.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.A_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.Lo(t)}A_(){}auth(){this.state=1;const e=this.R_(this.i_),t=this.i_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,i])=>{this.i_===t&&this.V_(n,i)},n=>{e(()=>{const i=new Ce(se.UNKNOWN,"Fetching auth token failed: "+n.message);return this.m_(i)})})}V_(e,t){const n=this.R_(this.i_);this.stream=this.f_(e,t),this.stream.xo(()=>{n(()=>this.listener.xo())}),this.stream.No(()=>{n(()=>(this.state=2,this.o_=this.Ti.enqueueAfterDelay(this.r_,1e4,()=>(this.c_()&&(this.state=3),Promise.resolve())),this.listener.No()))}),this.stream.Lo(i=>{n(()=>this.m_(i))}),this.stream.onMessage(i=>{n(()=>++this.__==1?this.g_(i):this.onNext(i))})}l_(){this.state=5,this.a_.Xo(async()=>{this.state=0,this.start()})}m_(e){return oe(m_,`close with error: ${e}`),this.stream=null,this.close(4,e)}R_(e){return t=>{this.Ti.enqueueAndForget(()=>this.i_===e?t():(oe(m_,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class Bx extends yE{constructor(e,t,n,i,a,u){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,i,u),this.serializer=a}f_(e,t){return this.connection.Wo("Listen",e,t)}g_(e){return this.onNext(e)}onNext(e){this.a_.reset();const t=HA(this.serializer,e),n=function(a){if(!("targetChange"in a))return De.min();const u=a.targetChange;return u.targetIds&&u.targetIds.length?De.min():u.readTime?In(u.readTime):De.min()}(e);return this.listener.p_(t,n)}y_(e){const t={};t.database=Sp(this.serializer),t.addTarget=function(a,u){let c;const d=u.target;if(c=gh(d)?{documents:M0(a,d)}:{query:O0(a,d).ht},c.targetId=u.targetId,u.resumeToken.approximateByteSize()>0){c.resumeToken=qA(a,u.resumeToken);const p=Tp(a,u.expectedCount);p!==null&&(c.expectedCount=p)}else if(u.snapshotVersion.compareTo(De.min())>0){c.readTime=vh(a,u.snapshotVersion.toTimestamp());const p=Tp(a,u.expectedCount);p!==null&&(c.expectedCount=p)}return c}(this.serializer,e);const n=XA(this.serializer,e);n&&(t.labels=n),this.I_(t)}w_(e){const t={};t.database=Sp(this.serializer),t.removeTarget=e,this.I_(t)}}class zx extends yE{constructor(e,t,n,i,a,u){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,i,u),this.serializer=a}get b_(){return this.__>0}start(){this.lastStreamToken=void 0,super.start()}A_(){this.b_&&this.S_([])}f_(e,t){return this.connection.Wo("Write",e,t)}g_(e){return ke(!!e.streamToken),this.lastStreamToken=e.streamToken,ke(!e.writeResults||e.writeResults.length===0),this.listener.D_()}onNext(e){ke(!!e.streamToken),this.lastStreamToken=e.streamToken,this.a_.reset();const t=QA(e.writeResults,e.commitTime),n=In(e.commitTime);return this.listener.v_(n,t)}C_(){const e={};e.database=Sp(this.serializer),this.I_(e)}S_(e){const t={streamToken:this.lastStreamToken,writes:e.map(n=>wh(this.serializer,n))};this.I_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ux{}class $x extends Ux{constructor(e,t,n,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=i,this.F_=!1}M_(){if(this.F_)throw new Ce(se.FAILED_PRECONDITION,"The client has already been terminated.")}bo(e,t,n,i){return this.M_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,u])=>this.connection.bo(e,Ip(t,n),i,a,u)).catch(a=>{throw a.name==="FirebaseError"?(a.code===se.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new Ce(se.UNKNOWN,a.toString())})}Co(e,t,n,i,a){return this.M_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([u,c])=>this.connection.Co(e,Ip(t,n),i,u,c,a)).catch(u=>{throw u.name==="FirebaseError"?(u.code===se.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),u):new Ce(se.UNKNOWN,u.toString())})}terminate(){this.F_=!0,this.connection.terminate()}}class Wx{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.x_=0,this.O_=null,this.N_=!0}B_(){this.x_===0&&(this.L_("Unknown"),this.O_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.O_=null,this.k_("Backend didn't respond within 10 seconds."),this.L_("Offline"),Promise.resolve())))}q_(e){this.state==="Online"?this.L_("Unknown"):(this.x_++,this.x_>=1&&(this.Q_(),this.k_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.L_("Offline")))}set(e){this.Q_(),this.x_=0,e==="Online"&&(this.N_=!1),this.L_(e)}L_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}k_(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.N_?(bt(t),this.N_=!1):oe("OnlineStateTracker",t)}Q_(){this.O_!==null&&(this.O_.cancel(),this.O_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const go="RemoteStore";class qx{constructor(e,t,n,i,a){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.K_=[],this.U_=new Map,this.W_=new Set,this.G_=[],this.z_=a,this.z_.To(u=>{n.enqueueAndForget(async()=>{_o(this)&&(oe(go,"Restarting streams for network reachability change."),await async function(d){const p=Re(d);p.W_.add(4),await pu(p),p.j_.set("Unknown"),p.W_.delete(4),await Jh(p)}(this))})}),this.j_=new Wx(n,i)}}async function Jh(r){if(_o(r))for(const e of r.G_)await e(!0)}async function pu(r){for(const e of r.G_)await e(!1)}function ed(r,e){const t=Re(r);t.U_.has(e.targetId)||(t.U_.set(e.targetId,e),vm(t)?ym(t):ja(t).c_()&&gm(t,e))}function ba(r,e){const t=Re(r),n=ja(t);t.U_.delete(e),n.c_()&&vE(t,e),t.U_.size===0&&(n.c_()?n.P_():_o(t)&&t.j_.set("Unknown"))}function gm(r,e){if(r.H_.Ne(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(De.min())>0){const t=r.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}ja(r).y_(e)}function vE(r,e){r.H_.Ne(e),ja(r).w_(e)}function ym(r){r.H_=new BA({getRemoteKeysForTarget:e=>r.remoteSyncer.getRemoteKeysForTarget(e),lt:e=>r.U_.get(e)||null,it:()=>r.datastore.serializer.databaseId}),ja(r).start(),r.j_.B_()}function vm(r){return _o(r)&&!ja(r).u_()&&r.U_.size>0}function _o(r){return Re(r).W_.size===0}function _E(r){r.H_=void 0}async function Gx(r){r.j_.set("Online")}async function Kx(r){r.U_.forEach((e,t)=>{gm(r,e)})}async function Hx(r,e){_E(r),vm(r)?(r.j_.q_(e),ym(r)):r.j_.set("Unknown")}async function Qx(r,e,t){if(r.j_.set("Online"),e instanceof R0&&e.state===2&&e.cause)try{await async function(i,a){const u=a.cause;for(const c of a.targetIds)i.U_.has(c)&&(await i.remoteSyncer.rejectListen(c,u),i.U_.delete(c),i.H_.removeTarget(c))}(r,e)}catch(n){oe(go,"Failed to remove targets %s: %s ",e.targetIds.join(","),n),await Nh(r,n)}else if(e instanceof th?r.H_.We(e):e instanceof N0?r.H_.Ze(e):r.H_.je(e),!t.isEqual(De.min()))try{const n=await oE(r.localStore);t.compareTo(n)>=0&&await function(a,u){const c=a.H_.ot(u);return c.targetChanges.forEach((d,p)=>{if(d.resumeToken.approximateByteSize()>0){const g=a.U_.get(p);g&&a.U_.set(p,g.withResumeToken(d.resumeToken,u))}}),c.targetMismatches.forEach((d,p)=>{const g=a.U_.get(d);if(!g)return;a.U_.set(d,g.withResumeToken(Vt.EMPTY_BYTE_STRING,g.snapshotVersion)),vE(a,d);const _=new Ts(g.target,d,p,g.sequenceNumber);gm(a,_)}),a.remoteSyncer.applyRemoteEvent(c)}(r,t)}catch(n){oe(go,"Failed to raise snapshot:",n),await Nh(r,n)}}async function Nh(r,e,t){if(!wi(e))throw e;r.W_.add(1),await pu(r),r.j_.set("Offline"),t||(t=()=>oE(r.localStore)),r.asyncQueue.enqueueRetryable(async()=>{oe(go,"Retrying IndexedDB access"),await t(),r.W_.delete(1),await Jh(r)})}function wE(r,e){return e().catch(t=>Nh(r,t,e))}async function mu(r){const e=Re(r),t=yi(e);let n=e.K_.length>0?e.K_[e.K_.length-1].batchId:io;for(;Xx(e);)try{const i=await Vx(e.localStore,n);if(i===null){e.K_.length===0&&t.P_();break}n=i.batchId,Yx(e,i)}catch(i){await Nh(e,i)}EE(e)&&TE(e)}function Xx(r){return _o(r)&&r.K_.length<10}function Yx(r,e){r.K_.push(e);const t=yi(r);t.c_()&&t.b_&&t.S_(e.mutations)}function EE(r){return _o(r)&&!yi(r).u_()&&r.K_.length>0}function TE(r){yi(r).start()}async function Zx(r){yi(r).C_()}async function Jx(r){const e=yi(r);for(const t of r.K_)e.S_(t.mutations)}async function eN(r,e,t){const n=r.K_.shift(),i=im.from(n,e,t);await wE(r,()=>r.remoteSyncer.applySuccessfulWrite(i)),await mu(r)}async function tN(r,e){e&&yi(r).b_&&await async function(n,i){if(function(u){return FA(u)&&u!==se.ABORTED}(i.code)){const a=n.K_.shift();yi(n).h_(),await wE(n,()=>n.remoteSyncer.rejectFailedWrite(a.batchId,i)),await mu(n)}}(r,e),EE(r)&&TE(r)}async function g_(r,e){const t=Re(r);t.asyncQueue.verifyOperationInProgress(),oe(go,"RemoteStore received new credentials");const n=_o(t);t.W_.add(3),await pu(t),n&&t.j_.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.W_.delete(3),await Jh(t)}async function bp(r,e){const t=Re(r);e?(t.W_.delete(2),await Jh(t)):e||(t.W_.add(2),await pu(t),t.j_.set("Unknown"))}function ja(r){return r.J_||(r.J_=function(t,n,i){const a=Re(t);return a.M_(),new Bx(n,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,i)}(r.datastore,r.asyncQueue,{xo:Gx.bind(null,r),No:Kx.bind(null,r),Lo:Hx.bind(null,r),p_:Qx.bind(null,r)}),r.G_.push(async e=>{e?(r.J_.h_(),vm(r)?ym(r):r.j_.set("Unknown")):(await r.J_.stop(),_E(r))})),r.J_}function yi(r){return r.Y_||(r.Y_=function(t,n,i){const a=Re(t);return a.M_(),new zx(n,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,i)}(r.datastore,r.asyncQueue,{xo:()=>Promise.resolve(),No:Zx.bind(null,r),Lo:tN.bind(null,r),D_:Jx.bind(null,r),v_:eN.bind(null,r)}),r.G_.push(async e=>{e?(r.Y_.h_(),await mu(r)):(await r.Y_.stop(),r.K_.length>0&&(oe(go,`Stopping write stream with ${r.K_.length} pending writes`),r.K_=[]))})),r.Y_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _m{constructor(e,t,n,i,a){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=i,this.removalCallback=a,this.deferred=new fi,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(u=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,i,a){const u=Date.now()+n,c=new _m(e,t,u,i,a);return c.start(n),c}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Ce(se.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function IE(r,e){if(bt("AsyncQueue",`${e}: ${r}`),wi(r))return new Ce(se.UNAVAILABLE,`${e}: ${r}`);throw r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class va{static emptySet(e){return new va(e.comparator)}constructor(e){this.comparator=e?(t,n)=>e(t,n)||ye.comparator(t.key,n.key):(t,n)=>ye.comparator(t.key,n.key),this.keyedMap=bl(),this.sortedSet=new mt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,n)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof va)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const i=t.getNext().key,a=n.getNext().key;if(!i.isEqual(a))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const n=new va;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y_{constructor(){this.Z_=new mt(ye.comparator)}track(e){const t=e.doc.key,n=this.Z_.get(t);n?e.type!==0&&n.type===3?this.Z_=this.Z_.insert(t,e):e.type===3&&n.type!==1?this.Z_=this.Z_.insert(t,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.Z_=this.Z_.insert(t,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.Z_=this.Z_.insert(t,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.Z_=this.Z_.remove(t):e.type===1&&n.type===2?this.Z_=this.Z_.insert(t,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.Z_=this.Z_.insert(t,{type:2,doc:e.doc}):Ae():this.Z_=this.Z_.insert(t,e)}X_(){const e=[];return this.Z_.inorderTraversal((t,n)=>{e.push(n)}),e}}class Da{constructor(e,t,n,i,a,u,c,d,p){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=a,this.fromCache=u,this.syncStateChanged=c,this.excludesMetadataChanges=d,this.hasCachedResults=p}static fromInitialDocuments(e,t,n,i,a){const u=[];return t.forEach(c=>{u.push({type:0,doc:c})}),new Da(e,t,va.emptySet(t),u,n,i,!0,!1,a)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Kh(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==n[i].type||!t[i].doc.isEqual(n[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nN{constructor(){this.ea=void 0,this.ta=[]}na(){return this.ta.some(e=>e.ra())}}class rN{constructor(){this.queries=v_(),this.onlineState="Unknown",this.ia=new Set}terminate(){(function(t,n){const i=Re(t),a=i.queries;i.queries=v_(),a.forEach((u,c)=>{for(const d of c.ta)d.onError(n)})})(this,new Ce(se.ABORTED,"Firestore shutting down"))}}function v_(){return new Ns(r=>g0(r),Kh)}async function sN(r,e){const t=Re(r);let n=3;const i=e.query;let a=t.queries.get(i);a?!a.na()&&e.ra()&&(n=2):(a=new nN,n=e.ra()?0:1);try{switch(n){case 0:a.ea=await t.onListen(i,!0);break;case 1:a.ea=await t.onListen(i,!1);break;case 2:await t.onFirstRemoteStoreListen(i)}}catch(u){const c=IE(u,`Initialization of query '${fa(e.query)}' failed`);return void e.onError(c)}t.queries.set(i,a),a.ta.push(e),e.sa(t.onlineState),a.ea&&e.oa(a.ea)&&wm(t)}async function iN(r,e){const t=Re(r),n=e.query;let i=3;const a=t.queries.get(n);if(a){const u=a.ta.indexOf(e);u>=0&&(a.ta.splice(u,1),a.ta.length===0?i=e.ra()?0:1:!a.na()&&e.ra()&&(i=2))}switch(i){case 0:return t.queries.delete(n),t.onUnlisten(n,!0);case 1:return t.queries.delete(n),t.onUnlisten(n,!1);case 2:return t.onLastRemoteStoreUnlisten(n);default:return}}function oN(r,e){const t=Re(r);let n=!1;for(const i of e){const a=i.query,u=t.queries.get(a);if(u){for(const c of u.ta)c.oa(i)&&(n=!0);u.ea=i}}n&&wm(t)}function aN(r,e,t){const n=Re(r),i=n.queries.get(e);if(i)for(const a of i.ta)a.onError(t);n.queries.delete(e)}function wm(r){r.ia.forEach(e=>{e.next()})}var Dp,__;(__=Dp||(Dp={}))._a="default",__.Cache="cache";class lN{constructor(e,t,n){this.query=e,this.aa=t,this.ua=!1,this.ca=null,this.onlineState="Unknown",this.options=n||{}}oa(e){if(!this.options.includeMetadataChanges){const n=[];for(const i of e.docChanges)i.type!==3&&n.push(i);e=new Da(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.ua?this.la(e)&&(this.aa.next(e),t=!0):this.ha(e,this.onlineState)&&(this.Pa(e),t=!0),this.ca=e,t}onError(e){this.aa.error(e)}sa(e){this.onlineState=e;let t=!1;return this.ca&&!this.ua&&this.ha(this.ca,e)&&(this.Pa(this.ca),t=!0),t}ha(e,t){if(!e.fromCache||!this.ra())return!0;const n=t!=="Offline";return(!this.options.Ta||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}la(e){if(e.docChanges.length>0)return!0;const t=this.ca&&this.ca.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}Pa(e){e=Da.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.ua=!0,this.aa.next(e)}ra(){return this.options.source!==Dp.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SE{constructor(e){this.key=e}}class CE{constructor(e){this.key=e}}class uN{constructor(e,t){this.query=e,this.fa=t,this.ga=null,this.hasCachedResults=!1,this.current=!1,this.pa=qe(),this.mutatedKeys=qe(),this.ya=v0(e),this.wa=new va(this.ya)}get ba(){return this.fa}Sa(e,t){const n=t?t.Da:new y_,i=t?t.wa:this.wa;let a=t?t.mutatedKeys:this.mutatedKeys,u=i,c=!1;const d=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,p=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((g,_)=>{const E=i.get(g),C=cu(this.query,_)?_:null,A=!!E&&this.mutatedKeys.has(E.key),P=!!C&&(C.hasLocalMutations||this.mutatedKeys.has(C.key)&&C.hasCommittedMutations);let M=!1;E&&C?E.data.isEqual(C.data)?A!==P&&(n.track({type:3,doc:C}),M=!0):this.va(E,C)||(n.track({type:2,doc:C}),M=!0,(d&&this.ya(C,d)>0||p&&this.ya(C,p)<0)&&(c=!0)):!E&&C?(n.track({type:0,doc:C}),M=!0):E&&!C&&(n.track({type:1,doc:E}),M=!0,(d||p)&&(c=!0)),M&&(C?(u=u.add(C),a=P?a.add(g):a.delete(g)):(u=u.delete(g),a=a.delete(g)))}),this.query.limit!==null)for(;u.size>this.query.limit;){const g=this.query.limitType==="F"?u.last():u.first();u=u.delete(g.key),a=a.delete(g.key),n.track({type:1,doc:g})}return{wa:u,Da:n,ls:c,mutatedKeys:a}}va(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,i){const a=this.wa;this.wa=e.wa,this.mutatedKeys=e.mutatedKeys;const u=e.Da.X_();u.sort((g,_)=>function(C,A){const P=M=>{switch(M){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ae()}};return P(C)-P(A)}(g.type,_.type)||this.ya(g.doc,_.doc)),this.Ca(n),i=i!=null&&i;const c=t&&!i?this.Fa():[],d=this.pa.size===0&&this.current&&!i?1:0,p=d!==this.ga;return this.ga=d,u.length!==0||p?{snapshot:new Da(this.query,e.wa,a,u,e.mutatedKeys,d===0,p,!1,!!n&&n.resumeToken.approximateByteSize()>0),Ma:c}:{Ma:c}}sa(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({wa:this.wa,Da:new y_,mutatedKeys:this.mutatedKeys,ls:!1},!1)):{Ma:[]}}xa(e){return!this.fa.has(e)&&!!this.wa.has(e)&&!this.wa.get(e).hasLocalMutations}Ca(e){e&&(e.addedDocuments.forEach(t=>this.fa=this.fa.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.fa=this.fa.delete(t)),this.current=e.current)}Fa(){if(!this.current)return[];const e=this.pa;this.pa=qe(),this.wa.forEach(n=>{this.xa(n.key)&&(this.pa=this.pa.add(n.key))});const t=[];return e.forEach(n=>{this.pa.has(n)||t.push(new CE(n))}),this.pa.forEach(n=>{e.has(n)||t.push(new SE(n))}),t}Oa(e){this.fa=e.gs,this.pa=qe();const t=this.Sa(e.documents);return this.applyChanges(t,!0)}Na(){return Da.fromInitialDocuments(this.query,this.wa,this.mutatedKeys,this.ga===0,this.hasCachedResults)}}const Ba="SyncEngine";class cN{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class hN{constructor(e){this.key=e,this.Ba=!1}}class dN{constructor(e,t,n,i,a,u){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=i,this.currentUser=a,this.maxConcurrentLimboResolutions=u,this.La={},this.ka=new Ns(c=>g0(c),Kh),this.qa=new Map,this.Qa=new Set,this.$a=new mt(ye.comparator),this.Ka=new Map,this.Ua=new cm,this.Wa={},this.Ga=new Map,this.za=mo.Un(),this.onlineState="Unknown",this.ja=void 0}get isPrimaryClient(){return this.ja===!0}}async function fN(r,e,t=!0){const n=td(r);let i;const a=n.ka.get(e);return a?(n.sharedClientState.addLocalQueryTarget(a.targetId),i=a.view.Na()):i=await AE(n,e,t,!0),i}async function pN(r,e){const t=td(r);await AE(t,e,!0,!1)}async function AE(r,e,t,n){const i=await Ch(r.localStore,Qn(e)),a=i.targetId,u=r.sharedClientState.addLocalQueryTarget(a,t);let c;return n&&(c=await Em(r,e,a,u==="current",i.resumeToken)),r.isPrimaryClient&&t&&ed(r.remoteStore,i),c}async function Em(r,e,t,n,i){r.Ha=(_,E,C)=>async function(P,M,U,W){let z=M.view.Sa(U);z.ls&&(z=await Rp(P.localStore,M.query,!1).then(({documents:x})=>M.view.Sa(x,z)));const X=W&&W.targetChanges.get(M.targetId),j=W&&W.targetMismatches.get(M.targetId)!=null,$=M.view.applyChanges(z,P.isPrimaryClient,X,j);return Vp(P,M.targetId,$.Ma),$.snapshot}(r,_,E,C);const a=await Rp(r.localStore,e,!0),u=new uN(e,a.gs),c=u.Sa(a.documents),d=fu.createSynthesizedTargetChangeForCurrentChange(t,n&&r.onlineState!=="Offline",i),p=u.applyChanges(c,r.isPrimaryClient,d);Vp(r,t,p.Ma);const g=new cN(e,t,u);return r.ka.set(e,g),r.qa.has(t)?r.qa.get(t).push(e):r.qa.set(t,[e]),p.snapshot}async function mN(r,e,t){const n=Re(r),i=n.ka.get(e),a=n.qa.get(i.targetId);if(a.length>1)return n.qa.set(i.targetId,a.filter(u=>!Kh(u,e))),void n.ka.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(i.targetId),n.sharedClientState.isActiveQueryTarget(i.targetId)||await ka(n.localStore,i.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(i.targetId),t&&ba(n.remoteStore,i.targetId),Va(n,i.targetId)}).catch(_i)):(Va(n,i.targetId),await ka(n.localStore,i.targetId,!0))}async function gN(r,e){const t=Re(r),n=t.ka.get(e),i=t.qa.get(n.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(n.targetId),ba(t.remoteStore,n.targetId))}async function xE(r,e){const t=Re(r);try{const n=await bx(t.localStore,e);e.targetChanges.forEach((i,a)=>{const u=t.Ka.get(a);u&&(ke(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?u.Ba=!0:i.modifiedDocuments.size>0?ke(u.Ba):i.removedDocuments.size>0&&(ke(u.Ba),u.Ba=!1))}),await wo(t,n,e)}catch(n){await _i(n)}}function w_(r,e,t){const n=Re(r);if(n.isPrimaryClient&&t===0||!n.isPrimaryClient&&t===1){const i=[];n.ka.forEach((a,u)=>{const c=u.view.sa(e);c.snapshot&&i.push(c.snapshot)}),function(u,c){const d=Re(u);d.onlineState=c;let p=!1;d.queries.forEach((g,_)=>{for(const E of _.ta)E.sa(c)&&(p=!0)}),p&&wm(d)}(n.eventManager,e),i.length&&n.La.p_(i),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function yN(r,e,t){const n=Re(r);n.sharedClientState.updateQueryState(e,"rejected",t);const i=n.Ka.get(e),a=i&&i.key;if(a){let u=new mt(ye.comparator);u=u.insert(a,xt.newNoDocument(a,De.min()));const c=qe().add(a),d=new du(De.min(),new Map,new mt(ze),u,c);await xE(n,d),n.$a=n.$a.remove(a),n.Ka.delete(e),Sm(n)}else await ka(n.localStore,e,!1).then(()=>Va(n,e,t)).catch(_i)}async function vN(r,e){const t=Re(r),n=e.batch.batchId;try{const i=await kx(t.localStore,e);Im(t,n,null),Tm(t,n),t.sharedClientState.updateMutationState(n,"acknowledged"),await wo(t,i)}catch(i){await _i(i)}}async function _N(r,e,t){const n=Re(r);try{const i=await function(u,c){const d=Re(u);return d.persistence.runTransaction("Reject batch","readwrite-primary",p=>{let g;return d.mutationQueue.lookupMutationBatch(p,c).next(_=>(ke(_!==null),g=_.keys(),d.mutationQueue.removeMutationBatch(p,_))).next(()=>d.mutationQueue.performConsistencyCheck(p)).next(()=>d.documentOverlayCache.removeOverlaysForBatchId(p,g,c)).next(()=>d.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(p,g)).next(()=>d.localDocuments.getDocuments(p,g))})}(n.localStore,e);Im(n,e,t),Tm(n,e),n.sharedClientState.updateMutationState(e,"rejected",t),await wo(n,i)}catch(i){await _i(i)}}function Tm(r,e){(r.Ga.get(e)||[]).forEach(t=>{t.resolve()}),r.Ga.delete(e)}function Im(r,e,t){const n=Re(r);let i=n.Wa[n.currentUser.toKey()];if(i){const a=i.get(e);a&&(t?a.reject(t):a.resolve(),i=i.remove(e)),n.Wa[n.currentUser.toKey()]=i}}function Va(r,e,t=null){r.sharedClientState.removeLocalQueryTarget(e);for(const n of r.qa.get(e))r.ka.delete(n),t&&r.La.Ja(n,t);r.qa.delete(e),r.isPrimaryClient&&r.Ua.Sr(e).forEach(n=>{r.Ua.containsKey(n)||NE(r,n)})}function NE(r,e){r.Qa.delete(e.path.canonicalString());const t=r.$a.get(e);t!==null&&(ba(r.remoteStore,t),r.$a=r.$a.remove(e),r.Ka.delete(t),Sm(r))}function Vp(r,e,t){for(const n of t)n instanceof SE?(r.Ua.addReference(n.key,e),wN(r,n)):n instanceof CE?(oe(Ba,"Document no longer in limbo: "+n.key),r.Ua.removeReference(n.key,e),r.Ua.containsKey(n.key)||NE(r,n.key)):Ae()}function wN(r,e){const t=e.key,n=t.path.canonicalString();r.$a.get(t)||r.Qa.has(n)||(oe(Ba,"New document in limbo: "+t),r.Qa.add(n),Sm(r))}function Sm(r){for(;r.Qa.size>0&&r.$a.size<r.maxConcurrentLimboResolutions;){const e=r.Qa.values().next().value;r.Qa.delete(e);const t=new ye(at.fromString(e)),n=r.za.next();r.Ka.set(n,new hN(t)),r.$a=r.$a.insert(t,n),ed(r.remoteStore,new Ts(Qn(Gh(t.path)),n,"TargetPurposeLimboResolution",Vn.ae))}}async function wo(r,e,t){const n=Re(r),i=[],a=[],u=[];n.ka.isEmpty()||(n.ka.forEach((c,d)=>{u.push(n.Ha(d,e,t).then(p=>{var g;if((p||t)&&n.isPrimaryClient){const _=p?!p.fromCache:(g=t==null?void 0:t.targetChanges.get(d.targetId))===null||g===void 0?void 0:g.current;n.sharedClientState.updateQueryState(d.targetId,_?"current":"not-current")}if(p){i.push(p);const _=fm.Yi(d.targetId,p);a.push(_)}}))}),await Promise.all(u),n.La.p_(i),await async function(d,p){const g=Re(d);try{await g.persistence.runTransaction("notifyLocalViewChanges","readwrite",_=>G.forEach(p,E=>G.forEach(E.Hi,C=>g.persistence.referenceDelegate.addReference(_,E.targetId,C)).next(()=>G.forEach(E.Ji,C=>g.persistence.referenceDelegate.removeReference(_,E.targetId,C)))))}catch(_){if(!wi(_))throw _;oe(pm,"Failed to update sequence numbers: "+_)}for(const _ of p){const E=_.targetId;if(!_.fromCache){const C=g.Ts.get(E),A=C.snapshotVersion,P=C.withLastLimboFreeSnapshotVersion(A);g.Ts=g.Ts.insert(E,P)}}}(n.localStore,a))}async function EN(r,e){const t=Re(r);if(!t.currentUser.isEqual(e)){oe(Ba,"User change. New user:",e.toKey());const n=await iE(t.localStore,e);t.currentUser=e,function(a,u){a.Ga.forEach(c=>{c.forEach(d=>{d.reject(new Ce(se.CANCELLED,u))})}),a.Ga.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await wo(t,n.Rs)}}function TN(r,e){const t=Re(r),n=t.Ka.get(e);if(n&&n.Ba)return qe().add(n.key);{let i=qe();const a=t.qa.get(e);if(!a)return i;for(const u of a){const c=t.ka.get(u);i=i.unionWith(c.view.ba)}return i}}async function IN(r,e){const t=Re(r),n=await Rp(t.localStore,e.query,!0),i=e.view.Oa(n);return t.isPrimaryClient&&Vp(t,e.targetId,i.Ma),i}async function SN(r,e){const t=Re(r);return lE(t.localStore,e).then(n=>wo(t,n))}async function CN(r,e,t,n){const i=Re(r),a=await function(c,d){const p=Re(c),g=Re(p.mutationQueue);return p.persistence.runTransaction("Lookup mutation documents","readonly",_=>g.Ln(_,d).next(E=>E?p.localDocuments.getDocuments(_,E):G.resolve(null)))}(i.localStore,e);a!==null?(t==="pending"?await mu(i.remoteStore):t==="acknowledged"||t==="rejected"?(Im(i,e,n||null),Tm(i,e),function(c,d){Re(Re(c).mutationQueue).qn(d)}(i.localStore,e)):Ae(),await wo(i,a)):oe(Ba,"Cannot apply mutation batch with id: "+e)}async function AN(r,e){const t=Re(r);if(td(t),PE(t),e===!0&&t.ja!==!0){const n=t.sharedClientState.getAllActiveQueryTargets(),i=await E_(t,n.toArray());t.ja=!0,await bp(t.remoteStore,!0);for(const a of i)ed(t.remoteStore,a)}else if(e===!1&&t.ja!==!1){const n=[];let i=Promise.resolve();t.qa.forEach((a,u)=>{t.sharedClientState.isLocalQueryTarget(u)?n.push(u):i=i.then(()=>(Va(t,u),ka(t.localStore,u,!0))),ba(t.remoteStore,u)}),await i,await E_(t,n),function(u){const c=Re(u);c.Ka.forEach((d,p)=>{ba(c.remoteStore,p)}),c.Ua.Dr(),c.Ka=new Map,c.$a=new mt(ye.comparator)}(t),t.ja=!1,await bp(t.remoteStore,!1)}}async function E_(r,e,t){const n=Re(r),i=[],a=[];for(const u of e){let c;const d=n.qa.get(u);if(d&&d.length!==0){c=await Ch(n.localStore,Qn(d[0]));for(const p of d){const g=n.ka.get(p),_=await IN(n,g);_.snapshot&&a.push(_.snapshot)}}else{const p=await aE(n.localStore,u);c=await Ch(n.localStore,p),await Em(n,RE(p),u,!1,c.resumeToken)}i.push(c)}return n.La.p_(a),i}function RE(r){return m0(r.path,r.collectionGroup,r.orderBy,r.filters,r.limit,"F",r.startAt,r.endAt)}function xN(r){return function(t){return Re(Re(t).persistence).zi()}(Re(r).localStore)}async function NN(r,e,t,n){const i=Re(r);if(i.ja)return void oe(Ba,"Ignoring unexpected query state notification.");const a=i.qa.get(e);if(a&&a.length>0)switch(t){case"current":case"not-current":{const u=await lE(i.localStore,y0(a[0])),c=du.createSynthesizedRemoteEventForCurrentChange(e,t==="current",Vt.EMPTY_BYTE_STRING);await wo(i,u,c);break}case"rejected":await ka(i.localStore,e,!0),Va(i,e,n);break;default:Ae()}}async function RN(r,e,t){const n=td(r);if(n.ja){for(const i of e){if(n.qa.has(i)&&n.sharedClientState.isActiveQueryTarget(i)){oe(Ba,"Adding an already active target "+i);continue}const a=await aE(n.localStore,i),u=await Ch(n.localStore,a);await Em(n,RE(a),u.targetId,!1,u.resumeToken),ed(n.remoteStore,u)}for(const i of t)n.qa.has(i)&&await ka(n.localStore,i,!1).then(()=>{ba(n.remoteStore,i),Va(n,i)}).catch(_i)}}function td(r){const e=Re(r);return e.remoteStore.remoteSyncer.applyRemoteEvent=xE.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=TN.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=yN.bind(null,e),e.La.p_=oN.bind(null,e.eventManager),e.La.Ja=aN.bind(null,e.eventManager),e}function PE(r){const e=Re(r);return e.remoteStore.remoteSyncer.applySuccessfulWrite=vN.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=_N.bind(null,e),e}class nu{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=mE(e.databaseInfo.databaseId),this.sharedClientState=this.Za(e),this.persistence=this.Xa(e),await this.persistence.start(),this.localStore=this.eu(e),this.gcScheduler=this.tu(e,this.localStore),this.indexBackfillerScheduler=this.nu(e,this.localStore)}tu(e,t){return null}nu(e,t){return null}eu(e){return sE(this.persistence,new rE,e.initialUser,this.serializer)}Xa(e){return new hm(Zh.ri,this.serializer)}Za(e){return new fE}async terminate(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}nu.provider={build:()=>new nu};class PN extends nu{constructor(e){super(),this.cacheSizeBytes=e}tu(e,t){ke(this.persistence.referenceDelegate instanceof Sh);const n=this.persistence.referenceDelegate.garbageCollector;return new Y0(n,e.asyncQueue,t)}Xa(e){const t=this.cacheSizeBytes!==void 0?hn.withCacheSize(this.cacheSizeBytes):hn.DEFAULT;return new hm(n=>Sh.ri(n,t),this.serializer)}}class kE extends nu{constructor(e,t,n){super(),this.ru=e,this.cacheSizeBytes=t,this.forceOwnership=n,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.ru.initialize(this,e),await PE(this.ru.syncEngine),await mu(this.ru.remoteStore),await this.persistence.Ci(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}eu(e){return sE(this.persistence,new rE,e.initialUser,this.serializer)}tu(e,t){const n=this.persistence.referenceDelegate.garbageCollector;return new Y0(n,e.asyncQueue,t)}nu(e,t){const n=new bC(t,this.persistence);return new kC(e.asyncQueue,n)}Xa(e){const t=nE(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),n=this.cacheSizeBytes!==void 0?hn.withCacheSize(this.cacheSizeBytes):hn.DEFAULT;return new dm(this.synchronizeTabs,t,e.clientId,n,e.asyncQueue,pE(),nh(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Za(e){return new fE}}class kN extends kE{constructor(e,t){super(e,t,!1),this.ru=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const t=this.ru.syncEngine;this.sharedClientState instanceof Yf&&(this.sharedClientState.syncEngine={uo:CN.bind(null,t),co:NN.bind(null,t),lo:RN.bind(null,t),zi:xN.bind(null,t),ao:SN.bind(null,t)},await this.sharedClientState.start()),await this.persistence.Ci(async n=>{await AN(this.ru.syncEngine,n),this.gcScheduler&&(n&&!this.gcScheduler.started?this.gcScheduler.start():n||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(n&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():n||this.indexBackfillerScheduler.stop())})}Za(e){const t=pE();if(!Yf.D(t))throw new Ce(se.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const n=nE(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Yf(t,e.asyncQueue,n,e.clientId,e.initialUser)}}class ru{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>w_(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=EN.bind(null,this.syncEngine),await bp(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new rN}()}createDatastore(e){const t=mE(e.databaseInfo.databaseId),n=function(a){return new jx(a)}(e.databaseInfo);return function(a,u,c,d){return new $x(a,u,c,d)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return function(n,i,a,u,c){return new qx(n,i,a,u,c)}(this.localStore,this.datastore,e.asyncQueue,t=>w_(this.syncEngine,t,0),function(){return p_.D()?new p_:new Mx}())}createSyncEngine(e,t){return function(i,a,u,c,d,p,g){const _=new dN(i,a,u,c,d,p);return g&&(_.ja=!0),_}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(i){const a=Re(i);oe(go,"RemoteStore shutting down."),a.W_.add(5),await pu(a),a.z_.shutdown(),a.j_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()}}ru.provider={build:()=>new ru};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bN{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.iu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.iu(this.observer.error,e):bt("Uncaught Error in snapshot listener:",e.toString()))}su(){this.muted=!0}iu(e,t){setTimeout(()=>{this.muted||e(t)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vi="FirestoreClient";class DN{constructor(e,t,n,i,a){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=i,this.user=cn.UNAUTHENTICATED,this.clientId=Ow.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=a,this.authCredentials.start(n,async u=>{oe(vi,"Received user=",u.uid),await this.authCredentialListener(u),this.user=u}),this.appCheckCredentials.start(n,u=>(oe(vi,"Received new app check token=",u),this.appCheckCredentialListener(u,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new fi;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=IE(t,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function Jf(r,e){r.asyncQueue.verifyOperationInProgress(),oe(vi,"Initializing OfflineComponentProvider");const t=r.configuration;await e.initialize(t);let n=t.initialUser;r.setCredentialChangeListener(async i=>{n.isEqual(i)||(await iE(e.localStore,i),n=i)}),e.persistence.setDatabaseDeletedListener(()=>r.terminate()),r._offlineComponents=e}async function T_(r,e){r.asyncQueue.verifyOperationInProgress();const t=await VN(r);oe(vi,"Initializing OnlineComponentProvider"),await e.initialize(t,r.configuration),r.setCredentialChangeListener(n=>g_(e.remoteStore,n)),r.setAppCheckTokenChangeListener((n,i)=>g_(e.remoteStore,i)),r._onlineComponents=e}async function VN(r){if(!r._offlineComponents)if(r._uninitializedComponentsProvider){oe(vi,"Using user provided OfflineComponentProvider");try{await Jf(r,r._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!function(i){return i.name==="FirebaseError"?i.code===se.FAILED_PRECONDITION||i.code===se.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(t))throw t;Wl("Error using user provided cache. Falling back to memory cache: "+t),await Jf(r,new nu)}}else oe(vi,"Using default OfflineComponentProvider"),await Jf(r,new PN(void 0));return r._offlineComponents}async function MN(r){return r._onlineComponents||(r._uninitializedComponentsProvider?(oe(vi,"Using user provided OnlineComponentProvider"),await T_(r,r._uninitializedComponentsProvider._online)):(oe(vi,"Using default OnlineComponentProvider"),await T_(r,new ru))),r._onlineComponents}async function ON(r){const e=await MN(r),t=e.eventManager;return t.onListen=fN.bind(null,e.syncEngine),t.onUnlisten=mN.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=pN.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=gN.bind(null,e.syncEngine),t}function FN(r,e,t={}){const n=new fi;return r.asyncQueue.enqueueAndForget(async()=>function(a,u,c,d,p){const g=new bN({next:E=>{g.su(),u.enqueueAndForget(()=>iN(a,_));const C=E.docs.has(c);!C&&E.fromCache?p.reject(new Ce(se.UNAVAILABLE,"Failed to get document because the client is offline.")):C&&E.fromCache&&d&&d.source==="server"?p.reject(new Ce(se.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):p.resolve(E)},error:E=>p.reject(E)}),_=new lN(Gh(c.path),g,{includeMetadataChanges:!0,Ta:!0});return sN(a,_)}(await ON(r),r.asyncQueue,e,t,n)),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bE(r){const e={};return r.timeoutSeconds!==void 0&&(e.timeoutSeconds=r.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const I_=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LN(r,e,t){if(!t)throw new Ce(se.INVALID_ARGUMENT,`Function ${r}() cannot be called with an empty ${e}.`)}function jN(r,e,t,n){if(e===!0&&n===!0)throw new Ce(se.INVALID_ARGUMENT,`${r} and ${t} cannot be used together.`)}function S_(r){if(!ye.isDocumentKey(r))throw new Ce(se.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${r} has ${r.length}.`)}function BN(r){if(r===void 0)return"undefined";if(r===null)return"null";if(typeof r=="string")return r.length>20&&(r=`${r.substring(0,20)}...`),JSON.stringify(r);if(typeof r=="number"||typeof r=="boolean")return""+r;if(typeof r=="object"){if(r instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(r);return e?`a custom ${e} object`:"an object"}}return typeof r=="function"?"a function":Ae()}function C_(r,e){if("_delegate"in r&&(r=r._delegate),!(r instanceof e)){if(e.name===r.constructor.name)throw new Ce(se.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=BN(r);throw new Ce(se.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zN="firestore.googleapis.com",A_=!0;class x_{constructor(e){var t,n;if(e.host===void 0){if(e.ssl!==void 0)throw new Ce(se.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=zN,this.ssl=A_}else this.host=e.host,this.ssl=(t=e.ssl)!==null&&t!==void 0?t:A_;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=G0;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<X0)throw new Ce(se.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}jN("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=bE((n=e.experimentalLongPollingOptions)!==null&&n!==void 0?n:{}),function(a){if(a.timeoutSeconds!==void 0){if(isNaN(a.timeoutSeconds))throw new Ce(se.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (must not be NaN)`);if(a.timeoutSeconds<5)throw new Ce(se.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (minimum allowed value is 5)`);if(a.timeoutSeconds>30)throw new Ce(se.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,i){return n.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class DE{constructor(e,t,n,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new x_({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Ce(se.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Ce(se.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new x_(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new TC;switch(n.type){case"firstParty":return new CC(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new Ce(se.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const n=I_.get(t);n&&(oe("ComponentProvider","Removing Datastore"),I_.delete(t),n.terminate())}(this),Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cm{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Cm(this.firestore,e,this._query)}}class Is{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new su(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Is(this.firestore,e,this._key)}}class su extends Cm{constructor(e,t,n){super(e,t,Gh(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Is(this.firestore,null,new ye(e))}withConverter(e){return new su(this.firestore,e,this._path)}}function UN(r,e,...t){if(r=ww(r),arguments.length===1&&(e=Ow.newId()),LN("doc","path",e),r instanceof DE){const n=at.fromString(e,...t);return S_(n),new Is(r,null,new ye(n))}{if(!(r instanceof Is||r instanceof su))throw new Ce(se.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=r._path.child(at.fromString(e,...t));return S_(n),new Is(r.firestore,r instanceof su?r.converter:null,new ye(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const N_="AsyncQueue";class R_{constructor(e=Promise.resolve()){this.Vu=[],this.mu=!1,this.fu=[],this.gu=null,this.pu=!1,this.yu=!1,this.wu=[],this.a_=new gE(this,"async_queue_retry"),this.bu=()=>{const n=nh();n&&oe(N_,"Visibility state changed to "+n.visibilityState),this.a_.t_()},this.Su=e;const t=nh();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.bu)}get isShuttingDown(){return this.mu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Du(),this.vu(e)}enterRestrictedMode(e){if(!this.mu){this.mu=!0,this.yu=e||!1;const t=nh();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.bu)}}enqueue(e){if(this.Du(),this.mu)return new Promise(()=>{});const t=new fi;return this.vu(()=>this.mu&&this.yu?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Vu.push(e),this.Cu()))}async Cu(){if(this.Vu.length!==0){try{await this.Vu[0](),this.Vu.shift(),this.a_.reset()}catch(e){if(!wi(e))throw e;oe(N_,"Operation failed with retryable error: "+e)}this.Vu.length>0&&this.a_.Xo(()=>this.Cu())}}vu(e){const t=this.Su.then(()=>(this.pu=!0,e().catch(n=>{this.gu=n,this.pu=!1;const i=function(u){let c=u.message||"";return u.stack&&(c=u.stack.includes(u.message)?u.stack:u.message+`
`+u.stack),c}(n);throw bt("INTERNAL UNHANDLED ERROR: ",i),n}).then(n=>(this.pu=!1,n))));return this.Su=t,t}enqueueAfterDelay(e,t,n){this.Du(),this.wu.indexOf(e)>-1&&(t=0);const i=_m.createAndSchedule(this,e,t,n,a=>this.Fu(a));return this.fu.push(i),i}Du(){this.gu&&Ae()}verifyOperationInProgress(){}async Mu(){let e;do e=this.Su,await e;while(e!==this.Su)}xu(e){for(const t of this.fu)if(t.timerId===e)return!0;return!1}Ou(e){return this.Mu().then(()=>{this.fu.sort((t,n)=>t.targetTimeMs-n.targetTimeMs);for(const t of this.fu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Mu()})}Nu(e){this.wu.push(e)}Fu(e){const t=this.fu.indexOf(e);this.fu.splice(t,1)}}class VE extends DE{constructor(e,t,n,i){super(e,t,n,i),this.type="firestore",this._queue=new R_,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new R_(e),this._firestoreClient=void 0,await e}}}function $N(r,e,t){t||(t=ph);const n=Sw(r,"firestore");if(n.isInitialized(t)){const i=n.getImmediate({identifier:t}),a=n.getOptions(t);if(oh(a,e))return i;throw new Ce(se.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if(e.cacheSizeBytes!==void 0&&e.localCache!==void 0)throw new Ce(se.INVALID_ARGUMENT,"cache and cacheSizeBytes cannot be specified at the same time as cacheSizeBytes willbe deprecated. Instead, specify the cache size in the cache object");if(e.cacheSizeBytes!==void 0&&e.cacheSizeBytes!==-1&&e.cacheSizeBytes<X0)throw new Ce(se.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return n.initialize({options:e,instanceIdentifier:t})}function WN(r){if(r._terminated)throw new Ce(se.FAILED_PRECONDITION,"The client has already been terminated.");return r._firestoreClient||qN(r),r._firestoreClient}function qN(r){var e,t,n;const i=r._freezeSettings(),a=function(c,d,p,g){return new lA(c,d,p,g.host,g.ssl,g.experimentalForceLongPolling,g.experimentalAutoDetectLongPolling,bE(g.experimentalLongPollingOptions),g.useFetchStreams)}(r._databaseId,((e=r._app)===null||e===void 0?void 0:e.options.appId)||"",r._persistenceKey,i);r._componentsProvider||!((t=i.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((n=i.localCache)===null||n===void 0)&&n._onlineComponentProvider)&&(r._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),r._firestoreClient=new DN(r._authCredentials,r._appCheckCredentials,r._queue,a,r._componentsProvider&&function(c){const d=c==null?void 0:c._online.build();return{_offline:c==null?void 0:c._offline.build(d),_online:d}}(r._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rh{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Rh(Vt.fromBase64String(e))}catch(t){throw new Ce(se.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Rh(Vt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ME{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Ce(se.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Dt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GN{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Ce(se.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Ce(se.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return ze(this._lat,e._lat)||ze(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KN{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,i){if(n.length!==i.length)return!1;for(let a=0;a<n.length;++a)if(n[a]!==i[a])return!1;return!0}(this._values,e._values)}}const HN=new RegExp("[~\\*/\\[\\]]");function QN(r,e,t){if(e.search(HN)>=0)throw P_(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,r);try{return new ME(...e.split("."))._internalPath}catch{throw P_(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,r)}}function P_(r,e,t,n,i){let a=`Function ${e}() called with invalid data`;a+=". ";let u="";return new Ce(se.INVALID_ARGUMENT,a+r+u)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OE{constructor(e,t,n,i,a){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=i,this._converter=a}get id(){return this._key.path.lastSegment()}get ref(){return new Is(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new XN(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(FE("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class XN extends OE{data(){return super.data()}}function FE(r,e){return typeof e=="string"?QN(r,e):e instanceof ME?e._internalPath:e._delegate._internalPath}class YN{convertValue(e,t="none"){switch(mi(e)){case 0:return null;case 1:return e.booleanValue;case 2:return vt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(xs(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Ae()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const n={};return lu(e,(i,a)=>{n[i]=this.convertValue(a,t)}),n}convertVectorValue(e){var t,n,i;const a=(i=(n=(t=e.fields)===null||t===void 0?void 0:t[Yl].arrayValue)===null||n===void 0?void 0:n.values)===null||i===void 0?void 0:i.map(u=>vt(u.doubleValue));return new KN(a)}convertGeoPoint(e){return new GN(vt(e.latitude),vt(e.longitude))}convertArray(e,t){return(e.values||[]).map(n=>this.convertValue(n,t))}convertServerTimestamp(e,t){switch(t){case"previous":const n=$h(e);return n==null?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(Xl(e));default:return null}}convertTimestamp(e){const t=As(e);return new Qt(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=at.fromString(e);ke(B0(n));const i=new co(n.get(1),n.get(3)),a=new ye(n.popFirst(5));return i.isEqual(t)||bt(`Document ${a} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZN{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class LE extends OE{constructor(e,t,n,i,a,u){super(e,t,n,i,u),this._firestore=e,this._firestoreImpl=e,this.metadata=a}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new JN(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const n=this._document.data.field(FE("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}class JN extends LE{data(e={}){return super.data(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eR(r){r=C_(r,Is);const e=C_(r.firestore,VE);return FN(WN(e),r._key).then(t=>nR(e,r,t))}class tR extends YN{constructor(e){super(),this.firestore=e}convertBytes(e){return new Rh(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Is(this.firestore,null,t)}}function nR(r,e,t){const n=t.docs.get(e._key),i=new tR(r);return new LE(r,i,e._key,n,new ZN(t.hasPendingWrites,t.fromCache),e.converter)}class rR{constructor(e){let t;this.kind="persistent",e!=null&&e.tabManager?(e.tabManager._initialize(e),t=e.tabManager):(t=aR(),t._initialize(e)),this._onlineComponentProvider=t._onlineComponentProvider,this._offlineComponentProvider=t._offlineComponentProvider}toJSON(){return{kind:this.kind}}}function sR(r){return new rR(r)}class iR{constructor(e){this.forceOwnership=e,this.kind="persistentSingleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=ru.provider,this._offlineComponentProvider={build:t=>new kE(t,e==null?void 0:e.cacheSizeBytes,this.forceOwnership)}}}class oR{constructor(){this.kind="PersistentMultipleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=ru.provider,this._offlineComponentProvider={build:t=>new kN(t,e==null?void 0:e.cacheSizeBytes)}}}function aR(r){return new iR(void 0)}function lR(){return new oR}(function(e,t=!0){(function(i){Fa=i})(Aw),Ul(new _a("firestore",(n,{instanceIdentifier:i,options:a})=>{const u=n.getProvider("app").getImmediate(),c=new VE(new IC(n.getProvider("auth-internal")),new AC(u,n.getProvider("app-check-internal")),function(p,g){if(!Object.prototype.hasOwnProperty.apply(p.options,["projectId"]))throw new Ce(se.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new co(p.options.projectId,g)}(u,i),u);return a=Object.assign({useFetchStreams:t},a),c._setSettings(a),c},"PUBLIC").setMultipleInstances(!0)),hi(fv,pv,e),hi(fv,pv,"esm2017")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jE="firebasestorage.googleapis.com",uR="storageBucket",cR=2*60*1e3,hR=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ss extends vo{constructor(e,t,n=0){super(ep(e),`Firebase Storage: ${t} (${ep(e)})`),this.status_=n,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,ss.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return ep(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var ns;(function(r){r.UNKNOWN="unknown",r.OBJECT_NOT_FOUND="object-not-found",r.BUCKET_NOT_FOUND="bucket-not-found",r.PROJECT_NOT_FOUND="project-not-found",r.QUOTA_EXCEEDED="quota-exceeded",r.UNAUTHENTICATED="unauthenticated",r.UNAUTHORIZED="unauthorized",r.UNAUTHORIZED_APP="unauthorized-app",r.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",r.INVALID_CHECKSUM="invalid-checksum",r.CANCELED="canceled",r.INVALID_EVENT_NAME="invalid-event-name",r.INVALID_URL="invalid-url",r.INVALID_DEFAULT_BUCKET="invalid-default-bucket",r.NO_DEFAULT_BUCKET="no-default-bucket",r.CANNOT_SLICE_BLOB="cannot-slice-blob",r.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",r.NO_DOWNLOAD_URL="no-download-url",r.INVALID_ARGUMENT="invalid-argument",r.INVALID_ARGUMENT_COUNT="invalid-argument-count",r.APP_DELETED="app-deleted",r.INVALID_ROOT_OPERATION="invalid-root-operation",r.INVALID_FORMAT="invalid-format",r.INTERNAL_ERROR="internal-error",r.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(ns||(ns={}));function ep(r){return"storage/"+r}function dR(){const r="An unknown error occurred, please check the error payload for server response.";return new ss(ns.UNKNOWN,r)}function fR(){return new ss(ns.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function pR(){return new ss(ns.CANCELED,"User canceled the upload/download.")}function mR(r){return new ss(ns.INVALID_URL,"Invalid URL '"+r+"'.")}function gR(r){return new ss(ns.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+r+"'.")}function k_(r){return new ss(ns.INVALID_ARGUMENT,r)}function BE(){return new ss(ns.APP_DELETED,"The Firebase app was deleted.")}function yR(r){return new ss(ns.INVALID_ROOT_OPERATION,"The operation '"+r+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mr{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let n;try{n=Mr.makeFromUrl(e,t)}catch{return new Mr(e,"")}if(n.path==="")return n;throw gR(e)}static makeFromUrl(e,t){let n=null;const i="([A-Za-z0-9.\\-_]+)";function a(X){X.path.charAt(X.path.length-1)==="/"&&(X.path_=X.path_.slice(0,-1))}const u="(/(.*))?$",c=new RegExp("^gs://"+i+u,"i"),d={bucket:1,path:3};function p(X){X.path_=decodeURIComponent(X.path)}const g="v[A-Za-z0-9_]+",_=t.replace(/[.]/g,"\\."),E="(/([^?#]*).*)?$",C=new RegExp(`^https?://${_}/${g}/b/${i}/o${E}`,"i"),A={bucket:1,path:3},P=t===jE?"(?:storage.googleapis.com|storage.cloud.google.com)":t,M="([^?#]*)",U=new RegExp(`^https?://${P}/${i}/${M}`,"i"),z=[{regex:c,indices:d,postModify:a},{regex:C,indices:A,postModify:p},{regex:U,indices:{bucket:1,path:2},postModify:p}];for(let X=0;X<z.length;X++){const j=z[X],$=j.regex.exec(e);if($){const x=$[j.indices.bucket];let I=$[j.indices.path];I||(I=""),n=new Mr(x,I),j.postModify(n);break}}if(n==null)throw mR(e);return n}}class vR{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _R(r,e,t){let n=1,i=null,a=null,u=!1,c=0;function d(){return c===2}let p=!1;function g(...M){p||(p=!0,e.apply(null,M))}function _(M){i=setTimeout(()=>{i=null,r(C,d())},M)}function E(){a&&clearTimeout(a)}function C(M,...U){if(p){E();return}if(M){E(),g.call(null,M,...U);return}if(d()||u){E(),g.call(null,M,...U);return}n<64&&(n*=2);let z;c===1?(c=2,z=0):z=(n+Math.random())*1e3,_(z)}let A=!1;function P(M){A||(A=!0,E(),!p&&(i!==null?(M||(c=2),clearTimeout(i),_(0)):M||(c=1)))}return _(0),a=setTimeout(()=>{u=!0,P(!0)},t),P}function wR(r){r(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ER(r){return r!==void 0}function b_(r,e,t,n){if(n<e)throw k_(`Invalid value for '${r}'. Expected ${e} or greater.`);if(n>t)throw k_(`Invalid value for '${r}'. Expected ${t} or less.`)}function TR(r){const e=encodeURIComponent;let t="?";for(const n in r)if(r.hasOwnProperty(n)){const i=e(n)+"="+e(r[n]);t=t+i+"&"}return t=t.slice(0,-1),t}var Ph;(function(r){r[r.NO_ERROR=0]="NO_ERROR",r[r.NETWORK_ERROR=1]="NETWORK_ERROR",r[r.ABORT=2]="ABORT"})(Ph||(Ph={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IR(r,e){const t=r>=500&&r<600,i=[408,429].indexOf(r)!==-1,a=e.indexOf(r)!==-1;return t||i||a}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SR{constructor(e,t,n,i,a,u,c,d,p,g,_,E=!0){this.url_=e,this.method_=t,this.headers_=n,this.body_=i,this.successCodes_=a,this.additionalRetryCodes_=u,this.callback_=c,this.errorCallback_=d,this.timeout_=p,this.progressCallback_=g,this.connectionFactory_=_,this.retry=E,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((C,A)=>{this.resolve_=C,this.reject_=A,this.start_()})}start_(){const e=(n,i)=>{if(i){n(!1,new Gc(!1,null,!0));return}const a=this.connectionFactory_();this.pendingConnection_=a;const u=c=>{const d=c.loaded,p=c.lengthComputable?c.total:-1;this.progressCallback_!==null&&this.progressCallback_(d,p)};this.progressCallback_!==null&&a.addUploadProgressListener(u),a.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&a.removeUploadProgressListener(u),this.pendingConnection_=null;const c=a.getErrorCode()===Ph.NO_ERROR,d=a.getStatus();if(!c||IR(d,this.additionalRetryCodes_)&&this.retry){const g=a.getErrorCode()===Ph.ABORT;n(!1,new Gc(!1,null,g));return}const p=this.successCodes_.indexOf(d)!==-1;n(!0,new Gc(p,a))})},t=(n,i)=>{const a=this.resolve_,u=this.reject_,c=i.connection;if(i.wasSuccessCode)try{const d=this.callback_(c,c.getResponse());ER(d)?a(d):a()}catch(d){u(d)}else if(c!==null){const d=dR();d.serverResponse=c.getErrorText(),this.errorCallback_?u(this.errorCallback_(c,d)):u(d)}else if(i.canceled){const d=this.appDelete_?BE():pR();u(d)}else{const d=fR();u(d)}};this.canceled_?t(!1,new Gc(!1,null,!0)):this.backoffId_=_R(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&wR(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class Gc{constructor(e,t,n){this.wasSuccessCode=e,this.connection=t,this.canceled=!!n}}function CR(r,e){e!==null&&e.length>0&&(r.Authorization="Firebase "+e)}function AR(r,e){r["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function xR(r,e){e&&(r["X-Firebase-GMPID"]=e)}function NR(r,e){e!==null&&(r["X-Firebase-AppCheck"]=e)}function RR(r,e,t,n,i,a,u=!0){const c=TR(r.urlParams),d=r.url+c,p=Object.assign({},r.headers);return xR(p,e),CR(p,t),AR(p,a),NR(p,n),new SR(d,r.method,p,r.body,r.successCodes,r.additionalRetryCodes,r.handler,r.errorHandler,r.timeout,r.progressCallback,i,u)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PR(r){if(r.length===0)return null;const e=r.lastIndexOf("/");return e===-1?"":r.slice(0,e)}function kR(r){const e=r.lastIndexOf("/",r.length-2);return e===-1?r:r.slice(e+1)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kh{constructor(e,t){this._service=e,t instanceof Mr?this._location=t:this._location=Mr.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new kh(e,t)}get root(){const e=new Mr(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return kR(this._location.path)}get storage(){return this._service}get parent(){const e=PR(this._location.path);if(e===null)return null;const t=new Mr(this._location.bucket,e);return new kh(this._service,t)}_throwIfRoot(e){if(this._location.path==="")throw yR(e)}}function D_(r,e){const t=e==null?void 0:e[uR];return t==null?null:Mr.makeFromBucketSpec(t,r)}function bR(r,e,t,n={}){r.host=`${e}:${t}`,r._protocol="http";const{mockUserToken:i}=n;i&&(r._overrideAuthToken=typeof i=="string"?i:s1(i,r.app.options.projectId))}class DR{constructor(e,t,n,i,a){this.app=e,this._authProvider=t,this._appCheckProvider=n,this._url=i,this._firebaseVersion=a,this._bucket=null,this._host=jE,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=cR,this._maxUploadRetryTime=hR,this._requests=new Set,i!=null?this._bucket=Mr.makeFromBucketSpec(i,this._host):this._bucket=D_(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Mr.makeFromBucketSpec(this._url,e):this._bucket=D_(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){b_("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){b_("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(t!==null)return t.accessToken}return null}async _getAppCheckToken(){if(Cw(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new kh(this,e)}_makeRequest(e,t,n,i,a=!0){if(this._deleted)return new vR(BE());{const u=RR(e,this._appId,n,i,t,this._firebaseVersion,a);return this._requests.add(u),u.getPromise().then(()=>this._requests.delete(u),()=>this._requests.delete(u)),u}}async makeRequestWithTokens(e,t){const[n,i]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,n,i).getPromise()}}const V_="@firebase/storage",M_="0.13.7";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zE="storage";function VR(r=lC(),e){r=ww(r);const n=Sw(r,zE).getImmediate({identifier:e}),i=n1("storage");return i&&MR(n,...i),n}function MR(r,e,t,n={}){bR(r,e,t,n)}function OR(r,{instanceIdentifier:e}){const t=r.getProvider("app").getImmediate(),n=r.getProvider("auth-internal"),i=r.getProvider("app-check-internal");return new DR(t,n,i,e,Aw)}function FR(){Ul(new _a(zE,OR,"PUBLIC").setMultipleInstances(!0)),hi(V_,M_,""),hi(V_,M_,"esm2017")}FR();const LR={apiKey:"AIzaSyAlv8DyWdhTjJjZYPqkghZUyEupG5g8SFk",authDomain:"groove-slider.firebaseapp.com",projectId:"groove-slider",storageBucket:"groove-slider.appspot.com",messagingSenderId:"87433841566",appId:"1:87433841566:web:da11fb420a121cc700248f",measurementId:"G-X0QJM954YF"},UE=xw(LR),tp=$N(UE,{localCache:sR({tabManager:lR()})});VR(UE);function jR(r,e){return new Promise((t,n)=>{try{const i=BR();i.onmessage=a=>{a.data.type==="complete"?(t(a.data.file),i.terminate()):a.data.type==="error"&&(n(new Error(a.data.error)),i.terminate())},i.onerror=a=>{n(a),i.terminate()},i.postMessage({data:r,config:e})}catch(i){n(i)}})}function BR(){const r=`
    self.onmessage = async (event) => {
      const { data, config } = event.data;
      
      try {
        // Basic export processing
        const exportedFile = await processExport(data, config);
        
        self.postMessage({ 
          type: 'complete', 
          file: exportedFile 
        });
      } catch (error) {
        self.postMessage({ 
          type: 'error', 
          error: error.message 
        });
      }
    };
    
    async function processExport(data, config) {
      console.log('Processing export', data, config);
      return data; // Temporary return
    }
  `,e=new Blob([r],{type:"application/javascript"});return new Worker(URL.createObjectURL(e))}const zR=({value:r,onChange:e})=>{var u;const[t,n]=le.useState(!1),i=[{value:"720x1280",label:"720p"},{value:"1080x1920",label:"1080p"},{value:"1440x2560",label:"2K"}],a=c=>{e(c),n(!1)};return T.jsxs("div",{className:"custom-resolution-dropdown",children:[T.jsxs("div",{className:"dropdown-header",onClick:()=>n(!t),children:[((u=i.find(c=>c.value===r))==null?void 0:u.label)||r,t?T.jsx(eS,{size:16}):T.jsx(XI,{size:16})]}),t&&T.jsx("div",{className:"dropdown-list",children:i.map(c=>T.jsx("div",{className:"dropdown-item",onClick:()=>a(c.value),children:c.label},c.value))})]})},UR=({isOpen:r,progress:e,message:t,onClose:n,onExport:i,isExporting:a,storyData:u})=>{const[c,d]=le.useState("1080x1920"),[p,g]=le.useState(!1),[_,E]=le.useState(30),[C,A]=le.useState(null),P=async()=>{const M={resolution:c,isExportLoopEnabled:p,exportLoopDuration:_};try{A(null);const W=await jR({storyData:u,resolution:c,isExportLoopEnabled:p,exportLoopDuration:_},M);i(W)}catch(U){console.error("Export failed",U),A(U.message||"Export failed. Please try again.")}};return r?T.jsx("div",{className:"modal-overlay",children:T.jsxs("div",{className:"modal-content export-modal",children:[T.jsx("button",{className:"modal-close",onClick:n,children:T.jsx(lo,{size:20})}),a?T.jsxs("div",{className:"loading-container",children:[T.jsx("h3",{children:"Exporting Video"}),T.jsx("p",{children:t}),T.jsxs("div",{className:"progress-container",children:[T.jsx("div",{className:"progress-bar",children:T.jsx("div",{className:"progress-fill",style:{width:`${e}%`}})}),T.jsxs("span",{className:"progress-text",children:[Math.round(e),"%"]})]})]}):T.jsxs(T.Fragment,{children:[T.jsx("h3",{className:"modal-title",children:"Export Settings"}),T.jsxs("div",{className:"resolution-selector",children:[T.jsx("label",{children:"Resolution:"}),T.jsx(zR,{value:c,onChange:d})]}),T.jsxs("div",{className:"export-loop-settings",children:[T.jsx("div",{className:"loop-toggle",children:T.jsxs("label",{children:[T.jsx("span",{children:"Export as Loop"}),T.jsx("input",{type:"checkbox",checked:p,onChange:()=>g(!p)})]})}),p&&T.jsxs("div",{className:"input-container",children:[T.jsx("label",{children:"Loop Duration (seconds):"}),T.jsx("input",{type:"number",min:"5",max:"300",value:_,onChange:M=>E(Number(M.target.value)),className:"loop-duration-input"})]})]}),C&&T.jsx("div",{className:"export-error-message",children:C}),T.jsxs("div",{className:"export-actions",children:[T.jsxs("button",{className:"action-button share",onClick:()=>{},children:[T.jsx(LS,{className:"button-icon"}),"Share"]}),T.jsxs("button",{className:"action-button download",onClick:P,children:[T.jsx(cw,{className:"button-icon"}),"Export"]})]})]})]})}):null},$R=({isOpen:r,onClose:e,onSave:t})=>{const[n,i]=le.useState(""),[a,u]=le.useState(!1),[c,d]=le.useState(null);if(!r)return null;const p=async g=>{if(g.preventDefault(),!n.trim()){d("Please enter a session name");return}try{u(!0),d(null),await t(n),i(""),e()}catch(_){console.error("Error saving session:",_),d("Failed to save session: "+_.message)}finally{u(!1)}};return T.jsx("div",{className:"modal-overlay",children:T.jsxs("div",{className:"modal-content save-session-modal",children:[T.jsx("button",{className:"modal-close",onClick:e,children:T.jsx(lo,{size:20})}),T.jsx("h3",{className:"modal-title",children:"Save Session"}),T.jsxs("form",{onSubmit:p,children:[T.jsxs("div",{className:"form-group",children:[T.jsx("label",{htmlFor:"session-name",children:"Session Name:"}),T.jsx("input",{type:"text",id:"session-name",value:n,onChange:g=>i(g.target.value),placeholder:"Enter a name for your session",autoFocus:!0,maxLength:50,className:"session-name-input"})]}),c&&T.jsx("div",{className:"save-error",children:c}),T.jsxs("div",{className:"modal-actions",children:[T.jsx("button",{type:"button",className:"cancel-button",onClick:e,disabled:a,children:"Cancel"}),T.jsx("button",{type:"submit",className:"save-button",disabled:a,children:a?T.jsxs(T.Fragment,{children:[T.jsx("div",{className:"spinner small"}),"Saving..."]}):T.jsxs(T.Fragment,{children:[T.jsx(fw,{size:16}),"Save Session"]})})]})]})]})})},O_={name:"GrooveGalleryDB",version:1},nd=()=>new Promise((r,e)=>{const t=indexedDB.open(O_.name,O_.version);t.onupgradeneeded=n=>{const i=n.target.result;if(!i.objectStoreNames.contains("sessions")){const a=i.createObjectStore("sessions",{keyPath:"id",autoIncrement:!0});a.createIndex("name","name",{unique:!1}),a.createIndex("createdAt","createdAt",{unique:!1})}i.objectStoreNames.contains("images")||i.createObjectStore("images",{keyPath:"id",autoIncrement:!0}).createIndex("sessionId","sessionId",{unique:!1}),i.objectStoreNames.contains("music")||i.createObjectStore("music",{keyPath:"id",autoIncrement:!0}).createIndex("sessionId","sessionId",{unique:!1})},t.onsuccess=n=>{const i=n.target.result;r(i)},t.onerror=n=>{console.error("IndexedDB error:",n.target.error),e(n.target.error)}}),WR=async r=>{try{const e=[];for(const d of r.stories)try{const g=await(await fetch(d.url)).blob();e.push({type:d.type,blob:g})}catch(p){console.error("Error processing image:",p)}let t=null;if(r.musicUrl)try{t=await(await fetch(r.musicUrl)).blob()}catch(d){console.error("Error processing music:",d)}const i=(await nd()).transaction(["sessions","images","music"],"readwrite"),a=i.objectStore("sessions"),u={name:r.name,createdAt:new Date,bpm:r.bpm,musicStartPoint:r.musicStartPoint,imageFitMode:r.imageFitMode,duration:r.duration,isLoopingEnabled:r.isLoopingEnabled,currentIndex:r.currentIndex},c=a.add(u);return new Promise((d,p)=>{c.onsuccess=async g=>{const _=g.target.result,E=i.objectStore("images");for(const C of e)E.add({sessionId:_,type:C.type,blob:C.blob});t&&i.objectStore("music").add({sessionId:_,blob:t}),i.oncomplete=()=>{console.log(`Session saved with ID: ${_}`),d(_)},i.onerror=C=>{console.error("Transaction error:",C.target.error),p(C.target.error)}},c.onerror=g=>{console.error("Error adding session:",g.target.error),p(g.target.error)}})}catch(e){throw console.error("saveSession error:",e),e}},qR=async r=>{try{const e=await nd(),t=await new Promise((c,d)=>{const _=e.transaction("sessions","readonly").objectStore("sessions").get(r);_.onsuccess=E=>{c(E.target.result)},_.onerror=E=>{d(E.target.error)}});if(!t)throw new Error(`Session with ID ${r} not found`);const i=(await new Promise((c,d)=>{const E=e.transaction("images","readonly").objectStore("images").index("sessionId").getAll(r);E.onsuccess=C=>{c(C.target.result)},E.onerror=C=>{d(C.target.error)}})).map(c=>({type:c.type,url:URL.createObjectURL(c.blob)})),a=await new Promise((c,d)=>{const E=e.transaction("music","readonly").objectStore("music").index("sessionId").get(r);E.onsuccess=C=>{c(C.target.result)},E.onerror=C=>{d(C.target.error)}});let u=null;return a&&a.blob&&(u=URL.createObjectURL(a.blob)),{...t,stories:i,musicUrl:u}}catch(e){throw console.error("loadSession error:",e),e}},GR=async()=>{try{const r=await nd();return new Promise((e,t)=>{const a=r.transaction("sessions","readonly").objectStore("sessions").getAll();a.onsuccess=u=>{e(u.target.result)},a.onerror=u=>{t(u.target.error)}})}catch(r){throw console.error("getAllSessions error:",r),r}},KR=async r=>{try{const t=(await nd()).transaction(["sessions","images","music"],"readwrite");t.objectStore("sessions").delete(r);const u=t.objectStore("images").index("sessionId").openCursor(IDBKeyRange.only(r));u.onsuccess=g=>{const _=g.target.result;_&&(_.delete(),_.continue())};const p=t.objectStore("music").index("sessionId").openCursor(IDBKeyRange.only(r));return p.onsuccess=g=>{const _=g.target.result;_&&(_.delete(),_.continue())},new Promise((g,_)=>{t.oncomplete=()=>{console.log(`Session ${r} deleted successfully`),g()},t.onerror=E=>{console.error("Error deleting session:",E.target.error),_(E.target.error)}})}catch(e){throw console.error("deleteSession error:",e),e}},HR=({onLoadSession:r,visible:e})=>{const[t,n]=le.useState([]),[i,a]=le.useState(!0),[u,c]=le.useState(null);le.useEffect(()=>{e&&d()},[e]);const d=async()=>{try{a(!0);const E=(await GR()).filter(C=>!C.name.startsWith("auto_save_"));E.sort((C,A)=>new Date(A.createdAt)-new Date(C.createdAt)),n(E),c(null)}catch(_){console.error("Error loading sessions:",_),c("Failed to load saved sessions")}finally{a(!1)}},p=async(_,E)=>{if(_.stopPropagation(),window.confirm("Are you sure you want to delete this session?"))try{await KR(E),n(t.filter(C=>C.id!==E))}catch(C){console.error("Error deleting session:",C),alert("Failed to delete session")}},g=_=>new Date(_).toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});return e?T.jsxs("div",{className:"sessions-list",children:[T.jsx("h3",{className:"sessions-title",children:"Saved Sessions"}),i&&T.jsx("div",{className:"sessions-loading",children:"Loading saved sessions..."}),u&&T.jsx("div",{className:"sessions-error",children:u}),!i&&t.length===0&&T.jsxs("div",{className:"sessions-empty",children:[T.jsx("p",{children:"No saved sessions yet"}),T.jsx("p",{className:"sessions-hint",children:"Create a slideshow and click Save to add one"})]}),!i&&t.length>0&&T.jsx("ul",{className:"sessions-items",children:t.map(_=>T.jsxs("li",{className:"session-item",onClick:()=>r(_.id),children:[T.jsxs("div",{className:"session-info",children:[T.jsx("div",{className:"session-name",children:_.name}),T.jsxs("div",{className:"session-date",children:[T.jsx(uw,{size:12}),T.jsx("span",{children:g(_.createdAt)})]}),T.jsxs("div",{className:"session-details",children:[T.jsxs("span",{children:[_.bpm," BPM"]}),T.jsxs("span",{children:[_.duration.toFixed(1),"s/slide"]})]})]}),T.jsxs("div",{className:"session-actions",children:[T.jsx("button",{className:"session-delete-btn",onClick:E=>p(E,_.id),title:"Delete session",children:T.jsx(WS,{size:16})}),T.jsx(ii,{size:16,className:"session-arrow"})]})]},_.id))})]}):null},gu=()=>new Promise((r,e)=>{const t=indexedDB.open("AudioVisualizerDB",3);t.onerror=n=>e("IndexedDB error: "+n.target.errorCode),t.onupgradeneeded=n=>{const i=n.target.result;i.objectStoreNames.contains("audioPositions")||i.createObjectStore("audioPositions",{keyPath:"audioUrl"}),i.objectStoreNames.contains("visualizerStates")||i.createObjectStore("visualizerStates",{keyPath:"audioUrl"}),i.objectStoreNames.contains("audioBuffers")||i.createObjectStore("audioBuffers",{keyPath:"audioUrl"})},t.onsuccess=n=>r(n.target.result)}),np=async(r,e)=>{try{const i=(await gu()).transaction(["audioPositions"],"readwrite").objectStore("audioPositions");return new Promise((a,u)=>{const c=i.put({audioUrl:r,...e,timestamp:Date.now()});c.onsuccess=()=>a(!0),c.onerror=()=>u(!1)})}catch(t){return console.error("Error storing audio positions:",t),!1}},F_=async(r,e)=>{try{console.log(`Attempting to store audio buffer for: ${r}`);const t=await gu(),n=new(window.AudioContext||window.webkitAudioContext),i=e.getChannelData(0),a={audioUrl:r,channels:e.numberOfChannels,sampleRate:e.sampleRate,length:e.length,duration:e.duration,channelData:i.buffer,timestamp:Date.now()},c=t.transaction(["audioBuffers"],"readwrite").objectStore("audioBuffers");return new Promise((d,p)=>{const g=c.put(a);g.onsuccess=()=>{console.log(`Successfully stored audio buffer for: ${r}`),d(!0)},g.onerror=_=>{console.error(`Failed to store audio buffer for: ${r}`,_),p(!1)}})}catch(t){return console.error("Error storing audio buffer:",t),!1}},QR=async r=>{try{console.log(`Attempting to retrieve audio buffer for: ${r}`);const n=(await gu()).transaction(["audioBuffers"],"readonly").objectStore("audioBuffers");return new Promise((i,a)=>{const u=n.get(r);u.onsuccess=c=>{const d=c.target.result;if(d){const g=new(window.AudioContext||window.webkitAudioContext)().createBuffer(d.channels,d.length,d.sampleRate);for(let _=0;_<d.channels;_++)g.getChannelData(_).set(new Float32Array(d.channelData));console.log(`Retrieved audio buffer for ${r}`),i({buffer:g})}else i(null)},u.onerror=c=>{console.error(`Error retrieving audio buffer for: ${r}`,c),a(null)}})}catch(e){return console.error("Error retrieving audio buffer:",e),null}},L_=async(r,e)=>{try{const i=(await gu()).transaction(["visualizerStates"],"readwrite").objectStore("visualizerStates");return new Promise((a,u)=>{const c=i.put({audioUrl:r,...e,timestamp:Date.now()});c.onsuccess=()=>a(!0),c.onerror=()=>u(!1)})}catch(t){return console.error("Error storing visualizer state:",t),!1}},XR=async r=>{try{const n=(await gu()).transaction(["visualizerStates"],"readonly").objectStore("visualizerStates");return new Promise((i,a)=>{const u=n.get(r);u.onsuccess=c=>{i(c.target.result||null)},u.onerror=()=>a(null)})}catch(e){return console.error("Error retrieving visualizer state:",e),null}},YR=({audioUrl:r,onStartPointChange:e,audioRef:t,musicStartPoint:n=0})=>{const i=le.useRef(null),a=le.useRef(null),[u,c]=le.useState(null),[d,p]=le.useState(!0),[g,_]=le.useState(0),[E,C]=le.useState(800),[A,P]=le.useState(0),[M,U]=le.useState(16),[W,z]=le.useState(0),[X,j]=le.useState(!1),[$,x]=le.useState(!1),I=le.useRef(null),R=le.useRef(null),b=le.useRef(!1);le.useEffect(()=>{if(!r||I.current===r)return;I.current=r,p(!0),(async()=>{try{const[q,ge]=await Promise.all([XR(r),QR(r)]),Te=new(window.AudioContext||window.webkitAudioContext);let be;if(ge)be=ge.buffer,console.log("Using cached audio buffer");else{const et=await(await fetch(r)).arrayBuffer();be=await Te.decodeAudioData(et),await F_(r,be)}c(be),_(be.duration),q&&(q.zoomLevel&&U(q.zoomLevel),q.waveformOffset!==void 0&&z(q.waveformOffset),e&&q.startPoint!==void 0&&Math.abs(q.startPoint-n)>.001&&e(q.startPoint)),p(!1)}catch(q){console.error("Error loading audio:",q),p(!1)}})()},[r,e,n]),le.useEffect(()=>{if(!r||!u)return;const te=setTimeout(()=>{Promise.all([L_(r,{zoomLevel:M,waveformOffset:W}),F_(r,u)]).catch(q=>{console.error("Auto-save failed:",q)})},5e3);return()=>clearTimeout(te)},[r,u,M,W]),le.useEffect(()=>{const te=t==null?void 0:t.current;if(!te)return;const q=()=>{const Te=te.currentTime;if(P(Te),b.current=!te.paused,X&&b.current){const be=g/M,$e=W,et=$e+be,Le=be*.2;if(Te>et-Le){const Pt=Math.max(0,Math.min(g-be,Te-be*.8));z(Pt)}else if(Te<$e+Le){const Pt=Math.max(0,Math.min(g-be,Te-be*.2));z(Pt)}}},ge=()=>{b.current&&te&&q(),R.current=requestAnimationFrame(ge)};return ge(),te.addEventListener("timeupdate",q),te.addEventListener("play",()=>{b.current=!0}),te.addEventListener("pause",()=>{b.current=!1}),te.addEventListener("seeking",q),()=>{te.removeEventListener("timeupdate",q),te.removeEventListener("play",()=>{b.current=!0}),te.removeEventListener("pause",()=>{b.current=!1}),te.removeEventListener("seeking",q),R.current&&cancelAnimationFrame(R.current)}},[t,X,M,W,g]),le.useEffect(()=>{if(!u||g===0||!r)return;if(M>1){const q=g/M,ge=Math.max(0,Math.min(g-q,n-q/2));z(ge)}const te=setTimeout(()=>{np(r,{startPoint:n}).catch(q=>console.error("Error saving to IndexedDB:",q))},1e3);return()=>clearTimeout(te)},[n,M,u,g,r]);const D=(te,q=!0)=>{if(isNaN(te))return"00:00.000";const ge=Math.floor(te/60),Te=Math.floor(te%60);if(q){const be=Math.floor(te%1*1e3);return`${ge.toString().padStart(2,"0")}:${Te.toString().padStart(2,"0")}.${be.toString().padStart(3,"0")}`}else return`${ge.toString().padStart(2,"0")}:${Te.toString().padStart(2,"0")}`},V=le.useCallback(()=>{if(!u||!i.current)return;const te=i.current,q=te.getContext("2d"),ge=te.width,Te=te.height;q.clearRect(0,0,ge,Te),q.fillStyle="#000",q.fillRect(0,0,ge,Te);const be=u.getChannelData(0),$e=g/M,et=Math.max(0,Math.min(g-$e,W)),Le=et+$e,Pt=be.length,On=Math.floor(et/g*Pt),fr=Math.floor(Le/g*Pt)-On,Zn=1,mn=0,gn=Math.floor(ge/(Zn+mn)),Lr=Math.floor(fr/gn);q.fillStyle="#ffecb4";for(let wt=0;wt<gn;wt++){const Fn=wt*(Zn+mn),st=On+Math.floor(wt/gn*fr);let ht=0;for(let Ln=0;Ln<Lr;Ln++){const gr=st+Ln;if(gr<be.length){const yr=Math.abs(be[gr]);yr>ht&&(ht=yr)}}const yn=Math.min(2,ht*.9)*(Te/2),jr=Fn,Jn=Te/2-yn,mr=yn*2;q.fillRect(jr,Jn,Zn,mr)}if(q.strokeStyle="rgba(100, 100, 100, 0.3)",q.lineWidth=1,q.beginPath(),q.moveTo(0,Te/2),q.lineTo(ge,Te/2),q.stroke(),q.beginPath(),q.moveTo(0,Te/4),q.lineTo(ge,Te/4),q.moveTo(0,3*Te/4),q.lineTo(ge,3*Te/4),q.stroke(),q.fillStyle="#777",q.font="10px Arial",A>=et&&A<=Le){const wt=(A-et)/$e*ge;q.fillStyle="rgb(255, 132, 0)";const Fn=$?7:5;q.fillRect(wt-Math.floor(Fn/2),0,Fn,Te),q.beginPath(),q.moveTo(wt,0),q.lineTo(wt-4,-4),q.lineTo(wt+4,-4),q.closePath(),q.fill()}if(n>=et&&n<=Le){const wt=(n-et)/$e*ge;q.fillStyle="rgba(61, 255, 8, 0.8)",q.fillRect(wt-1,0,5,Te),q.beginPath(),q.moveTo(wt,0),q.lineTo(wt-6,-6),q.lineTo(wt+6,-6),q.closePath(),q.fill()}const pr=3;q.fillStyle="rgba(100, 100, 255, 0.5)",q.fillRect(0,Te-pr,ge*($e/g),pr)},[u,A,M,W,g,n,E]);le.useEffect(()=>{if(u&&!d){const te=requestAnimationFrame(V);return()=>cancelAnimationFrame(te)}},[u,A,M,W,g,n,d,V]);const k=te=>{if(te.preventDefault(),te.stopPropagation(),!u||!i.current||ee)return;const q=i.current,ge=q.getBoundingClientRect(),be=(te.type.includes("touch")?te.touches?te.touches[0].clientX:te.changedTouches[0].clientX:te.clientX)-ge.left,$e=g/M,et=W,Le=be/q.width,Pt=et+Le*$e,On=Math.round(Pt*1e3)/1e3,Yn=Math.max(0,Math.min(g,On));t!=null&&t.current&&(t.current.currentTime=Yn),P(Yn),console.log({zoomLevel:M,canvasWidth:q.width,clickPosition:be,clickRatio:Le,visibleStart:et.toFixed(3),visibleDuration:$e.toFixed(3),calculatedTime:Pt.toFixed(3),finalTime:Yn.toFixed(3)}),r&&L_(r,{zoomLevel:M,waveformOffset:W,startPoint:n}).catch(fr=>console.error("Save on click failed:",fr))},ue=()=>{U(te=>{if(te>=64)return te;const q=Math.min(64,te*2);if(u){const ge=g/te,Te=W+ge/2,be=g/q,$e=Math.max(0,Math.min(g-be,Te-be/2));z($e)}return q})},ve=()=>{U(te=>{if(te<=1)return 1;const q=Math.max(1,te/2);if(q===1)z(0);else if(u){const ge=g/te,Te=W+ge/2,be=g/q,$e=Math.max(0,Math.min(g-be,Te-be/2));z($e)}return q})},pe=()=>{if(!u)return;const te=g/M,q=Math.max(0,Math.min(g-te,n-te/2));z(q)},de=te=>{if(!u)return;te.preventDefault();const q=g/M,ge=Math.max(0,g-q),Te=.05*q;te.deltaY>0?z(be=>Math.min(ge,be+Te)):z(be=>Math.max(0,be-Te))},[ee,ne]=le.useState(!1),[re,F]=le.useState(0),Z=te=>{u&&(te.preventDefault(),ne(!0),F(te.clientX),te.currentTarget.style.cursor="grabbing")},Ee=te=>{if(!ee||!u)return;const q=te.clientX-re,ge=g/M,Te=E/ge,be=q/Te,$e=Math.max(0,g-ge);z(et=>Math.max(0,Math.min($e,et-be))),F(te.clientX)},Ve=te=>{ne(!1),te.currentTarget.style.cursor="grab"},me=()=>{if(!(t!=null&&t.current)||!e||!r)return;const te=t.current.currentTime,q=Math.round(te*1e3)/1e3;e(q),console.log(`Setting start point to ${q}`),np(r,{startPoint:q}).then(()=>{console.log("Start point saved successfully")}).catch(ge=>{console.error("Failed to save start point:",ge)})},Be=te=>{if(!u||!e||!r)return;const q=te*.001,ge=Math.max(0,Math.min(g,n+q)),Te=Math.round(ge*1e3)/1e3;if(e(Te),console.log(`Adjusting start point to ${Te}`),np(r,{startPoint:Te}).then(()=>{console.log("Adjusted start point saved successfully")}).catch(be=>{console.error("Failed to save adjusted start point:",be)}),M>1){const be=g/M,$e=W,et=$e+be;if(ge<$e||ge>et){const Le=Math.max(0,Math.min(g-be,ge-be/2));z(Le)}}};return T.jsx("div",{className:"waveform-container",ref:a,children:d?T.jsx("div",{className:"waveform-loading",children:"Loading waveform..."}):T.jsxs(T.Fragment,{children:[T.jsxs("div",{className:"waveform-canvas-container",style:{position:"relative",cursor:ee?"grabbing":"grab"},onWheel:de,onMouseDown:Z,onMouseMove:Ee,onMouseUp:Ve,onMouseLeave:Ve,onClick:k,onTouchStart:te=>{if(!u)return;te.preventDefault();const q=te.touches[0];ne(!0),F(q.clientX),te.currentTarget.style.cursor="grabbing"},onTouchMove:te=>{if(!ee||!u)return;te.preventDefault();const q=te.touches[0],ge=q.clientX-re,Te=g/M,be=E/Te,$e=ge/be,et=Math.max(0,g-Te);z(Le=>Math.max(0,Math.min(et,Le-$e))),F(q.clientX)},onTouchEnd:te=>{ee||k(te),ne(!1),te.currentTarget.style.cursor="grab"},onTouchCancel:te=>{ne(!1),te.currentTarget.style.cursor="grab"},children:[T.jsx("canvas",{ref:i,width:800,height:80,className:"waveform-canvas"}),T.jsx("button",{onClick:pe,style:{position:"absolute",top:"5px",left:"30px",background:"rgba(255, 215, 0, 0.5)",color:"white",border:"none",borderRadius:"3px",padding:"2px 6px",fontSize:"10px",cursor:"pointer"},title:"Focus view on start point",children:"Find Start"}),T.jsxs("div",{style:{position:"absolute",top:"5px",left:"5px",background:"rgba(0, 0, 0, 0.5)",color:"white",borderRadius:"3px",padding:"2px 5px",fontSize:"10px"},children:[M,"x"]})]}),T.jsxs("div",{className:"waveform-timestamps",style:{display:"flex",justifyContent:"space-between",padding:"5px 0",gap:"10px",fontSize:"12px",fontFamily:"monospace"},children:[T.jsxs("span",{className:"current-position",style:{color:"white",fontSize:"14px",border:"solid 2px white",borderRadius:"3px",padding:"2px 5px",WebkitUserSelect:"none",MozUserSelect:"none",msUserSelect:"none",userSelect:"none",WebkitTouchCallout:"none",WebkitUserSelect:"none",MozUserSelect:"none",msUserSelect:"none",userSelect:"none",WebkitTouchCallout:"none"},children:["Position: ",D(A)]}),T.jsxs("span",{className:"start-point",style:{color:"white",fontSize:"14px",border:"solid 2px orange",borderRadius:"3px",padding:"2px 5px",cursor:"pointer",WebkitUserSelect:"none",MozUserSelect:"none",msUserSelect:"none",userSelect:"none",WebkitTouchCallout:"none"},onClick:pe,title:"Click to focus on start point",children:["Start: ",D(n)]}),T.jsxs("span",{className:"duration",style:{color:"white",fontSize:"14px",border:"solid 2px white",borderRadius:"3px",padding:"2px 5px",WebkitUserSelect:"none",MozUserSelect:"none",msUserSelect:"none",userSelect:"none",WebkitTouchCallout:"none"},children:["Total: ",D(g)]})]}),T.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"5px 0",margin:"5px 0"},children:T.jsxs("div",{style:{display:"flex",gap:"5px"},children:[T.jsx("button",{onClick:ve,disabled:M<=1,style:{background:M>=64?"#555":"#222",color:"white",border:"solid 2px white",borderRadius:"3px",padding:"3px 8px",fontSize:"16px",fontFamily:"Arial, sans-serif",cursor:M>=64?"not-allowed":"pointer",WebkitUserSelect:"none",MozUserSelect:"none",msUserSelect:"none",userSelect:"none",WebkitTouchCallout:"none"},children:T.jsx(NS,{})}),T.jsx("button",{onClick:ue,disabled:M>=64,style:{background:M>=64?"#555":"#222",color:"white",border:"solid 2px white",borderRadius:"3px",padding:"3px 8px",fontSize:"16px",fontFamily:"Arial, sans-serif",cursor:M>=64?"not-allowed":"pointer",WebkitUserSelect:"none",MozUserSelect:"none",msUserSelect:"none",userSelect:"none",WebkitTouchCallout:"none"},children:T.jsx(DS,{})})]})}),T.jsxs("div",{className:"navigation-controls",style:{display:"flex",justifyContent:"center",gap:"8px",padding:"10px 0"},children:[T.jsx("button",{onClick:()=>Be(-20),style:{background:"#DAA520",border:"none",borderRadius:"4px",padding:"6px 12px",color:"black",cursor:"pointer",fontSize:"16px",WebkitUserSelect:"none",MozUserSelect:"none",msUserSelect:"none",userSelect:"none",WebkitTouchCallout:"none"},children:"-20 ms"}),T.jsx("button",{onClick:()=>Be(-5),style:{background:"#DAA520",border:"none",borderRadius:"4px",padding:"6px 12px",color:"black",cursor:"pointer",fontSize:"16px",WebkitUserSelect:"none",MozUserSelect:"none",msUserSelect:"none",userSelect:"none",WebkitTouchCallout:"none"},children:"-5 ms"}),T.jsx("button",{onClick:()=>Be(5),style:{background:"#DAA520",border:"none",borderRadius:"4px",padding:"6px 12px",color:"black",cursor:"pointer",fontSize:"16px",WebkitUserSelect:"none",MozUserSelect:"none",msUserSelect:"none",userSelect:"none",WebkitTouchCallout:"none"},children:"+5 ms"}),T.jsx("button",{onClick:()=>Be(20),style:{background:"#DAA520",border:"none",borderRadius:"4px",padding:"6px 12px",color:"black",cursor:"pointer",fontSize:"16px",WebkitUserSelect:"none",MozUserSelect:"none",msUserSelect:"none",userSelect:"none",WebkitTouchCallout:"none"},children:"+20 ms"})]}),T.jsx("button",{className:"set-start-point-button",onClick:me,style:{background:"#FFD700",border:"none",borderRadius:"4px",padding:"10px",margin:"5px 0",color:"#333",fontSeize:"16px",fontWeight:"bold",cursor:"pointer",width:"100%",WebkitUserSelect:"none",MozUserSelect:"none",msUserSelect:"none",userSelect:"none",WebkitTouchCallout:"none"},children:"Set Start Point"}),T.jsxs("div",{className:"audio-progress",style:{margin:"15px 0 5px 0",width:"100%",opacity:M===1?"1":"0.5"},children:[T.jsx("input",{type:"range",min:"0",max:g||100,step:"0.01",value:A,disabled:M!==1,onMouseDown:()=>{M===1&&t!=null&&t.current&&!t.current.paused&&t.current.pause()},onMouseUp:()=>{M===1&&t!=null&&t.current&&b.current&&t.current.play().catch(te=>console.error("Resume error:",te))},onChange:te=>{if(M===1){const q=parseFloat(te.target.value);t!=null&&t.current&&(t.current.currentTime=q),P(q)}},className:"progress-slider",style:{width:"100%",height:"10px",borderRadius:"5px",outline:"none",background:`linear-gradient(to right, rgb(255, 132, 0) ${A/g*100}%, rgb(32, 32, 32) ${A/g*100}%)`,cursor:M===1?"pointer":"not-allowed"}}),M!==1&&T.jsx("div",{style:{textAlign:"center",fontSize:"12px",color:"#AAA",marginTop:"5px"},children:"Zoom out fully to use the progress slider"})]})]})})},ZR=r=>(e,t)=>(r.set(e,t),t),j_=Number.MAX_SAFE_INTEGER===void 0?9007199254740991:Number.MAX_SAFE_INTEGER,$E=536870912,B_=$E*2,JR=(r,e)=>t=>{const n=e.get(t);let i=n===void 0?t.size:n<B_?n+1:0;if(!t.has(i))return r(t,i);if(t.size<$E){for(;t.has(i);)i=Math.floor(Math.random()*B_);return r(t,i)}if(t.size>j_)throw new Error("Congratulations, you created a collection of unique numbers which uses all available integers!");for(;t.has(i);)i=Math.floor(Math.random()*j_);return r(t,i)},WE=new WeakMap,eP=ZR(WE),tP=JR(eP,WE),nP=r=>typeof r.start=="function",z_=new WeakMap,rP=r=>({...r,connect:({call:e})=>async()=>{const{port1:t,port2:n}=new MessageChannel,i=await e("connect",{port:t},[t]);return z_.set(n,i),n},disconnect:({call:e})=>async t=>{const n=z_.get(t);if(n===void 0)throw new Error("The given port is not connected.");await e("disconnect",{portId:n})},isSupported:({call:e})=>()=>e("isSupported")}),rp=new WeakMap,sP=r=>{if(rp.has(r))return rp.get(r);const e=new Map;return rp.set(r,e),e},iP=r=>{const e=rP(r);return t=>{const n=sP(t);t.addEventListener("message",({data:c})=>{const{id:d}=c;if(d!==null&&n.has(d)){const{reject:p,resolve:g}=n.get(d);n.delete(d),c.error===void 0?g(c.result):p(new Error(c.error.message))}}),nP(t)&&t.start();const i=(c,d=null,p=[])=>new Promise((g,_)=>{const E=tP(n);n.set(E,{reject:_,resolve:g}),d===null?t.postMessage({id:E,method:c},p):t.postMessage({id:E,method:c,params:d},p)}),a=(c,d,p=[])=>{t.postMessage({id:null,method:c,params:d},p)};let u={};for(const[c,d]of Object.entries(e))u={...u,[c]:d({call:i,notify:a})};return{...u}}},U_=(r,e,t)=>({endTime:e,insertTime:t,type:"exponentialRampToValue",value:r}),$_=(r,e,t)=>({endTime:e,insertTime:t,type:"linearRampToValue",value:r}),Mp=(r,e)=>({startTime:e,type:"setValue",value:r}),qE=(r,e,t)=>({duration:t,startTime:e,type:"setValueCurve",values:r}),GE=(r,e,{startTime:t,target:n,timeConstant:i})=>n+(e-n)*Math.exp((t-r)/i),ya=r=>r.type==="exponentialRampToValue",bh=r=>r.type==="linearRampToValue",oi=r=>ya(r)||bh(r),Am=r=>r.type==="setValue",ws=r=>r.type==="setValueCurve",Dh=(r,e,t,n)=>{const i=r[e];return i===void 0?n:oi(i)||Am(i)?i.value:ws(i)?i.values[i.values.length-1]:GE(t,Dh(r,e-1,i.startTime,n),i)},W_=(r,e,t,n,i)=>t===void 0?[n.insertTime,i]:oi(t)?[t.endTime,t.value]:Am(t)?[t.startTime,t.value]:ws(t)?[t.startTime+t.duration,t.values[t.values.length-1]]:[t.startTime,Dh(r,e-1,t.startTime,i)],Op=r=>r.type==="cancelAndHold",Fp=r=>r.type==="cancelScheduledValues",si=r=>Op(r)||Fp(r)?r.cancelTime:ya(r)||bh(r)?r.endTime:r.startTime,q_=(r,e,t,{endTime:n,value:i})=>t===i?i:0<t&&0<i||t<0&&i<0?t*(i/t)**((r-e)/(n-e)):0,G_=(r,e,t,{endTime:n,value:i})=>t+(r-e)/(n-e)*(i-t),oP=(r,e)=>{const t=Math.floor(e),n=Math.ceil(e);return t===n?r[t]:(1-(e-t))*r[t]+(1-(n-e))*r[n]},aP=(r,{duration:e,startTime:t,values:n})=>{const i=(r-t)/e*(n.length-1);return oP(n,i)},Kc=r=>r.type==="setTarget";class lP{constructor(e){this._automationEvents=[],this._currenTime=0,this._defaultValue=e}[Symbol.iterator](){return this._automationEvents[Symbol.iterator]()}add(e){const t=si(e);if(Op(e)||Fp(e)){const n=this._automationEvents.findIndex(a=>Fp(e)&&ws(a)?a.startTime+a.duration>=t:si(a)>=t),i=this._automationEvents[n];if(n!==-1&&(this._automationEvents=this._automationEvents.slice(0,n)),Op(e)){const a=this._automationEvents[this._automationEvents.length-1];if(i!==void 0&&oi(i)){if(a!==void 0&&Kc(a))throw new Error("The internal list is malformed.");const u=a===void 0?i.insertTime:ws(a)?a.startTime+a.duration:si(a),c=a===void 0?this._defaultValue:ws(a)?a.values[a.values.length-1]:a.value,d=ya(i)?q_(t,u,c,i):G_(t,u,c,i),p=ya(i)?U_(d,t,this._currenTime):$_(d,t,this._currenTime);this._automationEvents.push(p)}if(a!==void 0&&Kc(a)&&this._automationEvents.push(Mp(this.getValue(t),t)),a!==void 0&&ws(a)&&a.startTime+a.duration>t){const u=t-a.startTime,c=(a.values.length-1)/a.duration,d=Math.max(2,1+Math.ceil(u*c)),p=u/(d-1)*c,g=a.values.slice(0,d);if(p<1)for(let _=1;_<d;_+=1){const E=p*_%1;g[_]=a.values[_-1]*(1-E)+a.values[_]*E}this._automationEvents[this._automationEvents.length-1]=qE(g,a.startTime,u)}}}else{const n=this._automationEvents.findIndex(u=>si(u)>t),i=n===-1?this._automationEvents[this._automationEvents.length-1]:this._automationEvents[n-1];if(i!==void 0&&ws(i)&&si(i)+i.duration>t)return!1;const a=ya(e)?U_(e.value,e.endTime,this._currenTime):bh(e)?$_(e.value,t,this._currenTime):e;if(n===-1)this._automationEvents.push(a);else{if(ws(e)&&t+e.duration>si(this._automationEvents[n]))return!1;this._automationEvents.splice(n,0,a)}}return!0}flush(e){const t=this._automationEvents.findIndex(n=>si(n)>e);if(t>1){const n=this._automationEvents.slice(t-1),i=n[0];Kc(i)&&n.unshift(Mp(Dh(this._automationEvents,t-2,i.startTime,this._defaultValue),i.startTime)),this._automationEvents=n}}getValue(e){if(this._automationEvents.length===0)return this._defaultValue;const t=this._automationEvents.findIndex(u=>si(u)>e),n=this._automationEvents[t],i=(t===-1?this._automationEvents.length:t)-1,a=this._automationEvents[i];if(a!==void 0&&Kc(a)&&(n===void 0||!oi(n)||n.insertTime>e))return GE(e,Dh(this._automationEvents,i-1,a.startTime,this._defaultValue),a);if(a!==void 0&&Am(a)&&(n===void 0||!oi(n)))return a.value;if(a!==void 0&&ws(a)&&(n===void 0||!oi(n)||a.startTime+a.duration>e))return e<a.startTime+a.duration?aP(e,a):a.values[a.values.length-1];if(a!==void 0&&oi(a)&&(n===void 0||!oi(n)))return a.value;if(n!==void 0&&ya(n)){const[u,c]=W_(this._automationEvents,i,a,n,this._defaultValue);return q_(e,u,c,n)}if(n!==void 0&&bh(n)){const[u,c]=W_(this._automationEvents,i,a,n,this._defaultValue);return G_(e,u,c,n)}return this._defaultValue}}const uP=r=>({cancelTime:r,type:"cancelAndHold"}),cP=r=>({cancelTime:r,type:"cancelScheduledValues"}),hP=(r,e)=>({endTime:e,type:"exponentialRampToValue",value:r}),dP=(r,e)=>({endTime:e,type:"linearRampToValue",value:r}),fP=(r,e,t)=>({startTime:e,target:r,timeConstant:t,type:"setTarget"}),pP=()=>new DOMException("","AbortError"),mP=r=>(e,t,[n,i,a],u)=>{r(e[i],[t,n,a],c=>c[0]===t&&c[1]===n,u)},gP=r=>(e,t,n)=>{const i=[];for(let a=0;a<n.numberOfInputs;a+=1)i.push(new Set);r.set(e,{activeInputs:i,outputs:new Set,passiveInputs:new WeakMap,renderer:t})},yP=r=>(e,t)=>{r.set(e,{activeInputs:new Set,passiveInputs:new WeakMap,renderer:t})},Ma=new WeakSet,KE=new WeakMap,HE=new WeakMap,QE=new WeakMap,XE=new WeakMap,YE=new WeakMap,ZE=new WeakMap,Lp=new WeakMap,K_=new WeakMap,JE={construct(){return JE}},vP=r=>{try{const e=new Proxy(r,JE);new e}catch{return!1}return!0},H_=/^import(?:(?:[\s]+[\w]+|(?:[\s]+[\w]+[\s]*,)?[\s]*\{[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?(?:[\s]*,[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?)*[\s]*}|(?:[\s]+[\w]+[\s]*,)?[\s]*\*[\s]+as[\s]+[\w]+)[\s]+from)?(?:[\s]*)("([^"\\]|\\.)+"|'([^'\\]|\\.)+')(?:[\s]*);?/,Q_=(r,e)=>{const t=[];let n=r.replace(/^[\s]+/,""),i=n.match(H_);for(;i!==null;){const a=i[1].slice(1,-1),u=i[0].replace(/([\s]+)?;?$/,"").replace(a,new URL(a,e).toString());t.push(u),n=n.slice(i[0].length).replace(/^[\s]+/,""),i=n.match(H_)}return[t.join(";"),n]},X_=r=>{if(r!==void 0&&!Array.isArray(r))throw new TypeError("The parameterDescriptors property of given value for processorCtor is not an array.")},Y_=r=>{if(!vP(r))throw new TypeError("The given value for processorCtor should be a constructor.");if(r.prototype===null||typeof r.prototype!="object")throw new TypeError("The given value for processorCtor should have a prototype.")},_P=(r,e,t,n,i,a,u,c,d,p,g,_,E)=>{let C=0;return(A,P,M={credentials:"omit"})=>{const U=g.get(A);if(U!==void 0&&U.has(P))return Promise.resolve();const W=p.get(A);if(W!==void 0){const j=W.get(P);if(j!==void 0)return j}const z=a(A),X=z.audioWorklet===void 0?i(P).then(([j,$])=>{const[x,I]=Q_(j,$),R=`${x};((a,b)=>{(a[b]=a[b]||[]).push((AudioWorkletProcessor,global,registerProcessor,sampleRate,self,window)=>{${I}
})})(window,'_AWGS')`;return t(R)}).then(()=>{const j=E._AWGS.pop();if(j===void 0)throw new SyntaxError;n(z.currentTime,z.sampleRate,()=>j(class{},void 0,($,x)=>{if($.trim()==="")throw e();const I=K_.get(z);if(I!==void 0){if(I.has($))throw e();Y_(x),X_(x.parameterDescriptors),I.set($,x)}else Y_(x),X_(x.parameterDescriptors),K_.set(z,new Map([[$,x]]))},z.sampleRate,void 0,void 0))}):Promise.all([i(P),Promise.resolve(r(_,_))]).then(([[j,$],x])=>{const I=C+1;C=I;const[R,b]=Q_(j,$),ue=`${R};((AudioWorkletProcessor,registerProcessor)=>{${b}
})(${x?"AudioWorkletProcessor":"class extends AudioWorkletProcessor {__b=new WeakSet();constructor(){super();(p=>p.postMessage=(q=>(m,t)=>q.call(p,m,t?t.filter(u=>!this.__b.has(u)):t))(p.postMessage))(this.port)}}"},(n,p)=>registerProcessor(n,class extends p{${x?"":"__c = (a) => a.forEach(e=>this.__b.add(e.buffer));"}process(i,o,p){${x?"":"i.forEach(this.__c);o.forEach(this.__c);this.__c(Object.values(p));"}return super.process(i.map(j=>j.some(k=>k.length===0)?[]:j),o,p)}}));registerProcessor('__sac${I}',class extends AudioWorkletProcessor{process(){return !1}})`,ve=new Blob([ue],{type:"application/javascript; charset=utf-8"}),pe=URL.createObjectURL(ve);return z.audioWorklet.addModule(pe,M).then(()=>{if(c(z))return z;const de=u(z);return de.audioWorklet.addModule(pe,M).then(()=>de)}).then(de=>{if(d===null)throw new SyntaxError;try{new d(de,`__sac${I}`)}catch{throw new SyntaxError}}).finally(()=>URL.revokeObjectURL(pe))});return W===void 0?p.set(A,new Map([[P,X]])):W.set(P,X),X.then(()=>{const j=g.get(A);j===void 0?g.set(A,new Set([P])):j.add(P)}).finally(()=>{const j=p.get(A);j!==void 0&&j.delete(P)}),X}},Ei=(r,e)=>{const t=r.get(e);if(t===void 0)throw new Error("A value with the given key could not be found.");return t},rd=(r,e)=>{const t=Array.from(r).filter(e);if(t.length>1)throw Error("More than one element was found.");if(t.length===0)throw Error("No element was found.");const[n]=t;return r.delete(n),n},eT=(r,e,t,n)=>{const i=Ei(r,e),a=rd(i,u=>u[0]===t&&u[1]===n);return i.size===0&&r.delete(e),a},yu=r=>Ei(ZE,r),Oa=r=>{if(Ma.has(r))throw new Error("The AudioNode is already stored.");Ma.add(r),yu(r).forEach(e=>e(!0))},tT=r=>"port"in r,vu=r=>{if(!Ma.has(r))throw new Error("The AudioNode is not stored.");Ma.delete(r),yu(r).forEach(e=>e(!1))},jp=(r,e)=>{!tT(r)&&e.every(t=>t.size===0)&&vu(r)},wP=(r,e,t,n,i,a,u,c,d,p,g,_,E)=>{const C=new WeakMap;return(A,P,M,U,W)=>{const{activeInputs:z,passiveInputs:X}=a(P),{outputs:j}=a(A),$=c(A),x=I=>{const R=d(P),b=d(A);if(I){const D=eT(X,A,M,U);r(z,A,D,!1),!W&&!_(A)&&t(b,R,M,U),E(P)&&Oa(P)}else{const D=n(z,A,M,U);e(X,U,D,!1),!W&&!_(A)&&i(b,R,M,U);const V=u(P);if(V===0)g(P)&&jp(P,z);else{const k=C.get(P);k!==void 0&&clearTimeout(k),C.set(P,setTimeout(()=>{g(P)&&jp(P,z)},V*1e3))}}};return p(j,[P,M,U],I=>I[0]===P&&I[1]===M&&I[2]===U,!0)?($.add(x),g(A)?r(z,A,[M,U,x],!0):e(X,U,[A,M,x],!0),!0):!1}},EP=r=>(e,t,[n,i,a],u)=>{const c=e.get(n);c===void 0?e.set(n,new Set([[i,t,a]])):r(c,[i,t,a],d=>d[0]===i&&d[1]===t,u)},TP=r=>(e,t)=>{const n=r(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});t.connect(n).connect(e.destination);const i=()=>{t.removeEventListener("ended",i),t.disconnect(n),n.disconnect()};t.addEventListener("ended",i)},IP={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",fftSize:2048,maxDecibels:-30,minDecibels:-100,smoothingTimeConstant:.8},SP=(r,e,t,n,i,a)=>class extends r{constructor(c,d){const p=i(c),g={...IP,...d},_=n(p,g),E=a(p)?e():null;super(c,!1,_,E),this._nativeAnalyserNode=_}get fftSize(){return this._nativeAnalyserNode.fftSize}set fftSize(c){this._nativeAnalyserNode.fftSize=c}get frequencyBinCount(){return this._nativeAnalyserNode.frequencyBinCount}get maxDecibels(){return this._nativeAnalyserNode.maxDecibels}set maxDecibels(c){const d=this._nativeAnalyserNode.maxDecibels;if(this._nativeAnalyserNode.maxDecibels=c,!(c>this._nativeAnalyserNode.minDecibels))throw this._nativeAnalyserNode.maxDecibels=d,t()}get minDecibels(){return this._nativeAnalyserNode.minDecibels}set minDecibels(c){const d=this._nativeAnalyserNode.minDecibels;if(this._nativeAnalyserNode.minDecibels=c,!(this._nativeAnalyserNode.maxDecibels>c))throw this._nativeAnalyserNode.minDecibels=d,t()}get smoothingTimeConstant(){return this._nativeAnalyserNode.smoothingTimeConstant}set smoothingTimeConstant(c){this._nativeAnalyserNode.smoothingTimeConstant=c}getByteFrequencyData(c){this._nativeAnalyserNode.getByteFrequencyData(c)}getByteTimeDomainData(c){this._nativeAnalyserNode.getByteTimeDomainData(c)}getFloatFrequencyData(c){this._nativeAnalyserNode.getFloatFrequencyData(c)}getFloatTimeDomainData(c){this._nativeAnalyserNode.getFloatTimeDomainData(c)}},Sn=(r,e)=>r.context===e,CP=(r,e,t)=>()=>{const n=new WeakMap,i=async(a,u)=>{let c=e(a);if(!Sn(c,u)){const p={channelCount:c.channelCount,channelCountMode:c.channelCountMode,channelInterpretation:c.channelInterpretation,fftSize:c.fftSize,maxDecibels:c.maxDecibels,minDecibels:c.minDecibels,smoothingTimeConstant:c.smoothingTimeConstant};c=r(u,p)}return n.set(u,c),await t(a,u,c),c};return{render(a,u){const c=n.get(u);return c!==void 0?Promise.resolve(c):i(a,u)}}},Vh=r=>{try{r.copyToChannel(new Float32Array(1),0,-1)}catch{return!1}return!0},Eo=()=>new DOMException("","IndexSizeError"),xm=r=>{r.getChannelData=(e=>t=>{try{return e.call(r,t)}catch(n){throw n.code===12?Eo():n}})(r.getChannelData)},AP={numberOfChannels:1},xP=(r,e,t,n,i,a,u,c)=>{let d=null;return class nT{constructor(g){if(i===null)throw new Error("Missing the native OfflineAudioContext constructor.");const{length:_,numberOfChannels:E,sampleRate:C}={...AP,...g};d===null&&(d=new i(1,1,44100));const A=n!==null&&e(a,a)?new n({length:_,numberOfChannels:E,sampleRate:C}):d.createBuffer(E,_,C);if(A.numberOfChannels===0)throw t();return typeof A.copyFromChannel!="function"?(u(A),xm(A)):e(Vh,()=>Vh(A))||c(A),r.add(A),A}static[Symbol.hasInstance](g){return g!==null&&typeof g=="object"&&Object.getPrototypeOf(g)===nT.prototype||r.has(g)}}},ur=-34028234663852886e22,Dn=34028234663852886e22,Ss=r=>Ma.has(r),NP={buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1},RP=(r,e,t,n,i,a,u,c)=>class extends r{constructor(p,g){const _=a(p),E={...NP,...g},C=i(_,E),A=u(_),P=A?e():null;super(p,!1,C,P),this._audioBufferSourceNodeRenderer=P,this._isBufferNullified=!1,this._isBufferSet=E.buffer!==null,this._nativeAudioBufferSourceNode=C,this._onended=null,this._playbackRate=t(this,A,C.playbackRate,Dn,ur)}get buffer(){return this._isBufferNullified?null:this._nativeAudioBufferSourceNode.buffer}set buffer(p){if(this._nativeAudioBufferSourceNode.buffer=p,p!==null){if(this._isBufferSet)throw n();this._isBufferSet=!0}}get loop(){return this._nativeAudioBufferSourceNode.loop}set loop(p){this._nativeAudioBufferSourceNode.loop=p}get loopEnd(){return this._nativeAudioBufferSourceNode.loopEnd}set loopEnd(p){this._nativeAudioBufferSourceNode.loopEnd=p}get loopStart(){return this._nativeAudioBufferSourceNode.loopStart}set loopStart(p){this._nativeAudioBufferSourceNode.loopStart=p}get onended(){return this._onended}set onended(p){const g=typeof p=="function"?c(this,p):null;this._nativeAudioBufferSourceNode.onended=g;const _=this._nativeAudioBufferSourceNode.onended;this._onended=_!==null&&_===g?p:_}get playbackRate(){return this._playbackRate}start(p=0,g=0,_){if(this._nativeAudioBufferSourceNode.start(p,g,_),this._audioBufferSourceNodeRenderer!==null&&(this._audioBufferSourceNodeRenderer.start=_===void 0?[p,g]:[p,g,_]),this.context.state!=="closed"){Oa(this);const E=()=>{this._nativeAudioBufferSourceNode.removeEventListener("ended",E),Ss(this)&&vu(this)};this._nativeAudioBufferSourceNode.addEventListener("ended",E)}}stop(p=0){this._nativeAudioBufferSourceNode.stop(p),this._audioBufferSourceNodeRenderer!==null&&(this._audioBufferSourceNodeRenderer.stop=p)}},PP=(r,e,t,n,i)=>()=>{const a=new WeakMap;let u=null,c=null;const d=async(p,g)=>{let _=t(p);const E=Sn(_,g);if(!E){const C={buffer:_.buffer,channelCount:_.channelCount,channelCountMode:_.channelCountMode,channelInterpretation:_.channelInterpretation,loop:_.loop,loopEnd:_.loopEnd,loopStart:_.loopStart,playbackRate:_.playbackRate.value};_=e(g,C),u!==null&&_.start(...u),c!==null&&_.stop(c)}return a.set(g,_),E?await r(g,p.playbackRate,_.playbackRate):await n(g,p.playbackRate,_.playbackRate),await i(p,g,_),_};return{set start(p){u=p},set stop(p){c=p},render(p,g){const _=a.get(g);return _!==void 0?Promise.resolve(_):d(p,g)}}},kP=r=>"playbackRate"in r,bP=r=>"frequency"in r&&"gain"in r,DP=r=>"offset"in r,VP=r=>!("frequency"in r)&&"gain"in r,MP=r=>"detune"in r&&"frequency"in r&&!("gain"in r),OP=r=>"pan"in r,Hn=r=>Ei(KE,r),_u=r=>Ei(QE,r),Bp=(r,e)=>{const{activeInputs:t}=Hn(r);t.forEach(i=>i.forEach(([a])=>{e.includes(r)||Bp(a,[...e,r])}));const n=kP(r)?[r.playbackRate]:tT(r)?Array.from(r.parameters.values()):bP(r)?[r.Q,r.detune,r.frequency,r.gain]:DP(r)?[r.offset]:VP(r)?[r.gain]:MP(r)?[r.detune,r.frequency]:OP(r)?[r.pan]:[];for(const i of n){const a=_u(i);a!==void 0&&a.activeInputs.forEach(([u])=>Bp(u,e))}Ss(r)&&vu(r)},FP=r=>{Bp(r.destination,[])},LP=(r,e,t,n,i,a,u,c)=>class extends r{constructor(p,g){const _=a(p),E=u(_),C=i(_,g,E),A=E?e(c):null;super(p,!1,C,A),this._isNodeOfNativeOfflineAudioContext=E,this._nativeAudioDestinationNode=C}get channelCount(){return this._nativeAudioDestinationNode.channelCount}set channelCount(p){if(this._isNodeOfNativeOfflineAudioContext)throw n();if(p>this._nativeAudioDestinationNode.maxChannelCount)throw t();this._nativeAudioDestinationNode.channelCount=p}get channelCountMode(){return this._nativeAudioDestinationNode.channelCountMode}set channelCountMode(p){if(this._isNodeOfNativeOfflineAudioContext)throw n();this._nativeAudioDestinationNode.channelCountMode=p}get maxChannelCount(){return this._nativeAudioDestinationNode.maxChannelCount}},jP=r=>{const e=new WeakMap,t=async(n,i)=>{const a=i.destination;return e.set(i,a),await r(n,i,a),a};return{render(n,i){const a=e.get(i);return a!==void 0?Promise.resolve(a):t(n,i)}}},BP=(r,e,t,n,i,a,u,c)=>(d,p)=>{const g=p.listener,_=()=>{const j=new Float32Array(1),$=e(p,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:9}),x=u(p);let I=!1,R=[0,0,-1,0,1,0],b=[0,0,0];const D=()=>{if(I)return;I=!0;const ve=n(p,256,9,0);ve.onaudioprocess=({inputBuffer:pe})=>{const de=[a(pe,j,0),a(pe,j,1),a(pe,j,2),a(pe,j,3),a(pe,j,4),a(pe,j,5)];de.some((ne,re)=>ne!==R[re])&&(g.setOrientation(...de),R=de);const ee=[a(pe,j,6),a(pe,j,7),a(pe,j,8)];ee.some((ne,re)=>ne!==b[re])&&(g.setPosition(...ee),b=ee)},$.connect(ve)},V=ve=>pe=>{pe!==R[ve]&&(R[ve]=pe,g.setOrientation(...R))},k=ve=>pe=>{pe!==b[ve]&&(b[ve]=pe,g.setPosition(...b))},ue=(ve,pe,de)=>{const ee=t(p,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:pe});ee.connect($,0,ve),ee.start(),Object.defineProperty(ee.offset,"defaultValue",{get(){return pe}});const ne=r({context:d},x,ee.offset,Dn,ur);return c(ne,"value",re=>()=>re.call(ne),re=>F=>{try{re.call(ne,F)}catch(Z){if(Z.code!==9)throw Z}D(),x&&de(F)}),ne.cancelAndHoldAtTime=(re=>x?()=>{throw i()}:(...F)=>{const Z=re.apply(ne,F);return D(),Z})(ne.cancelAndHoldAtTime),ne.cancelScheduledValues=(re=>x?()=>{throw i()}:(...F)=>{const Z=re.apply(ne,F);return D(),Z})(ne.cancelScheduledValues),ne.exponentialRampToValueAtTime=(re=>x?()=>{throw i()}:(...F)=>{const Z=re.apply(ne,F);return D(),Z})(ne.exponentialRampToValueAtTime),ne.linearRampToValueAtTime=(re=>x?()=>{throw i()}:(...F)=>{const Z=re.apply(ne,F);return D(),Z})(ne.linearRampToValueAtTime),ne.setTargetAtTime=(re=>x?()=>{throw i()}:(...F)=>{const Z=re.apply(ne,F);return D(),Z})(ne.setTargetAtTime),ne.setValueAtTime=(re=>x?()=>{throw i()}:(...F)=>{const Z=re.apply(ne,F);return D(),Z})(ne.setValueAtTime),ne.setValueCurveAtTime=(re=>x?()=>{throw i()}:(...F)=>{const Z=re.apply(ne,F);return D(),Z})(ne.setValueCurveAtTime),ne};return{forwardX:ue(0,0,V(0)),forwardY:ue(1,0,V(1)),forwardZ:ue(2,-1,V(2)),positionX:ue(6,0,k(0)),positionY:ue(7,0,k(1)),positionZ:ue(8,0,k(2)),upX:ue(3,0,V(3)),upY:ue(4,1,V(4)),upZ:ue(5,0,V(5))}},{forwardX:E,forwardY:C,forwardZ:A,positionX:P,positionY:M,positionZ:U,upX:W,upY:z,upZ:X}=g.forwardX===void 0?_():g;return{get forwardX(){return E},get forwardY(){return C},get forwardZ(){return A},get positionX(){return P},get positionY(){return M},get positionZ(){return U},get upX(){return W},get upY(){return z},get upZ(){return X}}},Mh=r=>"context"in r,wu=r=>Mh(r[0]),To=(r,e,t,n)=>{for(const i of r)if(t(i)){if(n)return!1;throw Error("The set contains at least one similar element.")}return r.add(e),!0},Z_=(r,e,[t,n],i)=>{To(r,[e,t,n],a=>a[0]===e&&a[1]===t,i)},J_=(r,[e,t,n],i)=>{const a=r.get(e);a===void 0?r.set(e,new Set([[t,n]])):To(a,[t,n],u=>u[0]===t,i)},za=r=>"inputs"in r,Oh=(r,e,t,n)=>{if(za(e)){const i=e.inputs[n];return r.connect(i,t,0),[i,t,0]}return r.connect(e,t,n),[e,t,n]},rT=(r,e,t)=>{for(const n of r)if(n[0]===e&&n[1]===t)return r.delete(n),n;return null},zP=(r,e,t)=>rd(r,n=>n[0]===e&&n[1]===t),sT=(r,e)=>{if(!yu(r).delete(e))throw new Error("Missing the expected event listener.")},iT=(r,e,t)=>{const n=Ei(r,e),i=rd(n,a=>a[0]===t);return n.size===0&&r.delete(e),i},Fh=(r,e,t,n)=>{za(e)?r.disconnect(e.inputs[n],t,0):r.disconnect(e,t,n)},St=r=>Ei(HE,r),iu=r=>Ei(XE,r),yo=r=>Lp.has(r),rh=r=>!Ma.has(r),ew=(r,e)=>new Promise(t=>{if(e!==null)t(!0);else{const n=r.createScriptProcessor(256,1,1),i=r.createGain(),a=r.createBuffer(1,2,44100),u=a.getChannelData(0);u[0]=1,u[1]=1;const c=r.createBufferSource();c.buffer=a,c.loop=!0,c.connect(n).connect(r.destination),c.connect(i),c.disconnect(i),n.onaudioprocess=d=>{const p=d.inputBuffer.getChannelData(0);Array.prototype.some.call(p,g=>g===1)?t(!0):t(!1),c.stop(),n.onaudioprocess=null,c.disconnect(n),n.disconnect(r.destination)},c.start()}}),sp=(r,e)=>{const t=new Map;for(const n of r)for(const i of n){const a=t.get(i);t.set(i,a===void 0?1:a+1)}t.forEach((n,i)=>e(i,n))},tw=r=>"context"in r,UP=r=>{const e=new Map;r.connect=(t=>(n,i=0,a=0)=>{const u=tw(n)?t(n,i,a):t(n,i),c=e.get(n);return c===void 0?e.set(n,[{input:a,output:i}]):c.every(d=>d.input!==a||d.output!==i)&&c.push({input:a,output:i}),u})(r.connect.bind(r)),r.disconnect=(t=>(n,i,a)=>{if(t.apply(r),n===void 0)e.clear();else if(typeof n=="number")for(const[u,c]of e){const d=c.filter(p=>p.output!==n);d.length===0?e.delete(u):e.set(u,d)}else if(e.has(n))if(i===void 0)e.delete(n);else{const u=e.get(n);if(u!==void 0){const c=u.filter(d=>d.output!==i&&(d.input!==a||a===void 0));c.length===0?e.delete(n):e.set(n,c)}}for(const[u,c]of e)c.forEach(d=>{tw(u)?r.connect(u,d.output,d.input):r.connect(u,d.output)})})(r.disconnect)},$P=(r,e,t,n)=>{const{activeInputs:i,passiveInputs:a}=_u(e),{outputs:u}=Hn(r),c=yu(r),d=p=>{const g=St(r),_=iu(e);if(p){const E=iT(a,r,t);Z_(i,r,E,!1),!n&&!yo(r)&&g.connect(_,t)}else{const E=zP(i,r,t);J_(a,E,!1),!n&&!yo(r)&&g.disconnect(_,t)}};return To(u,[e,t],p=>p[0]===e&&p[1]===t,!0)?(c.add(d),Ss(r)?Z_(i,r,[t,d],!0):J_(a,[r,t,d],!0),!0):!1},WP=(r,e,t,n)=>{const{activeInputs:i,passiveInputs:a}=Hn(e),u=rT(i[n],r,t);return u===null?[eT(a,r,t,n)[2],!1]:[u[2],!0]},qP=(r,e,t)=>{const{activeInputs:n,passiveInputs:i}=_u(e),a=rT(n,r,t);return a===null?[iT(i,r,t)[1],!1]:[a[2],!0]},Nm=(r,e,t,n,i)=>{const[a,u]=WP(r,t,n,i);if(a!==null&&(sT(r,a),u&&!e&&!yo(r)&&Fh(St(r),St(t),n,i)),Ss(t)){const{activeInputs:c}=Hn(t);jp(t,c)}},Rm=(r,e,t,n)=>{const[i,a]=qP(r,t,n);i!==null&&(sT(r,i),a&&!e&&!yo(r)&&St(r).disconnect(iu(t),n))},GP=(r,e)=>{const t=Hn(r),n=[];for(const i of t.outputs)wu(i)?Nm(r,e,...i):Rm(r,e,...i),n.push(i[0]);return t.outputs.clear(),n},KP=(r,e,t)=>{const n=Hn(r),i=[];for(const a of n.outputs)a[1]===t&&(wu(a)?Nm(r,e,...a):Rm(r,e,...a),i.push(a[0]),n.outputs.delete(a));return i},HP=(r,e,t,n,i)=>{const a=Hn(r);return Array.from(a.outputs).filter(u=>u[0]===t&&(n===void 0||u[1]===n)&&(i===void 0||u[2]===i)).map(u=>(wu(u)?Nm(r,e,...u):Rm(r,e,...u),a.outputs.delete(u),u[0]))},QP=(r,e,t,n,i,a,u,c,d,p,g,_,E,C,A,P)=>class extends p{constructor(U,W,z,X){super(z),this._context=U,this._nativeAudioNode=z;const j=g(U);_(j)&&t(ew,()=>ew(j,P))!==!0&&UP(z),HE.set(this,z),ZE.set(this,new Set),U.state!=="closed"&&W&&Oa(this),r(this,X,z)}get channelCount(){return this._nativeAudioNode.channelCount}set channelCount(U){this._nativeAudioNode.channelCount=U}get channelCountMode(){return this._nativeAudioNode.channelCountMode}set channelCountMode(U){this._nativeAudioNode.channelCountMode=U}get channelInterpretation(){return this._nativeAudioNode.channelInterpretation}set channelInterpretation(U){this._nativeAudioNode.channelInterpretation=U}get context(){return this._context}get numberOfInputs(){return this._nativeAudioNode.numberOfInputs}get numberOfOutputs(){return this._nativeAudioNode.numberOfOutputs}connect(U,W=0,z=0){if(W<0||W>=this._nativeAudioNode.numberOfOutputs)throw i();const X=g(this._context),j=A(X);if(E(U)||C(U))throw a();if(Mh(U)){const I=St(U);try{const b=Oh(this._nativeAudioNode,I,W,z),D=rh(this);(j||D)&&this._nativeAudioNode.disconnect(...b),this.context.state!=="closed"&&!D&&rh(U)&&Oa(U)}catch(b){throw b.code===12?a():b}if(e(this,U,W,z,j)){const b=d([this],U);sp(b,n(j))}return U}const $=iu(U);if($.name==="playbackRate"&&$.maxValue===1024)throw u();try{this._nativeAudioNode.connect($,W),(j||rh(this))&&this._nativeAudioNode.disconnect($,W)}catch(I){throw I.code===12?a():I}if($P(this,U,W,j)){const I=d([this],U);sp(I,n(j))}}disconnect(U,W,z){let X;const j=g(this._context),$=A(j);if(U===void 0)X=GP(this,$);else if(typeof U=="number"){if(U<0||U>=this.numberOfOutputs)throw i();X=KP(this,$,U)}else{if(W!==void 0&&(W<0||W>=this.numberOfOutputs)||Mh(U)&&z!==void 0&&(z<0||z>=U.numberOfInputs))throw i();if(X=HP(this,$,U,W,z),X.length===0)throw a()}for(const x of X){const I=d([this],x);sp(I,c)}}},XP=(r,e,t,n,i,a,u,c,d,p,g,_,E)=>(C,A,P,M=null,U=null)=>{const W=P.value,z=new lP(W),X=A?n(z):null,j={get defaultValue(){return W},get maxValue(){return M===null?P.maxValue:M},get minValue(){return U===null?P.minValue:U},get value(){return P.value},set value($){P.value=$,j.setValueAtTime($,C.context.currentTime)},cancelAndHoldAtTime($){if(typeof P.cancelAndHoldAtTime=="function")X===null&&z.flush(C.context.currentTime),z.add(i($)),P.cancelAndHoldAtTime($);else{const x=Array.from(z).pop();X===null&&z.flush(C.context.currentTime),z.add(i($));const I=Array.from(z).pop();P.cancelScheduledValues($),x!==I&&I!==void 0&&(I.type==="exponentialRampToValue"?P.exponentialRampToValueAtTime(I.value,I.endTime):I.type==="linearRampToValue"?P.linearRampToValueAtTime(I.value,I.endTime):I.type==="setValue"?P.setValueAtTime(I.value,I.startTime):I.type==="setValueCurve"&&P.setValueCurveAtTime(I.values,I.startTime,I.duration))}return j},cancelScheduledValues($){return X===null&&z.flush(C.context.currentTime),z.add(a($)),P.cancelScheduledValues($),j},exponentialRampToValueAtTime($,x){if($===0)throw new RangeError;if(!Number.isFinite(x)||x<0)throw new RangeError;const I=C.context.currentTime;return X===null&&z.flush(I),Array.from(z).length===0&&(z.add(p(W,I)),P.setValueAtTime(W,I)),z.add(u($,x)),P.exponentialRampToValueAtTime($,x),j},linearRampToValueAtTime($,x){const I=C.context.currentTime;return X===null&&z.flush(I),Array.from(z).length===0&&(z.add(p(W,I)),P.setValueAtTime(W,I)),z.add(c($,x)),P.linearRampToValueAtTime($,x),j},setTargetAtTime($,x,I){return X===null&&z.flush(C.context.currentTime),z.add(d($,x,I)),P.setTargetAtTime($,x,I),j},setValueAtTime($,x){return X===null&&z.flush(C.context.currentTime),z.add(p($,x)),P.setValueAtTime($,x),j},setValueCurveAtTime($,x,I){const R=$ instanceof Float32Array?$:new Float32Array($);if(_!==null&&_.name==="webkitAudioContext"){const b=x+I,D=C.context.sampleRate,V=Math.ceil(x*D),k=Math.floor(b*D),ue=k-V,ve=new Float32Array(ue);for(let de=0;de<ue;de+=1){const ee=(R.length-1)/I*((V+de)/D-x),ne=Math.floor(ee),re=Math.ceil(ee);ve[de]=ne===re?R[ne]:(1-(ee-ne))*R[ne]+(1-(re-ee))*R[re]}X===null&&z.flush(C.context.currentTime),z.add(g(ve,x,I)),P.setValueCurveAtTime(ve,x,I);const pe=k/D;pe<b&&E(j,ve[ve.length-1],pe),E(j,R[R.length-1],b)}else X===null&&z.flush(C.context.currentTime),z.add(g(R,x,I)),P.setValueCurveAtTime(R,x,I);return j}};return t.set(j,P),e.set(j,C),r(j,X),j},YP=r=>({replay(e){for(const t of r)if(t.type==="exponentialRampToValue"){const{endTime:n,value:i}=t;e.exponentialRampToValueAtTime(i,n)}else if(t.type==="linearRampToValue"){const{endTime:n,value:i}=t;e.linearRampToValueAtTime(i,n)}else if(t.type==="setTarget"){const{startTime:n,target:i,timeConstant:a}=t;e.setTargetAtTime(i,n,a)}else if(t.type==="setValue"){const{startTime:n,value:i}=t;e.setValueAtTime(i,n)}else if(t.type==="setValueCurve"){const{duration:n,startTime:i,values:a}=t;e.setValueCurveAtTime(a,i,n)}else throw new Error("Can't apply an unknown automation.")}}),ZP=(r,e,t,n,i,a,u,c,d,p,g,_,E,C,A,P,M,U,W,z)=>class extends A{constructor(j,$){super(j,$),this._nativeContext=j,this._audioWorklet=r===void 0?void 0:{addModule:(x,I)=>r(this,x,I)}}get audioWorklet(){return this._audioWorklet}createAnalyser(){return new e(this)}createBiquadFilter(){return new i(this)}createBuffer(j,$,x){return new t({length:$,numberOfChannels:j,sampleRate:x})}createBufferSource(){return new n(this)}createChannelMerger(j=6){return new a(this,{numberOfInputs:j})}createChannelSplitter(j=6){return new u(this,{numberOfOutputs:j})}createConstantSource(){return new c(this)}createConvolver(){return new d(this)}createDelay(j=1){return new g(this,{maxDelayTime:j})}createDynamicsCompressor(){return new _(this)}createGain(){return new E(this)}createIIRFilter(j,$){return new C(this,{feedback:$,feedforward:j})}createOscillator(){return new P(this)}createPanner(){return new M(this)}createPeriodicWave(j,$,x={disableNormalization:!1}){return new U(this,{...x,imag:$,real:j})}createStereoPanner(){return new W(this)}createWaveShaper(){return new z(this)}decodeAudioData(j,$,x){return p(this._nativeContext,j).then(I=>(typeof $=="function"&&$(I),I),I=>{throw typeof x=="function"&&x(I),I})}},JP={Q:1,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:350,gain:0,type:"lowpass"},ek=(r,e,t,n,i,a,u,c)=>class extends r{constructor(p,g){const _=a(p),E={...JP,...g},C=i(_,E),A=u(_),P=A?t():null;super(p,!1,C,P),this._Q=e(this,A,C.Q,Dn,ur),this._detune=e(this,A,C.detune,1200*Math.log2(Dn),-1200*Math.log2(Dn)),this._frequency=e(this,A,C.frequency,p.sampleRate/2,0),this._gain=e(this,A,C.gain,40*Math.log10(Dn),ur),this._nativeBiquadFilterNode=C,c(this,1)}get detune(){return this._detune}get frequency(){return this._frequency}get gain(){return this._gain}get Q(){return this._Q}get type(){return this._nativeBiquadFilterNode.type}set type(p){this._nativeBiquadFilterNode.type=p}getFrequencyResponse(p,g,_){try{this._nativeBiquadFilterNode.getFrequencyResponse(p,g,_)}catch(E){throw E.code===11?n():E}if(p.length!==g.length||g.length!==_.length)throw n()}},tk=(r,e,t,n,i)=>()=>{const a=new WeakMap,u=async(c,d)=>{let p=t(c);const g=Sn(p,d);if(!g){const _={Q:p.Q.value,channelCount:p.channelCount,channelCountMode:p.channelCountMode,channelInterpretation:p.channelInterpretation,detune:p.detune.value,frequency:p.frequency.value,gain:p.gain.value,type:p.type};p=e(d,_)}return a.set(d,p),g?(await r(d,c.Q,p.Q),await r(d,c.detune,p.detune),await r(d,c.frequency,p.frequency),await r(d,c.gain,p.gain)):(await n(d,c.Q,p.Q),await n(d,c.detune,p.detune),await n(d,c.frequency,p.frequency),await n(d,c.gain,p.gain)),await i(c,d,p),p};return{render(c,d){const p=a.get(d);return p!==void 0?Promise.resolve(p):u(c,d)}}},nk=(r,e)=>(t,n)=>{const i=e.get(t);if(i!==void 0)return i;const a=r.get(t);if(a!==void 0)return a;try{const u=n();return u instanceof Promise?(r.set(t,u),u.catch(()=>!1).then(c=>(r.delete(t),e.set(t,c),c))):(e.set(t,u),u)}catch{return e.set(t,!1),!1}},rk={channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6},sk=(r,e,t,n,i)=>class extends r{constructor(u,c){const d=n(u),p={...rk,...c},g=t(d,p),_=i(d)?e():null;super(u,!1,g,_)}},ik=(r,e,t)=>()=>{const n=new WeakMap,i=async(a,u)=>{let c=e(a);if(!Sn(c,u)){const p={channelCount:c.channelCount,channelCountMode:c.channelCountMode,channelInterpretation:c.channelInterpretation,numberOfInputs:c.numberOfInputs};c=r(u,p)}return n.set(u,c),await t(a,u,c),c};return{render(a,u){const c=n.get(u);return c!==void 0?Promise.resolve(c):i(a,u)}}},ok={channelCount:6,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:6},ak=(r,e,t,n,i,a)=>class extends r{constructor(c,d){const p=n(c),g=a({...ok,...d}),_=t(p,g),E=i(p)?e():null;super(c,!1,_,E)}},lk=(r,e,t)=>()=>{const n=new WeakMap,i=async(a,u)=>{let c=e(a);if(!Sn(c,u)){const p={channelCount:c.channelCount,channelCountMode:c.channelCountMode,channelInterpretation:c.channelInterpretation,numberOfOutputs:c.numberOfOutputs};c=r(u,p)}return n.set(u,c),await t(a,u,c),c};return{render(a,u){const c=n.get(u);return c!==void 0?Promise.resolve(c):i(a,u)}}},uk=r=>(e,t,n)=>r(t,e,n),ck=r=>(e,t)=>{const n=r(e,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),i=e.createBuffer(1,2,44100);return n.buffer=i,n.loop=!0,n.connect(t),n.start(),()=>{n.stop(),n.disconnect(t)}},hk={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",offset:1},dk=(r,e,t,n,i,a,u)=>class extends r{constructor(d,p){const g=i(d),_={...hk,...p},E=n(g,_),C=a(g),A=C?t():null;super(d,!1,E,A),this._constantSourceNodeRenderer=A,this._nativeConstantSourceNode=E,this._offset=e(this,C,E.offset,Dn,ur),this._onended=null}get offset(){return this._offset}get onended(){return this._onended}set onended(d){const p=typeof d=="function"?u(this,d):null;this._nativeConstantSourceNode.onended=p;const g=this._nativeConstantSourceNode.onended;this._onended=g!==null&&g===p?d:g}start(d=0){if(this._nativeConstantSourceNode.start(d),this._constantSourceNodeRenderer!==null&&(this._constantSourceNodeRenderer.start=d),this.context.state!=="closed"){Oa(this);const p=()=>{this._nativeConstantSourceNode.removeEventListener("ended",p),Ss(this)&&vu(this)};this._nativeConstantSourceNode.addEventListener("ended",p)}}stop(d=0){this._nativeConstantSourceNode.stop(d),this._constantSourceNodeRenderer!==null&&(this._constantSourceNodeRenderer.stop=d)}},fk=(r,e,t,n,i)=>()=>{const a=new WeakMap;let u=null,c=null;const d=async(p,g)=>{let _=t(p);const E=Sn(_,g);if(!E){const C={channelCount:_.channelCount,channelCountMode:_.channelCountMode,channelInterpretation:_.channelInterpretation,offset:_.offset.value};_=e(g,C),u!==null&&_.start(u),c!==null&&_.stop(c)}return a.set(g,_),E?await r(g,p.offset,_.offset):await n(g,p.offset,_.offset),await i(p,g,_),_};return{set start(p){u=p},set stop(p){c=p},render(p,g){const _=a.get(g);return _!==void 0?Promise.resolve(_):d(p,g)}}},pk=r=>e=>(r[0]=e,r[0]),mk={buffer:null,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",disableNormalization:!1},gk=(r,e,t,n,i,a)=>class extends r{constructor(c,d){const p=n(c),g={...mk,...d},_=t(p,g),C=i(p)?e():null;super(c,!1,_,C),this._isBufferNullified=!1,this._nativeConvolverNode=_,g.buffer!==null&&a(this,g.buffer.duration)}get buffer(){return this._isBufferNullified?null:this._nativeConvolverNode.buffer}set buffer(c){if(this._nativeConvolverNode.buffer=c,c===null&&this._nativeConvolverNode.buffer!==null){const d=this._nativeConvolverNode.context;this._nativeConvolverNode.buffer=d.createBuffer(1,1,d.sampleRate),this._isBufferNullified=!0,a(this,0)}else this._isBufferNullified=!1,a(this,this._nativeConvolverNode.buffer===null?0:this._nativeConvolverNode.buffer.duration)}get normalize(){return this._nativeConvolverNode.normalize}set normalize(c){this._nativeConvolverNode.normalize=c}},yk=(r,e,t)=>()=>{const n=new WeakMap,i=async(a,u)=>{let c=e(a);if(!Sn(c,u)){const p={buffer:c.buffer,channelCount:c.channelCount,channelCountMode:c.channelCountMode,channelInterpretation:c.channelInterpretation,disableNormalization:!c.normalize};c=r(u,p)}return n.set(u,c),za(c)?await t(a,u,c.inputs[0]):await t(a,u,c),c};return{render(a,u){const c=n.get(u);return c!==void 0?Promise.resolve(c):i(a,u)}}},vk=(r,e)=>(t,n,i)=>{if(e===null)throw new Error("Missing the native OfflineAudioContext constructor.");try{return new e(t,n,i)}catch(a){throw a.name==="SyntaxError"?r():a}},_k=()=>new DOMException("","DataCloneError"),nw=r=>{const{port1:e,port2:t}=new MessageChannel;return new Promise(n=>{const i=()=>{t.onmessage=null,e.close(),t.close(),n()};t.onmessage=()=>i();try{e.postMessage(r,[r])}catch{}finally{i()}})},wk=(r,e,t,n,i,a,u,c,d,p,g)=>(_,E)=>{const C=u(_)?_:a(_);if(i.has(E)){const A=t();return Promise.reject(A)}try{i.add(E)}catch{}return e(d,()=>d(C))?C.decodeAudioData(E).then(A=>(nw(E).catch(()=>{}),e(c,()=>c(A))||g(A),r.add(A),A)):new Promise((A,P)=>{const M=async()=>{try{await nw(E)}catch{}},U=W=>{P(W),M()};try{C.decodeAudioData(E,W=>{typeof W.copyFromChannel!="function"&&(p(W),xm(W)),r.add(W),M().then(()=>A(W))},W=>{U(W===null?n():W)})}catch(W){U(W)}})},Ek=(r,e,t,n,i,a,u,c)=>(d,p)=>{const g=e.get(d);if(g===void 0)throw new Error("Missing the expected cycle count.");const _=a(d.context),E=c(_);if(g===p){if(e.delete(d),!E&&u(d)){const C=n(d),{outputs:A}=t(d);for(const P of A)if(wu(P)){const M=n(P[0]);r(C,M,P[1],P[2])}else{const M=i(P[0]);C.connect(M,P[1])}}}else e.set(d,g-p)},Tk={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",delayTime:0,maxDelayTime:1},Ik=(r,e,t,n,i,a,u)=>class extends r{constructor(d,p){const g=i(d),_={...Tk,...p},E=n(g,_),C=a(g),A=C?t(_.maxDelayTime):null;super(d,!1,E,A),this._delayTime=e(this,C,E.delayTime),u(this,_.maxDelayTime)}get delayTime(){return this._delayTime}},Sk=(r,e,t,n,i)=>a=>{const u=new WeakMap,c=async(d,p)=>{let g=t(d);const _=Sn(g,p);if(!_){const E={channelCount:g.channelCount,channelCountMode:g.channelCountMode,channelInterpretation:g.channelInterpretation,delayTime:g.delayTime.value,maxDelayTime:a};g=e(p,E)}return u.set(p,g),_?await r(p,d.delayTime,g.delayTime):await n(p,d.delayTime,g.delayTime),await i(d,p,g),g};return{render(d,p){const g=u.get(p);return g!==void 0?Promise.resolve(g):c(d,p)}}},Ck=r=>(e,t,n,i)=>r(e[i],a=>a[0]===t&&a[1]===n),Ak=r=>"delayTime"in r,xk=(r,e,t)=>function n(i,a){const u=Mh(a)?a:t(r,a);if(Ak(u))return[];if(i[0]===u)return[i];if(i.includes(u))return[];const{outputs:c}=e(u);return Array.from(c).map(d=>n([...i,u],d[0])).reduce((d,p)=>d.concat(p),[])},Nk={attack:.003,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",knee:30,ratio:12,release:.25,threshold:-24},Rk=(r,e,t,n,i,a,u,c)=>class extends r{constructor(p,g){const _=a(p),E={...Nk,...g},C=n(_,E),A=u(_),P=A?t():null;super(p,!1,C,P),this._attack=e(this,A,C.attack),this._knee=e(this,A,C.knee),this._nativeDynamicsCompressorNode=C,this._ratio=e(this,A,C.ratio),this._release=e(this,A,C.release),this._threshold=e(this,A,C.threshold),c(this,.006)}get attack(){return this._attack}get channelCount(){return this._nativeDynamicsCompressorNode.channelCount}set channelCount(p){const g=this._nativeDynamicsCompressorNode.channelCount;if(this._nativeDynamicsCompressorNode.channelCount=p,p>2)throw this._nativeDynamicsCompressorNode.channelCount=g,i()}get channelCountMode(){return this._nativeDynamicsCompressorNode.channelCountMode}set channelCountMode(p){const g=this._nativeDynamicsCompressorNode.channelCountMode;if(this._nativeDynamicsCompressorNode.channelCountMode=p,p==="max")throw this._nativeDynamicsCompressorNode.channelCountMode=g,i()}get knee(){return this._knee}get ratio(){return this._ratio}get reduction(){return typeof this._nativeDynamicsCompressorNode.reduction.value=="number"?this._nativeDynamicsCompressorNode.reduction.value:this._nativeDynamicsCompressorNode.reduction}get release(){return this._release}get threshold(){return this._threshold}},Pk=(r,e,t,n,i)=>()=>{const a=new WeakMap,u=async(c,d)=>{let p=t(c);const g=Sn(p,d);if(!g){const _={attack:p.attack.value,channelCount:p.channelCount,channelCountMode:p.channelCountMode,channelInterpretation:p.channelInterpretation,knee:p.knee.value,ratio:p.ratio.value,release:p.release.value,threshold:p.threshold.value};p=e(d,_)}return a.set(d,p),g?(await r(d,c.attack,p.attack),await r(d,c.knee,p.knee),await r(d,c.ratio,p.ratio),await r(d,c.release,p.release),await r(d,c.threshold,p.threshold)):(await n(d,c.attack,p.attack),await n(d,c.knee,p.knee),await n(d,c.ratio,p.ratio),await n(d,c.release,p.release),await n(d,c.threshold,p.threshold)),await i(c,d,p),p};return{render(c,d){const p=a.get(d);return p!==void 0?Promise.resolve(p):u(c,d)}}},kk=()=>new DOMException("","EncodingError"),bk=r=>e=>new Promise((t,n)=>{if(r===null){n(new SyntaxError);return}const i=r.document.head;if(i===null)n(new SyntaxError);else{const a=r.document.createElement("script"),u=new Blob([e],{type:"application/javascript"}),c=URL.createObjectURL(u),d=r.onerror,p=()=>{r.onerror=d,URL.revokeObjectURL(c)};r.onerror=(g,_,E,C,A)=>{if(_===c||_===r.location.href&&E===1&&C===1)return p(),n(A),!1;if(d!==null)return d(g,_,E,C,A)},a.onerror=()=>{p(),n(new SyntaxError)},a.onload=()=>{p(),t()},a.src=c,a.type="module",i.appendChild(a)}}),Dk=r=>class{constructor(t){this._nativeEventTarget=t,this._listeners=new WeakMap}addEventListener(t,n,i){if(n!==null){let a=this._listeners.get(n);a===void 0&&(a=r(this,n),typeof n=="function"&&this._listeners.set(n,a)),this._nativeEventTarget.addEventListener(t,a,i)}}dispatchEvent(t){return this._nativeEventTarget.dispatchEvent(t)}removeEventListener(t,n,i){const a=n===null?void 0:this._listeners.get(n);this._nativeEventTarget.removeEventListener(t,a===void 0?null:a,i)}},Vk=r=>(e,t,n)=>{Object.defineProperties(r,{currentFrame:{configurable:!0,get(){return Math.round(e*t)}},currentTime:{configurable:!0,get(){return e}}});try{return n()}finally{r!==null&&(delete r.currentFrame,delete r.currentTime)}},Mk=r=>async e=>{try{const t=await fetch(e);if(t.ok)return[await t.text(),t.url]}catch{}throw r()},Ok={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",gain:1},Fk=(r,e,t,n,i,a)=>class extends r{constructor(c,d){const p=i(c),g={...Ok,...d},_=n(p,g),E=a(p),C=E?t():null;super(c,!1,_,C),this._gain=e(this,E,_.gain,Dn,ur)}get gain(){return this._gain}},Lk=(r,e,t,n,i)=>()=>{const a=new WeakMap,u=async(c,d)=>{let p=t(c);const g=Sn(p,d);if(!g){const _={channelCount:p.channelCount,channelCountMode:p.channelCountMode,channelInterpretation:p.channelInterpretation,gain:p.gain.value};p=e(d,_)}return a.set(d,p),g?await r(d,c.gain,p.gain):await n(d,c.gain,p.gain),await i(c,d,p),p};return{render(c,d){const p=a.get(d);return p!==void 0?Promise.resolve(p):u(c,d)}}},jk=r=>e=>{const t=r(e);if(t.renderer===null)throw new Error("Missing the renderer of the given AudioNode in the audio graph.");return t.renderer},Bk=r=>e=>{var t;return(t=r.get(e))!==null&&t!==void 0?t:0},zk=r=>e=>{const t=r(e);if(t.renderer===null)throw new Error("Missing the renderer of the given AudioParam in the audio graph.");return t.renderer},Mn=()=>new DOMException("","InvalidStateError"),Uk=r=>e=>{const t=r.get(e);if(t===void 0)throw Mn();return t},$k=(r,e)=>t=>{let n=r.get(t);if(n!==void 0)return n;if(e===null)throw new Error("Missing the native OfflineAudioContext constructor.");return n=new e(1,1,44100),r.set(t,n),n},Wk=r=>e=>{const t=r.get(e);if(t===void 0)throw new Error("The context has no set of AudioWorkletNodes.");return t},sd=()=>new DOMException("","InvalidAccessError"),qk=r=>{r.getFrequencyResponse=(e=>(t,n,i)=>{if(t.length!==n.length||n.length!==i.length)throw sd();return e.call(r,t,n,i)})(r.getFrequencyResponse)},Gk={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers"},Kk=(r,e,t,n,i,a)=>class extends r{constructor(c,d){const p=n(c),g=i(p),_={...Gk,...d},E=e(p,g?null:c.baseLatency,_),C=g?t(_.feedback,_.feedforward):null;super(c,!1,E,C),qk(E),this._nativeIIRFilterNode=E,a(this,1)}getFrequencyResponse(c,d,p){return this._nativeIIRFilterNode.getFrequencyResponse(c,d,p)}},oT=(r,e,t,n,i,a,u,c,d,p,g)=>{const _=p.length;let E=c;for(let C=0;C<_;C+=1){let A=t[0]*p[C];for(let P=1;P<i;P+=1){const M=E-P&d-1;A+=t[P]*a[M],A-=r[P]*u[M]}for(let P=i;P<n;P+=1)A+=t[P]*a[E-P&d-1];for(let P=i;P<e;P+=1)A-=r[P]*u[E-P&d-1];a[E]=p[C],u[E]=A,E=E+1&d-1,g[C]=A}return E},Hk=(r,e,t,n)=>{const i=t instanceof Float64Array?t:new Float64Array(t),a=n instanceof Float64Array?n:new Float64Array(n),u=i.length,c=a.length,d=Math.min(u,c);if(i[0]!==1){for(let A=0;A<u;A+=1)a[A]/=i[0];for(let A=1;A<c;A+=1)i[A]/=i[0]}const p=32,g=new Float32Array(p),_=new Float32Array(p),E=e.createBuffer(r.numberOfChannels,r.length,r.sampleRate),C=r.numberOfChannels;for(let A=0;A<C;A+=1){const P=r.getChannelData(A),M=E.getChannelData(A);g.fill(0),_.fill(0),oT(i,u,a,c,d,g,_,0,p,P,M)}return E},Qk=(r,e,t,n,i)=>(a,u)=>{const c=new WeakMap;let d=null;const p=async(g,_)=>{let E=null,C=e(g);const A=Sn(C,_);if(_.createIIRFilter===void 0?E=r(_,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}):A||(C=_.createIIRFilter(u,a)),c.set(_,E===null?C:E),E!==null){if(d===null){if(t===null)throw new Error("Missing the native OfflineAudioContext constructor.");const M=new t(g.context.destination.channelCount,g.context.length,_.sampleRate);d=(async()=>{await n(g,M,M.destination);const U=await i(M);return Hk(U,_,a,u)})()}const P=await d;return E.buffer=P,E.start(0),E}return await n(g,_,C),C};return{render(g,_){const E=c.get(_);return E!==void 0?Promise.resolve(E):p(g,_)}}},Xk=(r,e,t,n,i,a)=>u=>(c,d)=>{const p=r.get(c);if(p===void 0){if(!u&&a(c)){const g=n(c),{outputs:_}=t(c);for(const E of _)if(wu(E)){const C=n(E[0]);e(g,C,E[1],E[2])}else{const C=i(E[0]);g.disconnect(C,E[1])}}r.set(c,d)}else r.set(c,p+d)},Yk=r=>e=>r!==null&&e instanceof r,Zk=r=>e=>r!==null&&typeof r.AudioNode=="function"&&e instanceof r.AudioNode,Jk=r=>e=>r!==null&&typeof r.AudioParam=="function"&&e instanceof r.AudioParam,e2=(r,e)=>t=>r(t)||e(t),t2=r=>e=>r!==null&&e instanceof r,n2=r=>r!==null&&r.isSecureContext,r2=(r,e,t,n,i,a)=>class extends t{constructor(c,d){super(c),this._nativeContext=c,YE.set(this,c),n(c)&&i.set(c,new Set),this._destination=new r(this,d),this._listener=e(this,c),this._onstatechange=null}get currentTime(){return this._nativeContext.currentTime}get destination(){return this._destination}get listener(){return this._listener}get onstatechange(){return this._onstatechange}set onstatechange(c){const d=typeof c=="function"?a(this,c):null;this._nativeContext.onstatechange=d;const p=this._nativeContext.onstatechange;this._onstatechange=p!==null&&p===d?c:p}get sampleRate(){return this._nativeContext.sampleRate}get state(){return this._nativeContext.state}},ou=r=>{const e=new Uint32Array([1179011410,40,1163280727,544501094,16,131073,44100,176400,1048580,1635017060,4,0]);try{const t=r.decodeAudioData(e.buffer,()=>{});return t===void 0?!1:(t.catch(()=>{}),!0)}catch{}return!1},s2=(r,e)=>(t,n,i)=>{const a=new Set;return t.connect=(u=>(c,d=0,p=0)=>{const g=a.size===0;if(e(c))return u.call(t,c,d,p),r(a,[c,d,p],_=>_[0]===c&&_[1]===d&&_[2]===p,!0),g&&n(),c;u.call(t,c,d),r(a,[c,d],_=>_[0]===c&&_[1]===d,!0),g&&n()})(t.connect),t.disconnect=(u=>(c,d,p)=>{const g=a.size>0;if(c===void 0)u.apply(t),a.clear();else if(typeof c=="number"){u.call(t,c);for(const E of a)E[1]===c&&a.delete(E)}else{e(c)?u.call(t,c,d,p):u.call(t,c,d);for(const E of a)E[0]===c&&(d===void 0||E[1]===d)&&(p===void 0||E[2]===p)&&a.delete(E)}const _=a.size===0;g&&_&&i()})(t.disconnect),t},_t=(r,e,t)=>{const n=e[t];n!==void 0&&n!==r[t]&&(r[t]=n)},Xt=(r,e)=>{_t(r,e,"channelCount"),_t(r,e,"channelCountMode"),_t(r,e,"channelInterpretation")},rw=r=>typeof r.getFloatTimeDomainData=="function",i2=r=>{r.getFloatTimeDomainData=e=>{const t=new Uint8Array(e.length);r.getByteTimeDomainData(t);const n=Math.max(t.length,r.fftSize);for(let i=0;i<n;i+=1)e[i]=(t[i]-128)*.0078125;return e}},o2=(r,e)=>(t,n)=>{const i=t.createAnalyser();if(Xt(i,n),!(n.maxDecibels>n.minDecibels))throw e();return _t(i,n,"fftSize"),_t(i,n,"maxDecibels"),_t(i,n,"minDecibels"),_t(i,n,"smoothingTimeConstant"),r(rw,()=>rw(i))||i2(i),i},a2=r=>r===null?null:r.hasOwnProperty("AudioBuffer")?r.AudioBuffer:null,Nt=(r,e,t)=>{const n=e[t];n!==void 0&&n!==r[t].value&&(r[t].value=n)},l2=r=>{r.start=(e=>{let t=!1;return(n=0,i=0,a)=>{if(t)throw Mn();e.call(r,n,i,a),t=!0}})(r.start)},Pm=r=>{r.start=(e=>(t=0,n=0,i)=>{if(typeof i=="number"&&i<0||n<0||t<0)throw new RangeError("The parameters can't be negative.");e.call(r,t,n,i)})(r.start)},km=r=>{r.stop=(e=>(t=0)=>{if(t<0)throw new RangeError("The parameter can't be negative.");e.call(r,t)})(r.stop)},u2=(r,e,t,n,i,a,u,c,d,p,g)=>(_,E)=>{const C=_.createBufferSource();return Xt(C,E),Nt(C,E,"playbackRate"),_t(C,E,"buffer"),_t(C,E,"loop"),_t(C,E,"loopEnd"),_t(C,E,"loopStart"),e(t,()=>t(_))||l2(C),e(n,()=>n(_))||d(C),e(i,()=>i(_))||p(C,_),e(a,()=>a(_))||Pm(C),e(u,()=>u(_))||g(C,_),e(c,()=>c(_))||km(C),r(_,C),C},c2=r=>r===null?null:r.hasOwnProperty("AudioContext")?r.AudioContext:r.hasOwnProperty("webkitAudioContext")?r.webkitAudioContext:null,h2=(r,e)=>(t,n,i)=>{const a=t.destination;if(a.channelCount!==n)try{a.channelCount=n}catch{}i&&a.channelCountMode!=="explicit"&&(a.channelCountMode="explicit"),a.maxChannelCount===0&&Object.defineProperty(a,"maxChannelCount",{value:n});const u=r(t,{channelCount:n,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,gain:1});return e(u,"channelCount",c=>()=>c.call(u),c=>d=>{c.call(u,d);try{a.channelCount=d}catch(p){if(d>a.maxChannelCount)throw p}}),e(u,"channelCountMode",c=>()=>c.call(u),c=>d=>{c.call(u,d),a.channelCountMode=d}),e(u,"channelInterpretation",c=>()=>c.call(u),c=>d=>{c.call(u,d),a.channelInterpretation=d}),Object.defineProperty(u,"maxChannelCount",{get:()=>a.maxChannelCount}),u.connect(a),u},d2=r=>r===null?null:r.hasOwnProperty("AudioWorkletNode")?r.AudioWorkletNode:null,f2=(r,e)=>r===null?512:Math.max(512,Math.min(16384,Math.pow(2,Math.round(Math.log2(r*e))))),aT=(r,e)=>{const t=r.createBiquadFilter();return Xt(t,e),Nt(t,e,"Q"),Nt(t,e,"detune"),Nt(t,e,"frequency"),Nt(t,e,"gain"),_t(t,e,"type"),t},p2=(r,e)=>(t,n)=>{const i=t.createChannelMerger(n.numberOfInputs);return r!==null&&r.name==="webkitAudioContext"&&e(t,i),Xt(i,n),i},m2=r=>{const e=r.numberOfOutputs;Object.defineProperty(r,"channelCount",{get:()=>e,set:t=>{if(t!==e)throw Mn()}}),Object.defineProperty(r,"channelCountMode",{get:()=>"explicit",set:t=>{if(t!=="explicit")throw Mn()}}),Object.defineProperty(r,"channelInterpretation",{get:()=>"discrete",set:t=>{if(t!=="discrete")throw Mn()}})},bm=(r,e)=>{const t=r.createChannelSplitter(e.numberOfOutputs);return Xt(t,e),m2(t),t},g2=(r,e,t,n,i)=>(a,u)=>{if(a.createConstantSource===void 0)return t(a,u);const c=a.createConstantSource();return Xt(c,u),Nt(c,u,"offset"),e(n,()=>n(a))||Pm(c),e(i,()=>i(a))||km(c),r(a,c),c},Ua=(r,e)=>(r.connect=e.connect.bind(e),r.disconnect=e.disconnect.bind(e),r),y2=(r,e,t,n)=>(i,{offset:a,...u})=>{const c=i.createBuffer(1,2,44100),d=e(i,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),p=t(i,{...u,gain:a}),g=c.getChannelData(0);g[0]=1,g[1]=1,d.buffer=c,d.loop=!0;const _={get bufferSize(){},get channelCount(){return p.channelCount},set channelCount(A){p.channelCount=A},get channelCountMode(){return p.channelCountMode},set channelCountMode(A){p.channelCountMode=A},get channelInterpretation(){return p.channelInterpretation},set channelInterpretation(A){p.channelInterpretation=A},get context(){return p.context},get inputs(){return[]},get numberOfInputs(){return d.numberOfInputs},get numberOfOutputs(){return p.numberOfOutputs},get offset(){return p.gain},get onended(){return d.onended},set onended(A){d.onended=A},addEventListener(...A){return d.addEventListener(A[0],A[1],A[2])},dispatchEvent(...A){return d.dispatchEvent(A[0])},removeEventListener(...A){return d.removeEventListener(A[0],A[1],A[2])},start(A=0){d.start.call(d,A)},stop(A=0){d.stop.call(d,A)}},E=()=>d.connect(p),C=()=>d.disconnect(p);return r(i,d),n(Ua(_,p),E,C)},v2=(r,e)=>(t,n)=>{const i=t.createConvolver();if(Xt(i,n),n.disableNormalization===i.normalize&&(i.normalize=!n.disableNormalization),_t(i,n,"buffer"),n.channelCount>2||(e(i,"channelCount",a=>()=>a.call(i),a=>u=>{if(u>2)throw r();return a.call(i,u)}),n.channelCountMode==="max"))throw r();return e(i,"channelCountMode",a=>()=>a.call(i),a=>u=>{if(u==="max")throw r();return a.call(i,u)}),i},lT=(r,e)=>{const t=r.createDelay(e.maxDelayTime);return Xt(t,e),Nt(t,e,"delayTime"),t},_2=r=>(e,t)=>{const n=e.createDynamicsCompressor();if(Xt(n,t),t.channelCount>2||t.channelCountMode==="max")throw r();return Nt(n,t,"attack"),Nt(n,t,"knee"),Nt(n,t,"ratio"),Nt(n,t,"release"),Nt(n,t,"threshold"),n},Or=(r,e)=>{const t=r.createGain();return Xt(t,e),Nt(t,e,"gain"),t},w2=r=>(e,t,n)=>{if(e.createIIRFilter===void 0)return r(e,t,n);const i=e.createIIRFilter(n.feedforward,n.feedback);return Xt(i,n),i};function E2(r,e){const t=e[0]*e[0]+e[1]*e[1];return[(r[0]*e[0]+r[1]*e[1])/t,(r[1]*e[0]-r[0]*e[1])/t]}function T2(r,e){return[r[0]*e[0]-r[1]*e[1],r[0]*e[1]+r[1]*e[0]]}function sw(r,e){let t=[0,0];for(let n=r.length-1;n>=0;n-=1)t=T2(t,e),t[0]+=r[n];return t}const I2=(r,e,t,n)=>(i,a,{channelCount:u,channelCountMode:c,channelInterpretation:d,feedback:p,feedforward:g})=>{const _=f2(a,i.sampleRate),E=p instanceof Float64Array?p:new Float64Array(p),C=g instanceof Float64Array?g:new Float64Array(g),A=E.length,P=C.length,M=Math.min(A,P);if(A===0||A>20)throw n();if(E[0]===0)throw e();if(P===0||P>20)throw n();if(C[0]===0)throw e();if(E[0]!==1){for(let I=0;I<P;I+=1)C[I]/=E[0];for(let I=1;I<A;I+=1)E[I]/=E[0]}const U=t(i,_,u,u);U.channelCount=u,U.channelCountMode=c,U.channelInterpretation=d;const W=32,z=[],X=[],j=[];for(let I=0;I<u;I+=1){z.push(0);const R=new Float32Array(W),b=new Float32Array(W);R.fill(0),b.fill(0),X.push(R),j.push(b)}U.onaudioprocess=I=>{const R=I.inputBuffer,b=I.outputBuffer,D=R.numberOfChannels;for(let V=0;V<D;V+=1){const k=R.getChannelData(V),ue=b.getChannelData(V);z[V]=oT(E,A,C,P,M,X[V],j[V],z[V],W,k,ue)}};const $=i.sampleRate/2;return Ua({get bufferSize(){return _},get channelCount(){return U.channelCount},set channelCount(I){U.channelCount=I},get channelCountMode(){return U.channelCountMode},set channelCountMode(I){U.channelCountMode=I},get channelInterpretation(){return U.channelInterpretation},set channelInterpretation(I){U.channelInterpretation=I},get context(){return U.context},get inputs(){return[U]},get numberOfInputs(){return U.numberOfInputs},get numberOfOutputs(){return U.numberOfOutputs},addEventListener(...I){return U.addEventListener(I[0],I[1],I[2])},dispatchEvent(...I){return U.dispatchEvent(I[0])},getFrequencyResponse(I,R,b){if(I.length!==R.length||R.length!==b.length)throw r();const D=I.length;for(let V=0;V<D;V+=1){const k=-Math.PI*(I[V]/$),ue=[Math.cos(k),Math.sin(k)],ve=sw(C,ue),pe=sw(E,ue),de=E2(ve,pe);R[V]=Math.sqrt(de[0]*de[0]+de[1]*de[1]),b[V]=Math.atan2(de[1],de[0])}},removeEventListener(...I){return U.removeEventListener(I[0],I[1],I[2])}},U)},S2=r=>r===null?null:r.hasOwnProperty("OfflineAudioContext")?r.OfflineAudioContext:r.hasOwnProperty("webkitOfflineAudioContext")?r.webkitOfflineAudioContext:null,C2=(r,e,t,n,i,a)=>(u,c)=>{const d=u.createOscillator();return Xt(d,c),Nt(d,c,"detune"),Nt(d,c,"frequency"),c.periodicWave!==void 0?d.setPeriodicWave(c.periodicWave):_t(d,c,"type"),e(t,()=>t(u))||Pm(d),e(n,()=>n(u))||a(d,u),e(i,()=>i(u))||km(d),r(u,d),d},A2=r=>(e,t)=>{const n=e.createPanner();return n.orientationX===void 0?r(e,t):(Xt(n,t),Nt(n,t,"orientationX"),Nt(n,t,"orientationY"),Nt(n,t,"orientationZ"),Nt(n,t,"positionX"),Nt(n,t,"positionY"),Nt(n,t,"positionZ"),_t(n,t,"coneInnerAngle"),_t(n,t,"coneOuterAngle"),_t(n,t,"coneOuterGain"),_t(n,t,"distanceModel"),_t(n,t,"maxDistance"),_t(n,t,"panningModel"),_t(n,t,"refDistance"),_t(n,t,"rolloffFactor"),n)},x2=(r,e,t,n,i,a,u,c,d,p)=>(g,{coneInnerAngle:_,coneOuterAngle:E,coneOuterGain:C,distanceModel:A,maxDistance:P,orientationX:M,orientationY:U,orientationZ:W,panningModel:z,positionX:X,positionY:j,positionZ:$,refDistance:x,rolloffFactor:I,...R})=>{const b=g.createPanner();if(R.channelCount>2||R.channelCountMode==="max")throw u();Xt(b,R);const D={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},V=t(g,{...D,channelInterpretation:"speakers",numberOfInputs:6}),k=n(g,{...R,gain:1}),ue=n(g,{...D,gain:1}),ve=n(g,{...D,gain:0}),pe=n(g,{...D,gain:0}),de=n(g,{...D,gain:0}),ee=n(g,{...D,gain:0}),ne=n(g,{...D,gain:0}),re=i(g,256,6,1),F=a(g,{...D,curve:new Float32Array([1,1]),oversample:"none"});let Z=[M,U,W],Ee=[X,j,$];const Ve=new Float32Array(1);re.onaudioprocess=({inputBuffer:q})=>{const ge=[d(q,Ve,0),d(q,Ve,1),d(q,Ve,2)];ge.some((be,$e)=>be!==Z[$e])&&(b.setOrientation(...ge),Z=ge);const Te=[d(q,Ve,3),d(q,Ve,4),d(q,Ve,5)];Te.some((be,$e)=>be!==Ee[$e])&&(b.setPosition(...Te),Ee=Te)},Object.defineProperty(ve.gain,"defaultValue",{get:()=>0}),Object.defineProperty(pe.gain,"defaultValue",{get:()=>0}),Object.defineProperty(de.gain,"defaultValue",{get:()=>0}),Object.defineProperty(ee.gain,"defaultValue",{get:()=>0}),Object.defineProperty(ne.gain,"defaultValue",{get:()=>0});const me={get bufferSize(){},get channelCount(){return b.channelCount},set channelCount(q){if(q>2)throw u();k.channelCount=q,b.channelCount=q},get channelCountMode(){return b.channelCountMode},set channelCountMode(q){if(q==="max")throw u();k.channelCountMode=q,b.channelCountMode=q},get channelInterpretation(){return b.channelInterpretation},set channelInterpretation(q){k.channelInterpretation=q,b.channelInterpretation=q},get coneInnerAngle(){return b.coneInnerAngle},set coneInnerAngle(q){b.coneInnerAngle=q},get coneOuterAngle(){return b.coneOuterAngle},set coneOuterAngle(q){b.coneOuterAngle=q},get coneOuterGain(){return b.coneOuterGain},set coneOuterGain(q){if(q<0||q>1)throw e();b.coneOuterGain=q},get context(){return b.context},get distanceModel(){return b.distanceModel},set distanceModel(q){b.distanceModel=q},get inputs(){return[k]},get maxDistance(){return b.maxDistance},set maxDistance(q){if(q<0)throw new RangeError;b.maxDistance=q},get numberOfInputs(){return b.numberOfInputs},get numberOfOutputs(){return b.numberOfOutputs},get orientationX(){return ue.gain},get orientationY(){return ve.gain},get orientationZ(){return pe.gain},get panningModel(){return b.panningModel},set panningModel(q){b.panningModel=q},get positionX(){return de.gain},get positionY(){return ee.gain},get positionZ(){return ne.gain},get refDistance(){return b.refDistance},set refDistance(q){if(q<0)throw new RangeError;b.refDistance=q},get rolloffFactor(){return b.rolloffFactor},set rolloffFactor(q){if(q<0)throw new RangeError;b.rolloffFactor=q},addEventListener(...q){return k.addEventListener(q[0],q[1],q[2])},dispatchEvent(...q){return k.dispatchEvent(q[0])},removeEventListener(...q){return k.removeEventListener(q[0],q[1],q[2])}};_!==me.coneInnerAngle&&(me.coneInnerAngle=_),E!==me.coneOuterAngle&&(me.coneOuterAngle=E),C!==me.coneOuterGain&&(me.coneOuterGain=C),A!==me.distanceModel&&(me.distanceModel=A),P!==me.maxDistance&&(me.maxDistance=P),M!==me.orientationX.value&&(me.orientationX.value=M),U!==me.orientationY.value&&(me.orientationY.value=U),W!==me.orientationZ.value&&(me.orientationZ.value=W),z!==me.panningModel&&(me.panningModel=z),X!==me.positionX.value&&(me.positionX.value=X),j!==me.positionY.value&&(me.positionY.value=j),$!==me.positionZ.value&&(me.positionZ.value=$),x!==me.refDistance&&(me.refDistance=x),I!==me.rolloffFactor&&(me.rolloffFactor=I),(Z[0]!==1||Z[1]!==0||Z[2]!==0)&&b.setOrientation(...Z),(Ee[0]!==0||Ee[1]!==0||Ee[2]!==0)&&b.setPosition(...Ee);const Be=()=>{k.connect(b),r(k,F,0,0),F.connect(ue).connect(V,0,0),F.connect(ve).connect(V,0,1),F.connect(pe).connect(V,0,2),F.connect(de).connect(V,0,3),F.connect(ee).connect(V,0,4),F.connect(ne).connect(V,0,5),V.connect(re).connect(g.destination)},te=()=>{k.disconnect(b),c(k,F,0,0),F.disconnect(ue),ue.disconnect(V),F.disconnect(ve),ve.disconnect(V),F.disconnect(pe),pe.disconnect(V),F.disconnect(de),de.disconnect(V),F.disconnect(ee),ee.disconnect(V),F.disconnect(ne),ne.disconnect(V),V.disconnect(re),re.disconnect(g.destination)};return p(Ua(me,b),Be,te)},N2=r=>(e,{disableNormalization:t,imag:n,real:i})=>{const a=n instanceof Float32Array?n:new Float32Array(n),u=i instanceof Float32Array?i:new Float32Array(i),c=e.createPeriodicWave(u,a,{disableNormalization:t});if(Array.from(n).length<2)throw r();return c},id=(r,e,t,n)=>r.createScriptProcessor(e,t,n),R2=(r,e)=>(t,n)=>{const i=n.channelCountMode;if(i==="clamped-max")throw e();if(t.createStereoPanner===void 0)return r(t,n);const a=t.createStereoPanner();return Xt(a,n),Nt(a,n,"pan"),Object.defineProperty(a,"channelCountMode",{get:()=>i,set:u=>{if(u!==i)throw e()}}),a},P2=(r,e,t,n,i,a)=>{const c=new Float32Array([1,1]),d=Math.PI/2,p={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},g={...p,oversample:"none"},_=(A,P,M,U)=>{const W=new Float32Array(16385),z=new Float32Array(16385);for(let R=0;R<16385;R+=1){const b=R/16384*d;W[R]=Math.cos(b),z[R]=Math.sin(b)}const X=t(A,{...p,gain:0}),j=n(A,{...g,curve:W}),$=n(A,{...g,curve:c}),x=t(A,{...p,gain:0}),I=n(A,{...g,curve:z});return{connectGraph(){P.connect(X),P.connect($.inputs===void 0?$:$.inputs[0]),P.connect(x),$.connect(M),M.connect(j.inputs===void 0?j:j.inputs[0]),M.connect(I.inputs===void 0?I:I.inputs[0]),j.connect(X.gain),I.connect(x.gain),X.connect(U,0,0),x.connect(U,0,1)},disconnectGraph(){P.disconnect(X),P.disconnect($.inputs===void 0?$:$.inputs[0]),P.disconnect(x),$.disconnect(M),M.disconnect(j.inputs===void 0?j:j.inputs[0]),M.disconnect(I.inputs===void 0?I:I.inputs[0]),j.disconnect(X.gain),I.disconnect(x.gain),X.disconnect(U,0,0),x.disconnect(U,0,1)}}},E=(A,P,M,U)=>{const W=new Float32Array(16385),z=new Float32Array(16385),X=new Float32Array(16385),j=new Float32Array(16385),$=Math.floor(16385/2);for(let de=0;de<16385;de+=1)if(de>$){const ee=(de-$)/(16384-$)*d;W[de]=Math.cos(ee),z[de]=Math.sin(ee),X[de]=0,j[de]=1}else{const ee=de/(16384-$)*d;W[de]=1,z[de]=0,X[de]=Math.cos(ee),j[de]=Math.sin(ee)}const x=e(A,{channelCount:2,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:2}),I=t(A,{...p,gain:0}),R=n(A,{...g,curve:W}),b=t(A,{...p,gain:0}),D=n(A,{...g,curve:z}),V=n(A,{...g,curve:c}),k=t(A,{...p,gain:0}),ue=n(A,{...g,curve:X}),ve=t(A,{...p,gain:0}),pe=n(A,{...g,curve:j});return{connectGraph(){P.connect(x),P.connect(V.inputs===void 0?V:V.inputs[0]),x.connect(I,0),x.connect(b,0),x.connect(k,1),x.connect(ve,1),V.connect(M),M.connect(R.inputs===void 0?R:R.inputs[0]),M.connect(D.inputs===void 0?D:D.inputs[0]),M.connect(ue.inputs===void 0?ue:ue.inputs[0]),M.connect(pe.inputs===void 0?pe:pe.inputs[0]),R.connect(I.gain),D.connect(b.gain),ue.connect(k.gain),pe.connect(ve.gain),I.connect(U,0,0),k.connect(U,0,0),b.connect(U,0,1),ve.connect(U,0,1)},disconnectGraph(){P.disconnect(x),P.disconnect(V.inputs===void 0?V:V.inputs[0]),x.disconnect(I,0),x.disconnect(b,0),x.disconnect(k,1),x.disconnect(ve,1),V.disconnect(M),M.disconnect(R.inputs===void 0?R:R.inputs[0]),M.disconnect(D.inputs===void 0?D:D.inputs[0]),M.disconnect(ue.inputs===void 0?ue:ue.inputs[0]),M.disconnect(pe.inputs===void 0?pe:pe.inputs[0]),R.disconnect(I.gain),D.disconnect(b.gain),ue.disconnect(k.gain),pe.disconnect(ve.gain),I.disconnect(U,0,0),k.disconnect(U,0,0),b.disconnect(U,0,1),ve.disconnect(U,0,1)}}},C=(A,P,M,U,W)=>{if(P===1)return _(A,M,U,W);if(P===2)return E(A,M,U,W);throw i()};return(A,{channelCount:P,channelCountMode:M,pan:U,...W})=>{if(M==="max")throw i();const z=r(A,{...W,channelCount:1,channelCountMode:M,numberOfInputs:2}),X=t(A,{...W,channelCount:P,channelCountMode:M,gain:1}),j=t(A,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:U});let{connectGraph:$,disconnectGraph:x}=C(A,P,X,j,z);Object.defineProperty(j.gain,"defaultValue",{get:()=>0}),Object.defineProperty(j.gain,"maxValue",{get:()=>1}),Object.defineProperty(j.gain,"minValue",{get:()=>-1});const I={get bufferSize(){},get channelCount(){return X.channelCount},set channelCount(V){X.channelCount!==V&&(R&&x(),{connectGraph:$,disconnectGraph:x}=C(A,V,X,j,z),R&&$()),X.channelCount=V},get channelCountMode(){return X.channelCountMode},set channelCountMode(V){if(V==="clamped-max"||V==="max")throw i();X.channelCountMode=V},get channelInterpretation(){return X.channelInterpretation},set channelInterpretation(V){X.channelInterpretation=V},get context(){return X.context},get inputs(){return[X]},get numberOfInputs(){return X.numberOfInputs},get numberOfOutputs(){return X.numberOfOutputs},get pan(){return j.gain},addEventListener(...V){return X.addEventListener(V[0],V[1],V[2])},dispatchEvent(...V){return X.dispatchEvent(V[0])},removeEventListener(...V){return X.removeEventListener(V[0],V[1],V[2])}};let R=!1;const b=()=>{$(),R=!0},D=()=>{x(),R=!1};return a(Ua(I,z),b,D)}},k2=(r,e,t,n,i,a,u)=>(c,d)=>{const p=c.createWaveShaper();if(a!==null&&a.name==="webkitAudioContext"&&c.createGain().gain.automationRate===void 0)return t(c,d);Xt(p,d);const g=d.curve===null||d.curve instanceof Float32Array?d.curve:new Float32Array(d.curve);if(g!==null&&g.length<2)throw e();_t(p,{curve:g},"curve"),_t(p,d,"oversample");let _=null,E=!1;return u(p,"curve",P=>()=>P.call(p),P=>M=>(P.call(p,M),E&&(n(M)&&_===null?_=r(c,p):!n(M)&&_!==null&&(_(),_=null)),M)),i(p,()=>{E=!0,n(p.curve)&&(_=r(c,p))},()=>{E=!1,_!==null&&(_(),_=null)})},b2=(r,e,t,n,i)=>(a,{curve:u,oversample:c,...d})=>{const p=a.createWaveShaper(),g=a.createWaveShaper();Xt(p,d),Xt(g,d);const _=t(a,{...d,gain:1}),E=t(a,{...d,gain:-1}),C=t(a,{...d,gain:1}),A=t(a,{...d,gain:-1});let P=null,M=!1,U=null;const W={get bufferSize(){},get channelCount(){return p.channelCount},set channelCount(j){_.channelCount=j,E.channelCount=j,p.channelCount=j,C.channelCount=j,g.channelCount=j,A.channelCount=j},get channelCountMode(){return p.channelCountMode},set channelCountMode(j){_.channelCountMode=j,E.channelCountMode=j,p.channelCountMode=j,C.channelCountMode=j,g.channelCountMode=j,A.channelCountMode=j},get channelInterpretation(){return p.channelInterpretation},set channelInterpretation(j){_.channelInterpretation=j,E.channelInterpretation=j,p.channelInterpretation=j,C.channelInterpretation=j,g.channelInterpretation=j,A.channelInterpretation=j},get context(){return p.context},get curve(){return U},set curve(j){if(j!==null&&j.length<2)throw e();if(j===null)p.curve=j,g.curve=j;else{const $=j.length,x=new Float32Array($+2-$%2),I=new Float32Array($+2-$%2);x[0]=j[0],I[0]=-j[$-1];const R=Math.ceil(($+1)/2),b=($+1)/2-1;for(let D=1;D<R;D+=1){const V=D/R*b,k=Math.floor(V),ue=Math.ceil(V);x[D]=k===ue?j[k]:(1-(V-k))*j[k]+(1-(ue-V))*j[ue],I[D]=k===ue?-j[$-1-k]:-((1-(V-k))*j[$-1-k])-(1-(ue-V))*j[$-1-ue]}x[R]=$%2===1?j[R-1]:(j[R-2]+j[R-1])/2,p.curve=x,g.curve=I}U=j,M&&(n(U)&&P===null?P=r(a,_):P!==null&&(P(),P=null))},get inputs(){return[_]},get numberOfInputs(){return p.numberOfInputs},get numberOfOutputs(){return p.numberOfOutputs},get oversample(){return p.oversample},set oversample(j){p.oversample=j,g.oversample=j},addEventListener(...j){return _.addEventListener(j[0],j[1],j[2])},dispatchEvent(...j){return _.dispatchEvent(j[0])},removeEventListener(...j){return _.removeEventListener(j[0],j[1],j[2])}};u!==null&&(W.curve=u instanceof Float32Array?u:new Float32Array(u)),c!==W.oversample&&(W.oversample=c);const z=()=>{_.connect(p).connect(C),_.connect(E).connect(g).connect(A).connect(C),M=!0,n(U)&&(P=r(a,_))},X=()=>{_.disconnect(p),p.disconnect(C),_.disconnect(E),E.disconnect(g),g.disconnect(A),A.disconnect(C),M=!1,P!==null&&(P(),P=null)};return i(Ua(W,C),z,X)},dr=()=>new DOMException("","NotSupportedError"),D2={numberOfChannels:1},V2=(r,e,t,n,i)=>class extends r{constructor(u,c,d){let p;if(typeof u=="number"&&c!==void 0&&d!==void 0)p={length:c,numberOfChannels:u,sampleRate:d};else if(typeof u=="object")p=u;else throw new Error("The given parameters are not valid.");const{length:g,numberOfChannels:_,sampleRate:E}={...D2,...p},C=n(_,g,E);e(ou,()=>ou(C))||C.addEventListener("statechange",(()=>{let A=0;const P=M=>{this._state==="running"&&(A>0?(C.removeEventListener("statechange",P),M.stopImmediatePropagation(),this._waitForThePromiseToSettle(M)):A+=1)};return P})()),super(C,_),this._length=g,this._nativeOfflineAudioContext=C,this._state=null}get length(){return this._nativeOfflineAudioContext.length===void 0?this._length:this._nativeOfflineAudioContext.length}get state(){return this._state===null?this._nativeOfflineAudioContext.state:this._state}startRendering(){return this._state==="running"?Promise.reject(t()):(this._state="running",i(this.destination,this._nativeOfflineAudioContext).finally(()=>{this._state=null,FP(this)}))}_waitForThePromiseToSettle(u){this._state===null?this._nativeOfflineAudioContext.dispatchEvent(u):setTimeout(()=>this._waitForThePromiseToSettle(u))}},M2={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:440,periodicWave:void 0,type:"sine"},O2=(r,e,t,n,i,a,u)=>class extends r{constructor(d,p){const g=i(d),_={...M2,...p},E=t(g,_),C=a(g),A=C?n():null,P=d.sampleRate/2;super(d,!1,E,A),this._detune=e(this,C,E.detune,153600,-153600),this._frequency=e(this,C,E.frequency,P,-P),this._nativeOscillatorNode=E,this._onended=null,this._oscillatorNodeRenderer=A,this._oscillatorNodeRenderer!==null&&_.periodicWave!==void 0&&(this._oscillatorNodeRenderer.periodicWave=_.periodicWave)}get detune(){return this._detune}get frequency(){return this._frequency}get onended(){return this._onended}set onended(d){const p=typeof d=="function"?u(this,d):null;this._nativeOscillatorNode.onended=p;const g=this._nativeOscillatorNode.onended;this._onended=g!==null&&g===p?d:g}get type(){return this._nativeOscillatorNode.type}set type(d){this._nativeOscillatorNode.type=d,this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.periodicWave=null)}setPeriodicWave(d){this._nativeOscillatorNode.setPeriodicWave(d),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.periodicWave=d)}start(d=0){if(this._nativeOscillatorNode.start(d),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.start=d),this.context.state!=="closed"){Oa(this);const p=()=>{this._nativeOscillatorNode.removeEventListener("ended",p),Ss(this)&&vu(this)};this._nativeOscillatorNode.addEventListener("ended",p)}}stop(d=0){this._nativeOscillatorNode.stop(d),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.stop=d)}},F2=(r,e,t,n,i)=>()=>{const a=new WeakMap;let u=null,c=null,d=null;const p=async(g,_)=>{let E=t(g);const C=Sn(E,_);if(!C){const A={channelCount:E.channelCount,channelCountMode:E.channelCountMode,channelInterpretation:E.channelInterpretation,detune:E.detune.value,frequency:E.frequency.value,periodicWave:u===null?void 0:u,type:E.type};E=e(_,A),c!==null&&E.start(c),d!==null&&E.stop(d)}return a.set(_,E),C?(await r(_,g.detune,E.detune),await r(_,g.frequency,E.frequency)):(await n(_,g.detune,E.detune),await n(_,g.frequency,E.frequency)),await i(g,_,E),E};return{set periodicWave(g){u=g},set start(g){c=g},set stop(g){d=g},render(g,_){const E=a.get(_);return E!==void 0?Promise.resolve(E):p(g,_)}}},L2={channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,orientationX:1,orientationY:0,orientationZ:0,panningModel:"equalpower",positionX:0,positionY:0,positionZ:0,refDistance:1,rolloffFactor:1},j2=(r,e,t,n,i,a,u)=>class extends r{constructor(d,p){const g=i(d),_={...L2,...p},E=t(g,_),C=a(g),A=C?n():null;super(d,!1,E,A),this._nativePannerNode=E,this._orientationX=e(this,C,E.orientationX,Dn,ur),this._orientationY=e(this,C,E.orientationY,Dn,ur),this._orientationZ=e(this,C,E.orientationZ,Dn,ur),this._positionX=e(this,C,E.positionX,Dn,ur),this._positionY=e(this,C,E.positionY,Dn,ur),this._positionZ=e(this,C,E.positionZ,Dn,ur),u(this,1)}get coneInnerAngle(){return this._nativePannerNode.coneInnerAngle}set coneInnerAngle(d){this._nativePannerNode.coneInnerAngle=d}get coneOuterAngle(){return this._nativePannerNode.coneOuterAngle}set coneOuterAngle(d){this._nativePannerNode.coneOuterAngle=d}get coneOuterGain(){return this._nativePannerNode.coneOuterGain}set coneOuterGain(d){this._nativePannerNode.coneOuterGain=d}get distanceModel(){return this._nativePannerNode.distanceModel}set distanceModel(d){this._nativePannerNode.distanceModel=d}get maxDistance(){return this._nativePannerNode.maxDistance}set maxDistance(d){this._nativePannerNode.maxDistance=d}get orientationX(){return this._orientationX}get orientationY(){return this._orientationY}get orientationZ(){return this._orientationZ}get panningModel(){return this._nativePannerNode.panningModel}set panningModel(d){this._nativePannerNode.panningModel=d}get positionX(){return this._positionX}get positionY(){return this._positionY}get positionZ(){return this._positionZ}get refDistance(){return this._nativePannerNode.refDistance}set refDistance(d){this._nativePannerNode.refDistance=d}get rolloffFactor(){return this._nativePannerNode.rolloffFactor}set rolloffFactor(d){this._nativePannerNode.rolloffFactor=d}},B2=(r,e,t,n,i,a,u,c,d,p)=>()=>{const g=new WeakMap;let _=null;const E=async(C,A)=>{let P=null,M=a(C);const U={channelCount:M.channelCount,channelCountMode:M.channelCountMode,channelInterpretation:M.channelInterpretation},W={...U,coneInnerAngle:M.coneInnerAngle,coneOuterAngle:M.coneOuterAngle,coneOuterGain:M.coneOuterGain,distanceModel:M.distanceModel,maxDistance:M.maxDistance,panningModel:M.panningModel,refDistance:M.refDistance,rolloffFactor:M.rolloffFactor},z=Sn(M,A);if("bufferSize"in M)P=n(A,{...U,gain:1});else if(!z){const X={...W,orientationX:M.orientationX.value,orientationY:M.orientationY.value,orientationZ:M.orientationZ.value,positionX:M.positionX.value,positionY:M.positionY.value,positionZ:M.positionZ.value};M=i(A,X)}if(g.set(A,P===null?M:P),P!==null){if(_===null){if(u===null)throw new Error("Missing the native OfflineAudioContext constructor.");const D=new u(6,C.context.length,A.sampleRate),V=e(D,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6});V.connect(D.destination),_=(async()=>{const k=await Promise.all([C.orientationX,C.orientationY,C.orientationZ,C.positionX,C.positionY,C.positionZ].map(async(ue,ve)=>{const pe=t(D,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:ve===0?1:0});return await c(D,ue,pe.offset),pe}));for(let ue=0;ue<6;ue+=1)k[ue].connect(V,0,ue),k[ue].start(0);return p(D)})()}const X=await _,j=n(A,{...U,gain:1});await d(C,A,j);const $=[];for(let D=0;D<X.numberOfChannels;D+=1)$.push(X.getChannelData(D));let x=[$[0][0],$[1][0],$[2][0]],I=[$[3][0],$[4][0],$[5][0]],R=n(A,{...U,gain:1}),b=i(A,{...W,orientationX:x[0],orientationY:x[1],orientationZ:x[2],positionX:I[0],positionY:I[1],positionZ:I[2]});j.connect(R).connect(b.inputs[0]),b.connect(P);for(let D=128;D<X.length;D+=128){const V=[$[0][D],$[1][D],$[2][D]],k=[$[3][D],$[4][D],$[5][D]];if(V.some((ue,ve)=>ue!==x[ve])||k.some((ue,ve)=>ue!==I[ve])){x=V,I=k;const ue=D/A.sampleRate;R.gain.setValueAtTime(0,ue),R=n(A,{...U,gain:0}),b=i(A,{...W,orientationX:x[0],orientationY:x[1],orientationZ:x[2],positionX:I[0],positionY:I[1],positionZ:I[2]}),R.gain.setValueAtTime(1,ue),j.connect(R).connect(b.inputs[0]),b.connect(P)}}return P}return z?(await r(A,C.orientationX,M.orientationX),await r(A,C.orientationY,M.orientationY),await r(A,C.orientationZ,M.orientationZ),await r(A,C.positionX,M.positionX),await r(A,C.positionY,M.positionY),await r(A,C.positionZ,M.positionZ)):(await c(A,C.orientationX,M.orientationX),await c(A,C.orientationY,M.orientationY),await c(A,C.orientationZ,M.orientationZ),await c(A,C.positionX,M.positionX),await c(A,C.positionY,M.positionY),await c(A,C.positionZ,M.positionZ)),za(M)?await d(C,A,M.inputs[0]):await d(C,A,M),M};return{render(C,A){const P=g.get(A);return P!==void 0?Promise.resolve(P):E(C,A)}}},z2={disableNormalization:!1},U2=(r,e,t,n)=>class uT{constructor(a,u){const c=e(a),d=n({...z2,...u}),p=r(c,d);return t.add(p),p}static[Symbol.hasInstance](a){return a!==null&&typeof a=="object"&&Object.getPrototypeOf(a)===uT.prototype||t.has(a)}},$2=(r,e)=>(t,n,i)=>(r(n).replay(i),e(n,t,i)),W2=(r,e,t)=>async(n,i,a)=>{const u=r(n);await Promise.all(u.activeInputs.map((c,d)=>Array.from(c).map(async([p,g])=>{const E=await e(p).render(p,i),C=n.context.destination;!t(p)&&(n!==C||!t(n))&&E.connect(a,g,d)})).reduce((c,d)=>[...c,...d],[]))},q2=(r,e,t)=>async(n,i,a)=>{const u=e(n);await Promise.all(Array.from(u.activeInputs).map(async([c,d])=>{const g=await r(c).render(c,i);t(c)||g.connect(a,d)}))},G2=(r,e,t,n)=>i=>r(ou,()=>ou(i))?Promise.resolve(r(n,n)).then(a=>{if(!a){const u=t(i,512,0,1);i.oncomplete=()=>{u.onaudioprocess=null,u.disconnect()},u.onaudioprocess=()=>i.currentTime,u.connect(i.destination)}return i.startRendering()}):new Promise(a=>{const u=e(i,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});i.oncomplete=c=>{u.disconnect(),a(c.renderedBuffer)},u.connect(i.destination),i.startRendering()}),K2=r=>(e,t)=>r.set(e,t),H2=(r,e,t,n,i,a,u,c)=>(d,p)=>t(d).render(d,p).then(()=>Promise.all(Array.from(n(p)).map(g=>t(g).render(g,p)))).then(()=>i(p)).then(g=>(typeof g.copyFromChannel!="function"?(u(g),xm(g)):e(a,()=>a(g))||c(g),r.add(g),g)),Q2={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",pan:0},X2=(r,e,t,n,i,a)=>class extends r{constructor(c,d){const p=i(c),g={...Q2,...d},_=t(p,g),E=a(p),C=E?n():null;super(c,!1,_,C),this._pan=e(this,E,_.pan)}get pan(){return this._pan}},Y2=(r,e,t,n,i)=>()=>{const a=new WeakMap,u=async(c,d)=>{let p=t(c);const g=Sn(p,d);if(!g){const _={channelCount:p.channelCount,channelCountMode:p.channelCountMode,channelInterpretation:p.channelInterpretation,pan:p.pan.value};p=e(d,_)}return a.set(d,p),g?await r(d,c.pan,p.pan):await n(d,c.pan,p.pan),za(p)?await i(c,d,p.inputs[0]):await i(c,d,p),p};return{render(c,d){const p=a.get(d);return p!==void 0?Promise.resolve(p):u(c,d)}}},Z2=r=>()=>{if(r===null)return!1;try{new r({length:1,sampleRate:44100})}catch{return!1}return!0},J2=(r,e)=>async()=>{if(r===null)return!0;if(e===null)return!1;const t=new Blob(['class A extends AudioWorkletProcessor{process(i){this.port.postMessage(i,[i[0][0].buffer])}}registerProcessor("a",A)'],{type:"application/javascript; charset=utf-8"}),n=new e(1,128,44100),i=URL.createObjectURL(t);let a=!1,u=!1;try{await n.audioWorklet.addModule(i);const c=new r(n,"a",{numberOfOutputs:0}),d=n.createOscillator();c.port.onmessage=()=>a=!0,c.onprocessorerror=()=>u=!0,d.connect(c),d.start(0),await n.startRendering(),await new Promise(p=>setTimeout(p))}catch{}finally{URL.revokeObjectURL(i)}return a&&!u},eb=(r,e)=>()=>{if(e===null)return Promise.resolve(!1);const t=new e(1,1,44100),n=r(t,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return new Promise(i=>{t.oncomplete=()=>{n.disconnect(),i(t.currentTime!==0)},t.startRendering()})},tb={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",curve:null,oversample:"none"},nb=(r,e,t,n,i,a,u)=>class extends r{constructor(d,p){const g=i(d),_={...tb,...p},E=t(g,_),A=a(g)?n():null;super(d,!0,E,A),this._isCurveNullified=!1,this._nativeWaveShaperNode=E,u(this,1)}get curve(){return this._isCurveNullified?null:this._nativeWaveShaperNode.curve}set curve(d){if(d===null)this._isCurveNullified=!0,this._nativeWaveShaperNode.curve=new Float32Array([0,0]);else{if(d.length<2)throw e();this._isCurveNullified=!1,this._nativeWaveShaperNode.curve=d}}get oversample(){return this._nativeWaveShaperNode.oversample}set oversample(d){this._nativeWaveShaperNode.oversample=d}},rb=(r,e,t)=>()=>{const n=new WeakMap,i=async(a,u)=>{let c=e(a);if(!Sn(c,u)){const p={channelCount:c.channelCount,channelCountMode:c.channelCountMode,channelInterpretation:c.channelInterpretation,curve:c.curve,oversample:c.oversample};c=r(u,p)}return n.set(u,c),za(c)?await t(a,u,c.inputs[0]):await t(a,u,c),c};return{render(a,u){const c=n.get(u);return c!==void 0?Promise.resolve(c):i(a,u)}}},sb=()=>typeof window>"u"?null:window,ib=(r,e)=>t=>{t.copyFromChannel=(n,i,a=0)=>{const u=r(a),c=r(i);if(c>=t.numberOfChannels)throw e();const d=t.length,p=t.getChannelData(c),g=n.length;for(let _=u<0?-u:0;_+u<d&&_<g;_+=1)n[_]=p[_+u]},t.copyToChannel=(n,i,a=0)=>{const u=r(a),c=r(i);if(c>=t.numberOfChannels)throw e();const d=t.length,p=t.getChannelData(c),g=n.length;for(let _=u<0?-u:0;_+u<d&&_<g;_+=1)p[_+u]=n[_]}},ob=r=>e=>{e.copyFromChannel=(t=>(n,i,a=0)=>{const u=r(a),c=r(i);if(u<e.length)return t.call(e,n,c,u)})(e.copyFromChannel),e.copyToChannel=(t=>(n,i,a=0)=>{const u=r(a),c=r(i);if(u<e.length)return t.call(e,n,c,u)})(e.copyToChannel)},ab=r=>(e,t)=>{const n=t.createBuffer(1,1,44100);e.buffer===null&&(e.buffer=n),r(e,"buffer",i=>()=>{const a=i.call(e);return a===n?null:a},i=>a=>i.call(e,a===null?n:a))},lb=(r,e)=>(t,n)=>{n.channelCount=1,n.channelCountMode="explicit",Object.defineProperty(n,"channelCount",{get:()=>1,set:()=>{throw r()}}),Object.defineProperty(n,"channelCountMode",{get:()=>"explicit",set:()=>{throw r()}});const i=t.createBufferSource();e(n,()=>{const c=n.numberOfInputs;for(let d=0;d<c;d+=1)i.connect(n,0,d)},()=>i.disconnect(n))},cT=(r,e,t)=>r.copyFromChannel===void 0?r.getChannelData(t)[0]:(r.copyFromChannel(e,t),e[0]),hT=r=>{if(r===null)return!1;const e=r.length;return e%2!==0?r[Math.floor(e/2)]!==0:r[e/2-1]+r[e/2]!==0},Eu=(r,e,t,n)=>{let i=r;for(;!i.hasOwnProperty(e);)i=Object.getPrototypeOf(i);const{get:a,set:u}=Object.getOwnPropertyDescriptor(i,e);Object.defineProperty(r,e,{get:t(a),set:n(u)})},ub=r=>({...r,channelCount:r.numberOfOutputs}),cb=r=>{const{imag:e,real:t}=r;return e===void 0?t===void 0?{...r,imag:[0,0],real:[0,0]}:{...r,imag:Array.from(t,()=>0),real:t}:t===void 0?{...r,imag:e,real:Array.from(e,()=>0)}:{...r,imag:e,real:t}},dT=(r,e,t)=>{try{r.setValueAtTime(e,t)}catch(n){if(n.code!==9)throw n;dT(r,e,t+1e-7)}},hb=r=>{const e=r.createBufferSource();e.start();try{e.start()}catch{return!0}return!1},db=r=>{const e=r.createBufferSource(),t=r.createBuffer(1,1,44100);e.buffer=t;try{e.start(0,1)}catch{return!1}return!0},fb=r=>{const e=r.createBufferSource();e.start();try{e.stop()}catch{return!1}return!0},Dm=r=>{const e=r.createOscillator();try{e.start(-1)}catch(t){return t instanceof RangeError}return!1},fT=r=>{const e=r.createBuffer(1,1,44100),t=r.createBufferSource();t.buffer=e,t.start(),t.stop();try{return t.stop(),!0}catch{return!1}},Vm=r=>{const e=r.createOscillator();try{e.stop(-1)}catch(t){return t instanceof RangeError}return!1},pb=r=>{r.start=(e=>(t=0,n=0,i)=>{const a=r.buffer,u=a===null?n:Math.min(a.duration,n);a!==null&&u>a.duration-.5/r.context.sampleRate?e.call(r,t,0,0):e.call(r,t,u,i)})(r.start)},pT=(r,e)=>{const t=e.createGain();r.connect(t);const n=(i=>()=>{i.call(r,t),r.removeEventListener("ended",n)})(r.disconnect);r.addEventListener("ended",n),Ua(r,t),r.stop=(i=>{let a=!1;return(u=0)=>{if(a)try{i.call(r,u)}catch{t.gain.setValueAtTime(0,u)}else i.call(r,u),a=!0}})(r.stop)},Tu=(r,e)=>t=>{const n={value:r};return Object.defineProperties(t,{currentTarget:n,target:n}),typeof e=="function"?e.call(r,t):e.handleEvent.call(r,t)},mb=mP(To),gb=EP(To),yb=Ck(rd),mT=new WeakMap,vb=Bk(mT),Fr=nk(new Map,new WeakMap),rs=sb(),gT=o2(Fr,Eo),Mm=jk(Hn),fn=W2(Hn,Mm,yo),_b=CP(gT,St,fn),Mt=Uk(YE),Ti=S2(rs),Rt=t2(Ti),yT=new WeakMap,vT=Dk(Tu),od=c2(rs),_T=Yk(od),wT=Zk(rs),wb=Jk(rs),zp=d2(rs),pn=QP(gP(KE),wP(mb,gb,Oh,yb,Fh,Hn,vb,yu,St,To,Ss,yo,rh),Fr,Xk(Lp,Fh,Hn,St,iu,Ss),Eo,sd,dr,Ek(Oh,Lp,Hn,St,iu,Mt,Ss,Rt),xk(yT,Hn,Ei),vT,Mt,_T,wT,wb,Rt,zp),Eb=SP(pn,_b,Eo,gT,Mt,Rt),Om=new WeakSet,iw=a2(rs),ET=pk(new Uint32Array(1)),Fm=ib(ET,Eo),Lm=ob(ET),Tb=xP(Om,Fr,dr,iw,Ti,Z2(iw),Fm,Lm),ad=TP(Or),TT=q2(Mm,_u,yo),Rs=uk(TT),Iu=u2(ad,Fr,hb,db,fb,Dm,fT,Vm,pb,ab(Eu),pT),Ps=$2(zk(_u),TT),Ib=PP(Rs,Iu,St,Ps,fn),is=XP(yP(QE),yT,XE,YP,uP,cP,hP,dP,fP,Mp,qE,od,dT),Sb=RP(pn,Ib,is,Mn,Iu,Mt,Rt,Tu),Cb=LP(pn,jP,Eo,Mn,h2(Or,Eu),Mt,Rt,fn),Ab=tk(Rs,aT,St,Ps,fn),Io=K2(mT),xb=ek(pn,is,Ab,sd,aT,Mt,Rt,Io),$a=s2(To,wT),Nb=lb(Mn,$a),Wa=p2(od,Nb),Rb=ik(Wa,St,fn),Pb=sk(pn,Rb,Wa,Mt,Rt),kb=lk(bm,St,fn),bb=ak(pn,kb,bm,Mt,Rt,ub),Db=y2(ad,Iu,Or,$a),ld=g2(ad,Fr,Db,Dm,Vm),Vb=fk(Rs,ld,St,Ps,fn),Mb=dk(pn,is,Vb,ld,Mt,Rt,Tu),IT=v2(dr,Eu),Ob=yk(IT,St,fn),Fb=gk(pn,Ob,IT,Mt,Rt,Io),Lb=Sk(Rs,lT,St,Ps,fn),jb=Ik(pn,is,Lb,lT,Mt,Rt,Io),ST=_2(dr),Bb=Pk(Rs,ST,St,Ps,fn),zb=Rk(pn,is,Bb,ST,dr,Mt,Rt,Io),Ub=Lk(Rs,Or,St,Ps,fn),$b=Fk(pn,is,Ub,Or,Mt,Rt),Wb=I2(sd,Mn,id,dr),jm=G2(Fr,Or,id,eb(Or,Ti)),qb=Qk(Iu,St,Ti,fn,jm),Gb=w2(Wb),Kb=Kk(pn,Gb,qb,Mt,Rt,Io),Hb=BP(is,Wa,ld,id,dr,cT,Rt,Eu),CT=new WeakMap,Qb=r2(Cb,Hb,vT,Rt,CT,Tu),AT=C2(ad,Fr,Dm,fT,Vm,pT),Xb=F2(Rs,AT,St,Ps,fn),Yb=O2(pn,is,AT,Xb,Mt,Rt,Tu),xT=ck(Iu),Zb=b2(xT,Mn,Or,hT,$a),ud=k2(xT,Mn,Zb,hT,$a,od,Eu),Jb=x2(Oh,Mn,Wa,Or,id,ud,dr,Fh,cT,$a),NT=A2(Jb),eD=B2(Rs,Wa,ld,Or,NT,St,Ti,Ps,fn,jm),tD=j2(pn,is,NT,eD,Mt,Rt,Io),nD=N2(Eo),rD=U2(nD,Mt,new WeakSet,cb),sD=P2(Wa,bm,Or,ud,dr,$a),RT=R2(sD,dr),iD=Y2(Rs,RT,St,Ps,fn),oD=X2(pn,is,RT,iD,Mt,Rt),aD=rb(ud,St,fn),lD=nb(pn,Mn,ud,aD,Mt,Rt,Io),uD=n2(rs),cD=Vk(rs),hD=new WeakMap,dD=$k(hD,Ti),fD=uD?_P(Fr,dr,bk(rs),cD,Mk(pP),Mt,dD,Rt,zp,new WeakMap,new WeakMap,J2(zp,Ti),rs):void 0,pD=e2(_T,Rt),mD=wk(Om,Fr,_k,kk,new WeakSet,Mt,pD,Vh,ou,Fm,Lm),gD=ZP(fD,Eb,Tb,Sb,xb,Pb,bb,Mb,Fb,mD,jb,zb,$b,Kb,Qb,Yb,tD,rD,oD,lD),yD=Wk(CT),vD=vk(dr,Ti),_D=H2(Om,Fr,Mm,yD,jm,Vh,Fm,Lm),wD=V2(gD,Fr,Mn,vD,_D),ow=(r,e,t)=>{const n=new wD(r.numberOfChannels,Math.round(t*r.sampleRate),r.sampleRate),i=n.createBiquadFilter(),a=n.createBufferSource();return i.frequency.value=240,i.type="lowpass",a.buffer=r,a.connect(i).connect(n.destination),a.start(0,e,t),n.startRendering().then(u=>{const c=u.getChannelData(0),d=u.sampleRate;return{channelData:c,sampleRate:d}})},ED=iP({analyze:({call:r})=>async(...e)=>{var t;const[n,i,a]=e,u=typeof i=="number"?i:0,c=typeof a=="number"?a:n.duration-u,{channelData:d,sampleRate:p}=await ow(n,u,c),g=typeof i=="object"?i:typeof a=="object"?a:(t=e[3])!==null&&t!==void 0?t:null;return r("analyze",{channelData:d,sampleRate:p,...g===null?g:{tempoSettings:g}},[d.buffer])},guess:({call:r})=>async(...e)=>{var t;const[n,i,a]=e,u=typeof i=="number"?i:0,c=typeof a=="number"?a:n.duration-u,{channelData:d,sampleRate:p}=await ow(n,u,c),g=typeof i=="object"?i:typeof a=="object"?a:(t=e[3])!==null&&t!==void 0?t:null;return r("guess",{channelData:d,sampleRate:p,...g===null?g:{tempoSettings:g}},[d.buffer])}}),TD=r=>{const e=new Worker(r);return ED(e)},ID=(r,e)=>{let t=null;return()=>{if(t!==null)return t;const n=new Blob([e],{type:"application/javascript; charset=utf-8"}),i=URL.createObjectURL(n);return t=r(i),setTimeout(()=>URL.revokeObjectURL(i)),t}},SD=`(()=>{var e={455:function(e,t){!function(e){"use strict";var t=function(e){return function(t){var r=e(t);return t.add(r),r}},r=function(e){return function(t,r){return e.set(t,r),r}},n=void 0===Number.MAX_SAFE_INTEGER?9007199254740991:Number.MAX_SAFE_INTEGER,o=536870912,s=2*o,a=function(e,t){return function(r){var a=t.get(r),i=void 0===a?r.size:a<s?a+1:0;if(!r.has(i))return e(r,i);if(r.size<o){for(;r.has(i);)i=Math.floor(Math.random()*s);return e(r,i)}if(r.size>n)throw new Error("Congratulations, you created a collection of unique numbers which uses all available integers!");for(;r.has(i);)i=Math.floor(Math.random()*n);return e(r,i)}},i=new WeakMap,c=r(i),u=a(c,i),l=t(u);e.addUniqueNumber=l,e.generateUniqueNumber=u}(t)}},t={};function r(n){var o=t[n];if(void 0!==o)return o.exports;var s=t[n]={exports:{}};return e[n].call(s.exports,s,s.exports,r),s.exports}(()=>{"use strict";const e=-32603,t=-32602,n=-32601,o=(e,t)=>Object.assign(new Error(e),{status:t}),s=t=>o('The handler of the method called "'.concat(t,'" returned an unexpected result.'),e),a=(t,r)=>async({data:{id:a,method:i,params:c}})=>{const u=r[i];try{if(void 0===u)throw(e=>o('The requested method called "'.concat(e,'" is not supported.'),n))(i);const r=void 0===c?u():u(c);if(void 0===r)throw(t=>o('The handler of the method called "'.concat(t,'" returned no required result.'),e))(i);const l=r instanceof Promise?await r:r;if(null===a){if(void 0!==l.result)throw s(i)}else{if(void 0===l.result)throw s(i);const{result:e,transferables:r=[]}=l;t.postMessage({id:a,result:e},r)}}catch(e){const{message:r,status:n=-32603}=e;t.postMessage({error:{code:n,message:r},id:a})}};var i=r(455);const c=new Map,u=(e,r,n)=>({...r,connect:({port:t})=>{t.start();const n=e(t,r),o=(0,i.generateUniqueNumber)(c);return c.set(o,(()=>{n(),t.close(),c.delete(o)})),{result:o}},disconnect:({portId:e})=>{const r=c.get(e);if(void 0===r)throw(e=>o('The specified parameter called "portId" with the given value "'.concat(e,'" does not identify a port connected to this worker.'),t))(e);return r(),{result:null}},isSupported:async()=>{if(await new Promise((e=>{const t=new ArrayBuffer(0),{port1:r,port2:n}=new MessageChannel;r.onmessage=({data:t})=>e(null!==t),n.postMessage(t,[t])}))){const e=n();return{result:e instanceof Promise?await e:e}}return{result:!1}}}),l=(e,t,r=()=>!0)=>{const n=u(l,t,r),o=a(e,n);return e.addEventListener("message",o),()=>e.removeEventListener("message",o)},h=(e,t,r)=>{const n=e.length,o=[];let s=!1;for(let a=0;a<n;a+=1)e[a]>t?s=!0:s&&(s=!1,o.push(a-1),a+=r/4-1);return s&&o.push(n-1),o},d=(e,t,r)=>{const n=(e=>{let t=0;const r=e.length;for(let n=0;n<r;n+=1)e[n]>t&&(t=e[n]);return t})(e),o=.3*n;let s=[],a=n-.05*n;if(n>.25)for(;s.length<30&&a>=o;)s=h(e,a,t),a-=.05*n;const i=(e=>{const t=[];return e.forEach(((r,n)=>{const o=Math.min(e.length-n,10);for(let s=1;s<o;s+=1){const o=e[n+s]-r;t.some((e=>e.interval===o&&(e.peaks.push(r),!0)))||t.push({interval:o,peaks:[r]})}})),t})(s),c=((e,t,r={})=>{var n,o;const s=Math.max(0,null!==(n=r.maxTempo)&&void 0!==n?n:180),a=Math.max(0,null!==(o=r.minTempo)&&void 0!==o?o:90),i=[];return e.forEach((e=>{let r=60/(e.interval/t);for(;r<a;)r*=2;for(;r>s;)r/=2;if(r<a)return;let n=!1,o=e.peaks.length;i.forEach((t=>{if(t.tempo===r&&(t.score+=e.peaks.length,t.peaks=[...t.peaks,...e.peaks],n=!0),t.tempo>r-.5&&t.tempo<r+.5){const n=2*Math.abs(t.tempo-r);o+=(1-n)*t.peaks.length,t.score+=(1-n)*e.peaks.length}})),n||i.push({peaks:e.peaks,score:o,tempo:r})})),i})(i,t,r);return c.sort(((e,t)=>t.score-e.score)),c},p=(e,t,r)=>{const n=d(e,t,r);if(0===n.length)throw new Error("The given channelData does not contain any detectable beats.");return n[0].tempo},f=(e,t,r)=>{const n=d(e,t,r);if(0===n.length)throw new Error("The given channelData does not contain any detectable beats.");const{peaks:o,tempo:s}=n[0],a=Math.round(s),i=60/a;o.sort(((e,t)=>e-t));let c=o[0]/t;for(;c>i;)c-=i;return{bpm:a,offset:c,tempo:s}};l(self,{analyze:({channelData:e,sampleRate:t,tempoSettings:r})=>({result:p(e,t,r)}),guess:({channelData:e,sampleRate:t,tempoSettings:r})=>({result:f(e,t,r)})})})()})();`,CD=ID(TD,SD),AD=(...r)=>CD().analyze(...r),un=new VI({log:!0,corePath:"https://unpkg.com/@ffmpeg/core@0.12.4/dist/ffmpeg-core.js",wasmPath:"https://unpkg.com/@ffmpeg/core@0.12.4/dist/ffmpeg-core.wasm"}),aw=async()=>{try{console.log("Starting FFmpeg load..."),await un.load({corePath:"https://cdn.jsdelivr.net/npm/@ffmpeg/core@0.12.15/dist/ffmpeg-core.js",wasmPath:"https://cdn.jsdelivr.net/npm/@ffmpeg/core@0.12.15/dist/ffmpeg-core.wasm"}),console.log("FFmpeg loaded successfully")}catch(r){throw console.error("FFmpeg load error:",r),r instanceof Error&&console.error({message:r.message,name:r.name,stack:r.stack,cause:r.cause}),alert("Failed to load FFmpeg. Please check your internet connection."),r}},xD=({onCreateSlideshow:r,onLoadSession:e,onClose:t})=>{const[n,i]=le.useState(!0),[a,u]=le.useState(!1);return T.jsx("div",{className:"landing-wrapper",children:T.jsxs("div",{className:"landing-container",children:[T.jsxs("div",{className:"landing-header",children:[T.jsx("button",{className:"info-button",onClick:()=>u(!0),children:T.jsx("span",{style:{width:24,height:24,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"50%",border:"1px solid white",fontSize:"16px"},children:"i"})}),T.jsx("h1",{className:"app-title",children:"Groove Slider v1.3"}),T.jsx("button",{className:"close-landing-button",onClick:t,children:T.jsx(lo,{size:24})})]}),T.jsxs("div",{className:"retro-background",children:[T.jsx("div",{className:"wave-pattern top"}),T.jsx("div",{className:"wave-pattern bottom"}),T.jsxs("div",{className:"project-management",children:[T.jsx("button",{className:"create-button",onClick:r,children:"Create Slideshow"}),T.jsx("button",{className:"sessions-toggle-button",onClick:()=>i(!n),children:n?"Hide Saved Projects":"Show Saved Projects"}),n&&T.jsx("div",{className:"landing-sessions-container",children:T.jsx(HR,{visible:!0,onLoadSession:e})})]})]}),T.jsx("div",{className:"featured-section",children:T.jsxs("button",{className:"use-style-button",children:[T.jsx($p,{size:18}),T.jsx("span",{children:"Follow Us "})]})}),a&&T.jsx(DD,{isOpen:a,onClose:()=>u(!1)})]})})},ND=({onUpload:r,onBPMChange:e,currentBPM:t,onStartPointChange:n,audioRef:i,musicUrl:a,musicStartPoint:u})=>{const[c,d]=le.useState(0),[p,g]=le.useState(!1),[_,E]=le.useState(1),[C,A]=le.useState(0),P=le.useRef(null),[M,U]=le.useState(""),[W,z]=le.useState(!1),[X,j]=le.useState(null),$=le.useRef(null),x=le.useRef(null);le.useRef(null),le.useEffect(()=>{if(!X){const D=new(window.AudioContext||window.webkitAudioContext);j(D)}return()=>{X&&X.close()}},[]);const I=async D=>{try{console.log("Starting BPM detection..."),z(!0);const V=new(window.AudioContext||window.webkitAudioContext),ue=await(await fetch(D)).arrayBuffer();console.log("Audio data fetched, decoding...");const ve=await V.decodeAudioData(ue);console.log("Audio decoded, analyzing tempo...");const pe=await AD(ve);console.log(`Raw detected tempo: ${pe}`);let de=pe;pe>140&&(de=pe/2);const ee=Math.round(de);return console.log(`Final detected BPM: ${ee}`),ee}catch(V){return console.error("BPM detection failed:",V),120}finally{z(!1)}},R=()=>{if(!P.current)return;const D=P.current.currentTime;if(d(D),p&&x.current!==null){const V=Math.abs(D-x.current);V>.005&&D<x.current+.5?(console.log(`Correcting drift of ${V.toFixed(6)}s`),P.current.currentTime=x.current,i.current&&(i.current.currentTime=x.current)):D>x.current+.5&&(x.current=null)}};le.useEffect(()=>{if(P.current&&i.current){P.current.addEventListener("timeupdate",R);const D=()=>{i.current.currentTime=P.current.currentTime};return P.current.addEventListener("timeupdate",D),P.current.addEventListener("seeking",()=>{$.current&&clearInterval($.current),$.current=setInterval(()=>{R()},10)}),P.current.addEventListener("seeked",()=>{$.current&&(clearInterval($.current),$.current=null)}),P.current.addEventListener("loadedmetadata",()=>{A(P.current.duration)}),()=>{P.current&&(P.current.removeEventListener("timeupdate",R),P.current.removeEventListener("timeupdate",D),P.current.removeEventListener("seeking",()=>{}),P.current.removeEventListener("seeked",()=>{})),$.current&&clearInterval($.current)}}},[i,P,p]);const b=async()=>{if(P.current)if(p)P.current.pause(),g(!1);else try{const D=P.current.currentTime;x.current=D,P.current.currentTime=D,X&&X.state==="suspended"&&await X.resume(),await P.current.play(),setTimeout(()=>{Math.abs(P.current.currentTime-D)>.005&&(console.log(`Forced correction: ${P.current.currentTime} -> ${D}`),P.current.currentTime=D)},10),g(!0)}catch(D){console.error("Playback error:",D),x.current=null}};return T.jsx("div",{className:"music-panel",children:T.jsxs("div",{className:"music-controls",children:[T.jsxs("div",{className:"bpm-control",children:[W&&T.jsxs("div",{className:"bpm-analyzer",children:[T.jsx(vS,{className:"spinner",size:18}),T.jsx("span",{children:"Analyzing beat..."})]}),T.jsxs("div",{className:"manual-bpm",children:[T.jsxs("label",{children:[T.jsx("span",{children:"AUTO-BPM"}),T.jsx("span",{children:"DETECTION:"})]}),T.jsx("input",{type:"number",min:"60",max:"180",value:t,onChange:D=>e(parseInt(D.target.value)),className:"bpm-input"})]}),T.jsxs("label",{className:"upload-button",children:[T.jsx($p,{className:"icon"}),T.jsx("span",{children:"Upload Music"}),T.jsx("input",{type:"file",accept:".mp3,.aac,.m4a,.wav,.aiff",onChange:async D=>{const V=D.target.files[0];if(V){const k=URL.createObjectURL(V);U(V.name),z(!0);try{const ue=await I(k);console.log(`Final detected BPM: ${ue}`),e(ue)}catch(ue){console.error("BPM detection failed:",ue),e(120)}finally{z(!1)}r(k),n(0),P.current&&(P.current.src=k,P.current.currentTime=0)}},className:"hidden-input"})]}),T.jsxs("label",{className:"record-button",children:[T.jsx(SS,{className:"icon"}),T.jsx("span",{children:"Record"}),T.jsx("input",{type:"file",accept:"audio/*",capture:"microphone",onChange:async D=>{const V=D.target.files[0];if(V)if(V.type.startsWith("audio/")&&V.size>0&&V.size<50*1024*1024){const k=URL.createObjectURL(V);U(V.name),z(!0);try{const ue=await I(k);console.log(`Final detected BPM: ${ue}`),e(ue)}catch(ue){console.error("BPM detection failed:",ue),e(120)}finally{z(!1)}r(k),n(0),P.current&&(P.current.src=k,P.current.currentTime=0)}else alert("Please select a valid audio file (max 50MB)")},className:"hidden-input"})]})]}),T.jsxs("div",{className:"music-player",children:[T.jsx("audio",{ref:P,src:a,onTimeUpdate:R,preload:"auto"}),a&&T.jsx("div",{className:"music-info",children:T.jsx("span",{children:M&&M.length>35?`${M.slice(0,35)}...`:M||"Track Title"})}),T.jsx("button",{className:"audio-control-button",onClick:b,children:p?T.jsx(hw,{size:32}):T.jsx(dw,{size:32})}),a&&T.jsx(YR,{audioUrl:a,audioRef:i,onStartPointChange:D=>{const V=Math.round(D*1e3)/1e3;x.current=V,n(V),P.current&&(P.current.currentTime=V)},musicStartPoint:u})]})]})})},RD=({currentIndex:r,totalSlides:e,onProgressClick:t})=>(console.log("Rendering ProgressBar",{currentIndex:r,totalSlides:e,bars:[...Array(e)].map((n,i)=>({index:i,isActive:i===r}))}),T.jsx("div",{className:"progress-container",children:[...Array(e)].map((n,i)=>T.jsx("div",{className:`progress-bar ${i===r?"active":""}`,style:{backgroundColor:i===r?"white":"rgba(255,255,255,0.3)"},onClick:()=>t(i)},i))})),PD=({onPrevious:r,onNext:e,isFirstSlide:t,isLastSlide:n})=>T.jsxs(T.Fragment,{children:[T.jsx("button",{onClick:r,className:"nav-button prev",disabled:t,children:T.jsx(Xi,{})}),T.jsx("button",{onClick:e,className:"nav-button next",disabled:n,children:T.jsx(ii,{})})]}),kD=({onFileUpload:r})=>T.jsx("div",{className:"empty-state",children:T.jsxs("label",{htmlFor:"file-upload",className:"file-upload-label",children:[T.jsx(nS,{size:48}),T.jsx("span",{children:"Add Images"}),T.jsx("input",{type:"file",id:"file-upload",accept:"image/*",multiple:!0,onChange:r,className:"hidden-input"})]})}),bD=({isOpen:r,progress:e,message:t})=>r?T.jsx("div",{className:"modal-overlay",children:T.jsx("div",{className:"modal-content export-progress",children:T.jsxs("div",{className:"loading-container",children:[T.jsx("h3",{className:"progress-title",children:t}),T.jsx("div",{className:"progress-bar-container",children:T.jsx("div",{className:"progress-bar-fill",style:{width:`${e||0}%`,transition:"width 0.3s ease-in-out"}})}),T.jsxs("div",{className:"progress-percentage",children:[Math.round(e||0),"%"]})]})})}):null,DD=({isOpen:r,onClose:e})=>{const[t,n]=le.useState(null),[i,a]=le.useState(""),[u,c]=le.useState(!0);le.useEffect(()=>{r&&(async()=>{try{if(console.group(" License Fetch Debugging"),console.log("Firestore DB:",tp),console.log("Modal Open:",r),!tp){console.error(" Firestore DB not initialized");return}const E=UN(tp,"content","license");console.log(" Document Reference:",E);try{const C=await eR(E);if(console.log(" Document Exists:",C.exists()),C.exists()){const A=C.data();console.log(" License Data:",A),A&&A.text?(console.log(" License Text Found"),a(A.text)):(console.warn(" No text field in license document"),a("No license text found."))}else console.warn(" No such document in Firestore"),a("License document does not exist.")}catch(C){if(console.error(" Snapshot Error:",C),C.code==="unavailable"){console.log(" Offline mode: Attempting to use cached data");const A=await getDocFromCache(E);if(A.exists()){const P=A.data();a(P.text||"Cached license text")}else a("License unavailable offline")}else a(`Error loading license: ${C.message}`)}}catch(E){console.error(" Detailed Firebase Error:",E),a(`Error loading license: ${E.message}`)}finally{console.groupEnd(),c(!1)}})()},[r]);const d=_=>{n(_)},p=()=>{n(null)},g=()=>{switch(t){case"credits":return T.jsxs("div",{className:"section-content",children:[T.jsxs("header",{className:"section-header",children:[T.jsx("button",{className:"back-button",onClick:p,children:T.jsx(Xi,{size:24})}),T.jsx("h2",{children:"Credits"})]}),T.jsx("div",{className:"section-body",children:T.jsxs("div",{className:"credits-content",children:[T.jsxs("div",{className:"developer-profile",children:[T.jsx("div",{className:"developer-avatar",children:T.jsx(HI,{size:64})}),T.jsx("h3",{children:"Ben Hayes"}),T.jsx("p",{className:"developer-title",children:"Creator & Developer"})]}),T.jsxs("div",{className:"company-info",children:[T.jsx("h4",{children:"Hayzer Apps"}),T.jsx("p",{children:"Groove Slider was designed, developed, and maintained by Ben Hayes as the sole developer."})]}),T.jsxs("div",{className:"developer-note",children:[T.jsx("p",{children:"From concept to implementation, every aspect of this app was crafted to provide an elegant way to create musical slideshows of your favorite moments."}),T.jsx("p",{children:"I hope you enjoy using Groove Slider as much as I enjoyed creating it."})]}),T.jsxs("div",{className:"contact-section",children:[T.jsx("h4",{children:"Connect"}),T.jsx("p",{children:"Have feedback or suggestions? I'd love to hear from you!"}),T.jsx("p",{children:"Email: contact@hayzerapps.com"})]})]})})]});case"feedback":return T.jsxs("div",{className:"section-content",children:[T.jsxs("header",{className:"section-header",children:[T.jsx("button",{className:"back-button",onClick:p,children:T.jsx(Xi,{size:24})}),T.jsx("h2",{children:"Feedback"})]}),T.jsx("div",{className:"section-body",children:T.jsxs("div",{className:"feedback-form",children:[T.jsx("p",{children:"We'd love to hear your thoughts on Groove Slider!"}),T.jsx("textarea",{placeholder:"Share your feedback here...",className:"feedback-textarea",rows:6}),T.jsx("button",{className:"submit-button",children:"Submit Feedback"})]})})]});case"restore":return T.jsxs("div",{className:"section-content",children:[T.jsxs("header",{className:"section-header",children:[T.jsx("button",{className:"back-button",onClick:p,children:T.jsx(Xi,{size:24})}),T.jsx("h2",{children:"Restore Purchase"})]}),T.jsxs("div",{className:"section-body",children:[T.jsx("p",{children:"Tap the button below to restore your previous purchases."}),T.jsx("button",{className:"restore-button",children:"Restore Purchases"})]})]});case"unsubscribe":return T.jsxs("div",{className:"section-content",children:[T.jsxs("header",{className:"section-header",children:[T.jsx("button",{className:"back-button",onClick:p,children:T.jsx(Xi,{size:24})}),T.jsx("h2",{children:"How to Unsubscribe"})]}),T.jsx("div",{className:"section-body",children:T.jsxs("div",{className:"unsubscribe-info",children:[T.jsx("p",{children:"For information on how to manage or cancel your subscription, please visit Google's official support page:"}),T.jsx("button",{className:"external-link-button",onClick:()=>window.open("https://support.google.com/googleplay/answer/7018481?hl=en&co=GENIE.Platform%3DAndroid","_blank"),children:"Google Play Subscription Help"})]})})]});case"privacy":return T.jsxs("div",{className:"section-content",children:[T.jsxs("header",{className:"section-header",children:[T.jsx("button",{className:"back-button",onClick:p,children:T.jsx(Xi,{size:24})}),T.jsx("h2",{children:"Privacy Policy"})]}),T.jsx("div",{className:"section-body",children:T.jsxs("div",{className:"privacy-content",children:[T.jsx("h3",{children:"Privacy Policy for Groove Slider"}),T.jsx("p",{children:"Last Updated: March 2, 2025"}),T.jsx("h4",{children:"Introduction"}),T.jsx("p",{children:"Welcome to Groove Slider. We respect your privacy and are committed to protecting your personal data. This privacy policy will inform you about how we handle your data when you use our application and tell you about your privacy rights."}),T.jsx("h4",{children:"What Data We Collect"}),T.jsx("p",{children:"Groove Slider requires access to the following on your device:"}),T.jsxs("ul",{children:[T.jsx("li",{children:"Image files (photos, pictures) that you select to include in your slideshows"}),T.jsx("li",{children:"Audio files (music, sounds) that you select to add to your slideshows"})]}),T.jsx("h4",{children:"How We Use Your Data"}),T.jsx("p",{children:"We use your data for the following purposes:"}),T.jsxs("ul",{children:[T.jsx("li",{children:"To create slideshows with your selected images"}),T.jsx("li",{children:"To add your selected music to your slideshows"}),T.jsx("li",{children:"To export these slideshows as MP4 video files to your device"})]}),T.jsx("h4",{children:"Data Processing"}),T.jsx("p",{children:"All data processing happens locally on your device. Your images and music:"}),T.jsxs("ul",{children:[T.jsx("li",{children:"Are not uploaded to our servers"}),T.jsx("li",{children:"Are not shared with third parties"}),T.jsx("li",{children:"Are only accessed when you explicitly grant permission"}),T.jsx("li",{children:"Are only used for the purpose of creating and exporting your slideshows"})]}),T.jsx("h4",{children:"Storage"}),T.jsx("p",{children:"The app stores:"}),T.jsxs("ul",{children:[T.jsx("li",{children:"Temporary copies of your selected images and music while processing"}),T.jsx("li",{children:"Your slideshow settings and preferences"}),T.jsx("li",{children:"Completed MP4 video files that are saved to your device storage"})]}),T.jsx("h4",{children:"Third-Party Services"}),T.jsx("p",{children:"Our app does not integrate with third-party analytics or advertising services."}),T.jsx("h4",{children:"Your Rights"}),T.jsx("p",{children:"You have the right to:"}),T.jsxs("ul",{children:[T.jsx("li",{children:"Delete your saved slideshows and preferences by uninstalling the app"}),T.jsx("li",{children:"Control what files you share with the app through your device permissions"})]}),T.jsx("h4",{children:"Children's Privacy"}),T.jsx("p",{children:"Our service is not directed to anyone under the age of 13. We do not knowingly collect personal information from children."}),T.jsx("h4",{children:"Changes to This Privacy Policy"}),T.jsx("p",{children:'We may update our Privacy Policy from time to time. We will notify you of any changes by posting the new Privacy Policy on this page and updating the "Last Updated" date.'}),T.jsx("h4",{children:"Contact Us"}),T.jsx("p",{children:"If you have any questions about this Privacy Policy, please contact us at: contact@grooveslider.app"})]})})]});case"license":return T.jsxs("div",{className:"section-content",children:[T.jsxs("header",{className:"section-header",children:[T.jsx("button",{className:"back-button",onClick:p,children:T.jsx(Xi,{size:24})}),T.jsx("h2",{children:"License Agreement"})]}),T.jsx("div",{className:"section-body",children:T.jsx("div",{className:"license-content",children:u?T.jsx("p",{children:"Loading license..."}):T.jsxs(T.Fragment,{children:[T.jsx("h3",{children:"End User License Agreement"}),T.jsx("p",{children:"Last Updated: March 2, 2025"}),T.jsx("div",{className:"license-text",children:i||"No license text available."})]})})})]});default:return null}};return T.jsx("div",{className:"modal-overlay",children:T.jsx("div",{className:"info-modal",children:t?g():T.jsxs(T.Fragment,{children:[T.jsxs("header",{className:"info-header",children:[T.jsx("h2",{children:"Settings"}),T.jsx("button",{className:"close-button",onClick:e,children:T.jsx(lo,{size:24})})]}),T.jsxs("div",{className:"info-content",children:[T.jsxs("div",{className:"pro-banner",children:[T.jsxs("div",{className:"pro-text",children:[T.jsxs("h3",{children:["Groove Slider ",T.jsx("span",{className:"pro-badge",children:"Pro"})]}),T.jsx("p",{children:"Unlock All Features"})]}),T.jsx("div",{className:"pro-image",children:T.jsx("div",{style:{width:80,height:80,background:"rgba(255,255,255,0.2)",borderRadius:"8px"}})})]}),T.jsxs("div",{className:"info-item-group",children:[T.jsxs("div",{className:"info-item",onClick:()=>d("credits"),children:[T.jsx(pS,{className:"info-icon"}),T.jsxs("div",{className:"info-text",children:[T.jsx("h4",{children:"Credits"}),T.jsx("p",{children:"About"})]}),T.jsx(ii,{})]}),T.jsxs("div",{className:"info-item",onClick:()=>d("feedback"),children:[T.jsx(TS,{className:"info-icon"}),T.jsx("div",{className:"info-text",children:T.jsx("h4",{children:"Feedback"})}),T.jsx(ii,{})]}),T.jsxs("div",{className:"info-item",onClick:()=>d("restore"),children:[T.jsx(BS,{className:"info-icon"}),T.jsx("div",{className:"info-text",children:T.jsx("h4",{children:"Restore Purchase"})}),T.jsx(ii,{})]})]}),T.jsxs("div",{className:"info-item-group",children:[T.jsxs("div",{className:"info-item",onClick:()=>d("unsubscribe"),children:[T.jsx(sS,{className:"info-icon"}),T.jsx("div",{className:"info-text",children:T.jsx("h4",{children:"How to unsubscribe"})}),T.jsx(ii,{})]}),T.jsxs("div",{className:"info-item",onClick:()=>d("privacy"),children:[T.jsx(wS,{className:"info-icon"}),T.jsx("div",{className:"info-text",children:T.jsx("h4",{children:"Privacy Policy"})}),T.jsx(ii,{})]}),T.jsxs("div",{className:"info-item",onClick:()=>d("license"),children:[T.jsx(cS,{className:"info-icon"}),T.jsx("div",{className:"info-text",children:T.jsx("h4",{children:"License"})}),T.jsx(ii,{})]}),T.jsxs("div",{className:"info-item",children:[T.jsx(dS,{className:"info-icon"}),T.jsxs("div",{className:"info-text",children:[T.jsx("h4",{children:"Version"}),T.jsx("p",{children:"Version 0.9.0 (Beta)"})]})]})]})]})]})})})},VD=({isVisible:r,onClose:e})=>r?T.jsx("div",{className:"share-notification",children:T.jsxs("div",{className:"share-content",children:[T.jsx("h3",{children:"Export Complete! "}),T.jsx("p",{children:"Share your creation:"}),T.jsxs("div",{className:"share-buttons",children:[T.jsx("button",{onClick:()=>window.open("https://instagram.com","_blank"),className:"share-button instagram",children:"Share to Instagram"}),T.jsx("button",{onClick:()=>window.open("https://tiktok.com","_blank"),className:"share-button tiktok",children:"Share to TikTok"})]}),T.jsx("button",{onClick:e,className:"close-notification",children:T.jsx(lo,{size:20})})]})}):null,PT=({stories:r,onClose:e,onReorder:t,onDelete:n,saveStateOnEditPanelToggle:i})=>{const[a,u]=le.useState(r.map((U,W)=>W+1)),[c,d]=le.useState(null),[p,g]=le.useState(null),[_,E]=le.useState(!1),C=U=>{d(c===U?null:U)},A=(U,W)=>{c===W&&(E(!0),U.currentTarget.style.cursor="grabbing")},P=(U,W)=>{U.preventDefault(),_&&c!==null&&c!==W&&g(W)},M=U=>{if(c!==null&&c!==U){const W=[...r],[z]=W.splice(c,1);W.splice(U,0,z);const X=W.map((j,$)=>$+1);u(X),t(W),d(null),g(null),E(!1)}};return T.jsxs("div",{className:"edit-panel",children:[T.jsxs("div",{className:"edit-panel-header",children:[T.jsx("h3",{children:"Re-order by Tap, Drag, Drop"}),T.jsx("button",{className:"edit-panel-close",onClick:e,children:T.jsx(lo,{size:20})})]}),T.jsx("div",{className:"thumbnails-container",children:r.map((U,W)=>T.jsx("div",{className:`thumbnail ${c===W?"selected":""}
${p===W?"drag-over":""}`,onClick:()=>C(W),onMouseDown:z=>A(z,W),onTouchStart:z=>A(z,W),onDragOver:z=>P(z,W),onMouseOver:z=>_&&P(z,W),onTouchMove:z=>{const X=z.touches[0],$=document.elementFromPoint(X.clientX,X.clientY).closest(".thumbnail");if($){const x=Array.from($.parentNode.children).indexOf($);P(z,x)}},onMouseUp:()=>M(W),onTouchEnd:()=>p!==null&&M(p),draggable:c===W,children:T.jsxs("div",{className:"thumbnail-content",children:[T.jsx("button",{className:"delete-button",onClick:z=>{z.stopPropagation(),n(W)},children:T.jsx(lo,{size:16})}),T.jsxs("div",{className:"image-thumbnail",children:[T.jsx("img",{src:U.url,alt:`Slide ${W+1}`}),c===W&&T.jsx("div",{className:"selection-dot"})]})]})},W))})]})},MD=({onFileUpload:r,onSaveSession:e,onExportSession:t,onPlayPause:n,isPlaying:i,duration:a,onDurationChange:u,onEdit:c,onMusicUpload:d,onBPMChange:p,musicUrl:g,bpm:_,onStartPointChange:E,musicStartPoint:C,audioRef:A,isLoopingEnabled:P,setIsLoopingEnabled:M,showEditPanel:U,setShowEditPanel:W,stories:z,setStories:X,handleDelete:j,handleReorder:$,saveStateOnEditPanelToggle:x})=>{const[I,R]=le.useState(!1),[b,D]=le.useState(!1),[V,k]=le.useState(1);le.useEffect(()=>{const ne=[.125,.25,.5,1,2,4,8,16].find(re=>Math.abs(a*_/(4*60)-re)<.01);ne&&k(ne)},[a,_]);const ue=(ee,ne)=>ee*4*60/ne,ve=()=>{R(!I),b&&D(!1),U&&W(!1)},pe=()=>{D(!b),I&&R(!1),U&&W(!1)},de=()=>{const ee=!U;W(ee),I&&R(!1),b&&D(!1),x(ee)};return T.jsxs("div",{className:"bottom-menu w-full flex flex-col items-stretch",children:[I&&T.jsx("div",{className:"duration-panel",children:T.jsxs("div",{className:"duration-controls",children:[T.jsx("h3",{children:"Bar-Based Slide Transitions"}),T.jsx("div",{className:"bar-options",children:[{value:.125,label:" Bar"},{value:.25,label:" Bar"},{value:.5,label:" Bar"},{value:1,label:"1 Bar"},{value:2,label:"2 Bars"},{value:4,label:"4 Bars"},{value:8,label:"8 Bars"},{value:16,label:"16 Bars"}].map(ee=>T.jsx("button",{className:`bar-option ${V===ee.value?"selected":""}`,onClick:()=>{const ne=ue(ee.value,_);k(ee.value),u(ne)},children:ee.label},ee.value))}),T.jsxs("div",{className:"duration-info",children:[T.jsx("span",{children:"Slide Change Speed:"}),T.jsxs("span",{className:"time-info",children:[a.toFixed(2),"s /",_," BPM"]})]})]})}),b&&T.jsx(ND,{audioRef:A,onUpload:d,onBPMChange:p,currentBPM:_,onStartPointChange:E,musicStartPoint:C,musicUrl:g}),U&&T.jsx(PT,{stories:z,onClose:()=>{W(!1),x(!1)},onReorder:$,onDelete:j}),T.jsxs("div",{className:"bottom-menu-buttons",children:[T.jsxs("button",{className:`bottom-menu-button ${P?"active":""}`,onClick:()=>M(!P),"data-loop":"true",children:[T.jsx(MS,{className:"bottom-menu-icon"}),T.jsx("span",{className:"bottom-menu-text",children:"Loop"})]}),T.jsxs("button",{className:`bottom-menu-button ${I?"active":""}`,onClick:ve,children:[T.jsx(uw,{className:"bottom-menu-icon"}),T.jsx("span",{className:"bottom-menu-text",children:"Speed"})]}),T.jsxs("button",{className:`bottom-menu-button ${b?"active":""}`,onClick:pe,children:[T.jsx($p,{className:"bottom-menu-icon"}),T.jsx("span",{className:"bottom-menu-text",children:"Music"})]}),T.jsxs("button",{className:`bottom-menu-button ${i?"active":""}`,onClick:n,children:[i?T.jsx(hw,{className:"bottom-menu-icon"}):T.jsx(dw,{className:"bottom-menu-icon"}),T.jsx("span",{className:"bottom-menu-text",children:i?"Pause":"Play"})]}),T.jsxs("div",{className:"bottom-menu-right-group",children:[T.jsxs("button",{className:`bottom-menu-button ${U?"active":""}`,onClick:de,children:[T.jsx(US,{className:"bottom-menu-icon"}),T.jsx("span",{className:"bottom-menu-text",children:"Edit"})]}),T.jsxs("label",{className:"bottom-menu-button",children:[T.jsx(gS,{className:"bottom-menu-icon"}),T.jsx("span",{className:"bottom-menu-text",children:"Add"}),T.jsx("input",{type:"file",id:"file-upload-bottom",accept:"image/*",multiple:!0,onChange:r,className:"hidden-input"})]}),T.jsxs("button",{className:"bottom-menu-button",onClick:e,children:[T.jsx(fw,{className:"bottom-menu-icon"}),T.jsx("span",{className:"bottom-menu-text",children:"Save"})]}),T.jsxs("button",{className:"bottom-menu-button",onClick:t,children:[T.jsx(cw,{className:"bottom-menu-icon"}),T.jsx("span",{className:"bottom-menu-text",children:"Export"})]})]})]})]})},OD=()=>{const[r,e]=le.useState(!0),[t,n]=le.useState(0),[i,a]=le.useState([]),[u,c]=le.useState(!1),[d,p]=le.useState(2),[g,_]=le.useState(!1),[E,C]=le.useState(!1),[A,P]=le.useState(!1),[M,U]=le.useState(null),[W,z]=le.useState(!1),[X,j]=le.useState(!1),[$,x]=le.useState(!1),[I,R]=le.useState("cover"),[b,D]=le.useState(!1),[V,k]=le.useState(!1),[ue,ve]=le.useState(null),[pe,de]=le.useState(""),[ee,ne]=le.useState(!1),[re,F]=le.useState(null),[Z,Ee]=le.useState(120),[Ve,me]=le.useState(0),[Be,te]=le.useState(!0),[q,ge]=le.useState({}),[Te,be]=le.useState(null),[$e,et]=le.useState(null),Le=le.useRef(null),Pt=le.useRef(null),On=async _e=>{try{await vr(`auto_save_edit_panel_${Date.now()}`,!0),console.log(`Session saved on edit panel ${_e?"open":"close"}`)}catch(xe){console.error("Error saving state on edit panel toggle:",xe)}},Yn=()=>{i.length>0?window.confirm("Start a new project? Any unsaved changes will be lost.")&&(fr(),e(!1)):e(!1)},fr=()=>{a([]),n(0),F(null),Le.current&&(Le.current.pause(),Le.current.src=""),c(!1),Ee(120),me(0),p(2),te(!1)},Zn=_e=>new Promise((xe,Fe)=>{const Ge=new Image;Ge.onload=()=>xe(_e),Ge.onerror=Fe,Ge.src=_e});le.useEffect(()=>{const _e=async()=>{const xe=[t-1,t,t+1].filter(Fe=>Fe>=0&&Fe<i.length);for(const Fe of xe)if(!q[i[Fe].url])try{await Zn(i[Fe].url),ge(Ge=>({...Ge,[i[Fe].url]:!0}))}catch(Ge){console.error("Failed to preload image:",Ge)}};i.length>0&&_e()},[t,i]),le.useEffect(()=>{aw().catch(console.error)},[]);const mn=async _e=>{const xe=Array.from(_e.target.files).filter(dt=>dt.type.startsWith("image/"));if(xe.length===0){alert("Please select image files only.");return}const Fe=await Promise.all(xe.map(async dt=>{const Ct=await gn(dt);return{type:"image",url:URL.createObjectURL(dt),originalName:dt.name,base64Data:Ct,dateAdded:new Date().toISOString()}})),Ge=[...i,...Fe];if(a(Ge),_e.target.value="",Fe.length>0)try{await vr("auto_save_"+Date.now(),!0),console.log(`Auto-save completed with ${Ge.length} total images`)}catch(dt){console.error("Auto-save failed:",dt)}},gn=_e=>new Promise(xe=>{const Fe=new FileReader;Fe.onloadend=()=>xe(Fe.result),Fe.readAsDataURL(_e)}),Lr=_e=>{const xe=_e.split(";base64,"),Fe=xe[0].split(":")[1],Ge=window.atob(xe[1]),dt=Ge.length,Ct=new Uint8Array(dt);for(let nn=0;nn<dt;++nn)Ct[nn]=Ge.charCodeAt(nn);return new Blob([Ct],{type:Fe})},pr=_e=>{F(_e),me(0),Le.current&&(Le.current.src=_e,Le.current.currentTime=0)},wt=_e=>{Ee(_e);const Ge=([.125,.25,.5,1,2,4,8,16].find(dt=>Math.abs(d*_e/(4*60)-dt)<.01)||1)*4*60/_e;p(Ge)},Fn=()=>{Pt.current=setInterval(()=>{n(_e=>!Be&&_e>=i.length-1?(st(),c(!1),Le.current&&Le.current.pause(),_e):(_e+1)%i.length)},d*1e3)},st=()=>{Pt.current&&clearInterval(Pt.current)},ht=async()=>{if(u)st(),Le.current&&Le.current.pause(),c(!1);else{if(t===i.length-1&&n(0),Fn(),Le.current&&re){const _e=Ve;Le.current.currentTime=_e;try{await Le.current.play(),setTimeout(()=>{Math.abs(Le.current.currentTime-_e)>.01&&(console.log("Correcting audio timing drift on play"),Le.current.currentTime=_e)},10)}catch(xe){console.log("Play error:",xe)}}c(!0)}};le.useEffect(()=>()=>st(),[]),le.useEffect(()=>{u&&(st(),Fn())},[d]);const yn=()=>{t<i.length-1&&n(t+1)},jr=()=>{t>0&&n(t-1)},Jn=_e=>be(_e.touches[0].clientX),mr=_e=>et(_e.touches[0].clientX),Ln=()=>{if(!Te||!$e)return;const _e=Te-$e,xe=_e>50,Fe=_e<-50;xe&&t<i.length-1&&yn(),Fe&&t>0&&jr(),be(null),et(null)},gr=_e=>{u&&(st(),c(!1),Le.current&&Le.current.pause()),n(0),a(_e)},yr=_e=>{const xe=i.filter((Fe,Ge)=>Ge!==_e);a(xe),t>=_e&&n(Math.max(0,t-1))},Ii=(_e,xe,Fe)=>Fe!=="cover"?`scale=${_e}:${xe}:force_original_aspect_ratio=1,pad=${_e}:${xe}:(ow-iw)/2:(oh-ih)/2:black`:`scale=iw*max(${_e}/iw\\,${xe}/ih):ih*max(${_e}/iw\\,${xe}/ih),crop=${_e}:${xe}`,Si=async _e=>{try{u&&(st(),Le.current&&Le.current.pause(),c(!1));const xe=await qR(_e);a(xe.stories),Ee(xe.bpm),p(xe.duration),te(xe.isLoopingEnabled),n(xe.currentIndex),R(xe.imageFitMode||"cover"),xe.musicUrl&&(F(xe.musicUrl),me(xe.musicStartPoint),Le.current&&(Le.current.src=xe.musicUrl,Le.current.currentTime=xe.musicStartPoint)),r&&e(!1),alert("Session loaded successfully!")}catch(xe){console.error("Error loading session:",xe),alert("Failed to load session: "+xe.message)}},Ci=async _e=>{const xe={..._e},{resolution:Fe="1080x1920",isExportLoopEnabled:Ge=!1,exportLoopDuration:dt=0}=xe;try{let Ct,nn="untitled.mp4";if("showSaveFilePicker"in window)Ct=await window.showSaveFilePicker({suggestedName:nn,types:[{description:"MP4 Video",accept:{"video/mp4":[".mp4"]}}]});else{const We=document.createElement("a");We.download=nn,Ct={createWritable:async()=>({write:async lt=>{const $t=URL.createObjectURL(new Blob([lt],{type:"video/mp4"}));We.href=$t,We.click(),URL.revokeObjectURL($t)},close:async()=>{}})}}k(!0),ne(!0),de("Preparing to export video..."),ve(0),un.loaded||await aw();let jn=[];const ks=[],[_r,Ai]=Fe.split("x").map(Number),Et=i.length*d,Br=Ge&&dt>0?Math.ceil(dt/Et):1;for(let We=0;We<Br;We++)for(let lt=0;lt<i.length;lt++){const $t=i[lt];de(`Processing image ${lt+1}/${i.length} (Loop ${We+1}/${Br})`);let zr;try{if($t.base64Data){const xi=Lr($t.base64Data);zr=new Uint8Array(await xi.arrayBuffer())}else zr=await Gy($t.url)}catch(xi){throw console.error(`Error fetching image ${lt+1}:`,xi),new Error(`Failed to process image ${lt+1}. Please check if all images are valid.`)}const vn=`input_${We}_${lt}.png`,os=`processed_${We}_${lt}.mp4`;await un.writeFile(vn,zr),jn.push(vn),await un.exec(["-loop","1","-i",vn,"-c:v","libx264","-t",`${d}`,"-pix_fmt","yuv420p","-vf",Ii(_r,Ai,I),"-r","30","-preset","ultrafast",os]),jn.push(os),ks.push({name:os}),ve((We*i.length+lt+1)/(Br*i.length)*75)}if(await un.writeFile("list.txt",ks.map(We=>`file '${We.name}'`).join(`
`)),jn.push("list.txt"),de("Creating final video..."),ve(85),await un.exec(["-f","concat","-safe","0","-i","list.txt","-c:v","copy","temp_output.mp4"]),jn.push("temp_output.mp4"),re){de("Adding background music...");try{let We;try{if(We=await Gy(re),console.log("Music data fetched, size:",We.byteLength),!We||We.byteLength<1e3)throw new Error("Music file appears to be invalid or too small")}catch(lt){throw console.error("Music fetch error:",lt),new Error("Could not access music file")}await un.writeFile("background.mp3",We),await un.exec(["-i","temp_output.mp4","-ss",String(Ve),"-i","background.mp3","-shortest","-map","0:v","-map","1:a","-c:v","copy","-c:a","aac","-b:a","192k","final_output.mp4"]);try{await un.deleteFile("background.mp3"),await un.deleteFile("temp_output.mp4")}catch(lt){console.warn("Non-critical cleanup error:",lt)}}catch(We){console.error("Music processing failed:",We),de("Music processing failed, creating video without audio..."),await un.exec(["-i","temp_output.mp4","-c","copy","final_output.mp4"])}}else await un.exec(["-i","temp_output.mp4","-c","copy","final_output.mp4"]);de("Preparing download..."),ve(95);try{const We=await un.readFile("final_output.mp4");ve(100);const lt=await Ct.createWritable();await lt.write(new Blob([We.buffer],{type:"video/mp4"})),await lt.close(),ne(!1),k(!1),D(!0);try{for(const $t of jn)await un.deleteFile($t);await un.deleteFile("final_output.mp4")}catch($t){console.warn("Final cleanup error (non-critical):",$t)}}catch(We){throw console.error("Final output error:",We),new Error(`Failed to save video: ${We.message}`)}}catch(Ct){console.error("Export error:",Ct),ne(!1),k(!1),alert(`Export failed: ${Ct.message}`);try{for(const nn of tempFiles||[])await un.deleteFile(nn).catch(()=>{})}catch{}}},vr=async(_e,xe=!1)=>{try{console.log("Saving session to IndexedDB:",{sessionName:_e,storiesCount:i.length,hasBase64Data:i.map(Ge=>!!Ge.base64Data),firstImagePreview:i.length>0?i[0].base64Data?i[0].base64Data.substring(0,50)+"...":"Missing base64 data":"No images"}),xe||(ne(!0),de("Saving session..."),ve(10));const Fe={name:_e,stories:i,musicUrl:re,bpm:Z,musicStartPoint:Ve,imageFitMode:I,duration:d,isLoopingEnabled:Be,currentIndex:t};xe||ve(40),await WR(Fe),console.log(`Session "${_e}" saved successfully!`,{timestamp:new Date().toISOString(),imageCount:i.length}),xe||(ve(100),de("Session saved successfully!"),setTimeout(()=>{ne(!1),_e.startsWith("auto_save_")||alert("Session saved successfully!")},1e3))}catch(Fe){console.error("Error saving session to database:",Fe,{sessionName:_e,storiesCount:i.length}),xe||(ne(!1),alert(`Failed to save session: ${Fe.message}`))}};return T.jsx(T.Fragment,{children:r?T.jsx(xD,{onCreateSlideshow:Yn,onLoadSession:Si,onClose:()=>e(!1)}):T.jsx("div",{className:"app-container",children:T.jsx("div",{className:"app-content",children:T.jsxs("div",{className:"slider-container",children:[T.jsxs("div",{className:"title-bar",children:[T.jsx("h1",{className:"slider-title",children:"Groove Slider"}),T.jsx("button",{onClick:()=>e(!0),className:"projects-button",children:"back"})]}),T.jsx("audio",{ref:Le,src:re,loop:!0}),i.length===0?T.jsx(kD,{onFileUpload:mn}):T.jsxs("div",{className:"story-container",onTouchStart:Jn,onTouchMove:mr,onTouchEnd:Ln,children:[T.jsx("div",{className:"story-slide",children:T.jsx("div",{className:"media-wrapper",children:T.jsxs("div",{className:"image-container",style:{position:"relative",width:"100%",height:"100%"},children:[T.jsx("button",{className:"image-fit-toggle",onClick:_e=>{_e.preventDefault(),console.log("Image fit button clicked"),R(xe=>{const Fe=xe==="cover"?"contain":"cover";return console.log("New image fit mode:",Fe),Fe})},children:I==="cover"?T.jsx(AS,{}):T.jsx(lS,{})}),i[t]&&i[t].url?T.jsx("img",{src:i[t].url,alt:`Slide ${t+1}`,className:"media-content",style:{objectFit:I,width:"100%",height:"100%",display:"block"},loading:"eager",onError:_e=>{console.log("Image failed to load, attempting recovery");const xe=i[t];if(xe&&xe.base64Data){const Fe=Lr(xe.base64Data),Ge=URL.createObjectURL(Fe),dt=[...i];dt[t]={...xe,url:Ge},a(dt),_e.target.src=Ge}}}):T.jsx("div",{className:"empty-image-placeholder",style:{backgroundColor:"#f5f5f5",width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",color:"#333"},children:"Select an image to display"})]})})}),T.jsx(PD,{onPrevious:jr,onNext:yn,isFirstSlide:t===0,isLastSlide:t===i.length-1}),T.jsx(RD,{currentIndex:t,totalSlides:i.length,onProgressClick:_e=>{console.log("Current Index:",t),console.log("Clicked Index:",_e),console.log("Total Stories:",i.length),n(_e)}})]}),T.jsx(MD,{audioRef:Le,onFileUpload:mn,onSaveSession:()=>z(!0),onExportSession:()=>P(!0),onPlayPause:ht,isPlaying:u,duration:d,onDurationChange:p,onEdit:()=>C(!E),onMusicUpload:pr,onBPMChange:wt,musicUrl:re,bpm:Z,onStartPointChange:me,musicStartPoint:Ve,onMusicPanelToggle:()=>setShowMusicPanel(!showMusicPanel),isLoopingEnabled:Be,setIsLoopingEnabled:te,showEditPanel:E,setShowEditPanel:C,stories:i,setStories:a,handleDelete:yr,handleReorder:gr,saveStateOnEditPanelToggle:On}),E&&T.jsx(PT,{stories:i,onClose:()=>{C(!1),On(!1)},onReorder:gr,onDelete:yr}),T.jsx(UR,{isOpen:A,progress:ue,message:pe,onClose:()=>P(!1),onExport:Ci,isExporting:V}),T.jsx($R,{isOpen:W,onClose:()=>z(!1),onSave:vr}),T.jsx(bD,{isOpen:ee,progress:ue,message:pe}),T.jsx(VD,{isVisible:b,onClose:()=>D(!1)})]})})})})};function FD({installPrompt:r,onInstallClick:e}){return T.jsxs("div",{className:"app-container",children:[r&&T.jsx("button",{onClick:e,style:{position:"fixed",top:"10px",right:"10px",zIndex:1e3,padding:"10px",backgroundColor:"#007bff",color:"white",border:"none",borderRadius:"5px",cursor:"pointer"},children:"Install App"}),T.jsx(OD,{})]})}function LD(){const[r,e]=le.useState(null);le.useEffect(()=>{"serviceWorker"in navigator&&window.addEventListener("load",async()=>{try{console.log("Attempting to register service worker"),console.log("Current origin:",window.location.origin),console.log("Current pathname:",window.location.pathname);const a=await navigator.serviceWorker.register("/groove-slider-img/sw.js",{scope:"/groove-slider-img/",type:"classic"});console.log("Service Worker registered successfully:",a),console.log("Registration scope:",a.scope)}catch(a){console.error("Service Worker registration failed:",a),console.error("Full error:",JSON.stringify(a,Object.getOwnPropertyNames(a)))}});const n=a=>{a.preventDefault(),e(a)},i=a=>{console.log("App was successfully installed")};return window.addEventListener("beforeinstallprompt",n),window.addEventListener("appinstalled",i),()=>{window.removeEventListener("beforeinstallprompt",n),window.removeEventListener("appinstalled",i)}},[]);const t=async()=>{if(r){r.prompt();const{outcome:n}=await r.userChoice;console.log(n==="accepted"?"User accepted the install prompt":"User dismissed the install prompt"),e(null)}};return T.jsx(le.StrictMode,{children:T.jsx(FD,{installPrompt:r,onInstallClick:t})})}$I.createRoot(document.getElementById("root")).render(T.jsx(LD,{}));
